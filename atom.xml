<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  
  <subtitle>日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</subtitle>
  <link href="https://jpdynamicscrm.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpdynamicscrm.github.io/blog/"/>
  <updated>2023-01-13T09:30:43.276Z</updated>
  <id>https://jpdynamicscrm.github.io/blog/</id>
  
  <author>
    <name>Japan Dynamics CRM &amp; Power Platform Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (有人実行)</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/</id>
    <published>2023-01-12T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.276Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの原野です。<br>本記事では Power Automate for desktop で作成したデスクトップ フローをクラウドフローから呼び出して、アテンド型(有人)でフローを実行する方法についてご案内いたします。  </p><span id="more"></span><ol><li><a href="#anchor-intro">概要</a></li><li><a href="#anchor-how-to-collect">有人実行(アテンド型)と無人実行(非アテンド型)の違い</a></li><li><a href="#anchor-licence-for-attended-automation">有人実行に必要なライセンスについて</a></li><li><a href="#anchor-attended-automation">デスクトップ フローを有人実行する方法</a><ol><li><a href="#anchor-register-computers">端末の登録方法</a></li><li><a href="#call-desktopflow-from-cloudflow">クラウド フローからデスクトップ フローを呼び出す方法</a></li><li><a href="#notes-on-attended-automation">有人実行の際の注意事項について</a></li><li><a href="#result-of-attended-automation-flow">実行結果</a></li></ol></li></ol><p><a id='anchor-intro'></a></p><h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p>クラウド フローから Power Automate for desktop を呼び出して、デスクトップ フローを有人実行する方法についてご案内いたします。  </p><p><a id='anchor-attend-and-unattended-automation'></a></p><h1 id="有人実行-アテンド型-と無人実行-非アテンド型-の違い"><a href="#有人実行-アテンド型-と無人実行-非アテンド型-の違い" class="headerlink" title="有人実行 (アテンド型) と無人実行 (非アテンド型) の違い"></a>有人実行 (アテンド型) と無人実行 (非アテンド型) の違い</h1><p>クラウド フローから Power Automate for desktop を呼び出す方法として以下の 2 種類がございます。  </p><ul><li>有人実行 (アテンド型) ：<br>ユーザーが端末にサインインしている状態でデスクトップ フローを実行します。デスクトップ フローの実行時に画面をリアルタイムで確認することができます。  </li><li>無人実行 (非アテンド型) ：<br>ユーザーが端末からサインアウトしている状態でデスクトップ フローを実行します。  </li></ul><p>有人実行と無人実行の違いについて、公開情報もございますのでご確認いただけますと幸いです。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/guidance/planning/attended-unattended">プロセス自動化のための有人および無人のシナリオ - Power Automate | Microsoft Learn</a></p><p><a id='anchor-licence-for-attended-automation'></a></p><h1 id="有人実行に必要なライセンスについて"><a href="#有人実行に必要なライセンスについて" class="headerlink" title="有人実行に必要なライセンスについて"></a>有人実行に必要なライセンスについて</h1><p>クラウド フローからデスクトップ フローを有人実行で呼び出す際には、下記のいずれかの Power Automate 有償ライセンスが必要になります。  </p><ul><li>有人RPAを含む Power Automate per user プラン  </li><li>従量課金制  </li></ul><p><a id='anchor-attended-automation'></a></p><h1 id="デスクトップ-フローを有人実行する方法"><a href="#デスクトップ-フローを有人実行する方法" class="headerlink" title="デスクトップ フローを有人実行する方法"></a>デスクトップ フローを有人実行する方法</h1><p>以下の方法について、順にご案内いたします。  </p><ul><li>端末の登録方法  </li><li>クラウド フローからデスクトップ フローを呼び出す方法  </li></ul><p><a id='register-computers'></a></p><h2 id="端末の登録方法"><a href="#端末の登録方法" class="headerlink" title="端末の登録方法"></a>端末の登録方法</h2><p>Power Automate コンピュータ ランタイムアプリを使用して、該当の環境にデスクトップ フローを実行する端末を登録を行います。  </p><ol><li><p>事前準備  </p><ul><li><p>セキュリティ ロール<br>コンピュータ登録には「環境作成者」または「デスクトップ フローコンピュータ所有者」のセキュリティ ロールが必要となります。<br>そのため、登録したい環境において、コンピュータ登録を実行しているアカウントに「環境作成者」または「デスクトップ フロー コンピュータ所有者」のセキュリティ ロールが付与されているかご確認ください。<br>セキュリティ ロールに関して以下の公開情報がございますので、ご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/security-roles-privileges">セキュリティ ロールおよび特権 - Power Platform | Microsoft Learn</a> </p></li><li><p>必要なエンドポイント<br>コンピュータを登録する際のネットワーク要件として、「ランタイムに必要なデスクトップ フロー サービス」がございます。<br>以下の公開情報をご確認いただき、グローバル エンドポイントと公開エンドポイントに接続できる状態となっているかご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/ip-address-configuration#desktop-flows-services-required-for-runtime">IP アドレスの構成 - Power Automate | Microsoft Learn</a>  </p></li></ul></li><li><p>Power Automate コンピュータ ランタイム アプリケーションをインストールする  </p><ul><li>Power Automate for desktop をまだインストールしていない場合<br>Power Automate for desktop のインストール時に「Power Automate コンピュータ ランタイム アプリをインストールして、Power Automate クラウド ポータルに接続する 」にチェックを入れます。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers3.png"></li><li>既にPower Automate for desktop インストールしている場合<br>設定 &gt; コンピューターの設定を開く &gt; アプリのインストールを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers.png">  </li></ul></li><li><p>Power Automate コンピュータ ランタイム アプリケーションを起動すると端末が自動的に現在の環境に登録されます。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers2.png"><br>上記の手順について公開情報にも記載がございますので、ご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage-machines#register-a-new-machine">コンピュータの管理 - Power Automate | Microsoft Learn</a>  </p></li></ol><p><a id='call-desktopflow-from-cloudflow'></a></p><h2 id="クラウド-フローからデスクトップ-フローを呼び出す方法"><a href="#クラウド-フローからデスクトップ-フローを呼び出す方法" class="headerlink" title="クラウド フローからデスクトップ フローを呼び出す方法"></a>クラウド フローからデスクトップ フローを呼び出す方法</h2><p>デスクトップ フローをクラウド フローから有人実行で呼び出す方法についてご案内いたします。  </p><ol><li><p>デスクトップ フローを作成します。<br>既にデスクトップ フローを作成済みの場合は手順 2 にお進みください。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow.png">  </p></li><li><p>デスクトップ フローを呼び出すためのクラウド フローを作成し、新しいステップ &gt; 「Desktop flows」コネクタの「デスクトップ用 Power Automate で構築したフローを実行する」アクションを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow4.png">  </p></li><li><p>デスクトップ フローへの接続を設定します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow5.png">  </p><ul><li>接続：コンピューターに直接送信をご指定ください。  </li><li>コンピューターまたはコンピューター グループ：登録済みの端末をご指定ください。  </li><li>ドメインとユーザー名：「ドメイン名\ユーザー名」の形式でご指定ください。<br>現在端末ログオンしているユーザーのドメインとユーザーの名は whoami コマンドから確認いただけます。<br>※ Web 版 Power Automate のログインアカウントではございませんので、ご注意ください。 </li><li>パスワード：上記で指定したユーザーのパスワードをご指定ください。  </li></ul><p> whoami コマンドについて、公開情報に詳細な記載がございますのでご確認ください。<br> <a href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/whoami">whoami | Microsoft Learn</a><br> また接続の作成方法についても、公開情報に詳細な記載がございますのでご確認ください。<br> <a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage-machines#trigger-a-desktop-flow-to-run-on-your-machine">コンピュータの管理 - Power Automate | Microsoft Learn</a>  </p></li><li><p>「デスクトップ用 Power Automate で構築したフローを実行する」アクションで呼び出したいデスクトップ フローと実行モードを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow6.png">  </p><ul><li>Desktop フロー：呼び出したいデスクトップ フローをご指定ください。  </li><li>実行モード：アテンド型をご指定ください。  </li></ul></li></ol><p><a id='notes-on-attended-automation'></a></p><h2 id="有人実行の際の注意事項について"><a href="#有人実行の際の注意事項について" class="headerlink" title="有人実行の際の注意事項について"></a>有人実行の際の注意事項について</h2><p>有人実行でデスクトップ フローを呼び出す際は、フローを問題なく実行するために以下の点をご確認いただけますと幸いです。  </p><ul><li>端末にログオンしていること：接続を設定した際に指定したユーザーでログオンしているかどうかご確認ください。  </li><li>画面をロックしていないこと：有人実行する際に画面をロックしているとフローが実行できませんので、画面がロックされていないことをご確認ください。  </li></ul><p><a id='result-of-attended-automation-flow'></a></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>Power Automate for desktop で作成したデスクトップ フローをクラウド フローからアテンド型 (有人) で呼び出して実行することができました。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/result-of-attended-automation-flow.png">  </p><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。  バージョンアップによって若干の UI の遷移など異なる場合があります。  その場合は画面の指示に従って進めてください。  </p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの原野です。&lt;br&gt;本記事では Power Automate for desktop で作成したデスクトップ フローをクラウドフローから呼び出して、アテンド型(有人)でフローを実行する方法についてご案内いたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で Teams のチーム作成とメンバー追加を自動化</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/create-team-and-add-members/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/create-team-and-add-members/</id>
    <published>2023-01-11T15:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.256Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの瀬戸です。</p><p>今回は、Teams の新しいチームの作成と、そのチームへのメンバー追加を、Power Automate で自動化する例をご紹介いたします。組織の方針でチーム作成を申請制にしている場合や、たくさんのチームを一度に作成しなければいけないときにご活用いただけます。</p><span id="more"></span><h2 id="メンバー表の例"><a href="#メンバー表の例" class="headerlink" title="メンバー表の例"></a>メンバー表の例</h2><p><img src="/blog/powerautomate/create-team-and-add-members/image01.png"></p><p>今回は、上図のような Excel ファイルのメンバー表を元に、チームのメンバーを追加すると想定しています。表はテーブル形式で、メンバーのメールアドレスと、チームに対する権限の列があります。このファイルを、既存の SharePoint サイトのドキュメント ライブラリへ保存しておきます。</p><h2 id="フローの例"><a href="#フローの例" class="headerlink" title="フローの例"></a>フローの例</h2><p>ここから、フローのサンプルをご案内します。フローの大まかな流れは下記の通りです。</p><ol><li>新しいチームを作成します。</li><li>Excel ファイルのメンバー表を読み込みます。</li><li>メンバー表のメールアドレスを元に、メンバーを追加します。</li></ol><h3 id="全体図"><a href="#全体図" class="headerlink" title="全体図"></a>全体図</h3><p>下図がフローの全体図です。それぞれのアクションの設定方法は後述します。</p><p><img src="/blog/powerautomate/create-team-and-add-members/image02.png"></p><h3 id="1-チームの作成"><a href="#1-チームの作成" class="headerlink" title="(1) チームの作成"></a>(1) チームの作成</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image03.png"></p><p>Microsoft Teams コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/teams/#%E3%83%81%E3%83%BC%E3%83%A0%E3%81%AE%E4%BD%9C%E6%88%90">チームの作成</a>」アクションを使用し、新しいチームを作成します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>チーム名</td><td>任意のチーム名を指定します。</td></tr><tr><td>説明</td><td>任意の説明文を指定します。</td></tr><tr><td>可視性</td><td>任意の値 (Private または Public) を選択します。</td></tr></tbody></table><p>「チームの作成」アクションでチームを作成すると、フロー作成者 (≒このアクションの接続のアカウント) がチームの所有者となります。</p><p>接続のアカウント：<br><img src="/blog/powerautomate/create-team-and-add-members/image18.png"></p><p>作成されたチームのメンバー：<br><img src="/blog/powerautomate/create-team-and-add-members/image19.png"></p><p>これは Teams で手作業でチームを作成した場合と同じ動作です。しかし、このままではメンバー表にいない人がチームに参加していることになってしまうため、後でチームを脱退する必要があります。このフローのサンプルでは、その脱退についても実施しています。</p><h3 id="2-表内に存在する行を一覧表示"><a href="#2-表内に存在する行を一覧表示" class="headerlink" title="(2) 表内に存在する行を一覧表示"></a>(2) 表内に存在する行を一覧表示</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image04.png"></p><p>Excel Online (Business) コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/excelonlinebusiness/#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%86%85%E3%81%AB%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8B%E8%A1%8C%E3%82%92%E4%B8%80%E8%A6%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B">表内に存在する行を一覧表示</a>」アクションを使用し、メンバー表の値を取得します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>場所</td><td>Excel ファイルがある場所を指定します。</td></tr><tr><td>ドキュメント ライブラリ</td><td>Excel ファイルがあるライブラリを指定します。</td></tr><tr><td>ファイル</td><td>Excel ファイルのパスを指定します。</td></tr><tr><td>テーブル</td><td>メンバー表のテーブル名を指定します。</td></tr></tbody></table><h3 id="3-マイ-プロフィールの取得-V2"><a href="#3-マイ-プロフィールの取得-V2" class="headerlink" title="(3) マイ プロフィールの取得 (V2)"></a>(3) マイ プロフィールの取得 (V2)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image05.png"></p><p>※ 設定が必要なパラメータはありません。</p><p>Office 365 Users コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365users/#%E8%87%AA%E5%88%86%E3%81%AE%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-(v2)">マイ プロフィールの取得 (V2)</a>」アクションを使用し、自分 (フロー作成者) の情報を取得します。<br>このアクションは、「(1) チームの作成」のアクションと接続のアカウントが同じである必要があります。</p><p>前述したように、「(1) チームの作成」で作成したチームは、自分が所有者として追加されています。しかし、メンバー表に自分がいない場合はチームから脱退しておきたいので、それに必要な情報を取得しています。</p><h3 id="4-アレイのフィルター処理-自分以外を抽出"><a href="#4-アレイのフィルター処理-自分以外を抽出" class="headerlink" title="(4) アレイのフィルター処理-自分以外を抽出"></a>(4) アレイのフィルター処理-自分以外を抽出</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image06.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-filter-array-action">アレイのフィルター処理</a>」アクションを使用し、Excel ファイルから取得したメンバー表から、自分 (フロー作成者) を削除した一覧を作成します。<br>この後メンバーをチームに追加しますが、前述したように自分はすでにメンバーとしてチームに参加しているため、追加の必要がないためです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>差出人</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「value」</td></tr><tr><td>条件式-左辺</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「メールアドレス」 ※<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しくない」</td></tr><tr><td>条件式-右辺</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「メール」</td></tr></tbody></table><p>※ 「メールアドレス」は メンバー表の列の名前です。</p><h3 id="5-Apply-to-each"><a href="#5-Apply-to-each" class="headerlink" title="(5) Apply to each"></a>(5) Apply to each</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image07.png"></p><p>コントロール コネクタの「Apply to each」アクションを使用し、自分 (フロー作成者) 以外のメンバーをチームに追加する繰り返し処理を行います。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>以前の手順から出力を選択</td><td>「(4) アレイのフィルター処理-自分以外を抽出」アクションの出力「本文」</td></tr></tbody></table><h3 id="6-ユーザーの検索-V2"><a href="#6-ユーザーの検索-V2" class="headerlink" title="(6) ユーザーの検索 (V2)"></a>(6) ユーザーの検索 (V2)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image08.png"></p><p>Office 365 Users コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365users/#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%92%E6%A4%9C%E7%B4%A2%E3%81%99%E3%82%8B-(v2)">ユーザーの検索 (V2)</a>」アクションを使用し、メンバー表のメールアドレスから、ユーザー情報を取得します。この後の処理に UPN (ユーザー プリンシパル名) が必要なのでこのアクションを使用していますが、メールアドレスと UPN が必ず一致する環境であれば、このアクションは必要ありません。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>検索語句</td><td>「(4) アレイのフィルター処理-自分以外を抽出」アクションの出力「メールアドレス」 ※<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr></tbody></table><p>※ 「メールアドレス」は メンバー表の列の名前です。</p><h3 id="7-作成-検索結果の1行目"><a href="#7-作成-検索結果の1行目" class="headerlink" title="(7) 作成-検索結果の1行目"></a>(7) 作成-検索結果の1行目</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image09.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、前のアクションのリスト形式の出力から、1行目を取り出します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td>以下を式として入力：<br><code>outputs(&#39;ユーザーの検索_(V2)&#39;)?[&#39;body/value&#39;]?[0]</code> ※</td></tr></tbody></table><p>※ <code>ユーザーの検索_(V2)</code> は、「(6) ユーザーの検索 (V2)」のアクション名です。</p><h3 id="8-チームにメンバーを追加する"><a href="#8-チームにメンバーを追加する" class="headerlink" title="(8) チームにメンバーを追加する"></a>(8) チームにメンバーを追加する</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image10.png"></p><p>Microsoft Teams コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/teams/#%E3%83%81%E3%83%BC%E3%83%A0%E3%81%AB%E3%83%A1%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">チームにメンバーを追加する</a>」アクションを使用し、新しく作成したチームにメンバーを追加します。また、メンバー表に「所有者」として記載されたメンバーを所有者として登録するようにします。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>チーム</td><td>「(1) チームの作成」アクションの出力「新しいチームID」</td></tr><tr><td>チームに追加するユーザーの<br>プリンシパル名または AAD ID</td><td>「(7) 作成-検索結果の1行目」アクションの出力「Id」<br>または以下を式として入力：<br><code>outputs(&#39;作成-検索結果の1行目&#39;)?[&#39;Id&#39;]</code> ※1</td></tr><tr><td>新しく追加されたユーザーが<br>チームの所有者である必要があります</td><td>以下を式として入力：<br><code>equals(item()?[&#39;権限&#39;], &#39;所有者&#39;)</code> ※2</td></tr></tbody></table><p>※1 <code>作成-検索結果の1行目</code> は、「(7) 作成-検索結果の1行目」のアクション名です。<br>※2 <code>権限</code> は、メンバー表の列名です。<code>所有者</code> は、メンバー表の権限の列に入力した値です。</p><h3 id="9-待ち時間-遅延"><a href="#9-待ち時間-遅延" class="headerlink" title="(9) 待ち時間 (遅延)"></a>(9) 待ち時間 (遅延)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image11.png"></p><p>スケジュール コネクタの「遅延」アクションを使用し、メンバーの追加後少し待機します。待機無しで次の処理へ移ると、前の処理がまだ処理中で、まれにエラーになることがあるためです。<br>実際に何秒待機するべきかは、サーバーの処理状況によって異なるため、個別に調整が必要です。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>カウント</td><td>5</td></tr><tr><td>単位</td><td>秒</td></tr></tbody></table><h3 id="10-アレイのフィルター処理-自分を抽出"><a href="#10-アレイのフィルター処理-自分を抽出" class="headerlink" title="(10) アレイのフィルター処理-自分を抽出"></a>(10) アレイのフィルター処理-自分を抽出</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image12.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-filter-array-action">アレイのフィルター処理</a>」アクションを使用し、メンバー表から自分 (フロー作成者) を抽出します。このアクションの出力を使い、既にチーム所有者として登録されている自分を削除するかどうか、権限を変更するかどうかを判定します。設定内容は、(4) のアクションとほぼ同じで、比較演算子が異なるのみです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>差出人</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「value」</td></tr><tr><td>条件式-左辺</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「メールアドレス」<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式-右辺</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「メール」</td></tr></tbody></table><p>※ <code>メールアドレス</code> は、メンバー表の列名です。</p><h3 id="11-条件-メンバー表に自分がないor所有者ではない"><a href="#11-条件-メンバー表に自分がないor所有者ではない" class="headerlink" title="(11) 条件-メンバー表に自分がないor所有者ではない"></a>(11) 条件-メンバー表に自分がないor所有者ではない</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image13.png"></p><p>コントロール コネクタの「条件」アクションを使用し、メンバー表に自分 (フロー作成者) がいない または メンバー表にはいるけど所有者ではないとき、で処理を分岐します。<br>条件に一致するときのみ、自分から所有者の権限を削除します。<br>メンバー表に自分がいないときはチームから自分を削除すればいいのですが、チームの所有者を削除するには、所有者権限の削除 → メンバーの削除、という 2 つの手順が必要です。</p><p>以下 2 つの条件式を「または」でつなげます：</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式1-左辺</td><td>以下を式として入力：<br><code>length(body(&#39;アレイのフィルター処理-自分を抽出&#39;))</code> ※1</td></tr><tr><td>条件式1-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式1-右辺</td><td><code>0</code></td></tr></tbody></table><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式2-左辺</td><td>以下を式として入力：<br><code>body(&#39;アレイのフィルター処理-自分を抽出&#39;)?[0]?[&#39;権限&#39;]</code> ※1</td></tr><tr><td>条件式2-比較演算子</td><td>「次の値に等しくない」</td></tr><tr><td>条件式2-右辺</td><td><code>所有者</code> ※2</td></tr></tbody></table><p>※1 <code>アレイのフィルター処理-自分を抽出</code> は、「(10) アレイのフィルター処理-自分を抽出」のアクション名です。<code>権限</code> は、メンバー表の列名です。<br>※2 <code>所有者</code> は、メンバー表の権限の列に入力した値です。</p><h3 id="12-HTTP-要求-V2-を送信する"><a href="#12-HTTP-要求-V2-を送信する" class="headerlink" title="(12) HTTP 要求 V2 を送信する"></a>(12) HTTP 要求 V2 を送信する</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image14.png"></p><p>Office 365 Groups コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365groups/#http-%E8%A6%81%E6%B1%82%E3%82%92%E9%80%81%E4%BF%A1%E3%81%99%E3%82%8B-v2-(%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC)">HTTP 要求 V2 を送信する</a>」アクションを使用し、自分 (フロー作成者) から所有者権限を削除します。<br>Teams のチームも Microsoft 365 グループの 1 つなので、メンバーの操作は Office 365 Groups コネクタのアクションからも行えます。しかし所有者権限を削除できるアクションは現時点では提供されていないため、「HTTP 要求 V2 を送信する」アクションを使用し Graph API を実行します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>URI</td><td><code>https://graph.microsoft.com/v1.0/groups/※1/owners/※2/$ref</code></td></tr><tr><td>メソッド</td><td>「DELETE」</td></tr><tr><td>本文</td><td>(空白)</td></tr><tr><td>Content-Type</td><td><code>application/json</code></td></tr></tbody></table><p>※1「(1) チームの作成」アクションの出力「新しいチームID」<br><br>※2「(3) マイ プロフィールの取得 (V2)」アクションの出力「ID」</p><p>参考：<a href="https://learn.microsoft.com/ja-jp/graph/api/group-delete-owners?view=graph-rest-1.0&tabs=http">グループ所有者を削除する - Microsoft Graph v1.0 | Microsoft Learn</a></p><h3 id="13-待ち時間-2-遅延"><a href="#13-待ち時間-2-遅延" class="headerlink" title="(13) 待ち時間 2 (遅延)"></a>(13) 待ち時間 2 (遅延)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image15.png"></p><p>スケジュール コネクタの「遅延」アクションを使用し、少し処理を待機します。<br>実際に何秒待機するべきかは、サーバーの処理状況によって異なるため、個別に調整が必要です。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>カウント</td><td>5</td></tr><tr><td>単位</td><td>秒</td></tr></tbody></table><h3 id="14-条件-メンバー表に自分がいない"><a href="#14-条件-メンバー表に自分がいない" class="headerlink" title="(14) 条件-メンバー表に自分がいない"></a>(14) 条件-メンバー表に自分がいない</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image16.png"></p><p>コントロール コネクタの「条件」アクションを使用し、メンバー表に自分 (フロー作成者) がいないとき、で条件分岐します。条件に一致するときのみ、チームから自分を削除します。<br>指定する条件は、(11) の条件式1と同じです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式-左辺</td><td>以下を式として入力：<br><code>length(body(&#39;アレイのフィルター処理-自分を抽出&#39;))</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式-右辺</td><td><code>0</code></td></tr></tbody></table><p>※ <code>アレイのフィルター処理-自分を抽出</code> は、「(10) アレイのフィルター処理-自分を抽出」のアクション名です。</p><h3 id="15-グループからメンバーを削除"><a href="#15-グループからメンバーを削除" class="headerlink" title="(15) グループからメンバーを削除"></a>(15) グループからメンバーを削除</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image17.png"></p><p>Office 365 Groups コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365groups/#%E3%83%A1%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E3%81%8B%E3%82%89%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B">グループからメンバーを削除</a>」アクションを使用し、自分 (フロー作成者) をチームから削除します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>グループ ID</td><td>「(1) チームの作成」アクションの出力「新しいチーム ID」</td></tr><tr><td>ユーザー プリンシパル名</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「ユーザー プリンシパル名」</td></tr></tbody></table><p>フローの各アクションの設定は以上です。</p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>今回の例では手動トリガーを使用しましたが、例えば手動トリガーの入力に「チーム名」などを追加すれば、実行の度に任意のチーム名を指定できるようになります。<br>そのほか、承認アクションや Microsoft Forms コネクタと組み合わせれば、申請からチーム作成の流れを自動化することも可能です。</p><p>この記事が皆さまの自動化の一助になりましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの瀬戸です。&lt;/p&gt;
&lt;p&gt;今回は、Teams の新しいチームの作成と、そのチームへのメンバー追加を、Power Automate で自動化する例をご紹介いたします。組織の方針でチーム作成を申請制にしている場合や、たくさんのチームを一度に作成しなければいけないときにご活用いただけます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>環境のテナント移行について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/T2T-Introduction/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/T2T-Introduction/</id>
    <published>2022-12-28T08:30:00.000Z</published>
    <updated>2023-01-13T09:30:43.392Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの島です。<br>本記事では、Power Platform の Dataverse あり環境を他のテナントに移行するプロセスについてご案内します。</p><span id="more"></span><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>Power Platform では、複数テナントの統合や企業組織の変更などに対応するため、環境のテナント移行をサポートしています。<br>テナント移行は運用影響の大きい処理であり、また <strong>リハーサル日程も含めた形で事前に移行スケジュールを計画いただく</strong> ことを弊社として強く推奨しております。<br>そのため計画段階でのお役に立てるよう、移行全体の流れやよくいただくご質問についてご案内いたします。</p><p>なお記事の前提として、以下の点についてご留意ください。</p><ul><li>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br>特にテナント移行は環境のダウンタイムを伴う運用影響の大きい処理ですので、確実に移行を完遂するため、記載内容についてはお手元でのご検証や弊社への問合せなどでもご確認ください。</li><li>最新情報につきましては、以下の公開情報もご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant">テナントからテナントへの移行</a></li><li>テナント移行は Dataverse あり環境が対象です。Dataverse なしの環境についてはテナント移行の実施が叶いませんので、Dataverse なしの環境に含まれるキャンバス アプリや Power Automate などの移行方法につきましては、各製品の公開情報をご参照ください。</li></ul><hr><ol><li><a href="#anchor-whole-process">移行の流れ</a></li><li><a href="#anchor-QA">よくいただくご質問</a></li></ol><p><a id='anchor-whole-process'></a></p><h2 id="1-移行の流れ"><a href="#1-移行の流れ" class="headerlink" title="1. 移行の流れ"></a>1. 移行の流れ</h2><p>テナント移行は以下の流れで実施いたします。</p><ol><li>(お客様) 移行対象の本番環境を直近でコピーしている環境について、リハーサル移行用のお問合せを起票いただく。</li><li>(お客様) テナント移行の事前準備を進めていただく。</li><li>(お客様) ユーザー マッピングファイルをご提供いただく。</li><li>(弊社) ユーザー マッピングファイルの検証を実施。</li><li>(弊社) 日程調整の上、テナント移行を実施。</li><li>(お客様・弊社) 1 ～ 5 のプロセスにて、リハーサル後の移行環境の動作に問題がなかった場合には、本番環境に対して 1 ～ 5 のプロセスを実施。</li></ol><h3 id="1-1-お問合せの起票について"><a href="#1-1-お問合せの起票について" class="headerlink" title="1-1. お問合せの起票について"></a>1-1. お問合せの起票について</h3><p>本番環境をコピーしたリハーサル環境をご用意いただいた上で、移行対象の環境ごとに、テナント移行を希望いただいている旨をご連絡ください。<br>お問合せ起票時に、以下の情報をお寄せください。</p><ul><li>移行対象環境の環境 URL</li><li>移行先のテナント ID ※<a href="https://learn.microsoft.com/ja-jp/sharepoint/find-your-office-365-tenant-id">ご確認方法</a></li><li>移行先テナントで環境にセキュリティ グループを割り当てる場合、セキュリティ グループの Azure Active Directory Object ID</li><li>移行実施をご希望の日時</li></ul><p>なお、移行日時をご指定いただく場合には、実施の 1 週間前までにお問合せにて日時をお知らせください。</p><h3 id="1-2-テナント移行の事前準備について"><a href="#1-2-テナント移行の事前準備について" class="headerlink" title="1-2. テナント移行の事前準備について"></a>1-2. テナント移行の事前準備について</h3><p>以下の項目について対応を実施ください。</p><h5 id="1-2-1-移行先テナントのライセンスについて"><a href="#1-2-1-移行先テナントのライセンスについて" class="headerlink" title="1-2-1. 移行先テナントのライセンスについて"></a>1-2-1. 移行先テナントのライセンスについて</h5><p>移行先テナントで、事前にユーザーに環境の利用権を有する Power Platform ライセンスを割り当てください。<br>またテナント単位のライセンスや Power Apps per app ライセンスをお使いの場合など、ユーザーに割り当てるライセンスがない場合にはお問合せにて個別にご相談ください。</p><h5 id="1-2-2-移行先テナントの容量について"><a href="#1-2-2-移行先テナントの容量について" class="headerlink" title="1-2-2. 移行先テナントの容量について"></a>1-2-2. 移行先テナントの容量について</h5><p>移行先テナントにて、移行対象の環境と同等以上の Power Platform テナントの空き容量を確保ください。<br>もしやむを得ず空き容量の確保が難しい場合には、お問合せにて個別にご相談ください。</p><p><a id='anchor-unsupported-components'></a></p><h5 id="1-2-3-事前準備が必要なコンポーネントについて"><a href="#1-2-3-事前準備が必要なコンポーネントについて" class="headerlink" title="1-2-3. 事前準備が必要なコンポーネントについて"></a>1-2-3. 事前準備が必要なコンポーネントについて</h5><p>テナント移行にあたって事前準備を実施いただく必要のあるコンポーネントがございます。<br>各コンポーネントについて、環境上での利用有無をご確認いただき、利用いただいている場合には事前準備を実施ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant?tabs=image#confirm-if-any-of-the-solutions-below-are-installed-in-the-environments-to-be-migrated-as-these-may-require-additional-steps-either-from-you-or-support">ご参考 : 対象コンポーネントについて</a></p><p>なお上記のコンポーネントの中には、キャンバス アプリや Power Automate など、<strong>事前対応いただかなかった場合移行できず消滅する機能</strong> が複数存在いたします。<br>そのため対象機能については、移行後に正しく動作するかをリハーサルにて必ずご確認いただきますようお願い申し上げます。</p><h5 id="1-2-4-ユーザー-SystemUser-テーブルのプラグインについて"><a href="#1-2-4-ユーザー-SystemUser-テーブルのプラグインについて" class="headerlink" title="1-2-4. ユーザー (SystemUser) テーブルのプラグインについて"></a>1-2-4. ユーザー (SystemUser) テーブルのプラグインについて</h5><p>ユーザー (SystemUser) テーブルに対してプラグインを実装いただいている場合、当該プラグインが動作することでユーザー マッピング時に想定しない処理が発生する可能性がございます。<br>そのため、移行前にユーザーテーブルのプラグインを無効化いただきますようお願い申し上げます。</p><h3 id="1-3-ユーザー-マッピングファイルのご提供について"><a href="#1-3-ユーザー-マッピングファイルのご提供について" class="headerlink" title="1-3. ユーザー マッピングファイルのご提供について"></a>1-3. ユーザー マッピングファイルのご提供について</h3><p>ユーザー マッピングファイルは、テナント移行において移行元テナントのユーザーと移行後テナントのユーザーを紐づける定義であり、以下のフォーマットで記述された CSV ファイルです。<br>「_移行元テナントのユーザーの UPN, 移行先テナントのユーザーの UPN_」</p><p>例えば AAA.com テナントから BBB.com テナントへ移行を行い、ユーザー XXX および YYY の 2 名のマッピングを行う場合、ユーザー マッピングファイルは以下のように記述されます。<br><em><code>XXX@AAA.com,XXX@BBB.com</code></em><br><em><code>YYY@AAA.com,YYY@BBB.com</code></em></p><p>そのため、以下の手順に従ってユーザー マッピングファイルを作成し、お問合せ内でご提供ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant?tabs=image#steps-to-create-the-mapping-file">ご参考 : マッピング ファイルを作成するステップ</a></p><p>なお、ユーザー マッピングファイルの内容に起因してテナント移行が失敗する事例が多くございます。<br>そのため、<strong>リハーサル移行であっても極力本番移行と同一のユーザー マッピングファイル</strong> をご提供いただきますようお願い申し上げます。<br>本番移行まで期間が空くなどにより同一ファイルのご提供が難しい場合には、観点を分けての複数回のリハーサル実施も承っております。</p><h3 id="1-4-ユーザー-マッピングファイルの検証について"><a href="#1-4-ユーザー-マッピングファイルの検証について" class="headerlink" title="1-4. ユーザー マッピングファイルの検証について"></a>1-4. ユーザー マッピングファイルの検証について</h3><p>ユーザー マッピングファイルをご提供いただいた後、弊社にてファイルの内容をもとに、ユーザーの存在有無やライセンス状況の確認を行います。<br>問題があった場合にはお問合せ内でその旨をご連絡いたします。<br>問題がない場合には、調整させていただいた日時をもとに、テナント移行の実施を手配いたします。</p><h3 id="1-5-テナント移行の実施について"><a href="#1-5-テナント移行の実施について" class="headerlink" title="1-5. テナント移行の実施について"></a>1-5. テナント移行の実施について</h3><p>いただいた情報をもとに、弊社データセンター部門にてテナント移行を実施いたします。<br>テナント移行の実施中は環境にアクセスいただけなくなりますのでご注意ください。<br>移行完了後、技術サポートから窓口営業時間内に移行結果をご連絡いたします。</p><h3 id="1-6-本番移行の実施について"><a href="#1-6-本番移行の実施について" class="headerlink" title="1-6. 本番移行の実施について"></a>1-6. 本番移行の実施について</h3><p>弊社では、本番環境をテナント移行する場合、移行が適切に行えることを確認するために必ずテスト環境での事前リハーサルをお願いしております。<br>必ず 1 から 5 までの手順にてリハーサル結果が問題ないことを確認の上で、本番環境の移行をご依頼ください。<br>特に <a href="#anchor-unsupported-components">1-2-3</a> の通り、移行にあたって追加対応が必要なコンポーネントにつきましては、必ずリハーサル後に動作をご確認ください。</p><p>本番移行にあたっては、リハーサルを実施した際のお問合せ番号を併記の上、改めてお問合せを起票いただけますと幸いです。</p><hr><p><a id='anchor-QA'></a></p><h2 id="2-よくいただくご質問"><a href="#2-よくいただくご質問" class="headerlink" title="2. よくいただくご質問"></a>2. よくいただくご質問</h2><h3 id="2-1-テナント移行前後で変更される環境情報はあるか"><a href="#2-1-テナント移行前後で変更される環境情報はあるか" class="headerlink" title="2-1. テナント移行前後で変更される環境情報はあるか"></a>2-1. テナント移行前後で変更される環境情報はあるか</h3><p>以下の項目については変更や影響がございますので、ご留意ください。</p><ul><li><a href="#anchor-unsupported-components">事前準備が必要なコンポーネント</a>には移行されないものがございます。</li><li>ユーザー マッピングに伴い、UPN や氏名などのユーザー情報が新テナントの Azure Active Directory の内容に置き換わります。</li></ul><p>以下の項目は変化いたしません。</p><ul><li>環境の URL ※環境を別リージョンに移行する場合を除く</li><li>環境の組織 ID</li><li>モデル駆動型アプリの内容や構成</li><li>関連付けやレコードの所有権情報、セキュリティ ロール情報などを含む Dataverse のすべてのデータ</li></ul><h3 id="2-2-移行の所要時間はどの程度か"><a href="#2-2-移行の所要時間はどの程度か" class="headerlink" title="2.-2. 移行の所要時間はどの程度か"></a>2.-2. 移行の所要時間はどの程度か</h3><p>移行の所要時間は、クラウド リソースの利用状況やネットワーク状況に依存いたします。<br>そのため移行時間を事前にお見積りすることは叶いませんが、通常では数時間程度の所要時間をいただいております。<br>詳細な移行時間につきましては、リハーサル移行の実績を目安としていただけますと幸いです。</p><h3 id="2-3-夜間や休日の移行を希望するが、Microsoft-側でどのような支援体制が可能か"><a href="#2-3-夜間や休日の移行を希望するが、Microsoft-側でどのような支援体制が可能か" class="headerlink" title="2-3 夜間や休日の移行を希望するが、Microsoft 側でどのような支援体制が可能か"></a>2-3 夜間や休日の移行を希望するが、Microsoft 側でどのような支援体制が可能か</h3><p>弊社技術サポートでは、<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-overview#what-hours-are-considered-local-business-hours-for-support">弊社技術サポート営業時間</a>内でのご支援を承っております。<br>そのため夜間や休日に移行を実施する場合には、営業時間内での技術サポートからの完了報告が叶いませんので、技術サポートからは翌営業日の営業時間に実施結果をご報告いたします。<br>誠に恐れ入りますが、サポート契約上の制限事項として何卒ご理解を賜りますようお願い申し上げます。</p><p>夜間や休日帯の移行に際し、弊社からのご連絡前に結果を確認されたい場合には、移行が完了したと考えられる時間帯以降に、環境がアクセス可能であることや環境の管理モードが無効となっていることをご確認ください。</p><h3 id="2-4-移行が失敗した場合の対応について"><a href="#2-4-移行が失敗した場合の対応について" class="headerlink" title="2-4 移行が失敗した場合の対応について"></a>2-4 移行が失敗した場合の対応について</h3><p>移行が万が一失敗した場合には、以下の対応を行います。</p><ul><li><p>テナントの移行処理自体が失敗した場合<br>弊社側で、自動で処理のロールバックを行います。</p></li><li><p>ユーザー マッピングが一部ユーザーのライセンス不足などにより失敗した場合<br>テナント移行の自動ロールバックは行いません。そのため環境の移行自体は完了し、ユーザー マッピングのみが完了していない状態となります。<br>この場合には、失敗した原因ごとに、ライセンス付与やユーザー マッピングファイルの修正など、発生事象に応じたご対応をお願い申し上げます。</p></li></ul><p>また、特に本番環境の移行が万が一失敗し、これにより広範な業務停止などの重大な影響が発生した場合には、緊急度重大のお問合せを起票いただくことで、事象回避を目的とした 24 時間体制でご支援できる場合がございます。</p><h3 id="2-5-ユーザー-マッピング後のユーザー情報はどのように更新されるか"><a href="#2-5-ユーザー-マッピング後のユーザー情報はどのように更新されるか" class="headerlink" title="2-5 ユーザー マッピング後のユーザー情報はどのように更新されるか"></a>2-5 ユーザー マッピング後のユーザー情報はどのように更新されるか</h3><p>ユーザー マッピング処理では、環境のユーザー情報のうち、UPN など Azure AD との連携に直接関わる部分の書き換えを行います。<br>これにより、移行完了後のユーザーは新テナントの Azure AD と同期されるようになります。<br>従って、その後は通常のユーザー同期機構により、ユーザー情報 (氏名や状態など) の書き換えが追加で行われます。</p><p>そのため移行後のユーザー状況が意図したものとなっていない場合、ユーザー同期機構の正常な動きに事象が起因する可能性がございますので、一度 Power Platform 管理センターからユーザーを再度追加するなどし、同期内容をご検証いただけますと幸いです。<br>よくいただくご質問として、Office 365 ライセンスのみをお持ちのユーザー様について、ユーザー マッピング後に一時的に状態が無効となるケースがございます。<br>これは当該ユーザーがライセンス要件上、環境に自動で追加されないためでございます。<br>本挙動は通常環境にユーザーを追加いただく際にも発生する正常なものであり、ユーザーの環境利用には影響いたしません。<br>・ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/create-users#categories-of-users-not-added-automatically-in-dataverse">Dataverse に自動的に追加されないユーザーのカテゴリ</a></p><hr><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>本記事がテナント移行をご検討いただいている皆様のお役に立てましたら幸いです。<br>ご不明な点などがございましたら、弊社サポート一同にてお待ち申し上げておりますので、ぜひお気軽にお問合せください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの島です。&lt;br&gt;本記事では、Power Platform の Dataverse あり環境を他のテナントに移行するプロセスについてご案内します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="環境" scheme="https://jpdynamicscrm.github.io/blog/tags/%E7%92%B0%E5%A2%83/"/>
    
    <category term="テナント移行" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E7%A7%BB%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop お問い合わせの際の情報取得手順</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/</id>
    <published>2022-12-28T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.284Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの原野です。<br>本記事では Power Automate for desktop 関連のお問い合わせの際の、情報取得手順についてご案内いたします。</p><span id="more"></span><ol><li><a href="#anchor-intro">概要</a></li><li><a href="#anchor-how-to-collect">情報取得手順詳細</a><ol><li><a href="#anchor-pad-version">Power Automate for desktop のバージョン</a></li><li><a href="#anchor-os-version">OS のバージョン</a></li><li><a href="#anchor-computer-log">コンピューター ログ</a></li><li><a href="#anchor-fiddler-log">Fiddler ログ</a></li><li><a href="#anchor-machine-information">マシン登録の情報</a></li><li><a href="#anchor-remote-desktop-setting">リモートデスクトップ設定</a></li><li><a href="#anchor-registry-setting">レジストリの設定</a></li><li><a href="#anchor-desktopflow">Power Automate for desktop のフロー</a></li><li><a href="#anchor-desktopflow-url">デスクトップ フローの実行履歴 URL</a></li><li><a href="#anchor-cloudflow-run-history-csv">クラウド フローの実行履歴 CSV</a></li><li><a href="#anchor-cloudflow-raw-input-output">クラウド フローのアクションの未加工入力と未加工出力</a></li></ol></li></ol><p><a id='anchor-intro'></a></p><h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p>Power Automate for desktop に関するサポートサービスのお問い合わせの際の、情報取得手順についてご案内致します。</p><p><a id='anchor-how-to-collect'></a></p><h1 id="情報取得手順詳細"><a href="#情報取得手順詳細" class="headerlink" title="情報取得手順詳細"></a>情報取得手順詳細</h1><p><a id='anchor-pad-version'></a></p><h2 id="1-Power-Automate-for-desktop-のバージョン"><a href="#1-Power-Automate-for-desktop-のバージョン" class="headerlink" title="1. Power Automate for desktop のバージョン"></a>1. Power Automate for desktop のバージョン</h2><p>Power Automate for desktop のバージョンが確認できる画面キャプチャをご提供ください。</p><ol><li>Power Automate for desktop &gt; ヘルプ &gt; バージョン情報 を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/pad-version.png">     </li><li>以下の画面キャプチャを取得してご提供ください。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/pad-version2.png"> </li></ol><p>なお、Power Automate for desktop のバージョンは以下からもご確認いただけます。 </p><ul><li>Power Automate for desktop の exe ファイル &gt; プロパティ &gt; 詳細<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/pad-version4.png"> </li></ul><p><a id='anchor-os-version'></a></p><h2 id="2-OS-のバージョン"><a href="#2-OS-のバージョン" class="headerlink" title="2. OS のバージョン"></a>2. OS のバージョン</h2><p>OS のバージョンが確認できる以下の画面キャプチャをご提供ください。</p><ul><li>システム &gt; バージョン情報 を開き以下の画面キャプチャを取得します。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/os-version1.png">  </li></ul><p><a id='anchor-computer-log'></a></p><h2 id="3-コンピューター-ログ"><a href="#3-コンピューター-ログ" class="headerlink" title="3. コンピューター ログ"></a>3. コンピューター ログ</h2><p>コンピューター ログの取得方法は大きく分けて 3 つございます。<br>Power Automate コンピューター ランタイムをご利用いただいている場合は a) の方法から、ご利用いただけない場合は b) の方法からログを取得してご提供ください。    </p><p>また、RunDefinition.json ファイルと Actions.log ファイルを保持するレジストリを登録いただいている場合は、c) の方法で取得できるログも併せてご提供ください。</p><h3 id="a-Power-Automate-コンピュータ-ランタイムからログを収集する"><a href="#a-Power-Automate-コンピュータ-ランタイムからログを収集する" class="headerlink" title="a) Power Automate コンピュータ ランタイムからログを収集する"></a>a) Power Automate コンピュータ ランタイムからログを収集する</h3><p>フロー実行後のログの出力に関して、過去 3 日間のログが Power Automate コンピューター ランタイムから出力いただけます。<br>Power Automate コンピュータ ランタイムからエクスポートした zip ファイルをご提供ください。  </p><ul><li>Power Automate コンピュータ ランタイム &gt; トラブルシューティング &gt; ログのエクスポート を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/computer-log.png"></li></ul><p>公開情報にも手順の記載がございますので、ご参照いただけますと幸いです。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/troubleshoot#collect-machine-logs">デスクトップ フローのトラブルシューティング - Power Automate | Microsoft Learn</a></p><h3 id="b-管理者権限のあるアカウントでフォルダからログを収集する"><a href="#b-管理者権限のあるアカウントでフォルダからログを収集する" class="headerlink" title="b) 管理者権限のあるアカウントでフォルダからログを収集する"></a>b) 管理者権限のあるアカウントでフォルダからログを収集する</h3><p>管理者権限のあるアカウントで以下のフォルダ内にあるファイルを zip ファイルにまとめてご提供ください。  </p><ul><li>フォルダ：%ProgramData%\Microsoft\Power Automate\Logs</li></ul><h3 id="c-レジストリを設定いただいている場合に収集できるログ"><a href="#c-レジストリを設定いただいている場合に収集できるログ" class="headerlink" title="c) レジストリを設定いただいている場合に収集できるログ"></a>c) レジストリを設定いただいている場合に収集できるログ</h3><p>以下のレジストリを登録いただきマシンを再起動した上で、以下でご案内するフォルダに格納されているファイルを取得してご提供ください。</p><ol><li>必要となるレジストリを確認する<br>以下の公開情報を参考に、必要となるレジストリが登録されていることをご確認ください。<br>公開情報にも手順の記載がございますので、ご参照いただけますと幸いです。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/governance#configure-power-automate-for-desktop-to-keep-the-flow-run-details">Power Automate でのガバナンス - Power Automate | Microsoft Learn</a><br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/computer-log2.png"></li></ol><p>2．ファイルを取得する<br>以下のフォルダに格納されているファイルを取得し、ご提供ください。  </p><ul><li>フォルダ：%localappdata%\Microsoft\Power Automate Desktop\Scripts{scriptid}\Runs{runid}<br>a) Actions.log：デスクトップ フローに設定された各アクションの実行結果が記載されたログです。<br>b) RunDefinition.json：デスクトップ フローの実行開始日、実行終了日、フローの実行結果(成功、失敗)が記載されたログです。  </li></ul><p>{ScriptId} にはデスクトップ フローの ID を、{RunId} にはフローの実行 ID を挿入します。  </p><p>&lt;デスクトップフローの ID とフローの実行 ID の確認方法&gt;<br>Power Automateポータルのデスクトップ フローの実行履歴からデスクトップ フローの ID とフローの実行 ID を確認いただけます。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/computer-log3.png"></p><p><a id='anchor-fiddler-log'></a></p><h2 id="4-Fiddler-ログ"><a href="#4-Fiddler-ログ" class="headerlink" title="4. Fiddler ログ"></a>4. Fiddler ログ</h2><p>以下の採取手順をご確認の上でログファイルをご提供ください。<br>なお、情報取得の際はキャプチャ対象を Non-Browser に変更いただくようお願いいたします。<br><a href="https://social.technet.microsoft.com/Forums/ja-JP/fe5f977a-2992-44c3-b643-38ad570a3d18/fiddler-12525124641239825505214622516338918?forum=DCRMSupport">Fiddler ログの採取手順 (microsoft.com)</a></p><p><a id='anchor-machine-information'></a></p><h2 id="5-マシン登録の情報"><a href="#5-マシン登録の情報" class="headerlink" title="5. マシン登録の情報"></a>5. マシン登録の情報</h2><p>該当のマシンの登録情報が確認できる画面キャプチャをご提供ください。</p><ol><li>Power Automate ポータルの画面 &gt; 監視 &gt; マシン<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/machine-information.png"></li><li>マシンまたはコンピューター グループから該当のコンピューターの詳細が分かる画面キャプチャをご提供ください。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/machine-information2.png"></li></ol><p><a id='anchor-remote-desktop-setting'></a></p><h2 id="6-リモート-デスクトップ設定"><a href="#6-リモート-デスクトップ設定" class="headerlink" title="6. リモート デスクトップ設定"></a>6. リモート デスクトップ設定</h2><p>実行される端末のリモート デスクトップの設定の画面キャプチャをご提供ください。 </p><ul><li>実行される端末 &gt; システムのプロパティ &gt; リモートデスクトップ<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/remote-desktop-setting2.png"></li></ul><p><a id='anchor-registry-setting'></a></p><h2 id="7-レジストリの設定"><a href="#7-レジストリの設定" class="headerlink" title="7. レジストリの設定"></a>7. レジストリの設定</h2><p>以下のキーのレジストリの設定が確認できる画面キャプチャをご提供ください。   </p><ul><li>実行される端末 &gt; システムのプロパティ &gt; コンピューター\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Power Automate Desktop\Registration<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/registry-setting4.png"><br>弊社のサポートエンジニアから別のキーの画面キャプチャを依頼された場合は、指示されたキーの画面キャプチャのご提供をお願いいたします。  </li></ul><p>また、サービスアカウントをご利用の場合は、上記に加えて以下の画面キャプチャもご提供ください。  </p><ul><li>実行される端末 &gt; システムのプロパティ &gt; コンピューター\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Power Automate Desktop\Registration &gt; Registration フォルダを右クリック &gt; アクセス許可 &gt; 詳細設定<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/registry-setting3.png">  </li></ul><p><a id='anchor-desktopflow'></a></p><h2 id="8-Power-Automate-for-desktop-のフロー"><a href="#8-Power-Automate-for-desktop-のフロー" class="headerlink" title="8. Power Automate for desktop のフロー"></a>8. Power Automate for desktop のフロー</h2><p>デスクトップ フローのデスクトップ フローの編集画面から、フロー内のアクション (Ctrl + C) をコピーし、テキストエディター (Ctrl + V) に貼り付けてご提供ください。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/desktopflow.png"><br>一度にコピーできるフローは 1 つだけであるため、フロー内に複数のサブフローがある場合は、サブフローごとに上記の手順を繰り返し、アクションを個別のテキスト ファイルに保存した上でご提供ください。  </p><p>ソリューションのエクスポートの詳細に関して、以下に記載がございますのでご参照いただけますと幸いです。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/#anchor-flowpackage-in-solution">Power Automate お問い合わせの際の情報取得手順 | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a>  </p><p>※なお、フロー内のアクションをコピーする方法では、コピー対象は、デスクトップフローのステップ情報でございます。<br>そのため、入出力変数の定義やフロー内のアクションで使用していない UI 要素など一部の情報がコピーの対象外となります。<br>エラーが発生しているアクションで入出力変数を使用している場合や、デスクトップ フロー全体の容量等を確認する必要がある場合は、弊社のサポートエンジニアから以下のソリューションごとエクスポートする方法での共有をお願いする可能性がございます。</p><p>&lt; ソリューションごとエクスポートする方法 &gt;<br>弊社のサポートエンジニアからソリューションごとエクスポートする方法を依頼された場合は、エクスポートしたソリューション ファイル (zip) をご提供ください。<br>弊社環境にインポートできるよう、依存関係のあるコンポーネントを含めてご提供をお願い致します。  </p><ol><li>コピー元テナントでソリューション メニューより、新しいソリューションを追加します。  </li><li>作成したソリューション &gt; 既存の追加 から、該当のデスクトップ フローを追加します。  </li><li>作成したソリューションの概要画面 &gt;  エクスポート からエクスポートしたソリューション ファイル (zip) をご提供ください。  </li></ol><p><a id='anchor-desktopflow-url'></a></p><h2 id="9-デスクトップ-フローの実行履歴-URL"><a href="#9-デスクトップ-フローの実行履歴-URL" class="headerlink" title="9. デスクトップ フローの実行履歴 URL"></a>9. デスクトップ フローの実行履歴 URL</h2><ol><li>マイ フロー&gt;デスクトップ フローから該当のフローを選択します。実行履歴から該当の日時を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/desktopflow-url.png">  </li><li>URLをコピーしてご提供ください。<br>エラー時にフローが実行されず実行履歴に残っていない場合は、1 の画面のURLをコピーしてご提供いただけますと幸いです。</li></ol><p><a id='anchor-cloudflow-run-history-csv'></a></p><h2 id="10-クラウド-フローの実行履歴-CSV"><a href="#10-クラウド-フローの実行履歴-CSV" class="headerlink" title="10. クラウド フローの実行履歴 CSV"></a>10. クラウド フローの実行履歴 CSV</h2><ol><li>デスクトップ フローを呼び出したクラウドフローの詳細画面を開き、「28 日間の実行履歴」から「すべての実行」を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/cloudflow-run-history-csv.png"></li><li>「.csv ファイルを取得」を選択し、取得した CSV ファイルをご提供ください。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/cloudflow-run-history-csv2.png"></li></ol><p>クラウド フローの実行履歴 CSV の取得方法の詳細に関して、以下に記載がございますのでご参照いただけますと幸いです。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/#anchor-flowrunhistory-csv">Power Automate お問い合わせの際の情報取得手順 | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a></p><p><a id='anchor-cloudflow-raw-input-output'></a></p><h2 id="11-クラウド-フローのアクションの未加工入力と未加工出力"><a href="#11-クラウド-フローのアクションの未加工入力と未加工出力" class="headerlink" title="11. クラウド フローのアクションの未加工入力と未加工出力"></a>11. クラウド フローのアクションの未加工入力と未加工出力</h2><p>実行履歴から「デスクトップ用 Power Automate で構築したフローを実行する」アクション等のデスクトップ フローを呼び出すアクションを展開します。<br>未加工入力および未加工出力として表示されるテキストをコピーし、ご提供ください。<br><img src="/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/cloudflow-raw-input-output.png">  </p><p>クラウド フローのアクションの未加工入力と未加工出力の取得方法の詳細に関して、以下にも記載がございますのでご参照いただけますと幸いです。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/#anchor-raw-input-output">Power Automate お問い合わせの際の情報取得手順 | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a></p><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの原野です。&lt;br&gt;本記事では Power Automate for desktop 関連のお問い合わせの際の、情報取得手順についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>非アクティブな Microsoft Dataverse for Teams 環境の自動削除について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/</id>
    <published>2022-12-28T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.316Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br><br>今回は、Dataverse for Teams 環境の自動削除について、下記項目の順にご説明いたします。<br>・Dataverse for Teams環境の自動無効化/削除メカニズムとは<br>・自動無効化/削除条件<br>・自動無効化/削除メカニズム自体の無効化の可否<br>・無効化/削除された環境の復元<br>・ご案内メール<br>・ご案内メールを受信された際の対応<br>・よくあるご質問  </p><p>下記公開情報を基にご説明いたします。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/inactive-teams-environment">非アクティブな Microsoft Dataverse for Teams 環境の自動削除</a><br>各項目について公開情報内にも詳細を記載しておりますのでご参照ください。   </p><p>なお、対象はあくまでDataverse for Teams環境となります。<br>環境が紐づいているチーム自体が削除されるわけではございませんので、ご安心ください。   </p><span id="more"></span>  <h2 id="lt-初めに-本メカニズムの停止について-gt"><a href="#lt-初めに-本メカニズムの停止について-gt" class="headerlink" title="&lt;初めに -本メカニズムの停止について-&gt;"></a><strong>&lt;初めに -本メカニズムの停止について-&gt;</strong></h2><p>2022年12月5日時点で、下記で停止についてご案内している本メカニズムが再度展開されることとなりました。<br><br>2022年12月より徐々に展開されます。<br><br>本内容については、メッセージセンターにて[MC480563(※)]をご確認いただけますと幸いでございます。<br><br>※日本リージョンのテナントの場合の番号となります。<br><br>なお、2022年10月より11月にかけて展開予定でございましたが、2022年12月に延期となりました。<br></p><br>--------------------------------------------------------------------------------------------------------------------------------<br>2022年9月14日時点、すでに展開されているDataverse for Teams環境の無効化に関する本メカニズムは停止されております。<br>本メカニズムのメール通知について多数のお客様からのお問い合わせをいただいており、<br>メール通知の内容に分かりづらい点が多く混乱を招く状況となっております。<br>そのため、本メカニズムの公開は一旦延期されることになりました。<br><br>メール通知を受け取られたお客様には大変ご心配をおかけしておりますが、送付されましたDataverse for Teams環境の削除に<br>関する通知につきましては、無視いただいても問題ございませんのでご安心ください。<br><br>改めて本メカニズムが公開される際にはメッセージセンター等にて通知させていただく予定でございますので、<br>その際にはご確認いただけますと幸いでございます。<br><br>なお、本メカニズムの停止に伴いまして、後述の「環境活動をトリガーする」機能も無効化されております。<br>しかしながら、Power Platform 管理センター上の無効化の警告、および「環境活動をトリガーする」機能は表示されたままとなっており、<br>「環境活動をトリガーする」を実行しても無効化の警告表示が消えないとのお問い合わせを受けております。<br>本メカニズム自体が停止されているため、本来は無効化の警告自体も表示されないべきですが、<br>本記事執筆時点では警告が表示されたままとなってしまっております。<br><br>ご混乱をお招きし大変申し訳ございません。<br>無効化の警告が表示されていても無視していただいて問題ございませんので、ご安心ください。<br><br><p>再度本メカニズムが有効化された際には、その7日後に対象環境が無効化される動きとなる予定でございますので、<br><br>再有効化後に「環境活動をトリガーする」をご実行いただけますと幸いでございます。<br><br></p><p>下図は本メカニズムの停止に関するメッセージセンターの通知となります。<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/message-center-rollout.png"><br><br><br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除メカニズムとは-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除メカニズムとは-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除メカニズムとは&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除メカニズムとは&gt;</strong></h2><p>本メカニズムは2022年8月末より徐々に展開されております。<br>一定期間（非アクティブ期間）中、ユーザーによる活動のないDataverse for Teams環境が無効化されます。<br>無効化状態が30日継続しますと、対象環境が自動削除されます。<br></p><p>無効化された環境では、アプリやフロー、チャットボット等がご利用いただけません。<br></p><p>非アクティブ期間は90日となっております。<br><br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除条件-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除条件-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除条件&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除条件&gt;</strong></h2><p>対象環境におけるユーザーのアプリ起動などの活動が設定期間中に実施されない場合、自動削除の対象となります。<br><br>対象の活動は下記の通りです。<br><br>・ユーザーの活動: アプリの起動、フローの実行、Power Virtual Agents ボットとのチャット<br><br>・作成者の活動: アプリ、フロー 、Power Virtual Agents ボット、カスタムコネクタの作成、読み取り、更新、削除<br><br>・管理者の活動: コピー、削除、バックアップ、復元、リセットなどの環境操作<br><br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除メカニズム自体の無効化の可否-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除メカニズム自体の無効化の可否-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除メカニズム自体の無効化の可否&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除メカニズム自体の無効化の可否&gt;</strong><br></h2><p>本メカニズムは無効化いただくことが出来ません。<br><br>何卒ご理解いただけますと幸いでございます。<br><br><br></p><h2 id="lt-自動無効化-削除された環境の復元-gt"><a href="#lt-自動無効化-削除された環境の復元-gt" class="headerlink" title="&lt;自動無効化/削除された環境の復元&gt; "></a><strong>&lt;自動無効化/削除された環境の復元&gt;</strong> <br></h2><p>環境無効化後、30日以内であれば環境の再有効化が可能でございます。<br><br>また、環境削除後も、7日以内であれば環境の復元が可能でございます。<br><br>どちらもPower Platform 管理センターよりご実施いただけます。<br></p><p>・無効にした Dataverse for Teams 環境の再有効化<br><br>①Power Platform 管理センター にサインイン<br><br>②環境　＞　無効化された Dataverse for Teams 環境を選択<br><br>③環境ページで 「環境を再度有効にする」 を選択<br><br><br><br>・削除された Dataverse for Teams 環境の復元<br><br>①Power Platform 管理センター にサインイン<br><br>②環境　＞　削除された環境を復元する　を選択<br><br>③回復する環境　＞　回復 を選択<br><br><br> 　　  </p><h2 id="lt-ご案内メール-gt"><a href="#lt-ご案内メール-gt" class="headerlink" title="&lt;ご案内メール&gt; "></a><strong>&lt;ご案内メール&gt;</strong> <br></h2><p>対象環境の無効化が実施される７日前より、その旨についてのご案内メールが次のユーザーに通知されます。<br><br>・対象Dataverse for Teams環境のチームの所有者<br><br>・対象Dataverse for Teams環境の作成者<br><br>・システム管理者<br><br></p><p>環境が無効化される旨のご案内メールは下図のようなものになります。<br><br>本記事執筆時点のメールのため、内容は変更される可能性がございます。<br><br>黒塗りのマスキング部分に対象環境名が記載されます。<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/announce-mail.jpg"><br><br><br></p><h2 id="lt-無効化対象のご案内メールを受信された際の対応-gt"><a href="#lt-無効化対象のご案内メールを受信された際の対応-gt" class="headerlink" title="&lt;無効化対象のご案内メールを受信された際の対応&gt;"></a><strong>&lt;無効化対象のご案内メールを受信された際の対応&gt;</strong><br></h2><p>下記2通りの方法にて、無効化対象となる非アクティブな期間のカウントを一旦リセットいただけます。<br><br>・対象環境において、アプリやフローのご実行など上述のユーザー活動を実施<br><br>・Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」を実行<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/trigger-button.png"><br><br></p><h2 id="lt-よくあるご質問-gt"><a href="#lt-よくあるご質問-gt" class="headerlink" title="&lt;よくあるご質問&gt; "></a><strong>&lt;よくあるご質問&gt;</strong> <br></h2><p>Q：メッセージセンターの番号は?<br><br>A：MC415083 となります。<br><br>該当メッセージURL:<a href="https://admin.microsoft.com/adminportal/home?ref=MessageCenter/:/messages/MC415083">https://admin.microsoft.com/adminportal/home?ref=MessageCenter/:/messages/MC415083</a><br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/message-center.png"><br><br><br></p><p>Q：Dataverse for Teams環境とは何か。無効化された場合、どのような影響があるか?<br><br>A：Microsoft Dataverse for Teams 環境は、チームにDataverse機能を使用したアプリを追加した場合や、<br><br>チーム内にチャットボットやPower Appsキャンバスアプリ等を作成した場合に作成される環境です。<br><br>無効化されると、環境内に作成されていたアプリやフロー、チャットボット等がご利用いただけなくなります。<br><br>具体的なシナリオや詳細について、以下の記事にて解説しておりますので、よろしければご参照ください。<br><br><a href="https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/">Dataverse for Teams 環境の管理方法</a><br><br><br></p><p>Q：Dataverse for Teams環境にて無効化される際に配信される通知メールを配信停止することは可能か?<br><br>A：恐れ入りますが、メール配信を停止することのできる機能はございません。<br><br>製品動作としてご理解賜りますようお願い申し上げます。<br><br><br></p><p>Q：Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」の実効は、通常ユーザにて操作可能なものか?<br><br>A：Power Platform管理センターにてDataverse for Teams環境の「環境活動をトリガーする」を実行できるユーザーは以下の通りでございます。<br><br>・対象Dataverse for Teams環境のチームの所有者<br><br>・対象Dataverse for Teams環境の作成者<br><br>・グローバル管理者<br><br>・Power Platform管理者<br><br>・Dynamics 365管理者<br><br><br></p><p>Q：「環境活動をトリガーする」を実行すると、有効期限は何日まで延びるのか?<br><br>A：有効期限は90日間延長され、その90日の期間中に、対象環境におけるユーザーのアプリ起動などの活動が実施されない場合、<br><br>再び自動削除の対象となり、7日前（トリガー実行から83日後）にメールにて通知されます。<br><br><br></p><p>Q：無効化される環境内のアプリ当の詳細については、どこから確認できるか?<br><br>A：下記より対象環境内のアプリ等をご確認いただけます。<br><br>Power Platform 管理センター　＞　環境　＞　対象環境　＞　リソース　＞　Power Apps/フロー<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/resources.png"><br><br><br></p><p>Q：再有効化した場合、無効化前の情報が維持されるか?<br><br>A：再有効化後または復元後は、無効前の情報が維持されます。<br><br>削除されてしまいますと、無効化前の情報は復元できなくなりますのでご注意ください。<br><br><br></p><p>免責事項<br><br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br&gt;&lt;br&gt;今回は、Dataverse for Teams 環境の自動削除について、下記項目の順にご説明いたします。&lt;br&gt;・Dataverse for Teams環境の自動無効化/削除メカニズムとは&lt;br&gt;・自動無効化/削除条件&lt;br&gt;・自動無効化/削除メカニズム自体の無効化の可否&lt;br&gt;・無効化/削除された環境の復元&lt;br&gt;・ご案内メール&lt;br&gt;・ご案内メールを受信された際の対応&lt;br&gt;・よくあるご質問  &lt;/p&gt;
&lt;p&gt;下記公開情報を基にご説明いたします。&lt;br&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-platform/admin/inactive-teams-environment&quot;&gt;非アクティブな Microsoft Dataverse for Teams 環境の自動削除&lt;/a&gt;&lt;br&gt;各項目について公開情報内にも詳細を記載しておりますのでご参照ください。   &lt;/p&gt;
&lt;p&gt;なお、対象はあくまでDataverse for Teams環境となります。&lt;br&gt;環境が紐づいているチーム自体が削除されるわけではございませんので、ご安心ください。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerApps" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerApps/"/>
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="DataverseforTeams" scheme="https://jpdynamicscrm.github.io/blog/tags/DataverseforTeams/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps/Power Automate/Power Virtual Agents お問い合わせ時の留意事項</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/about-power-platform-support/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/about-power-platform-support/</id>
    <published>2022-12-28T00:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.392Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームです。<br>今回は、Power Apps/Power Automate/Power Virtual Agents のお問い合わせをいただく際の留意事項、ご協力いただきたい事項についてご紹介します。  </p><p>我々サポートチームといたしましては、できる限りお客様のお役に立てるよう、日々調査に努めておりますが、お客様の協力があって初めてご支援ができることも多くございます。<br>また、クラウドサービスの性質や、成長スピードの速い Power Platform という製品の性質上、また情報保護の観点から、どうしてもお客様への情報のご提供が難しい場合もございます。  </p><p>サポートをご利用いただくうえでは、以下のような点にご留意ください。   </p><span id="more"></span><h2 id="1．お問い合わせ起票時のお願い"><a href="#1．お問い合わせ起票時のお願い" class="headerlink" title="1．お問い合わせ起票時のお願い"></a>1．お問い合わせ起票時のお願い</h2><hr><p>調査を迅速に開始するため、また、コミュニケーションを円滑に進めるため、以下の点にご協力ください。  </p><h3 id="お問い合わせ内容はできる限り詳細にご記載ください"><a href="#お問い合わせ内容はできる限り詳細にご記載ください" class="headerlink" title="お問い合わせ内容はできる限り詳細にご記載ください"></a>お問い合わせ内容はできる限り詳細にご記載ください</h3><p>認識齟齬をなくすため、お問い合わせ内容はできる限り詳細に記載してください。<br>例えばエラーが発生した場合、 </p><ul><li>いつ発生したのか  </li><li>毎回発生するのか  </li><li>表示されているエラーメッセージやエラー画面のキャプチャ  </li><li>エラーが発生した状況  </li></ul><p>などをできる限り詳細に記載いただくことで、我々も正確に事象を把握でき、調査がスムーズに進みます。<br>反対に、お問い合わせ内容にこれらの情報が不足している場合、内容を把握するだけで何回もやり取りが必要になり、日数を要してしまう場合があります。   </p><h3 id="情報提供にご協力ください"><a href="#情報提供にご協力ください" class="headerlink" title="情報提供にご協力ください"></a>情報提供にご協力ください</h3><p>お問い合わせフォームに、エラー内容やフロー/アプリの URL などを質問する項目がある場合があります。<br>お問い合わせ時にこれらの項目について記載いただくことで、お問い合わせを受領してすぐに詳細調査を開始することができますので、お問い合わせフォームの項目はできるかぎりすべて入力いただくよう、ご協力をお願いいたします。<br>また、お問い合わせ時にお寄せいただきたい情報とその情報採取手順について、ブログ記事でご紹介しています。<br>事象によって必要な情報は異なるため、すべてを添付いただく必要はございませんが、お問い合わせいただく事象に関係のありそうなものをお問い合わせ時に添付いただけますと、調査がスムーズに進みますので、ご協力をお願いいたします。  </p><p><a href="https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/">Power Apps キャンバス アプリ お問い合わせの際の情報取得手順</a><br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/">Power Automate お問い合わせの際の情報採取手順</a>  </p><h3 id="お問い合わせの分割起票にご協力ください"><a href="#お問い合わせの分割起票にご協力ください" class="headerlink" title="お問い合わせの分割起票にご協力ください"></a>お問い合わせの分割起票にご協力ください</h3><p>テクニカル サポートでは、お客様の技術的な課題に対して、各製品の専任のエンジニアが担当となりご支援を差し上げております。<br>そのため、複数の製品に跨るご質問に関しては、製品ごとに分割してお問い合わせをご起票いただくようお願いいたします。</p><p>また、同一製品に関するご質問であっても、質問内容が多岐にわたる場合には、分割起票をご依頼することがございます。<br>課題管理やお客様とのコミュニケーションの円滑化、複数エンジニアでの並行調査を可能とするため、技術的に一問一答形式でお問い合わせいただくようお願いいたします。</p><h2 id="2．調査へのご協力のお願い"><a href="#2．調査へのご協力のお願い" class="headerlink" title="2．調査へのご協力のお願い"></a>2．調査へのご協力のお願い</h2><hr><h3 id="情報提供にご協力ください-1"><a href="#情報提供にご協力ください-1" class="headerlink" title="情報提供にご協力ください"></a>情報提供にご協力ください</h3><p>上述したように、調査を円滑に進めるには、お客様からの情報提供が不可欠です。<br>Power Platform は、複数のサービスをつなぐという製品の性質上、Power Platform 以外の製品に関する情報や、監査ログなどの情報をご依頼する場合があります。<br>お手数をおかけしますが、以下のような点についてご理解・ご協力をお願いいたします。  </p><ul><li>お問い合わせの起票時に診断情報へのアクセスの同意を求める箇所がございますので、「診断情報へのアクセスを許可する」をご選択ください。<br>参考: <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-environment#consent-information">同意情報について</a>  </li><li>上記の診断情報へのアクセスを許可いただいていても、サポート担当者にて閲覧ができないデータもございます。この場合、弊社より必要な情報の採取をご依頼いたしますので、お客様側でのデータの取得にご協力ください。</li></ul><p>また、お客様にてご作成いただいているフロー、アプリ、ボットが複雑な場合や、弊社での事象の再現が難しい場合、調査を進めるためには、お客様にて事象の切り分けをご実施いただく必要がございます。<br>製品の性質上、お客様のご協力なしに調査を進めることは難しい場合も多くございますので、ご理解・ご協力のほどお願いいたします。</p><h3 id="お問い合わせは、事象の発生後できるかぎりすぐにご起票ください"><a href="#お問い合わせは、事象の発生後できるかぎりすぐにご起票ください" class="headerlink" title="お問い合わせは、事象の発生後できるかぎりすぐにご起票ください"></a>お問い合わせは、事象の発生後できるかぎりすぐにご起票ください</h3><p>Power Platform では、事象の発生から 28 日が経過すると、サーバーログを破棄しています。<br>事象の発生から時間が経ってしまうと、ログが残っておらず、調査ができない場合がございますので、お問い合わせはできる限りお早めにご起票ください。  </p><h3 id="Teams-会議にご協力ください"><a href="#Teams-会議にご協力ください" class="headerlink" title="Teams 会議にご協力ください"></a>Teams 会議にご協力ください</h3><p>Power Apps や Power Automate for desktop など、クライアント端末上で動作するサービスをご利用いただいている場合、事象を正しく把握するために、Teams 会議での画面共有をしながらのコミュニケーションをご依頼する場合がございます。<br>特に、お問い合わせいただいた事象が弊社では再現できない場合、Teams 会議での事象の確認、再現手順の確認、情報採取が必要となってきますので、ご協力をお願いいたします。  </p><h3 id="サードパーティサービスと連携する場合の調査について"><a href="#サードパーティサービスと連携する場合の調査について" class="headerlink" title="サードパーティサービスと連携する場合の調査について"></a>サードパーティサービスと連携する場合の調査について</h3><p>Power Platform にてサードパーティ サービスをご使用の場合、弊社では詳細な調査ができない場合があります。<br>事象に関する切り分けの結果、サードパーティ サービス側での調査が必要と判断した場合、お客様から他社様へのお問い合わせをご依頼する場合や、調査を終了とさせていただく場合がございますので、ご理解のほどお願いいたします。  </p><h2 id="3．Power-Platform-でのサポート-サービス全般に関する留意事項"><a href="#3．Power-Platform-でのサポート-サービス全般に関する留意事項" class="headerlink" title="3．Power Platform でのサポート サービス全般に関する留意事項"></a>3．Power Platform でのサポート サービス全般に関する留意事項</h2><hr><h3 id="仕様確認について"><a href="#仕様確認について" class="headerlink" title="仕様確認について"></a>仕様確認について</h3><p>仕様確認のお問い合わせについては、公開情報や現時点の動作をもとに、想定される動作をご案内いたします。<br>公開情報に記載されている以上の情報については、ご提供できない場合があることを、あらかじめご承知おきください。   </p><h3 id="再現性のない事象について"><a href="#再現性のない事象について" class="headerlink" title="再現性のない事象について"></a>再現性のない事象について</h3><p>過去の特定の時期にのみ発生していた問題や、発生頻度の少ない事象に関する調査は、事象発生時の情報が不足している場合、十分な調査を行うことができないことから、原因特定までのご支援が出来ない場合がございます。<br>そのため、確認可能な情報からのベストエフォートでの調査となりますこと、予めご了承の程お願いいたします。    </p><p>なお、クラウド製品におきましては、その特性上、一過性の障害（サービスとのネットワーク接続が一瞬失われたり、サービスが一時的にビジー状態になる等）が発生する場合がございますが、これらの障害は自動修正され、少し時間をおいてから操作を再試行することで、高い確率で正常に実行されます。<br>このような事象においては、根本原因の究明は困難となりますこと、ご理解くださいますようお願いいたします。</p><p><strong>例）以下のようなお問い合わせは、技術サポートのご支援の対象外となりますこと、予めご了承の程お願いいたします。</strong>  </p><ul><li>キャンバスアプリにてデータを保存した際、過去に一度のみエラーが発生し、データが登録されなかった。その後発生はしていないが、エラーの理由が不明であり再現した際に備えたいため、原因と対応策を教えてほしい  </li><li>クラウドフローを編集しようとしたが、編集画面が描画されず、一時的にフローの編集ができなかった。特定のユーザでのみ発生しており、一定時間経過後に解消したが、根本原因について調査してほしい。 </li></ul><h3 id="長期にわたる修正について"><a href="#長期にわたる修正について" class="headerlink" title="長期にわたる修正について"></a>長期にわたる修正について</h3><p>調査の結果、サービス側の改修が必要となることがございますが、修正が長期にわたることが想定される場合は、お問い合わせを一旦クローズとさせていただきます。<br>定期的な修正状況の確認や、修正の進捗報告をご希望の場合は、ご確認が必要なタイミングで、その都度お問い合わせを起票いただくようお願いいたします。   </p><h3 id="リリース時期や今後の予定に関するご質問について"><a href="#リリース時期や今後の予定に関するご質問について" class="headerlink" title="リリース時期や今後の予定に関するご質問について"></a>リリース時期や今後の予定に関するご質問について</h3><p>新機能のリリース時期や修正の展開時期など、今後の予定に関するご質問には、基本的にはお答えすることができません。<br>状況に応じて、ベストエフォートで開発部門への確認を行い、目安としてご案内を差し上げることがございますが、ご案内する時期についてはあくまでもその時点での予定であり、変更となる可能性が多分にあることをご承知おきください。   </p><h3 id="お客様側での情報採取や確認にお時間がかかる場合について"><a href="#お客様側での情報採取や確認にお時間がかかる場合について" class="headerlink" title="お客様側での情報採取や確認にお時間がかかる場合について"></a>お客様側での情報採取や確認にお時間がかかる場合について</h3><p>お客様側での情報採取や、ご案内内容の確認、実装などにお時間がかかる場合には、お問い合わせを一旦クローズとさせていただきます。<br>テクニカル サポートは、短期的な課題に対してご支援を差し上げるサービスですので、2 週間程度を目安に、それ以上のお時間が必要な場合には、お問い合わせの一旦クローズにご理解ください。<br>なお、クローズ後にご質問が発生した場合には、以前のお問い合わせ番号を記載してお問い合わせいただければ、情報を引継いでご支援を再開することが可能ですので、ご安心ください。  </p><h3 id="サンプル作成やカスタマイズ、パフォーマンス-チューニングについて"><a href="#サンプル作成やカスタマイズ、パフォーマンス-チューニングについて" class="headerlink" title="サンプル作成やカスタマイズ、パフォーマンス チューニングについて"></a>サンプル作成やカスタマイズ、パフォーマンス チューニングについて</h3><p>以下のようなご依頼については、テクニカル サポートでは承ることができません。<br>別途プロアクティブ サービスなどのご紹介を差し上げる場合がございますので、ご理解ください。  </p><ul><li>サンプルの作成 </li><li>説明資料の作成やレビュー </li><li>お客様のご要件に沿ったカスタマイズのご提供 </li><li>パフォーマンスチューニングのご依頼 (詳細は次項を参照) </li></ul><h3 id="パフォーマンス-チューニングについて"><a href="#パフォーマンス-チューニングについて" class="headerlink" title="パフォーマンス チューニングについて"></a>パフォーマンス チューニングについて</h3><p>サポートからは、パフォーマンスに影響する一般的な事例や対応策をご案内することは可能ですが、お客様環境固有のカスタマイズに応じたチューニングを行うことはご支援の対象外となります。<br>また、パフォーマンスへ影響を与えている処理を特定いただき、製品プラットフォーム側に原因があるかの調査は可能ですが、カスタマイズ部分に原因がある場合は、改善方法のご提案はご支援の対象外となります。  </p><p><strong>例）以下のようなお問い合わせは、技術サポートのご支援の対象外となりますこと、予めご了承の程お願いいたします。</strong> </p><ul><li>あるキャンバスアプリにおいて、検索処理に時間を要している。<br>アプリを提供するので、パフォーマンス改善のために実施すべき内容を教えてほしい。 </li><li>特定のクラウドフローにおいて、スロットリングが頻繁に発生し、フローの処理が遅くなっている。スロットリングを発生させないようなフローの修正方法があれば教えてほしい。 </li></ul><h3 id="プレビュー機能について"><a href="#プレビュー機能について" class="headerlink" title="プレビュー機能について"></a>プレビュー機能について</h3><p>プレビュー機能は、”現状のまま”、”不具合とともに” 利用可能な機能としてご提供しています。<br>不具合を確認した場合、事象により開発部門にフィードバックを行うことはございますが、修正のお約束はできないことをご了承ください。<br>また、機能強化のご要望がございましたら、Ideas サイトまでご投稿ください。<br><a href="https://ideas.powerapps.com/">Power Apps Ideas</a><br><a href="https://ideas.powerautomate.com/">Power Automate Ideas</a><br><a href="https://ideas.powervirtualagents.com/">Power Virtual Agents Ideas</a>  </p><h3 id="サポート外の機能について"><a href="#サポート外の機能について" class="headerlink" title="サポート外の機能について"></a>サポート外の機能について</h3><p>以下のようなサービス・機能は、テクニカル サポートでのご支援の対象外です。<br>テクニカル サポート以外のお問い合わせ先があるものもございますので、それぞれ適切なお問い合わせ先へのご起票をお願いいたします。  </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/guidance/coe/starter-kit">CoE スターターキット</a> (問合せ先: <a href="https://aka.ms/coe-starter-kit-issues">aka.ms/coe-starter-kit-issues</a>)</li><li><a href="https://learn.microsoft.com/ja-jp/power-automate/guidance/automation-kit/overview/introduction">Automation Kit</a> (問合せ先: <a href="https//aka.ms/automation-kit-issues">aka.ms/automation-kit-issues</a>)</li><li>PowerShell コマンド </li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/teams/use-sample-apps-from-teams-store">Power Apps for Teams のサンプルアプリ</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/open-and-run-a-sample-app">Power Apps のテンプレートアプリ</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-platform/alm/devops-build-tools">Power Apps Build Tool</a> (問合せ先: <a href="https://powerusers.microsoft.com/t5/Power-Apps-Pro-Dev-ISV/bd-p/pa_component_framework">Power Apps component framework, ALM &amp; Pro Dev forum</a>)</li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/developer/data-platform/tools/devtools-install">Power Platform Tools</a> (問合せ先: <a href="https://github.com/microsoft/powerplatform-vscode/issues">https://github.com/microsoft/powerplatform-vscode/issues</a>)</li><li>Microsoft Lobe (問合せ先: <a href="https://www.lobe.ai/docs/welcome/welcome">Lobe Community or Contact Us</a>)</li></ul><h3 id="公開情報の修正依頼・追加依頼について"><a href="#公開情報の修正依頼・追加依頼について" class="headerlink" title="公開情報の修正依頼・追加依頼について"></a>公開情報の修正依頼・追加依頼について</h3><p>我々サポートチームは、責任をもってお客様にご回答を差し上げておりますため、障害発生時や製品に不具合が発生している場合、サポートからの回答をもってマイクロソフトからの正式なご案内とさせていただく場合がございます。<br>公開情報に情報の記載がない場合、サポートチームよりフィードバックすることは可能ですが、情報の記載をお約束することはできかねますので、ご了承ください。  </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームです。&lt;br&gt;今回は、Power Apps/Power Automate/Power Virtual Agents のお問い合わせをいただく際の留意事項、ご協力いただきたい事項についてご紹介します。  &lt;/p&gt;
&lt;p&gt;我々サポートチームといたしましては、できる限りお客様のお役に立てるよう、日々調査に努めておりますが、お客様の協力があって初めてご支援ができることも多くございます。&lt;br&gt;また、クラウドサービスの性質や、成長スピードの速い Power Platform という製品の性質上、また情報保護の観点から、どうしてもお客様への情報のご提供が難しい場合もございます。  &lt;/p&gt;
&lt;p&gt;サポートをご利用いただくうえでは、以下のような点にご留意ください。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Supportability" scheme="https://jpdynamicscrm.github.io/blog/tags/Supportability/"/>
    
  </entry>
  
  <entry>
    <title>Dynamics 365 Customer Engagement サポートチームより問題の早期解決に向けたお客様へのお願い</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/For-early-resolution-of-issues/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/For-early-resolution-of-issues/</id>
    <published>2022-11-28T00:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.360Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの鎌田です。</p><p>いつも Dynamics 365 をご利用いただきありがとうございます。<br>本記事では、Dynamics 365 をご利用されている皆様へ、問題の早期解決のためにサポートチームからお客様へのお願いを申し上げます。<br>ぜひお問い合わせの際にご確認をいただけますと幸いです。</p><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E8%AA%BF%E6%9F%BB%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E6%83%85%E5%A0%B1%E3%81%94%E6%8F%90%E4%BE%9B%E3%81%AE%E3%81%8A%E9%A1%98%E3%81%84">調査のための情報ご提供のお願い</a></li><li><a href="#%E5%95%8F%E9%A1%8C%E3%81%AE%E6%AD%A3%E7%A2%BA%E3%81%AA%E7%90%86%E8%A7%A3">問題の正確な理解</a></li><li><a href="#%E5%88%87%E3%82%8A%E5%88%86%E3%81%91%E6%83%85%E5%A0%B1">切り分け情報</a></li><li><a href="#%E6%A5%AD%E5%8B%99%E5%BD%B1%E9%9F%BF%E9%81%94%E6%88%90%E4%BA%8B%E9%A0%85%E8%83%8C%E6%99%AF%E3%82%84%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB">業務影響、達成事項、背景やスケジュール</a></li><li><a href="#%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88-%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">サポート インスタンスについて</a></li><li><a href="#%E4%BB%95%E6%A7%98%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E8%AA%BF%E6%9F%BB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">仕様の確認に関する調査について</a></li><li><a href="#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA%E3%81%AB%E3%82%88%E3%82%8A%E5%95%8F%E9%A1%8C%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E5%A0%B4%E5%90%88">カスタマイズにより問題が発生している場合</a></li><li><a href="#%E5%8F%82%E8%80%83">参考</a></li></ul><h2 id="調査のための情報ご提供のお願い"><a href="#調査のための情報ご提供のお願い" class="headerlink" title="調査のための情報ご提供のお願い"></a>調査のための情報ご提供のお願い</h2><p>問題の調査を進めるために、お客様に問題を特定するための情報および問題の再現手順のご提供をお願いしております。後述の情報をお問い合わせ時にご提供いただけますとスムーズに調査を開始可能です。<br>調査に必要な情報が不足する場合は、調査が難航したり、解決が難しくなるケースがあり、調査に必要な情報をご提供いただけるまで、ご対応を一旦終了とさせていただくことがございます。</p><p>また、データセンター内の更新頻度が高いため、調査には最新の情報を必要とします。そのため、ご提供頂きました情報が古い場合、調査が困難になる場合があり、同じ情報のご提供を複数回お願いさせていただくことがございます。<br>何卒、お客様のご理解、ご協力のほどお願い申し上げます。</p><h2 id="問題の正確な理解"><a href="#問題の正確な理解" class="headerlink" title="問題の正確な理解"></a>問題の正確な理解</h2><p>発生事象の正確な把握が問題解決の第一歩となります。正確な情報をご提供いただき事象が具体的になれば、サポート エンジニアはより具体的に調査観点の絞り込みができます。弊社にて事象を再現させることができれば、より迅速な調査が可能となります。</p><p>下記にご提供いただきたい情報の例をご紹介いたします。なお、再現手順を文章で具体的に記載いただくことや、事象発生時の画面のキャプチャは発生事象の把握に非常に有用です。発生事象に対するお客様とエンジニアの認識が一致するようにご提供いただけますと幸いです。</p><ul><li>事象発生日時（例：MM 月 DD 日 午前 HH 時 MM 分頃。分単位はおおよそでも問題ございません）</li><li>事象発生ユーザーの UPN</li><li>事象発生環境 URL</li><li>事象発生が確認できる画面キャプチャ</li><li>エラーメッセージをコピーしたテキストファイル</li><li>事象発生時の操作内容や再現手順</li><li>再現時のビデオや、<a href="https://learn.microsoft.com/ja-jp/office/troubleshoot/settings/how-to-use-problem-steps-recorder">問題ステップ レコーダー (PSR)</a> ログ</li></ul><p>また、事象再現時のクライアントとサーバー間の通信を確認するために下記ログの採取をご依頼する場合がございます。事象再現時時の RequestID や正確な日時がわかるため、エラーだけでなく、サーバーからの応答遅延などの問題にも素早く正確な調査を開始できます。</p><ul><li><a href="https://social.technet.microsoft.com/Forums/azure/ja-JP/fe5f977a-2992-44c3-b643-38ad570a3d18/fiddler-12525124641239825505214622516338918?forum=DCRMSupport">Fiddler</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/azure-portal/capture-browser-trace#google-chrome-and-microsoft-edge">ブラウザ トレース ログ</a><br>※上記リンクの手順にて、「Azure Portal」は、事象が発生する Dynamics 365 / Power Platform のアドレスへ読み替えてください。</li></ul><p>オンプレミス版の Dynamics をご利用いただいている場合、下記情報もご共有くださいますと幸いです。</p><ul><li>ネットワーク図</li><li>Dynamics 365 Server version</li><li>SQL Server Edition / version</li><li>Windows Server OS Edition / version</li></ul><h2 id="切り分け情報"><a href="#切り分け情報" class="headerlink" title="切り分け情報"></a>切り分け情報</h2><p>問題の切り分けが可能であれば、切り分け結果をご共有ください。何を切り分けするかは事象によりケース バイ ケースですが、一般的な切り分け例をご紹介いたします。</p><ul><li><a href="https://support.microsoft.com/ja-jp/microsoft-edge/microsoft-edge-%E3%81%AE%E9%96%B2%E8%A6%A7%E5%B1%A5%E6%AD%B4%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%BE%E3%81%9F%E3%81%AF%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B-00cf7943-a9e1-975a-a33d-ac10ce454ca4">ブラウザのキャッシュ クリア</a> や <a href="https://support.microsoft.com/ja-jp/microsoft-edge/microsoft-edge-%E3%81%A7-inprivate-%E3%83%96%E3%83%A9%E3%82%A6%E3%82%BA%E3%82%92%E4%BD%BF%E3%81%86-e6f47704-340c-7d4f-b00d-d0cf35aa1fcc">InPrivate ブラウズ</a> により改善するか</li><li>別ユーザーでも事象が発生するか</li><li>同じユーザーで、別 PC でも事象が発生するか</li><li>再現頻度（100% 発生するか、時々なのか）</li></ul><h2 id="業務影響、達成事項、背景やスケジュール"><a href="#業務影響、達成事項、背景やスケジュール" class="headerlink" title="業務影響、達成事項、背景やスケジュール"></a>業務影響、達成事項、背景やスケジュール</h2><p>発生している問題が業務やプロジェクト、またそのスケジュールへ与える具体的な影響、問題を解消することで達成すべき状態や、達成すべき理由につきまして、ご提供くださいますと幸いです。<br>お客様個別の事情を勘案し、より適切なご案内を差し上げるため、これらの情報を伺うことがございます。</p><h2 id="サポート-インスタンスについて"><a href="#サポート-インスタンスについて" class="headerlink" title="サポート インスタンスについて"></a>サポート インスタンスについて</h2><p>サポート インスタンスへお客様の事象が発生しているインスタンスをコピーしていただくことで、事象の再現と調査を一貫して行うことが可能となり、早期解決が見込めます。 サポート インスタンスは、サポート チームが調査などに必要と判断した場合に作成するため、お客様のご要望で作成することはできませんが、お問合せ起票時に下記の対応を実施いただけますと迅速に作成することができます。</p><ul><li>サポート インスタンスの作成に同意いただける場合は、起票時に作成同意の旨を記載ください</li><li>サポート インスタンスの作成に社内 / エンド顧客の同意が必要な場合は、事前にご確認をお願いいたします</li></ul><p>サポート インスタンスの詳細につきましては <a href="https://jpdynamicscrm.github.io/blog/powerplatform/Provide-Support-Instance/">サポート インスタンスの提供</a> をご参照ください。</p><h2 id="仕様の確認に関する調査について"><a href="#仕様の確認に関する調査について" class="headerlink" title="仕様の確認に関する調査について"></a>仕様の確認に関する調査について</h2><p>Dynamics 365 の動作について、仕様の確認をお問い合わせいただく場合がありますが、Dynamics 365 では様々な修正やお客様からの機能実装などのご要望に応じて継続的に内部コンポーネントを更新していることから、個々のテナント環境での動作差異を含め、Dynamics 365 サービスの説明をはじめ弊社サイトに記載の内容以上の仕様に関する情報のご提供が困難な場合がございます。</p><p>原則としては公開されている情報以上の仕様についての情報は提供しておりませんが、ご質問の背景をお知らせいただくことで、代替となる手法など参考情報のご案内が可能になる場合がございます。</p><h2 id="カスタマイズにより問題が発生している場合"><a href="#カスタマイズにより問題が発生している場合" class="headerlink" title="カスタマイズにより問題が発生している場合"></a>カスタマイズにより問題が発生している場合</h2><p>弊社が提供する API が文書通りに機能しない場合や、API 利用により製品機能に意図しない影響を及ぼす場合などは、発生事象についての詳細説明、再現可能な最小のスクリプトのコピーと再現手順をご提供ください。</p><p>お客様様がご利用のスクリプトをそのままご提供される場合、発生事象と無関係なコードを含みますため、調査が困難となります。まずは製品の意図しない動作(**の情報が取得できるはずが取得されてこない)を引き起こしているお客様のスクリプトの箇所を切り分け、スクリプトを簡略化ください。</p><p>「スクリプトを変更していないが意図しない動作が発生している」旨のお問い合わせをいただくことがございますが、その場合であっても、まずはお客様にて、発生事象に対してスクリプトの切り分けや簡素化をご対応くださいますようお願いいたします。</p><p><a href="https://learn.microsoft.com/ja-jp/troubleshoot/power-platform/power-apps/isolate-model-app-issues#simplify-custom-scripts">カスタム スクリプトを簡略化する</a> も併せてご参照くださいますと幸いです。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>以下の記事もあわせてご確認ください。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-overview#which-support-plan-do-i-need-in-order-to-request-a-root-cause-analysis-rca">根本原因分析 (RCA) を要求するにはどのサポート プランが必要ですか。</a></li><li><a href="https://learn.microsoft.com/ja-jp/troubleshoot/power-platform/power-apps/isolate-common-issues">一般的な Power Apps デバッグ戦略</a></li><li><a href="/blog/powerplatform/Notes-when-using-support/">クラウド サポートをご利用いただく際の留意点</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの鎌田です。&lt;/p&gt;
&lt;p&gt;いつも Dynamics 365 をご利用いただきありがとうございます。&lt;br&gt;本記事では、Dynamics 365 をご利用されている皆様へ、問題の早期解決のためにサポートチームからお客様</summary>
      
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
    <category term="サポート" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88/"/>
    
  </entry>
  
  <entry>
    <title>Dynamics 365 Customer Engagement のクラウド サポートをご利用いただく際の留意点</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Notes-when-using-support/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Notes-when-using-support/</id>
    <published>2022-11-28T00:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.364Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの鎌田です。</p><p>いつも Dynamics 365 をご利用いただきありがとうございます。<br>本記事では、Dynamics 365 をご利用されている皆様へクラウド サポートをご利用いただく際の留意点を申し上げます。<br>ぜひお問い合わせの際にご確認をいただけますと幸いです。</p><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E7%95%AA%E5%8F%B7%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">お問い合わせ番号について</a></li><li><a href="#%E5%8E%9F%E5%9B%A0%E7%A9%B6%E6%98%8E%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E8%AA%BF%E6%9F%BB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">原因究明に関する調査について</a></li><li><a href="#%E9%95%B7%E6%9C%9F%E7%9A%84%E3%81%AA%E4%BF%AE%E6%AD%A3%E9%A0%85%E7%9B%AE%E3%81%A8%E3%81%97%E3%81%A6%E6%A4%9C%E8%A8%8E%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">長期的な修正項目として検討される事象について</a></li><li><a href="#%E3%81%8A%E5%AE%A2%E6%A7%98%E3%81%A8%E3%81%AE%E3%81%94%E9%80%A3%E7%B5%A1%E3%81%8C%E3%81%A4%E3%81%8B%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88%E3%82%84%E3%80%81%E3%81%8A%E5%BE%85%E3%81%A1%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">お客様とのご連絡がつかない場合や、お待ちする場合について</a></li><li><a href="#%E5%8F%82%E8%80%83">参考</a></li></ul><h2 id="お問い合わせ番号について"><a href="#お問い合わせ番号について" class="headerlink" title="お問い合わせ番号について"></a>お問い合わせ番号について</h2><p>クラウド サポートでは、お問い合わせ受付の際にお問い合わせ番号を発行させていただきます。お問い合わせの内容が複数の異なる技術的観点からの調査が必要な場合には、お問い合わせの管理上 <a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a> より新しいお問い合わせの起票をお願いいたします。<br>2021 年 10 月 27 日以降、個人情報保護の強化のため、基本的に弊社サポート担当者でのチケットの起票については行っておりません。あらかじめご理解の上、ご協力くださいますようお願い申し上げます。</p><h2 id="原因究明に関する調査について"><a href="#原因究明に関する調査について" class="headerlink" title="原因究明に関する調査について"></a>原因究明に関する調査について</h2><p>Dynamics 365 では、マイクロソフトがサービスの提供に影響を与えると認識したサービス インシデントのうち、大規模なものはインシデントの事後レポート (PIR)、それ以外のものは Microsoft 365 管理センターの <a href="https://admin.microsoft.com/Adminportal/Home#/servicehealth">サービス正常性ダッシュボード</a> にて根本原因に関する情報を提供しております。インシデントの事後レポート (PIR) に関しましてはサービス正常性ダッシュボードから英語版をダウンロードすることが可能です。<br>また、お問い合わせいただいた問題を再現することができない場合、原因調査・原因究明が難しい場合がございます。ご理解のほどお願い申し上げます。</p><h2 id="長期的な修正項目として検討される事象について"><a href="#長期的な修正項目として検討される事象について" class="headerlink" title="長期的な修正項目として検討される事象について"></a>長期的な修正項目として検討される事象について</h2><p>お問い合わせいただいた問題の中には、影響範囲など様々な観点から開発部門で判断した結果、中長期的な検討課題として調査する場合があります。そのような中長期的な視点で調査を行う問題について、回避策が存在する場合には一旦サービス リクエストでの対応を終了をご相談させていただく場合がございます。</p><p>ご対応を終了後でも、新たなご懸念点がある場合や、調査の進捗を確認する必要がある場合には、元お問い合わせ番号を添えて新規にお問い合わせをご起票いただけましたらご対応を再開いたしますのでご安心ください。なお、調査の進捗確認において、お問い合わせ時点でも調査が継続中の場合にはその旨のご報告をもってサービス リクエストの回答とさせていただくことをご了承ください。</p><h2 id="お客様とのご連絡がつかない場合や、お待ちする場合について"><a href="#お客様とのご連絡がつかない場合や、お待ちする場合について" class="headerlink" title="お客様とのご連絡がつかない場合や、お待ちする場合について"></a>お客様とのご連絡がつかない場合や、お待ちする場合について</h2><p>次の状況では、お問い合わせについて対応終了のステータスとさせていただくことがございますことをご了承ください。</p><ul><li>事象の解決に繋がる可能性が高い情報をご案内させていただいた場合や、調査に必要な情報が不足している場合に、お客様と複数回連絡がつかない状況</li><li>お客様での調査ログ採取や確認などにお時間を要することが予測される状況</li></ul><p>事象が改善せず引き続き調査が必要である場合や、調査ログが採取された場合は、元お問い合わせ番号を添えて新規サービス リクエストでお問い合わせください。内容を継続してご対応を再開いたします。<br>何卒、お客様のご理解、ご協力のほどお願い申し上げます。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>以下の記事もあわせてご確認ください。</p><ul><li><a href="/blog/powerplatform/For-early-resolution-of-issues/">サポートチームより問題の早期解決に向けたお客様へのお願い</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの鎌田です。&lt;/p&gt;
&lt;p&gt;いつも Dynamics 365 をご利用いただきありがとうございます。&lt;br&gt;本記事では、Dynamics 365 をご利用されている皆様へクラウド サポートをご利用いただく際の留意点を申</summary>
      
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
    <category term="サポート" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88/"/>
    
  </entry>
  
  <entry>
    <title>アプリごとの Power Apps プラン（per app plan）ライセンスについて</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerapps/power-apps-per-app-license/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerapps/power-apps-per-app-license/</id>
    <published>2022-11-18T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.232Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br/><br>今回は、アプリごとの Power Apps プラン（per app plan）ライセンスについて、下記項目の順にご説明いたします。<br>・前提<br>・アプリごとの Power Apps プランライセンスとは<br>・ライセンスに含まれるPower Automateの使用権<br>・ライセンス割り当て方法<br>・ライセンス割り当て可能なユーザー<br>・ライセンスを割り当て解除するには<br>・レポート機能について<br>・従量課金プランについて<br><br/><br/></p><span id="more"></span> <h2 id="lt-前提-gt"><a href="#lt-前提-gt" class="headerlink" title="&lt;前提&gt;"></a><strong>&lt;前提&gt;</strong></h2><p>キャンバスアプリについては、アプリを実行する際に、実行するユーザーに有効なライセンスが必要となります。<br><br/><br/><br>そのため、有償版のライセンスがないユーザーでも、有償機能を含むアプリの作成は可能でございます。<br>有償機能を含むアプリを実行する場合、実行する際に、対象ユーザーに有償版のライセンスの付与が必要となります。<br><br/><br/><br>必要なライセンスは、アプリのライセンスの種類で確認が可能でございます。<br><br/><br/><br>※下記いずれかの場合、アプリのライセンス種類が「プレミア」になります。<br>・アプリ内で有償機能を利用している<br>・アプリからフローを呼び出している場合、フロー内で有償機能を利用している<br>その場合には、アプリを実行するユーザー全員にPower Appsの有償ライセンスが必要となります。<br><br/><br/><br>アプリのライセンス種類の確認方法については、下記公開情報をご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/license-designation#check-app-license-designation-from-app-settings">アプリのライセンス指定の確認方法 </a><br><br/><br/></p><h2 id="lt-アプリごとの-Power-Apps-プランライセンスとは-gt"><a href="#lt-アプリごとの-Power-Apps-プランライセンスとは-gt" class="headerlink" title="&lt;アプリごとの Power Apps プランライセンスとは&gt;"></a><strong>&lt;アプリごとの Power Apps プランライセンスとは&gt;</strong></h2><p>Power Apps の全ての機能を利用可能でございます。<br>１ライセンスで1ユーザーが１アプリを利用可能でございます。<br><br/><br/><br>実行したいアプリが複数ある場合には、実行したいアプリ数分のライセンスが必要となります。<br>1つのアプリを複数ユーザーが実行したい場合、実行するユーザー数分のライセンスが必要となります。<br><br/><br/><br>詳細については下記公開情報､ライセンスガイドをご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/about-powerapps-perapp">アプリごとの Power Apps プランについて</a><br><a href="https://go.microsoft.com/fwlink/?LinkId=2085130&clcid=0x411">Microsoft Power Apps、Microsoft Power Automate、Microsoft Power Virtual Agents ライセンスガイド</a><br>※PDFファイルがダウンロードされます。<br><br/><br/></p><p>　  </p><h2 id="lt-アプリごとの-Power-Apps-プランライセンスに含まれるPower-Automateの使用権-gt"><a href="#lt-アプリごとの-Power-Apps-プランライセンスに含まれるPower-Automateの使用権-gt" class="headerlink" title="&lt;アプリごとの Power Apps プランライセンスに含まれるPower Automateの使用権&gt;"></a><strong>&lt;アプリごとの Power Apps プランライセンスに含まれるPower Automateの使用権&gt;</strong></h2><p>アプリのコンテキスト内であればプレミアムコネクタを含むフローの利用が可能でございます。<br><br/><br/><br>アプリのコンテキスト内とは、下記トリガーのフローを指します。<br>①Power Appsトリガーのフロー<br>②Power Apps（V2）トリガーのフロー<br>③スケジュールトリガーでアプリ内のデータソースを操作するためのフロー<br>④自動トリガーでアプリ内のデータソースを操作するためのフロー<br>⑤手動トリガーでアプリ内のデータソースを操作するためのフロー<br><br/><br>ただし、アプリごとの Power Apps プランライセンスのみ付与の場合、現状の動作制限として、上記③④⑤のフローかつプレミアムコネクタを含むフローを作成することはできません。<br>フローが作成可能なPower Appsの試用版ライセンスを取得する必要がございます。<br><br/><br/></p><h2 id="lt-アプリごとの-Power-Apps-プランライセンス割り当て方法-gt"><a href="#lt-アプリごとの-Power-Apps-プランライセンス割り当て方法-gt" class="headerlink" title="&lt;アプリごとの Power Apps プランライセンス割り当て方法&gt;"></a><strong>&lt;アプリごとの Power Apps プランライセンス割り当て方法&gt;</strong></h2><p>環境にライセンス割り当て　→　アプリに割り当て　→　ユーザーにアプリ共有　というイメージとなります。<br><br/><br/><br>①Power Platform管理センターから、該当の環境に対してパスを割り当てます。<br>　リソース　＞　容量　＞　アドオン　＞　パス割り当て対象の環境のペンマーク　＞　アプリのパス<br>　<img src="/blog/powerapps/power-apps-per-app-license/assign-to-envs.png"><br><br/><br/><br>②Power Appsポータルサイトにて対象アプリの「アプリパスごとの自動割り当て」（または「アプリごとのライセンス」）を「オン」に変更します。<br>　①で対象環境にパスの割り当てがされていない場合、その環境下でアプリに対して「アプリパスごとの自動割り当て」が設定出来ません。<br>　パスの設定がper appプランでアプリを共有するための前提の設定となります。<br> <br/><br/><br>　アプリ　＞　対象アプリを選択　＞　設定　＞　「アプリパスごとの自動割り当て」（または「アプリごとのライセンス」）<br>　<img src="/blog/powerapps/power-apps-per-app-license/assign-to-apps.png"><br>　<img src="/blog/powerapps/power-apps-per-app-license/assign-to-apps2.png"><br><br/><br>　※環境にアプリごとの Power Apps プランライセンスのパスを割り当てている場合、2020 年 10 月 1 日以降に作成したアプリについては、自動にオンとなります。<br>　※アプリの設定は、対象アプリにおける下記のユーザーの場合に、設定可能でございます。<br>　・作成者<br>　・共同所有者<br><br/><br/><br>③「アプリパスごとの自動割り当て」（または「アプリごとのライセンス」）を有効化後、<br>　対象のユーザーに対してアプリを共有することで、 共有されたユーザーに対してPower Apps per app planが自動的に有効となります。<br><br/><br>　アプリ共有方法は下記公開情報をご参照ください。<br>　<a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/share-app">キャンバス アプリを組織と共有する</a><br><br/><br/></p><p>　　  </p><h2 id="lt-アプリごとの-Power-Apps-プランライセンス割り当て可能なユーザー-gt"><a href="#lt-アプリごとの-Power-Apps-プランライセンス割り当て可能なユーザー-gt" class="headerlink" title="&lt;アプリごとの Power Apps プランライセンス割り当て可能なユーザー&gt;"></a><strong>&lt;アプリごとの Power Apps プランライセンス割り当て可能なユーザー&gt;</strong></h2><p>下記より設定いただけます。<br>Power Platform 管理センター　＞　設定　＞　アドオン容量の割り当て<br><img src="/blog/powerapps/power-apps-per-app-license/who-can-assign.png"><br><br/><br/><br>「任意の環境管理者」の場合、対象環境において「システム管理者（System Administrator）」のセキュリティロールが<br>割り当てられているユーザーが割り当てが可能でございます。<br><br/><br/><br>「特定の管理者のみ」の場合、下記3種の管理者ユーザーが割り当て可能でございます。<br>・グローバル管理者<br>・Dynamics 365 管理者<br>・Power Platform 管理者<br><br/><br>詳細については下記公開情報をご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-add-on?WT.mc_id=ppac_inproduct_settings#control-who-can-allocate-add-on-capacity">アドオン容量を割り当てることができるコントロール</a><br><br/><br/></p><h2 id="lt-アプリごとの-Power-Apps-プランライセンス割り当て解除するには-gt"><a href="#lt-アプリごとの-Power-Apps-プランライセンス割り当て解除するには-gt" class="headerlink" title="&lt;アプリごとの Power Apps プランライセンス割り当て解除するには&gt;"></a><strong>&lt;アプリごとの Power Apps プランライセンス割り当て解除するには&gt;</strong></h2><p>下記いずれかをご実行ください。<br>・アプリの共有を停止<br>・環境に割り当てるパスを解除（0にする）<br><br/><br/></p><h2 id="lt-レポート機能について-gt"><a href="#lt-レポート機能について-gt" class="headerlink" title="&lt;レポート機能について&gt;"></a><strong>&lt;レポート機能について&gt;</strong></h2><p>現状、各種管理センターなどから、ユーザーに対してアプリごとの Power Apps プランライセンスが割り当てられたことを確認できる機能のご用意はない状況でございます。<br>アプリごとの Power Apps プランライセンスの使用レポート機能は現在開発中となっております。<br>下記公開情報にて最新情報を記載しておりますので、ご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/about-powerapps-perapp#when-will-i-be-able-to-see-the-list-of-users-who-are-using-the-power-apps-per-app-license">アプリ ライセンスごとの Power Apps を使用しているユーザー リストを見ることができますか?</a><br><br/><br>レポート機能が未実装のたため、現状ではライセンスを消費する制御も未実装となっております。<br><br/><br/><br>①環境にライセンスを割り当てる<br>②該当のアプリの設定で「アプリごとのライセンス」をオンにする<br>③アプリをユーザーに共有する<br><br/><br>上記の①②③を満たす場合、環境に割り当てられたパスの数に関わらず、<br>アプリが共有されたユーザーはPower Apps per app planの範囲内でアプリの利用が可能となります。<br>※環境に割り当てられたパスの数が3つだとしても、4人以上のユーザーへの共有、アプリの実行が可能でございます。<br><br/><br>実際に環境内でアプリの利用が可能な状態のユーザーの数と、<br>割り当てられたアプリのパスの数に差異が生じてしまう場面もあるかと存じますが、<br>環境に割り当てられたパスの数と、実際にPower Apps per app planの利用権でアプリを利用しているユーザーの数を<br>お守りいただくようにお客様にはご案内を差し上げている状況でございます。<br><br/></p><p>また、今後、数の整合性を取るためのチェック機能が実装される可能性もございますため、<br>環境に割り当てられたパスの数と実際に利用するユーザーの数が乖離しないようご運用をいただけますと幸いでございます。<br><br/><br>想定される数のパスをご購入いただき、運用をいただけておりましたら、<br>弊社としてはライセンス要件上問題ないと考えております。<br><br/><br>製品としての制御もございませんので、問題なくご利用いただけますためご安心いただけますと幸いでございます。<br><br/><br/></p><h2 id="lt-従量課金プランについて-gt"><a href="#lt-従量課金プランについて-gt" class="headerlink" title="&lt;従量課金プランについて&gt;"></a><strong>&lt;従量課金プランについて&gt;</strong></h2><p>従量課金のプランがございます。<br>詳細については下記公開情報をご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/pay-as-you-go-overview">従量課金制プランの概要</a>   </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br/&gt;&lt;br&gt;今回は、アプリごとの Power Apps プラン（per app plan）ライセンスについて、下記項目の順にご説明いたします。&lt;br&gt;・前提&lt;br&gt;・アプリごとの Power Apps プランライセンスとは&lt;br&gt;・ライセンスに含まれるPower Automateの使用権&lt;br&gt;・ライセンス割り当て方法&lt;br&gt;・ライセンス割り当て可能なユーザー&lt;br&gt;・ライセンスを割り当て解除するには&lt;br&gt;・レポート機能について&lt;br&gt;・従量課金プランについて&lt;br&gt;&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="license" scheme="https://jpdynamicscrm.github.io/blog/tags/license/"/>
    
  </entry>
  
  <entry>
    <title>環境内のデスクトップ フローの所有者、作成日、修正日を確認する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-get-owner/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-get-owner/</id>
    <published>2022-11-15T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.284Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの原野です。  </p><p>今回は、Power Automate for desktop で作成した環境内のデスクトップ フローの所有者、作成日、修正日などの基礎情報を確認する方法についてご紹介します。<br>なお、ご案内する方法は「環境」ごとの確認になりますので、予めご了承いただけますと幸いです。</p><p>デスクトップ フローに関しても、所有者、作成日、修正日などの基礎情報を環境単位で簡単に確認できます。</p><p>お試しいただけましたら幸いです。</p><span id="more"></span><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>環境の管理者権限のあるユーザーの場合、デスクトップ フローの所有者等の基礎情報を確認する方法は大きく分けて 2 つあります。</p><h2 id="a-Power-Automate-ポータル画面から確認する"><a href="#a-Power-Automate-ポータル画面から確認する" class="headerlink" title="a. Power Automate ポータル画面から確認する"></a>a. Power Automate ポータル画面から確認する</h2><p>環境の管理者は、環境内の全てのデスクトップ フローの共同所有者となります。<br>そのため、有償ライセンスをお持ちの場合「マイ フロー &gt; デスクトップ フロー」から環境内の全てのフローの情報を確認いただけます。</p><p>有償ライセンスについては以下をご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/premium-features#plans-that-provide-entitlements-for-the-premium-rpa-features">Premium RPA 機能 - Power Automate | Microsoft Learn</a></p><p>また、Power Automate ポータル画面からデスクトップ フローを確認する方法については以下に記載されています。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage#list-of-desktop-flows">デスクトップ フローの共有と管理 - Power Automate | Microsoft Learn</a></p><h2 id="b-Dataverse-内のテーブルから確認する"><a href="#b-Dataverse-内のテーブルから確認する" class="headerlink" title="b. Dataverse 内のテーブルから確認する"></a>b. Dataverse 内のテーブルから確認する</h2><p>デスクトップ フローの所有者等の情報は、Dataverse のプロセス テーブルに格納されています。<br>環境の管理者権限のあるユーザーが以下の手順を行うことで、環境ごとのデスクトップ フローの基礎情報を一括で取得いただけます。<br>取得した情報は Excel ファイルにエクスポートすることが可能です。</p><h3 id="1-Power-Apps-の画面に遷移します"><a href="#1-Power-Apps-の画面に遷移します" class="headerlink" title="1. Power Apps の画面に遷移します"></a>1. Power Apps の画面に遷移します</h3><p>Power Automate 画面より「データ &gt; テーブル」からメニューを選択することで Power Apps の画面に遷移します。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image1.png"><br><br><br><br></p><h3 id="2-「詳細設定」を選択します"><a href="#2-「詳細設定」を選択します" class="headerlink" title="2. 「詳細設定」を選択します"></a>2. 「詳細設定」を選択します</h3><p>まず、今回確認したい環境を選択します。<br>その上で、表示された Power Apps 画面の右上のギアアイコンより「詳細設定」を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image2.png"><br><br><br><br></p><h3 id="3-フィルタアイコンを選択します"><a href="#3-フィルタアイコンを選択します" class="headerlink" title="3. フィルタアイコンを選択します"></a>3. フィルタアイコンを選択します</h3><p>表示された Dynamics 365 画面右上のフィルタアイコンを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image3.png"><br><br><br><br></p><h3 id="4-「プロセス」を選択した上で、条件をクリアします"><a href="#4-「プロセス」を選択した上で、条件をクリアします" class="headerlink" title="4. 「プロセス」を選択した上で、条件をクリアします"></a>4. 「プロセス」を選択した上で、条件をクリアします</h3><p>表示された「高度な検索」の「検索」画面で、「プロセス」を選択した上で、赤枠の 「クリア」で条件をクリアします。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image4.png"><br><br><br><br></p><h3 id="5-条件を設定し、リボンの-「結果」をクリックします"><a href="#5-条件を設定し、リボンの-「結果」をクリックします" class="headerlink" title="5. 条件を設定し、リボンの 「結果」をクリックします"></a>5. 条件を設定し、リボンの 「結果」をクリックします</h3><p>検索条件として、カテゴリから「デスクトップ フロー」を選択下さい。<br>また、「列の編集 &gt; 列の追加」から作成日、修正日など追加で表示する列を選択できます。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image5.png"><br><br><br><br></p><p>※列の追加方法の具体的な手順について<br>例えば、作成者のメールアドレスの列を追加で表示させたい場合、以下の方法で追加できます。</p><h4 id="5-1-「列の編集」を選択します"><a href="#5-1-「列の編集」を選択します" class="headerlink" title="5-1.「列の編集」を選択します"></a>5-1.「列の編集」を選択します</h4><p><img src="/blog/powerautomate/power-automate-desktop-get-owner/image7.png"><br><br><br><br></p><h4 id="5-2-「列の追加」を選択します"><a href="#5-2-「列の追加」を選択します" class="headerlink" title="5-2.「列の追加」を選択します"></a>5-2.「列の追加」を選択します</h4><p><img src="/blog/powerautomate/power-automate-desktop-get-owner/image8.png"><br><br><br><br></p><h4 id="5-3-「レコードの種類」を「所有ユーザー-ユーザー-」に変更します"><a href="#5-3-「レコードの種類」を「所有ユーザー-ユーザー-」に変更します" class="headerlink" title="5-3.「レコードの種類」を「所有ユーザー (ユーザー)」に変更します"></a>5-3.「レコードの種類」を「所有ユーザー (ユーザー)」に変更します</h4><p><img src="/blog/powerautomate/power-automate-desktop-get-owner/image9.png"><br><br><br><br></p><h4 id="5-4-表示させたい項目を選択し、「OK」を-2-回押してメイン画面に戻ります"><a href="#5-4-表示させたい項目を選択し、「OK」を-2-回押してメイン画面に戻ります" class="headerlink" title="5-4. 表示させたい項目を選択し、「OK」を 2 回押してメイン画面に戻ります"></a>5-4. 表示させたい項目を選択し、「OK」を 2 回押してメイン画面に戻ります</h4><p><img src="/blog/powerautomate/power-automate-desktop-get-owner/image10.png"><br><br><br><br></p><h3 id="6-デスクトップ-フローの基礎情報が一覧表示されます"><a href="#6-デスクトップ-フローの基礎情報が一覧表示されます" class="headerlink" title="6. デスクトップ フローの基礎情報が一覧表示されます"></a>6. デスクトップ フローの基礎情報が一覧表示されます</h3><p>表示された検索結果は 「プロセスのエクスポート」から Excel にエクスポートすることが可能です。<br><img src="/blog/powerautomate/power-automate-desktop-get-owner/image6.png"><br><br><br><br></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>環境内のデスクトップ フローの所有者、作成日、修正日などの基礎情報を確認する方法についてご紹介しました。<br>少しでもお役に立つ情報がございましたら幸いです。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの原野です。  &lt;/p&gt;
&lt;p&gt;今回は、Power Automate for desktop で作成した環境内のデスクトップ フローの所有者、作成日、修正日などの基礎情報を確認する方法についてご紹介します。&lt;br&gt;なお、ご案内する方法は「環境」ごとの確認になりますので、予めご了承いただけますと幸いです。&lt;/p&gt;
&lt;p&gt;デスクトップ フローに関しても、所有者、作成日、修正日などの基礎情報を環境単位で簡単に確認できます。&lt;/p&gt;
&lt;p&gt;お試しいただけましたら幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>サポート インスタンスの提供</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Provide-Support-Instance/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Provide-Support-Instance/</id>
    <published>2022-11-11T08:30:00.000Z</published>
    <updated>2023-01-13T09:30:43.364Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの鎌田です。</p><p>本記事では弊社サポート サービスでお問合せいただいたお客様に向けてご案内しておりますサポート インスタンスを紹介します。</p><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>サポート インスタンスは、弊社エンジニアがお客様の問題を再現させて調査することを目的とした環境です。</p><p>サポート インスタンスへお客様の事象が発生している環境をコピーしていただくことで、事象の再現と調査を一貫して行うことが可能となり、早期解決が見込めます</p><p>弊社エンジニアがサポート インスタンスを利用した調査が有効であると判断した場合、お客様にサポート インスタンスの作成について可否を伺います。ご了承いただける場合は、次の 1, 2 をご対応いただき、弊社にてサポート インスタンス作成後、お客様にて 3 のコピーをお願いいたします。</p><hr><ol><li><a href="#anchor-about-criteria">サポートインスタンス作成条件の確認</a></li><li><a href="#anchor-about-information">情報の提供</a></li><li><a href="#anchor-about-copy">サポートインスタンスのコピー</a></li></ol><p><a id='anchor-about-criteria'></a></p><h2 id="1-サポートインスタンス作成条件の確認"><a href="#1-サポートインスタンス作成条件の確認" class="headerlink" title="1. サポートインスタンス作成条件の確認"></a>1. サポートインスタンス作成条件の確認</h2><p>サポート インスタンスを作成するために、次の全ての条件を満たす必要がございます。</p><ul><li>a. お問い合わせ起票者は、事象発生環境にて、システム管理者のセキュリティロールが割り当てられている。</li><li>b. お問い合わせの対象製品として Dynamics 365 Customer Enagagement が選択されている。<br><img src="/blog/powerplatform/Provide-Support-Instance/00_SR_product.png"></li><li>c. お問い合わせにて、サポート インスタンス作成の同意レベルが、次のいずれかに設定されている。<ul><li>診断情報へのアクセスで <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/copy-environment#copy-over-customizations-and-schemas-only">最小限のコピー</a> を許可する</li><li>診断情報へのアクセスで <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/copy-environment#copy-over-everything">フル コピー</a> を許可する</li></ul>  同意レベルが異なる場合 <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-environment#how-do-i-grant-or-revoke-consent-after-i-create-a-support-request">サポート リクエストを作成した後、同意を付与または取り消すにはどうすればよいですか?</a> を参考に、同意レベルを設定ください。</li></ul><p><strong>留意事項</strong></p><p>事象発生テナントとお問い合わせ起票テナントが異なる場合 – 例えば A 社環境で事象が発生しており、パートナー様 B 社が代理で調査依頼を起票する場合は条件 a ~ c を満たすことをご確認ください。条件を満たさない場合、条件に合致するよう新規お問い合わせのご起票をお願いさせていただくことがございます。</p><p>これらの条件は <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-environment">サポート環境と顧客データへのアクセスへの同意</a> に説明されますように、お客様のプライバシーを尊重するための措置でございます。ご了承くださいますと幸いでございます。</p><p><a id='anchor-about-information'></a></p><h2 id="2-情報の提供"><a href="#2-情報の提供" class="headerlink" title="2. 情報の提供"></a>2. 情報の提供</h2><ol><li><a href="#anchor-about-criteria">サポートインスタンス作成条件の確認</a> が完了しましたら、サポート インスタンス作成のため、弊社サポート エンジニアへ次の情報をご提供ください。</li></ol><ul><li><p>事象発生環境 URL (***.crm*.dynamics.com)</p></li><li><p>事象発生環境をサポートインスタンスへコピーするユーザーの UPN (ユーザーは事象発生環境にてシステム管理者セキュリティ ロールが割り当てられている必要がございます。)</p><p>UPN は Power Platform 管理センター &gt; 環境 &gt; 設定 &gt; ユーザー のユーザー名よりご確認いただけます。<br><img src="/blog/powerplatform/Provide-Support-Instance/00_UPN.png"></p></li></ul><p>ご提供いただいた情報より、弊社にてサポート インスタンスを作成いたします。</p><p>サポート エンジニアより、新規作成したサポート インスタンス環境名をお問い合わせ起票者へご連絡いたしますので、3. <a href="#anchor-about-copy">サポートインスタンスのコピー</a> の手順でコピーを実施ください。</p><p><a id='anchor-about-copy'></a></p><h2 id="3-サポートインスタンスのコピー"><a href="#3-サポートインスタンスのコピー" class="headerlink" title="3. サポートインスタンスのコピー"></a>3. サポートインスタンスのコピー</h2><p>弊社エンジニアより、サポートインスタンス環境名が通知されましたら、2. <a href="#anchor-about-information">情報の提供</a> でご共有いただきました UPN のユーザーにて、コピー操作をお願いいたします。</p><ol><li><p>当該 UPN のユーザーにて、 <a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a> へサインインします。</p></li><li><p>左ペインより [環境] をクリックし、さらに、事象が発生しているインスタンスをクリックします。</p></li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/00_choose-environment.png"></p><ol start="3"><li>事象が発生しているインスタンスが開いたら、上部メニューの [コピー] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/01_copy_environment.png"></p><ol start="4"><li>[環境のコピー] が右ペインに表示されます。[上書きコピー] や [上書きする環境を選択します] を設定します。設定は担当のサポート エンジニアより指定された項目をお選びください <a href="#%E6%B3%A8%E9%87%88">(※1)</a> 。その後、「私は、Microsoft がオンライン サービスの運用に…」 からはじまる注意書きを確認、チェックをつけた後に、最下段の [コピー] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/02_copy_environment_setting.png"></p><p><strong>留意事項</strong></p><p>監査ログはコピーするか否かを選択することができます。監査ログをコピーすると、環境のコピーにかかる時間が大幅に長くなる可能性があり、既定では実行されません。 <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/copy-environment#copying-audit-logs">こちらのページ</a> の操作を実行することで、環境コピーに監査ログを含めることができます。弊社エンジニアから監査ログのコピーを依頼された場合はご対応をお願いいたします。</p><ol start="5"><li>確認のダイアログでは [確認] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/03_overwrite_confirm.png"></p><ol start="6"><li>コピーが開始されますので、お待ちください。各フェイズが [開始前] [進行中] [成功] と進展していきます。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/04_processing.png"></p><ol start="7"><li>成功しましたらコピー手順は終了です。担当エンジニアまで完了の旨をご連絡ください。</li></ol><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><ul><li>本手順は執筆時点の弊社検証環境でのユーザー インターフェイスを基に紹介しております。不明点がございましたら、担当のサポート エンジニアまでご相談ください。</li><li>作成したインスタンスはお客様のテナントのストレージ容量には影響ございません。</li><li>サポート インスタンスは、既定では7日間で自動削除されますが、サポート エンジニアの調査状況により削除が延長される場合があります。この場合についても、調査が終了した後に自動削除されます。</li></ul><h2 id="注釈"><a href="#注釈" class="headerlink" title="注釈"></a>注釈</h2><ul><li>(※1) [環境のコピー] で、サポート インスタンス名が長すぎることなどが原因で、サポート インスタンスを見つけられない場合は、ブラウザの Ctrl + F、もしくは F3 キーで検索が可能です。</li></ul><p><img src="/blog/powerplatform/Provide-Support-Instance/07_search_instance.png"></p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><table><thead><tr><th>リンク</th><th>内容</th></tr></thead><tbody><tr><td><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-environment#what-are-support-environments">サポート環境とは</a></td><td>サポートインスタンス全般の解説をしております。</td></tr><tr><td><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/copy-environment">環境のコピー</a></td><td>完全コピー (すべて) や最小限のコピー (カスタマイズとスキーマのみ) について解説をしております。</td></tr><tr><td><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/copy-environment#copying-audit-logs">監査ログのコピー</a></td><td>環境コピー時に監査ログをコピーする手順について解説をしております。</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの鎌田です。&lt;/p&gt;
&lt;p&gt;本記事では弊社サポート サービスでお問合せいただいたお客様に向けてご案内しておりますサポート インスタンスを紹介します。&lt;/p&gt;
&lt;h2 id=&quot;概要&quot;&gt;&lt;a href=&quot;#概要&quot; clas</summary>
      
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dataverse for Teams" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse-for-Teams/"/>
    
    <category term="環境" scheme="https://jpdynamicscrm.github.io/blog/tags/%E7%92%B0%E5%A2%83/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop のサポート範囲について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/</id>
    <published>2022-11-11T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.252Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポート チームの 王 です。<br>今日は Power Automate for desktop のサポート範囲についてご案内いたします。  </p><span id="more"></span><h2 id="初めに"><a href="#初めに" class="headerlink" title="初めに"></a>初めに</h2><p>Power Automate for desktop は Windows をご利用のお客様であればどなたでも追加費用なしでご利用いただける RPA ツールです。2021 年 3 月 3日 (日本時間) に公開されました。<br><a href="https://docs.microsoft.com/ja-jp/power-automate/desktop-flows/introduction">Power Automate for desktop の概要</a>  </p><p>今回は Power Automate for desktop のサポート範囲についてご案内します。  </p><h2 id="Power-Automate-for-desktop-のサポートについて"><a href="#Power-Automate-for-desktop-のサポートについて" class="headerlink" title="Power Automate for desktop のサポートについて"></a>Power Automate for desktop のサポートについて</h2><p>Windows のライセンスに含まれる Power Automate for desktop は、PC にインストールして使用する無料のアプリケーションです。<br>このアプリケーションには、SLA や Microsoft サポートが含まれないため、ビジネス クリティカルな用途で使用すべきではありません。<br>Power Automate for desktop をビジネス クリティカルな用途で使用する場合、サポートが含まれる適切な Microsoft ライセンスの購入をご検討ください。<br>対象となるプランは以下です ※2022/11 時点  </p><ul><li>Power Automate per user plan with attended RPA  </li><li>Power Automate unattended RPA add-on（前提としてPower Automate per user with attended RPA または Power Automate per flow が必要）  </li><li>従量課金制プラン</li></ul><p>ライセンスのご購入状況は、Microsoft 365 管理センターの [課金情報] - [サービスを購入する] からご確認いただけます。<br>上記ライセンスで Power Automate for desktopご利用されていないお客様は、サポートにお問い合わせをいただいた場合もご支援することができません。<br>ライセンスをお持ちでない場合は、以下のコミュニティをご活用ください。<br><a href="https://powerusers.microsoft.com/t5/Microsoft-Power-Automate/ct-p/MPACommunity">Microsoft Power Automate Community</a></p><p>また、お問い合わせをいただく際には、弊社にてライセンスのチェックを行わせていただく場合がございますので、以下の情報を添えてお問い合わせいただけますと幸いでございます。</p><h3 id="お問い合わせ時の情報採取手順"><a href="#お問い合わせ時の情報採取手順" class="headerlink" title="お問い合わせ時の情報採取手順"></a>お問い合わせ時の情報採取手順</h3><ol><li>Power Automate for desktop にサインインしているユーザーで <a href="https://make.powerautomate.com/">Power Automate ポータル</a> にアクセスします。</li><li>画面右上から、デスクトップ フローを作成中の環境を選択します。</li><li>キーボードの <code>Ctrl</code> + <code>Alt</code> + <code>A</code> を押下し、別タブにて表示される情報を全てコピーし、テキスト形式でお寄せください。</li></ol><p>手順 3 にて取得した情報に以下のいずれかが含まれる場合、サポートが含まれるプランをお持ちのため、ご支援が可能でございます。</p><ul><li>“environment” 内の “isPayAsYouGoEnabled” が true の場合</li><li>“userServicePlans” 内で “isCurrent” が true のプランにて、”rpaAttendedAllowed” または “rpaUnattendedAllowed” のいずれかが true の場合</li></ul><p>サポート範囲については以下ライセンスガイドからもご確認いただくことが可能です。<br>英語版　：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409</a><br>日本語版：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411</a>  </p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>Power Autoamte for desktop で弊社サポートをご利用いただけるライセンスにについてご案内いたしました。<br>製品やライセンスに関する情報は随時更新されるため、最新の情報については公開情報もしくは上記ライセンスガイドをご参照ください。  </p><p>–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポート チームの 王 です。&lt;br&gt;今日は Power Automate for desktop のサポート範囲についてご案内いたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps キャンバス アプリ お問い合わせの際の情報取得手順</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/</id>
    <published>2022-10-31T15:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.200Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの谷です。<br/><br>弊社サポートでは、キャンバス アプリが動作しない、エラーが発生する、等のトラブルシューティングにおいて、お問い合わせの内容をもとに調査方針を立てておりますが、発生している事象を明確に把握するため、ご利用者様の環境で発生している事象の切り分けや情報提供をお願いすることがあります。<br/><br>この記事では、キャンバス アプリのトラブルシューティングを行うにあたって、必要となる情報の取得手順をご説明します。</p><span id="more"></span><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>キャンバス アプリ編集時、また実行時に発生する問題解決におけるお問い合わせの際の情報取得手順についてご説明します。</p><hr><ol><li><a href="#anchor-about-situation">事象の発生状況</a></li><li><a href="#anchor-about-screencapture">事象発生時のエラーメッセージや画面キャプチャ・動画</a></li><li><a href="#anchor-about-appchecker">アプリ チェッカーのエラーメッセージ　※編集中のみ</a></li><li><a href="#anchor-about-versions">Power Apps バージョン</a></li><li><a href="#anchor-about-monitorlog">Power Apps モニターログ</a></li><li><a href="#anchor-about-networkhar">Webブラウザのネットワーク トレース・コンソール ログ</a></li><li><a href="#anchor-about-sessionid">セッションID</a></li><li><a href="#anchor-about-app-tenant-ids">アプリURL (アプリID、テナントID) </a></li><li><a href="#anchor-about-enviromentid">環境ID</a></li><li><a href="#anchor-about-canvasapp">アプリ</a></li></ol><h2 id="情報取得手順"><a href="#情報取得手順" class="headerlink" title="情報取得手順"></a>情報取得手順</h2><p><a id='anchor-about-situation'></a></p><h3 id="1-事象の発生状況"><a href="#1-事象の発生状況" class="headerlink" title="1. 事象の発生状況"></a>1. 事象の発生状況</h3><p>エラーや意図しない状況がどのような状況下で発生するかお知らせください。<br/><br>事象の発生条件を見極めることで、問題の箇所を特定するだけではなく、弊社環境で動作検証を行い再現するかどうか確認することができます。<br/><br>例えば、以下の情報をお知らせいただくことでより明確に事象を把握することができます。</p><ul><li>事象が発生するタイミング<ul><li>いつから発生しているか・現在も継続して発生しているか</li><li>どのような頻度で発生しているか</li><li>発生前後で何らかの変更を行ったか</li></ul></li><li>事象が発生する端末の差異</li><li>事象が発生しているユーザーと事象が発生していないユーザーの差異<ul><li>事象の内容によりユーザーのメールアドレス情報やユーザープリンシパル名をご提供いただく場合があります</li></ul></li><li>キャンバス アプリをご利用いただいている端末のネットワーク環境の差異(プロキシー経由で利用など)</li><li>事象が発生しているWebブラウザの差異(Microsoft Edge、Google Chrome、Firefoxなど)<ul><li>Webブラウザのプラグインや拡張機能の有無</li></ul></li><li>事象の発生環境 (Power Apps モバイルアプリ/Webブラウザ)</li></ul><p><a id='anchor-about-screencapture'></a></p><h3 id="2-事象発生時のエラーメッセージや画面キャプチャ・動画"><a href="#2-事象発生時のエラーメッセージや画面キャプチャ・動画" class="headerlink" title="2. 事象発生時のエラーメッセージや画面キャプチャ・動画"></a>2. 事象発生時のエラーメッセージや画面キャプチャ・動画</h3><p>エラーの内容を具体的に表すメッセージや画面キャプチャなどの情報をお寄せください。<br/><br>事象再現時の動画がありますと事象の発生状況をより正確に把握することができます。</p><h4 id="エラーメッセージや画面キャプチャ"><a href="#エラーメッセージや画面キャプチャ" class="headerlink" title="エラーメッセージや画面キャプチャ"></a>エラーメッセージや画面キャプチャ</h4><p>エラーの内容が分かるよう画面キャプチャをご取得ください。<br/><br>エラーメッセージ内にタイムスタンプや何らかのエラーコードが記載されている場合はそれらの情報を <strong>テキスト形式</strong> でご取得ください。</p><h4 id="動画"><a href="#動画" class="headerlink" title="動画"></a>動画</h4><p>以下の2つの方法で事象発生時の動画をご取得ください。</p><ul><li><p>Windows ＋ G での画面収録</p><ol><li>Webブラウザを起動します</li><li>Webブラウザの画面を一度クリックしたのち、Windowsキー + G を押下します</li><li>「●」から画面キャプチャを開始します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image01.png"></li></ul></li><li>事象を発生させます</li><li>画面キャプチャを停止します</li><li>録画ファイルが保存されます</li></ol></li><li><p>Teams会議の録画機能</p><ol><li>Teams会議を開始します</li><li>「Start Recording」を選択し、録画を開始します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image02.png"></li></ul></li><li>画面共有し、事象を発生させます</li><li>Teams会議を終了します(録画も停止します)</li><li>録画ファイルを保存します</li></ol></li></ul><p><a id='anchor-about-appchecker'></a></p><h3 id="3-アプリ-チェッカーのエラーメッセージ-※編集中のみ"><a href="#3-アプリ-チェッカーのエラーメッセージ-※編集中のみ" class="headerlink" title="3. アプリ チェッカーのエラーメッセージ　※編集中のみ"></a>3. アプリ チェッカーのエラーメッセージ　※編集中のみ</h3><p>キャンバス アプリ編集中の場合、Power Apps Studioのアプリ チェッカーにエラーメッセージが記録されます。<br/><br>エラーが発生している処理(関数やコントロール等)と併せてアプリチェッカーに記録されているエラーメッセージをご提供ください。</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>対象のアプリの編集画面を表示します</li><li>事象を発生させます</li><li>アプリ チェッカーに記録されるエラーメッセージを <strong>画面キャプチャ</strong> などで取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image03.png"></li></ul></li></ol><p><a id='anchor-about-versions'></a></p><h3 id="4-Power-Appsバージョン"><a href="#4-Power-Appsバージョン" class="headerlink" title="4. Power Appsバージョン"></a>4. Power Appsバージョン</h3><p>バージョン差異による問題かどうかお調べする際に使用します。</p><h4 id="キャンバスアプリ-編集時"><a href="#キャンバスアプリ-編集時" class="headerlink" title="キャンバスアプリ 編集時"></a>キャンバスアプリ 編集時</h4><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>対象のアプリ編集画面を表示します</li><li>メニュー「設定」＞「サポート」を選択します</li><li>作成バージョンを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image04.png"></li></ul></li></ol><h4 id="キャンバス-アプリ-実行時"><a href="#キャンバス-アプリ-実行時" class="headerlink" title="キャンバス アプリ 実行時"></a>キャンバス アプリ 実行時</h4><p>本手順にてキャンバスアプリのリリース バージョンをご取得いただき、さらに、事象が発生している端末においてライブバージョンをご取得ください。<br/><br>ライブ バージョンはセッション情報から取得します。<br/><br>Webブラウザで事象が発生している場合、<a href="#anchor-about-sessionid-playweb">セッションID(Webブラウザ)</a> をご参照ください。<br/><br>モバイル アプリで事象が発生している場合、<a href="#anchor-about-sessionid-playmobile">セッションID(モバイルアプリ)</a> をご参照ください。</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>対象のアプリの「…」メニュー＞「詳細」を選択します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image05.png"></li></ul></li><li>「バージョン」タブを押下し、Power Apps リリース バージョンを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image06.png"></li></ul></li></ol><p><a id='anchor-about-monitorlog'></a></p><h3 id="5-Power-Apps-モニターログ"><a href="#5-Power-Apps-モニターログ" class="headerlink" title="5. Power Apps モニターログ"></a>5. Power Apps モニターログ</h3><p>キャンバス アプリ編集中、あるいは再生中に発生するイベントの記録をご提供ください。<br/><br>アプリ実行中のイベントを確認することで発生している事象を正確に把握することができます。</p><p>以下ブログ記事でもモニターログの取得方法をご説明しています。<br/><br><a href="https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-monitor/">キャンバス アプリのモニターログ取得手順</a></p><h4 id="キャンバス-アプリ-再生時"><a href="#キャンバス-アプリ-再生時" class="headerlink" title="キャンバス アプリ 再生時"></a>キャンバス アプリ 再生時</h4><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にアクセスします</li><li>アプリ 一覧画面から対象のアプリの「…」メニューを表示し、「監視」を選択します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage01.png"></li></ul></li><li>別タブで監視ウィンドウが表示されるので「公開したアプリの再生」を行います<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage02.png"></li></ul></li><li>別タブでアプリが再生されるので事象を発生させます</li><li>手順3で表示した監視ウィンドウに移動し、記録されたモニター結果を「ダウンロード」します <ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage03.png"></li></ul></li><li>ダウンロードしたファイル（PowerAppsTraceEvents.json）をご提供ください</li></ol><h4 id="キャンバス-アプリ-編集時"><a href="#キャンバス-アプリ-編集時" class="headerlink" title="キャンバス アプリ 編集時"></a>キャンバス アプリ 編集時</h4><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にアクセスします</li><li>アプリ 一覧画面から対象のアプリの編集画面を表示します  </li><li>画面左方にある　高度なツール＞監視＞モニターを開く を選択します<ul><li>別タブで監視ウィンドウが表示されます</li><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage04.png"></li></ul></li><li>アプリ編集画面に戻り、事象を発生させます</li><li>監視ウィンドウに移動し、記録されたモニター結果を「ダウンロード」します <ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage03.png"></li></ul></li><li>ダウンロードしたファイル（PowerAppsTraceEvents.json）をご提供ください</li></ol><p><a id='anchor-about-networkhar'></a></p><h3 id="6-Webブラウザのネットワークト-レース・コンソール-ログ"><a href="#6-Webブラウザのネットワークト-レース・コンソール-ログ" class="headerlink" title="6. Webブラウザのネットワークト レース・コンソール ログ"></a>6. Webブラウザのネットワークト レース・コンソール ログ</h3><p>キャンバス アプリ編集中、あるいは実行中に発生するHTTPリクエストの記録をご提供ください。<br/><br>Power Appsサービスへ送信するHTTPリクエストやPower Appsサービスから受信するHTTPレスポンスの内容を確認することで通信上の問題を特定します。<br/><br>※事象の内容により、netsh traceコマンドやサードパーティ製のツール「Fiddler」によるネットワーク キャプチャの取得をお願いする場合があります。</p><ol><li>Webブラウザを起動します</li><li>事象が発生する画面を表示します</li><li>手順2で表示している画面(タブ)上で[F12] を押下してブラウザの開発者ツールを開始します<ul><li>「ログの保持」・「キャッシュを無効にする」にチェックを入れます(❶・❷)</li></ul></li><li>[F5]を押下して画面を再読み込み後、事象が発生する操作を行います</li><li>ブラウザ開発者ツールに戻り、Networkタブの赤色の [Stop recording network log] アイコンをクリックします(❸)</li><li>[Export HAR] のアイコンをクリックし、任意のファイル名で保存します(❹)</li><li>Consoleタブをクリックし、表示されるすべての情報をコピーして <strong>テキスト形式</strong> で保存します(❺)</li></ol><p><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image07.png"></p><p><a id='anchor-about-sessionid'></a></p><h3 id="7-セッションID"><a href="#7-セッションID" class="headerlink" title="7. セッションID"></a>7. セッションID</h3><p>セッション情報からPower Appsサービス側の記録を確認し、発生している事象を調査します。</p><p><a id='anchor-about-sessionid-playweb'></a></p><h4 id="Webブラウザ"><a href="#Webブラウザ" class="headerlink" title="Webブラウザ"></a>Webブラウザ</h4><ul><li><p>キャンバス アプリ編集時</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>アプリ 一覧画面から対象のアプリのアプリ編集画面を表示します</li><li>メニュー「設定」を選択します</li><li>ポップアップの左メニューから「サポート」を選択します</li><li>「セッション詳細」を押下し、セッションIDを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image08.png"></li></ul></li></ol></li><li><p>キャンバス アプリ実行時</p><ol><li>対象のアプリを実行します</li><li>画面右上部の歯車アイコンを押下します</li><li>「セッション詳細」を選択し、Power Apps ライブバージョンを含む、表示されている情報をすべてを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image09.png"></li></ul></li></ol></li></ul><p><a id='anchor-about-sessionid-playmobile'></a></p><h4 id="モバイルアプリ"><a href="#モバイルアプリ" class="headerlink" title="モバイルアプリ"></a>モバイルアプリ</h4><ol><li>Power Apps モバイルアプリを起動します</li><li>画面左上部のユーザーアイコンを押下します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image10.png"></li></ul></li><li>「バージョン情報」を <strong>テキスト形式</strong> でお手元に控えます<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image11.png"></li></ul></li><li>「セッション詳細」を押下します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image12.png"></li></ul></li><li>クリップボードにコピーされた セッションIDを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image13.png"></li></ul></li></ol><h4 id="SharePoint-カスタマイズ-フォーム等、埋め込みのキャンバス-アプリ"><a href="#SharePoint-カスタマイズ-フォーム等、埋め込みのキャンバス-アプリ" class="headerlink" title="SharePoint カスタマイズ フォーム等、埋め込みのキャンバス アプリ"></a>SharePoint カスタマイズ フォーム等、埋め込みのキャンバス アプリ</h4><ol><li>Alt キーを押下しながらフォームを右クリックします</li><li>「セッション詳細」を押下し、セッションIDを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image14.png"></li></ul></li></ol><p><a id='anchor-about-app-tenant-ids'></a></p><h3 id="8-アプリURL-アプリID、テナントID）"><a href="#8-アプリURL-アプリID、テナントID）" class="headerlink" title="8. アプリURL(アプリID、テナントID）"></a>8. アプリURL(アプリID、テナントID）</h3><p>アプリID、テナントIDの情報からPower Appsサービス側の記録を確認し、発生している事象を調査します。</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にアクセスします</li><li>アプリ 一覧画面から対象のアプリの「…」メニューを押下し、「詳細」を選択します</li><li>Web リンク、アプリIDを <strong>テキスト形式</strong> で取得します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image15.png"></li></ul></li></ol><p><a id='anchor-about-enviromentid'></a></p><h3 id="9-環境ID"><a href="#9-環境ID" class="headerlink" title="9. 環境ID"></a>9. 環境ID</h3><p>環境IDの情報からPower Appsサービス側の記録を確認し、発生している事象を調査します。</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にアクセスします</li><li>事象が発生している環境に切り替えます (❶)</li><li>画面右上部の歯車アイコンを押下します (❷)</li><li>「セッション詳細」を選択します (❸)</li><li>ポップアップで表示された、環境IDを含むセッションの詳細情報すべてを <strong>テキスト形式</strong> で取得します (❹)<ul><li>※環境IDは赤枠で囲った部分です。本セッション情報を用いて事象が発生している環境の情報を確認します</li><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image16.png"></li></ul></li></ol><p><a id='anchor-about-canvasapp'></a></p><h3 id="10-アプリ"><a href="#10-アプリ" class="headerlink" title="10. アプリ"></a>10. アプリ</h3><p>事象が発生しているアプリを調査し、問題の箇所を特定します。<br/><br>アプリが接続するデータソースによりSharePoint リストのテンプレートやDataverse テーブルのメタ情報をご提供いただく場合があります。</p><h4 id="アプリのエクスポートファイル"><a href="#アプリのエクスポートファイル" class="headerlink" title="アプリのエクスポートファイル"></a>アプリのエクスポートファイル</h4><p>「エクスポート」機能によりエクスポートされるアプリのファイルは公開済みのバージョンです。<br/><br>アプリを編集中の場合はmsappファイルとしてローカルに保存したアプリのファイルをご取得ください。</p><ul><li><p>公開済みのアプリ</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>アプリ 一覧画面から対象のアプリの「…」メニューを押下し、「エクスポートパッケージ」を選択します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image17.png"></li></ul></li><li>任意の名前を付けてエクスポートします</li><li>ローカルにzipファイルがダウンロードされます</li></ol></li><li><p>編集中の最新のアプリ</p><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>アプリ一覧画面から対象のアプリを編集します</li><li>メニュー「ファイル」＞「名前を付けて保存」を選択します</li><li>保存先を「このコンピューター」を選択します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image18.png"></li></ul></li><li>ローカルにmsappファイルがダウンロードされます<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image19.png"></li></ul></li></ol></li></ul><h4 id="アプリを含むソリューションファイル"><a href="#アプリを含むソリューションファイル" class="headerlink" title="アプリを含むソリューションファイル"></a>アプリを含むソリューションファイル</h4><ol><li>Power Apps 作成者ポータル(<a href="http://make.powerapps.com/">http://make.powerapps.com</a>) にサインインします</li><li>ソリューション 一覧画面を表示します</li><li>「新しいソリューション」を押下します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image20.png"></li></ul></li><li>手順3 で作成したソリューションに対象のアプリを追加します<ul><li>必要に応じて使用するDataverseテーブルなどを含めます</li><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image21.png"></li></ul></li><li>カスタマイズを公開します<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image22.png"></li></ul></li><li>ソリューションをエクスポートします<ul><li><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image23.png"></li></ul></li><li>ローカルにzipファイルがダウンロードされます</li></ol><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。<br/><br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><ul><li><a href="https://support.microsoft.com/ja-jp/office/teams-%E3%81%A7%E4%BC%9A%E8%AD%B0%E3%82%92%E8%A8%98%E9%8C%B2%E3%81%99%E3%82%8B-34dfbe7f-b07d-4a27-b4c6-de62f1348c24">Teams で会議を記録する</a></li><li><a href="https://social.technet.microsoft.com/Forums/ja-JP/7c2e860a-c756-42d7-8fde-6afe043ab57f/12502125211245412470125401248812524125401247312398124611251512?forum=DCRMSupport">ブラウザートレースのキャプチャ手順</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/get-sessionid">セッションおよびアプリ ID の詳細を取得する</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/monitor-canvasapps">モニターでキャンバス アプリをデバッグする</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/monitor-advanced">高度なモニタリングの概要</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの谷です。&lt;br/&gt;&lt;br&gt;弊社サポートでは、キャンバス アプリが動作しない、エラーが発生する、等のトラブルシューティングにおいて、お問い合わせの内容をもとに調査方針を立てておりますが、発生している事象を明確に把握するため、ご利用者様の環境で発生している事象の切り分けや情報提供をお願いすることがあります。&lt;br/&gt;&lt;br&gt;この記事では、キャンバス アプリのトラブルシューティングを行うにあたって、必要となる情報の取得手順をご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Canvas app" scheme="https://jpdynamicscrm.github.io/blog/tags/Canvas-app/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
  </entry>
  
  <entry>
    <title>MC435264 (セキュリティ グループに関連付けられた Dataverse 環境でのキャンバス アプリの共有に関する更新プログラム) について</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/mc435264/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/mc435264/</id>
    <published>2022-10-17T00:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.200Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの谷です。<br/><br>メッセージセンターにてご確認いただける MC435264 について、ご利用のキャンバスアプリへの影響についてご説明します。</p><span id="more"></span><h2 id="MC435264-の内容"><a href="#MC435264-の内容" class="headerlink" title="MC435264 の内容"></a>MC435264 の内容</h2><p>Power Platform 環境作成時にその環境にアクセスできるセキュリティグループを指定すると、指定したセキュリティグループのメンバーのみが当該の環境のキャンバスアプリを利用できるようになり、<br>それ以外のユーザーは当該環境のキャンバスアプリにアクセスが制限されます。</p><p>これまでは、Power Platform 環境作成時に環境にアクセスできるセキュリティグループを設定することができましたが、実際にセキュリティグループよるキャンバスアプリへのアクセス制御を行う機能は実装されておりませんでした。<br/><br>この度の変更により、このセキュリティグループによるアクセス制御機能を正式にリリースいたします。<br/><br>対象の環境に紐づくセキュリティ グループのメンバー (ユーザー) は当該環境のキャンバスアプリへのアクセス権を持ちますが、セキュリティ グループ外のユーザーは新規環境のキャンバスアプリへのアクセス権を持ちません。</p><p>※環境作成 設定画面のセキュリティ グループ設定画面<br/><br><img src="/blog/canvasapp/mc435264/image01.png"></p><p>※環境にアクセスできるセキュリティ グループが設定されている場合<br/><br><img src="/blog/canvasapp/mc435264/image02.png"></p><p>※環境にアクセスできるセキュリティ グループが設定されていない場合<br/><br><img src="/blog/canvasapp/mc435264/image03.png"></p><h2 id="ご利用のキャンバスアプリへの影響"><a href="#ご利用のキャンバスアプリへの影響" class="headerlink" title="ご利用のキャンバスアプリへの影響"></a>ご利用のキャンバスアプリへの影響</h2><p>環境へのアクセスをセキュリティグループで制限している場合、当該環境のアプリの実行ユーザーが当該セキュリティ グループのメンバーである場合のみ利用できるようになります。<br/><br>引き続き、当該環境のアプリを実行、共有するためには、対象のユーザーを環境に紐づくセキュリティ グループ メンバーに追加します。</p><h2 id="よくあるご質問"><a href="#よくあるご質問" class="headerlink" title="よくあるご質問"></a>よくあるご質問</h2><h3 id="いつからこの変更が適用されますか？"><a href="#いつからこの変更が適用されますか？" class="headerlink" title="いつからこの変更が適用されますか？"></a>いつからこの変更が適用されますか？</h3><p>2022 年 10 月 24 日以降に、当更新プログラムのリリースを開始します。2022 年 11 月 11 日までにすべてのリージョンで完全に完了する予定です。</p><h3 id="キャンバス-アプリ以外への影響はありますか？"><a href="#キャンバス-アプリ以外への影響はありますか？" class="headerlink" title="キャンバス アプリ以外への影響はありますか？"></a>キャンバス アプリ以外への影響はありますか？</h3><p>キャンバス アプリ以外の機能への影響はありません。<br/><br>例えば、Power Automateやモデル駆動型アプリなどPower Platform上で動作する他のサービスへの影響はありません。</p><h3 id="セキュリティ-グループにより環境へのアクセスを制御していませんが影響はありますか？"><a href="#セキュリティ-グループにより環境へのアクセスを制御していませんが影響はありますか？" class="headerlink" title="セキュリティ グループにより環境へのアクセスを制御していませんが影響はありますか？"></a>セキュリティ グループにより環境へのアクセスを制御していませんが影響はありますか？</h3><p>いいえ。セキュリティ グループによるアクセス制御を行っていない環境は当変更の影響はありません。これまでどおり、すべてのユーザーへキャンバスアプリを共有し、アプリを実行することができます。<br/><br>同様に、既定環境におきましてもセキュリティ グループによるアクセス制御が行えない環境でございますため、当変更による影響はありません。</p><h3 id="Dataverse環境がありませんが影響はありますか？"><a href="#Dataverse環境がありませんが影響はありますか？" class="headerlink" title="Dataverse環境がありませんが影響はありますか？"></a>Dataverse環境がありませんが影響はありますか？</h3><p>いいえ。本変更は Dataverse データベースが作成されている環境のみ影響します。<br/><br>Dataverse データベースが作成されていない環境への影響はありません。これまでどおり、すべてのユーザーへキャンバス アプリを共有し、アプリを実行することができます。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの谷です。&lt;br/&gt;&lt;br&gt;メッセージセンターにてご確認いただける MC435264 について、ご利用のキャンバスアプリへの影響についてご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="キャンバス アプリ" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9-%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
  </entry>
  
  <entry>
    <title>DLP ポリシーに設定されているコネクタの一覧を出力する</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Output-dlp-policy-connector-list/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Output-dlp-policy-connector-list/</id>
    <published>2022-10-12T10:23:09.000Z</published>
    <updated>2023-01-13T09:30:43.364Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。</p><p>この記事では、データ消失防止 (DLP) ポリシー に設定されたコネクタの一覧を、CSV ファイルに出力する方法をご案内いたします。</p><span id="more"></span><h2 id="DLP-ポリシーとコネクタ"><a href="#DLP-ポリシーとコネクタ" class="headerlink" title="DLP ポリシーとコネクタ"></a>DLP ポリシーとコネクタ</h2><p>データ消失防止 (DLP) ポリシーとは、テナントや環境単位でコネクタの利用を制限できる、管理者向けの機能です。<br><a href="https://admin.powerplatform.microsoft.com/home">Power Platform 管理センター</a> よりアクセスいただけます。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-17-17-29-40.png"></p><p>参考：<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/wp-data-loss-prevention">データの消失防止ポリシー</a></p><p>しかし、提供されているコネクタは非常に数が多く、DLP ポリシーを設定する画面ではすべてを把握するのが難しいのが現状です。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-16-35-50.png"><br>(2022年8月某日に確認した時点で800個以上)</p><p>こんな時は、コネクタの一覧をファイルに出力できると、より把握しやすくなるのではないでしょうか。Power Platform の管理者向けの PowerShell コマンドレットを活用すれば、コネクタの一覧を CSV ファイルに出力できます。</p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>Power Platform の PowerShell コマンドレットのご利用には、事前準備が必要です。詳しい手順は下記公開情報の「インストール」の章をご参照ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell">Power Apps の PowerShell サポート</a></p><p><code>Install-Module</code> に失敗する場合は、インストールに必要な設定が不足している可能性が考えられます。その設定については、弊社 Windows サポートチームによる記事にまとめられていますので、こちらもぜひご覧ください。</p><p><a href="https://jpwinsup.github.io/blog/2021/06/14/UserInterfaceAndApps/PowerShell/how-to-setup-install-module/">PowerShell Gallery からモジュールをインストールするために必要な設定 | Microsoft Japan Windows Technology Support Blog</a></p><h2 id="サンプル"><a href="#サンプル" class="headerlink" title="サンプル"></a>サンプル</h2><p>今回は、<a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powerapps.administration.powershell/get-dlppolicy?view=pa-ps-latest">Get-DlpPolicy</a> を使用します。</p><p>このコマンドレットは DLP ポリシーの一覧や DLP ポリシーの詳細情報を取得できます。これを <code>Export-Csv</code> と組み合わせ、CSV ファイルを作成します。</p><p>以下に、サンプルコードを記載いたします。</p><div class="alert is-info"><p class="alert-title">Note</p><p>説明のためのサンプルであり、エラー処理などは含まれておりません。ご使用の際は、十分にご検証いただきますようお願いします。</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">特定のDLPポリシーに設定されているコネクタの一覧をcsvファイルに出力します</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="built_in">Import-Module</span> Microsoft.PowerApps.Administration.PowerShell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$filePath</span> = <span class="string">&quot;[CSVファイルパス]&quot;</span></span><br><span class="line"><span class="comment"># ポリシーのID</span></span><br><span class="line"><span class="variable">$policyId</span> = <span class="string">&quot;[DLPポリシーのID]&quot;</span></span><br><span class="line"><span class="comment"># メールアドレス</span></span><br><span class="line"><span class="variable">$mailAddress</span> = <span class="string">&quot;[メールアドレス]&quot;</span></span><br><span class="line"><span class="comment"># パスワード</span></span><br><span class="line"><span class="variable">$plainPassword</span> = <span class="string">&quot;[パスワード]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># サインイン</span></span><br><span class="line"><span class="variable">$pass</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$plainPassword</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Add-PowerAppsAccount</span> <span class="literal">-Username</span> <span class="variable">$mailAddress</span> <span class="literal">-Password</span> <span class="variable">$pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DLP ポリシーとコネクタの取得</span></span><br><span class="line"><span class="variable">$DLPPolicy</span> = <span class="built_in">Get-DlpPolicy</span> <span class="literal">-PolicyName</span> <span class="variable">$policyId</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Test-Path</span> <span class="variable">$filePath</span>) &#123;</span><br><span class="line">    <span class="built_in">Remove-Item</span> <span class="variable">$filePath</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$group</span> <span class="keyword">in</span> <span class="variable">$DLPPolicy</span>.connectorGroups) &#123;</span><br><span class="line">    <span class="variable">$groupName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># グループの名前を分かりやすいものに置き換えます</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;Confidential&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;Business&quot;</span></span><br><span class="line">    </span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;General&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;NonBusiness&quot;</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;Blocked&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;Blocked&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$connector</span> <span class="keyword">in</span> <span class="variable">$group</span>.connectors) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = [<span class="type">PSCustomObject</span>]<span class="selector-tag">@</span>&#123;</span><br><span class="line">            Policy = <span class="variable">$DLPPolicy</span>.displayName</span><br><span class="line">            <span class="built_in">Group</span> = <span class="variable">$groupName</span></span><br><span class="line">            Name = <span class="variable">$connector</span>.name</span><br><span class="line">            ID = <span class="variable">$connector</span>.id</span><br><span class="line">            <span class="built_in">Type</span> = <span class="variable">$connector</span>.type</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Export-Csv</span> <span class="literal">-Path</span> <span class="variable">$filePath</span> <span class="literal">-Encoding</span> UTF8 <span class="literal">-NoTypeInformation</span> <span class="literal">-Append</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>サンプル中の <code>[DLPポリシーのID]</code> は DLP ポリシーの編集画面の URL から取得できます。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-17-24-45.png"></p><p>そして、サンプルを実行すると、以下のような CSV ファイルを出力できます。DLP ポリシーでどのようにコネクタを分類しているか、より把握しやすくなりました。<br><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-16-56-37.png"></p><h2 id="画面で確認できるコネクタと件数が異なるとき"><a href="#画面で確認できるコネクタと件数が異なるとき" class="headerlink" title="画面で確認できるコネクタと件数が異なるとき"></a>画面で確認できるコネクタと件数が異なるとき</h2><p>PowerShell の <code>Get-DlpPolicy</code> で取得できるコネクタの顔ぶれと Power Platform 管理センター で確認できるコネクタの顔ぶれが異なる場合があります。</p><p>原因は以下の2つのいずれか、または両方が考えられます。</p><ul><li>最後に DLP ポリシーを保存してから、新しいコネクタが追加されたか、廃止されたコネクタがある。</li><li>Power Virtual Agents など、DLP ポリシーの対象とならないコネクタがある。</li></ul><h3 id="新しいコネクタが追加されたか、廃止されたコネクタがある"><a href="#新しいコネクタが追加されたか、廃止されたコネクタがある" class="headerlink" title="新しいコネクタが追加されたか、廃止されたコネクタがある"></a>新しいコネクタが追加されたか、廃止されたコネクタがある</h3><p>PowerShell で取得できるコネクタと、Power Platform 管理センターで見えるコネクタには、以下の違いがあります。</p><table><thead><tr><th>種類</th><th>説明</th></tr></thead><tbody><tr><td>PowerShell で取得できるコネクタ</td><td>ポリシーに明示的に追加されたコネクタのみを取得できます。</td></tr><tr><td>Power Platform 管理センターで見るコネクタ</td><td>現時点で有効なコネクタが表示されます (ポリシー作成以降に追加/廃止されたコネクタが表示/非表示になります)。</td></tr></tbody></table><p>つまり、以下のような現象が起きます。</p><p>DLP ポリシーを作成した後に、新しく追加されたコネクタがある場合：</p><ul><li>Power Platform 管理センターでは新しいコネクタが表示されます。</li><li>新しいコネクタは自動的にポリシーに追加されないため、PowerShell で取得した結果には含まれません。</li></ul><p>ポリシー作成以降に廃止されたコネクタがある場合：</p><ul><li>Power Platform 管理センターでは廃止されたコネクタが表示されなくなります。</li><li>PowerShell で取得した結果には、廃止されたコネクタが残ります。</li></ul><p>表示上の不一致はありますが、ポリシー作成以降に追加されたコネクタは既定のデータグループの設定に従って制御されるため、ポリシーは想定通り動作しますのでご安心ください。</p><p> 参考：</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/dlp-connector-classification#default-data-group-for-new-connectors">新しいコネクタの既定データ グループ について</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/prevent-data-loss#change-the-default-data-group">既定のデータ グループの変更</a></li></ul><p>なお、Power Platform 管理センターで対象のポリシーを編集し保存し直していただくと、新しく追加されたコネクタが PowerShell で取得した結果に含まれるようになります。しかし、廃止されたコネクタは PowerShell で取得した結果に残り続けますのでご承知おきください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;/p&gt;
&lt;p&gt;この記事では、データ消失防止 (DLP) ポリシー に設定されたコネクタの一覧を、CSV ファイルに出力する方法をご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="PowerShell" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerShell/"/>
    
  </entry>
  
  <entry>
    <title>テナントレベルでの分析のアプリ在庫について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerapps/inventory-report/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerapps/inventory-report/</id>
    <published>2022-10-04T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.228Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br><br>今回は、Power Appsのテナントレベルでの分析機能の[アプリ在庫]タブの下記項目について、順にご説明いたします。<br>・最終実行日のフィルターについて<br>・「最終オープン日」が空欄の場合<br>・その他のフィルター</p><p>ビュー上の各列の意味など、テナントレベルでの分析機能の詳細については下記公開情報をご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/powerapps-analytics-reports">Power Apps のテナント レベルの分析</a>   </p><span id="more"></span>  <h2 id="lt-最終実行日のフィルターについて-gt"><a href="#lt-最終実行日のフィルターについて-gt" class="headerlink" title="&lt;最終実行日のフィルターについて&gt;"></a><strong>&lt;最終実行日のフィルターについて&gt;</strong></h2><p>「アプリ在庫」タブでは、テナント内に存在するキャンバスアプリ、モデル駆動型アプリについて一覧でご確認いただけます。<br>アプリの最終オープン日（実行日）を基準としたフィルターでご確認いただけます。<br>Last Openedより下図選択肢の期間をご指定いただけます。<br>なお、テナントレベルの分析の有効化後に実行された日付にてカウントされております。<br><br></p><p>・30日以内（Less than 30 days）<br>・30日以上（Over 30 days）<br>・60日以上（Over 60 days）<br>・90日以上（Over 90 days）<br>・180日以上（Over 180 days）<br><img src="/blog/powerapps/inventory-report/date-option.png"><br><br></p><p>「30日以上」を選択した場合、最終実行日が30日より前のアプリがすべて対象となります。<br>下図は2022年10月4日時点での30日以上をフィルターとしたキャプチャでございます。<br>60日以上経過のアプリも含まれております。<br><img src="/blog/powerapps/inventory-report/over30days.png"><br><br></p><p>そのため、より経過日数が長いフィルターを選んでいただきますと、表示されるアプリ数は少なくなります。<br>下図は「60日以上」を選択した場合の表示となります。<br>上図の「30日以上」の場合より、表示されるアプリ数が減っています。<br><img src="/blog/powerapps/inventory-report/over60days.png"><br><br><br></p><h2 id="lt-「最終オープン日」が空欄の場合-gt"><a href="#lt-「最終オープン日」が空欄の場合-gt" class="headerlink" title="&lt;「最終オープン日」が空欄の場合&gt;"></a><strong>&lt;「最終オープン日」が空欄の場合&gt;</strong></h2><p>「30日以内」フィルターで表示した場合、「最終オープン日」が空欄のアプリがございます。<br>こちらは、テナントレベルの分析機能を有効化後、まだ一度も実行されていないアプリとなります。<br><img src="/blog/powerapps/inventory-report/empty-last-opend.png"><br><br></p><p>「最終オープン日」部分をクリックしていただきますと、降順/昇順切り替えが可能でございます。<br>過去30日間で実行されたアプリをご確認いただく際には、順を切り替えてご確認いただけますと幸いでございます。<br><img src="/blog/powerapps/inventory-report/last-opened-order.png"><br><br></p><p>なお、「作成者」「共有ユーザー」「環境」「接続」などの数値は、フィルターによって一覧表示されているアプリの合計数となっております。<br>「30日以内」フィルターの場合、上述の通り、テナントレベルの分析機能の有効化後にまだ実行されていないアプリも一覧に表示されており、<br>「作成者」「共有ユーザー」「環境」「接続」の数値には、それらのアプリも含まれております。<br><br><br><br></p><h2 id="lt-その他のフィルター-gt"><a href="#lt-その他のフィルター-gt" class="headerlink" title="&lt;その他のフィルター&gt;"></a><strong>&lt;その他のフィルター&gt;</strong></h2><p>その他下記フィルターなどで一覧表示するアプリをフィルターいただけます。<br>・アプリ種類<br>・アプリが存在する環境種類<br>・アプリが存在する環境名<br><br><br><br></p><p>免責事項<br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br&gt;&lt;br&gt;今回は、Power Appsのテナントレベルでの分析機能の[アプリ在庫]タブの下記項目について、順にご説明いたします。&lt;br&gt;・最終実行日のフィルターについて&lt;br&gt;・「最終オープン日」が空欄の場合&lt;br&gt;・その他のフィルター&lt;/p&gt;
&lt;p&gt;ビュー上の各列の意味など、テナントレベルでの分析機能の詳細については下記公開情報をご参照ください。&lt;br&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-platform/admin/powerapps-analytics-reports&quot;&gt;Power Apps のテナント レベルの分析&lt;/a&gt;   &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="Tenant-level Analytics" scheme="https://jpdynamicscrm.github.io/blog/tags/Tenant-level-Analytics/"/>
    
    <category term="Inventory Report" scheme="https://jpdynamicscrm.github.io/blog/tags/Inventory-Report/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate フロー所有者の退職・異動への備え</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/change-flow-owner/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/change-flow-owner/</id>
    <published>2022-10-01T00:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.252Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの谷です。<br/><br>クラウド フロー所有者の退職・異動に際し、 クラウド フローの所有者を管理する方法についてご説明します。</p><span id="more"></span><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#anchor-about-flowowner">フローの所有者・実行専用ユーザーとは？</a></li><li><a href="#anchor-about-flowowner-retire">フロー作成者 (所有者) が退職あるいは離任する場合はどうしたらいいか？</a></li><li><a href="#anchor-solution-flow-or-not">ソリューション フローと非ソリューション フロー</a></li><li><a href="#anchor-add-flow-co-owner">フローの所有者を追加するにはどうしたらいいか？</a><ul><li><a href="#anchor-add-flow-co-owner-ps">PowerShell で所有者を追加する方法</a></li><li><a href="#anchor-add-flow-co-owner-ppac">Power Platform 管理センターで所有者を追加する方法</a></li><li><a href="#anchor-add-flow-co-owner-portal">フロー編集画面で所有者を追加する方法</a></li></ul></li><li><a href="#anchor-change-flow-owner">フロー作成者 (所有者) を変更したい場合はどうしたらいいか？</a><ul><li>非ソリューションフロー<ul><li><a href="#anchor-change-flow-owner-rename">所有者が「名前をつけて保存」する方法</a></li><li><a href="#anchor-change-flow-owner-cp">フローの「コピーを送信」する方法</a></li><li><a href="#anchor-change-flow-export">フローのエクスポートを行い、新たなユーザーでインポートする方法</a></li></ul></li><li>ソリューションフロー<ul><li><a href="#anchor-change-flow-solution">フロー詳細画面からフローの所有者を変更する方法</a></li></ul></li></ul></li></ol><p><a id='anchor-about-flowowner'></a></p><h2 id="フローの所有者・実行専用ユーザーとは？"><a href="#フローの所有者・実行専用ユーザーとは？" class="headerlink" title="フローの所有者・実行専用ユーザーとは？"></a>フローの所有者・実行専用ユーザーとは？</h2><p>フローを作成・実行するためには以下の 2 種類の権限があります。<br/></p><p><strong>作成者 (所有者)</strong><br/><br>フローの実行、編集、削除、共有設定を行うことが可能です。<br/><br>フローの作成者のみがフローのオリジナルの所有者となりますが、所有者は複数存在できます。</p><p><strong>実行専用ユーザー</strong><br/><br>フローの実行のみを行うことが可能です。</p><div class="alert is-important"><p class="alert-title">重要</p><p>フローのパフォーマンスは作成者のライセンスにより決定されます</p><p>自動フローやスケジュール フローの場合は作成者のライセンスにより、また、</p><p>インスタント フローの場合は実行者のライセンスによりパフォーマンスプロファイルが決定します。</p><p>フローの所有者が複数存在する場合、作成者以外の所有者のライセンスはフローのパフォーマンスに影響いたしません。</p></div><p><a id='anchor-about-flowowner-retire'></a></p><h2 id="フロー作成者-所有者-が退職あるいは離任する場合はどうしたらいいか？"><a href="#フロー作成者-所有者-が退職あるいは離任する場合はどうしたらいいか？" class="headerlink" title="フロー作成者 (所有者) が退職あるいは離任する場合はどうしたらいいか？"></a>フロー作成者 (所有者) が退職あるいは離任する場合はどうしたらいいか？</h2><h3 id="実行について"><a href="#実行について" class="headerlink" title="実行について"></a>実行について</h3><p>フロー所有者のアカウントを削除後、フロー自体は削除されずそのまま残りますが、引き続きご利用いただくには以下の観点から対応が必要です。</p><ol><li>作成者がいない状態が続くと、有効なライセンスがないとみなされフローが中断される場合がある。</li><li>削除されたユーザーアカウントの接続を使用している場合、アカウントの削除に伴い接続が無効となる。<br/><br> ※フロー作成者 (所有者) の変更および、接続の修正が必要になる場合があります。</li></ol><p>したがいまして、引き続きご利用いただくためには以下のいずれかの対応を行ってください。</p><ol><li>フローに Power Automate per flow ライセンスを割り当て、接続を修正する。</li><li>新たなフローとして保存し、新たな所有者でフローを実行する。<br/><br> なお、現時点では、一部のフローのみ、既存のフローの作成者 (所有者) を変更することができます。<br/></li></ol><h3 id="編集・削除・共有について"><a href="#編集・削除・共有について" class="headerlink" title="編集・削除・共有について"></a>編集・削除・共有について</h3><p>フローの所有者がいる場合、フローを編集・削除・共有することができます。<br/><br>所有者は以下のいずれかの方法で追加いただけます。</p><ul><li>PowerShell</li><li>Power Platform 管理センター</li><li>フロー編集画面</li></ul><p><a id='anchor-solution-flow-or-not'></a></p><h2 id="ソリューション-フローと非ソリューション-フロー"><a href="#ソリューション-フローと非ソリューション-フロー" class="headerlink" title="ソリューション フローと非ソリューション フロー"></a>ソリューション フローと非ソリューション フロー</h2><p>Power Platform では、Power Platform 上で構築するアプリやフローなどのコンポーネントを管理するためのメカニズム、ソリューションを提供しています。<br/><br>ソリューションに含まれるフローは<strong>ソリューション 対応 フロー</strong>と呼ばれます。<br/><br>ソリューション 対応 フローには独自で作成したソリューションに含まれるフローやDataverse for Teams環境で作成するフローがあります。<br/></p><p>本記事ではソリューション対応フローを「ソリューション フロー」、それ以外のフローを「非ソリューションフロー」として記載しています。<br/><br>ソリューション フローであるか否かにより、フローの所有者を追加する方法、フローの所有者を変更する方法が一部異なりますためご留意ください。</p><p><a id='anchor-add-flow-co-owner'></a></p><h2 id="フローの所有者を追加するにはどうしたらいいか？"><a href="#フローの所有者を追加するにはどうしたらいいか？" class="headerlink" title="フローの所有者を追加するにはどうしたらいいか？"></a>フローの所有者を追加するにはどうしたらいいか？</h2><p>フローの所有者を追加する方法が複数ありますので、状況に応じた方法をご利用ください。</p><p><a id='#anchor-add-flow-co-owner-ps'></a></p><h3 id="PowerShell-で所有者を追加する方法"><a href="#PowerShell-で所有者を追加する方法" class="headerlink" title="PowerShell で所有者を追加する方法"></a>PowerShell で所有者を追加する方法</h3><p>グローバル管理者、Power Platform 管理者、Dynamics 365 管理者などの管理者はフローの所有者を追加することができます。<br/><br>非ソリューション フローの場合のみご利用いただける方法です。<br/></p><p>事前準備として、管理者用 Power Apps コマンドレットのPowerShell モジュールをインストールいただく必要があります。<br/><br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation">https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation</a></p><p><strong>実行例</strong></p><ol><li>(事前準備) 管理者向け Power Apps コマンドレットをインストールします</li><li>(事前準備) コマンドを実行するユーザー (管理者アカウント) でPower Platform 管理センターにサインインします</li><li>以下のコマンドを実行します</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-AdminFlowOwnerRole -EnvironmentName &lt;環境ID&gt; -FlowName &lt;フローID&gt; -PrincipalType User -RoleName CanEdit -PrincipalObjectId &lt;新所有者のObjectID&gt;</span><br></pre></td></tr></table></figure><p><img src="/blog/powerautomate/change-flow-owner/image01.png"> </p><p><strong>&lt;環境ID&gt;の確認方法</strong></p><ul><li>管理者用 Power Apps コマンドレット「 <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#display-a-list-of-all-environments">Get-AdminPowerAppEnvironment</a>　」コマンドで対象の 環境ID をご確認ください<ul><li>例えば、以下のとおり実行いただきますとテナント内の全環境について 環境ID が取得できます。</li><li>```<br>  Get-AdminPowerAppEnvironment<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    - ![](/blog/powerautomate/change-flow-owner/image02.png)</span><br><span class="line"></span><br><span class="line">**&lt;フローID&gt;の確認方法**</span><br><span class="line">- 管理者用 Power Apps コマンドレット「[Get-AdminFlow](https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#display-all-flows)」あるいはフロー編集画面のURLからご確認ください</span><br><span class="line">    - Get-AdminFlow実行例</span><br><span class="line">        - 例えば、以下のとおり実行いただきますと、環境内のすべてのフローが取得できます</span><br><span class="line">        - ```</span><br><span class="line">            Get-AdminFlow -EnvironmentName &lt;環境ID&gt;</span><br></pre></td></tr></table></figure><ul><li><img src="/blog/powerautomate/change-flow-owner/image03.png"></li></ul></li><li>フロー編集画面におけるフローIDの確認例<ul><li>対象のフローの編集画面のURLの一部がフローIDでございます</li><li><img src="/blog/powerautomate/change-flow-owner/image04.png"></li></ul></li></ul></li></ul><p><strong>&lt;新所有者の ObjectID&gt; の確認方法</strong></p><ul><li>「<a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/view-user-accounts-with-microsoft-365-powershell?view=o365-worldwide#view-additional-property-values-for-a-specific-account">Get-AzureADUser</a>」コマンド、あるいは Azure Active Directory 管理センターでご確認ください</li><li>Get-AzureADUser 実行例<ul><li>例えば、以下のとおり実行いただきますとテナント内の全ユーザーについて ObjectId が取得できます。</li><li><pre><code>  Get-AzureADUser | Select DisplayName, UserPrincipalName, ObjectId</code></pre></li><li><img src="/blog/powerautomate/change-flow-owner/image05.png"></li></ul></li><li>Azure Active Directory 管理センターにおけるユーザーの ObjectID の確認例<ul><li><a href="https://aad.portal.azure.com/">Azure Active Directory 管理センター</a> &gt; ユーザー &gt; 対象のユーザー</li><li><img src="/blog/powerautomate/change-flow-owner/image06.png"></li></ul></li></ul><p><a id='anchor-add-flow-co-owner-ppac'></a></p><h3 id="Power-Platform-管理センターで所有者を追加する方法"><a href="#Power-Platform-管理センターで所有者を追加する方法" class="headerlink" title="Power Platform 管理センターで所有者を追加する方法"></a>Power Platform 管理センターで所有者を追加する方法</h3><p>グローバル管理者、Power Platform 管理者、Dynamics 365 管理者などの管理者や環境管理者、システム管理者など対象の環境の管理者セキュリティロールを持つユーザーはPower Platform 管理センターからフローの所有者を追加することができます。<br/><br>非ソリューション フロー、ソリューション フローでご利用いただける方法です。<br/></p><ol><li>管理者アカウントで <a href="https://admin.powerplatform.com/">Power Platform 管理センター</a> にアクセスします</li><li>対象の環境の「設定」を表示し、「リソース」＞「フロー」を選択します<br> <img src="/blog/powerautomate/change-flow-owner/image07.png"></li><li>対象のアプリの「…」メニューから、「共有」を選択します<br> <img src="/blog/powerautomate/change-flow-owner/image08.png"></li><li>所有者として追加したいアカウントを追加します</li></ol><p><a id='anchor-add-flow-co-owner-portal'></a></p><h3 id="フロー編集画面で所有者を追加する方法"><a href="#フロー編集画面で所有者を追加する方法" class="headerlink" title="フロー編集画面で所有者を追加する方法"></a>フロー編集画面で所有者を追加する方法</h3><p>フロー作成者(所有者)はフロー編集画面から所有者を追加することができます。<br/><br>非ソリューション フロー、ソリューション フローでご利用いただける方法です。</p><ol><li>Power Automate 作成者ポータルにアクセスします</li><li>対象のフローの「…」メニューから「共有」を選択します<br> <img src="/blog/powerautomate/change-flow-owner/image09.png"></li><li>所有者として追加したいアカウントを追加します</li></ol><p><a id='anchor-change-flow-owner'></a></p><h2 id="フロー作成者-所有者-を変更したい場合はどうしたらいいか？"><a href="#フロー作成者-所有者-を変更したい場合はどうしたらいいか？" class="headerlink" title="フロー作成者 (所有者) を変更したい場合はどうしたらいいか？"></a>フロー作成者 (所有者) を変更したい場合はどうしたらいいか？</h2><p>非ソリューション フロー、あるいはソリューション フローかどうかにより変更方法が異なりますので、それぞれ説明します。</p><p><strong>非ソリューション フロー</strong></p><p>元の所有者で作成されたフローを複製し、新しい所有者でフローを新たに作成します。<br/><br>新たなフローとして保存を行うことで、フロー作成者 (所有者) を変更します。<br/><br>元の所有者で作成されたフローは残ったままとなってしまいますため、無効化や削除することを推奨します。</p><ul><li>所有者が「名前を付けて保存」する</li><li>フローの「コピーを送信」する</li><li>フローのエクスポートを行い、新たな所有者で当フローをインポートする</li></ul><p><strong>ソリューション フロー</strong></p><ul><li>フロー詳細画面からフローの所有者を変更する</li></ul><p><a id='anchor-change-flow-owner-rename'></a></p><h3 id="＜非ソリューション-フロー＞-所有者が「名前をつけて保存」する方法"><a href="#＜非ソリューション-フロー＞-所有者が「名前をつけて保存」する方法" class="headerlink" title="＜非ソリューション フロー＞　所有者が「名前をつけて保存」する方法"></a>＜非ソリューション フロー＞　所有者が「名前をつけて保存」する方法</h3><p>変更先のユーザーにフローを共有し、フロー一覧より「名前をつけて保存」選択いただきますと<br/><br>同一環境に同一構成のフローを別名で、自身のフローとして保存いただけます。</p><p><strong>実行例</strong></p><ol><li>フロー一覧画面から「名前を付けて保存」を実行します<br> <img src="/blog/powerautomate/change-flow-owner/image11.png"> </li></ol><p><a id='anchor-change-flow-owner-cp'></a></p><h3 id="＜非ソリューション-フロー＞-フローの「コピーを送信」する方法"><a href="#＜非ソリューション-フロー＞-フローの「コピーを送信」する方法" class="headerlink" title="＜非ソリューション フロー＞　フローの「コピーを送信」する方法"></a>＜非ソリューション フロー＞　フローの「コピーを送信」する方法</h3><p>作成したフローをテンプレートとして、組織内のユーザーに送信いただけます。<br/><br>「コピーの送信」時に変更先ユーザーを指定し、指定されたユーザーにメール通知されますため、<br/><br>メールリンクより対象フローのテンプレートへアクセスし、自身のフローとして保存ください。<br/></p><p><strong>実行例</strong></p><ol><li>フロー編集画面から「コピーの送信」を実行し、新たな所有者のメールアドレスを指定します<br> <img src="/blog/powerautomate/change-flow-owner/image12.png"> </li><li>メール内のリンクをクリックし、テンプレートにアクセスします<br> <img src="/blog/powerautomate/change-flow-owner/image13.png"> </li><li>フローを保存します</li></ol><p><a id='anchor-change-flow-export'></a></p><h3 id="＜非ソリューション-フロー＞-フローのエクスポートを行い、新たなユーザーでインポートする方法"><a href="#＜非ソリューション-フロー＞-フローのエクスポートを行い、新たなユーザーでインポートする方法" class="headerlink" title="＜非ソリューション フロー＞　フローのエクスポートを行い、新たなユーザーでインポートする方法"></a>＜非ソリューション フロー＞　フローのエクスポートを行い、新たなユーザーでインポートする方法</h3><p>フローのパッケージファイルをしてエクスポートし、エクスポートしたファイルを変更先ユーザーにご送付いただきます。<br/><br>変更先ユーザーは当該エクスポートファイルをPower Automate ポータル画面よりインポートすることで、同一構成のフローを自身のフローとして保存いただけます。<br/><br>なお、パッケージのエクスポート後のインポートはテナントや環境をまたいだ実施が可能です。</p><p><strong>実行例</strong></p><ol><li>フロー編集画面から「エクスポート」を実行します<br> <img src="/blog/powerautomate/change-flow-owner/image15.png"> </li><li>新たな所有者で「インポート」を実行します<br> <img src="/blog/powerautomate/change-flow-owner/image16.png"> </li></ol><p><a id='anchor-change-flow-solution'></a></p><h3 id="＜ソリューション-フロー＞-フロー詳細画面からフローの所有者を変更する方法"><a href="#＜ソリューション-フロー＞-フロー詳細画面からフローの所有者を変更する方法" class="headerlink" title="＜ソリューション フロー＞　フロー詳細画面からフローの所有者を変更する方法"></a>＜ソリューション フロー＞　フロー詳細画面からフローの所有者を変更する方法</h3><p>以下の方法でフローの所有者を変更できます。<br/></p><p><strong>実行例</strong></p><ol><li>対象のソリューション 編集画面を表示し、対象のフローの「詳細」メニューを選択します<br> <img src="/blog/powerautomate/change-flow-owner/image17.png"> </li><li>フロー編集画面の「編集」を押下します<br> <img src="/blog/powerautomate/change-flow-owner/image18.png"> </li><li>所有者を変更します<br/><br> <img src="/blog/powerautomate/change-flow-owner/image19.png"> </li></ol><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスをもとに紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。</p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><ul><li><a href="https://docs.microsoft.com/ja-jp/power-automate/limits-and-config#performance-profiles">パフォーマンスプロファイルについて</a></li><li><a href="https://docs.microsoft.com/ja-jp/troubleshoot/power-platform/power-automate/manage-orphan-flow-when-owner-leaves-org">PowerShell を使用してフローの所有者を追加する</a></li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/manage-power-automate">Power Platform 管理センターにてフローの所有者を追加する</a></li><li><a href="https://support.microsoft.com/ja-jp/topic/%E6%89%80%E6%9C%89%E8%80%85%E3%81%8C%E7%B5%84%E7%B9%94%E3%82%92%E9%9B%A2%E3%82%8C%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E5%AD%A4%E7%AB%8B%E3%81%97%E3%81%9F%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95-c2915d93-cf96-98a3-e78c-5a69224270b7">所有者が組織を離れるときに孤立したフローを管理する方法</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの谷です。&lt;br/&gt;&lt;br&gt;クラウド フロー所有者の退職・異動に際し、 クラウド フローの所有者を管理する方法についてご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flows/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate におけるフローの有効期限切れを防ぐ</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/how-to-avoid-flow-expiration/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/how-to-avoid-flow-expiration/</id>
    <published>2022-09-26T00:13:00.000Z</published>
    <updated>2023-01-13T09:30:43.268Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、 Power Platform サポートの竹内です。<br>今回は、 Power Automate で一定期間フローを実行していない場合に有効期限が切れてしまい自動的に無効化される事象を防ぐために、どのように対応すればよいのかをご紹介します。</p><h2 id="前提"><a href="#前提" class="headerlink" title="[前提]"></a>[前提]</h2><p>現在、以下のプランで Power Automate をご利用されている方々に対し、 90 日間フローを実行していない場合にはフローの作成者 (所有者) と共同作成者 (共同所有者) へ 30 日後にフローを自動的に無効化する旨のメールが届きます。<br>その後、30 日以内に適切な対応がされない場合には、フローはシステム上無効化され、フローの作成者 (所有者) と共同作成者 (共同所有者) へメールで通知されます。<br>[対象のプラン]<br>無料版と試用版、Power Apps 開発者プラン* 、 Microsoft 365 プラン  </p><p>詳細については以下の公開文書を併せてご確認ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits">制限と構成 - Power Automate | Microsoft Docs</a></p><p>*Power Apps コミュニティプランは 2021 年 5 月に Power Apps 開発者プランに名称を変更しました。<br>Power Apps 開発者プランの詳細につきましては以下の公開情報をご参照ください。  </p><p><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan#improvements-from-the-previous-power-apps-community-plan">Power Apps 開発者プランにサインアップ - Power Apps | Microsoft Docs</a></p><h2 id="フローの無効化を回避する方法"><a href="#フローの無効化を回避する方法" class="headerlink" title="[フローの無効化を回避する方法]"></a>[フローの無効化を回避する方法]</h2><p>以降では、フローが自動的に無効化される事象を回避する方法についてご案内いたします。その方法は大きく分けて、以下の 3 つがございます。<br>① スタンドアロンの Power Automate ライセンスを購入する。<br>② フロー作成、あるいは最終実行日から 120 日以内に 1 度以上実行する。<br>③ フローの最終更新日から 30 日以内に 1 度以上更新する。</p><p>以降ではそれらについて詳細にご紹介いたします。</p><span id="more"></span><h2 id="①-スタンドアロンの-Power-Automate-ライセンスを購入する。"><a href="#①-スタンドアロンの-Power-Automate-ライセンスを購入する。" class="headerlink" title="① スタンドアロンの Power Automate ライセンスを購入する。"></a>① スタンドアロンの Power Automate ライセンスを購入する。</h2><p>スタンドアロンの Power Automate ライセンスを購入することにより、自動で無効化される事象を回避できます。以下のいずれかの方法をご検討ください。</p><ul><li>ユーザーごとの Power Autoamte ライセンスを購入し、対象のフローの作成者に割り当てる  </li><li>フローごとの Power Autoamte ライセンスを購入し、対象のフローに割り当てる  </li></ul><p>詳細につきましては以下の公開情報も併せてご確認ください。  </p><p><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits">制限と構成 - Power Automate | Microsoft Docs</a></p><p>また、スタンドアロンの Power Automate ライセンスの詳細につきましては以下の公開情報をご参照ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/types">Power Automate ライセンスの種類 - Power Platform | Microsoft Docs</a><br><a href="https://powerautomate.microsoft.com/ja-jp/pricing/">価格 | Microsoft Power Automate</a>  </p><h2 id="②-フロー作成日、あるいは最終実行日から-120-日以内に-1-度以上実行する。"><a href="#②-フロー作成日、あるいは最終実行日から-120-日以内に-1-度以上実行する。" class="headerlink" title="② フロー作成日、あるいは最終実行日から 120 日以内に 1 度以上実行する。"></a>② フロー作成日、あるいは最終実行日から 120 日以内に 1 度以上実行する。</h2><p>フローを実行することにより、フローを実行していない 90 日の期間と自動的に無効化されるまでの 30 日の期間をリセットすることができます。<br>手動で実行する方法についてご紹介致します</p><p>フローの一覧画面から対象のフローを選択し、下図の赤枠のいずれかを押すことにより実行します。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image006.png">  </p><p>あるいは下図のフローの詳細画面から実行することもできます。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image007.png">  </p><br>参考情報としまして、下図のように「スケジュール済みクラウド フロー」を作成する場合、90 日に一度は実行されるように設定していただくことで、フローの有効期限切れを防ぐことができます。<p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image005.png">  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image008.png">  </p><h2 id="③-フローの最終更新日から-30-日以内に-1-度以上更新する。"><a href="#③-フローの最終更新日から-30-日以内に-1-度以上更新する。" class="headerlink" title="③ フローの最終更新日から 30 日以内に 1 度以上更新する。"></a>③ フローの最終更新日から 30 日以内に 1 度以上更新する。</h2><p>フローの更新をしていただくことにより、フローが自動的に無効化されるまでの 30 日の期間をリセットすることができます。<br>定期的に手動で更新する、あるいはフローを定期的に更新するフローを作成することによって実現することができます。  </p><p>まず、手動で更新する方法についてご紹介致します。<br>例として、下図のフローの更新を行います。最終変更日時が 9 月 14 日 12:14 であることが確認できます。  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image009.png">  </p><p>では、更新を行います。このフローの編集画面へ遷移すると以下のような画面になります。<br>ここで保存ボタンを押してください。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image011.png">  </p><p>すると、変更日時が更新されていることが確認できます。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image012.png">  </p><p>この操作を定期的に行っていただくことにより、自動的にフローがオフになる事象を回避することができます。</p><br>次に定期的にフローを更新するフローを活用する方法をご紹介いたします。[Power Automate Management] コネクタの [フローの更新] アクションを使用することで、フローの更新が可能となります。以下ではその設定方法をご案内します。<p>1.スケジュール済みクラウドフローを作成し、30 日以内 (下画像では 2 週) 毎に実行するよう設定する。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image013.png">  </p><p>2.[Power Automate Management] コネクタの [フローの取得] アクションを追加する。<br>環境：更新対象のフローがある環境を指定<br>Flow：更新対象のフローを指定  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image014.png">  </p><p>3.[Power Automate Management] コネクタの [フローの取得] アクションを追加する。  </p><p>環境：手順 2 で設定した環境を指定<br>Flow：手順 2 で設定したフローを指定<br>フローの表示名：動的なコンテンツ &gt; フローの取得 &gt; フローの表示名<br>フロー定義：動的なコンテンツ &gt; フローの取得 &gt; フロー定義<br>フローの状態：Started  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image015.png">  </p><p>以上です。<br>このフローを実行すると、変更日時が更新されていることが確認できます。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image017.png"></p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>以上、Power Automate で一定期間フローを実行していない場合の有効期限切れを防ぐ方法を大きく 3 つご紹介いたしました。<br>なお、Power Automate はグローバルでご利用いただいているクラウド製品となりますので、30 日や 90 日などの実行間隔は余裕をもってご設定ください。<br>参考になりましたら幸いです。  </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、 Power Platform サポートの竹内です。&lt;br&gt;今回は、 Power Automate で一定期間フローを実行していない場合に有効期限が切れてしまい自動的に無効化される事象を防ぐために、どのように対応すればよいのかをご紹介します。&lt;/p&gt;
&lt;h2 id=&quot;前提&quot;&gt;&lt;a href=&quot;#前提&quot; class=&quot;headerlink&quot; title=&quot;[前提]&quot;&gt;&lt;/a&gt;[前提]&lt;/h2&gt;&lt;p&gt;現在、以下のプランで Power Automate をご利用されている方々に対し、 90 日間フローを実行していない場合にはフローの作成者 (所有者) と共同作成者 (共同所有者) へ 30 日後にフローを自動的に無効化する旨のメールが届きます。&lt;br&gt;その後、30 日以内に適切な対応がされない場合には、フローはシステム上無効化され、フローの作成者 (所有者) と共同作成者 (共同所有者) へメールで通知されます。&lt;br&gt;[対象のプラン]&lt;br&gt;無料版と試用版、Power Apps 開発者プラン* 、 Microsoft 365 プラン  &lt;/p&gt;
&lt;p&gt;詳細については以下の公開文書を併せてご確認ください。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits&quot;&gt;制限と構成 - Power Automate | Microsoft Docs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;*Power Apps コミュニティプランは 2021 年 5 月に Power Apps 開発者プランに名称を変更しました。&lt;br&gt;Power Apps 開発者プランの詳細につきましては以下の公開情報をご参照ください。  &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan#improvements-from-the-previous-power-apps-community-plan&quot;&gt;Power Apps 開発者プランにサインアップ - Power Apps | Microsoft Docs&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;フローの無効化を回避する方法&quot;&gt;&lt;a href=&quot;#フローの無効化を回避する方法&quot; class=&quot;headerlink&quot; title=&quot;[フローの無効化を回避する方法]&quot;&gt;&lt;/a&gt;[フローの無効化を回避する方法]&lt;/h2&gt;&lt;p&gt;以降では、フローが自動的に無効化される事象を回避する方法についてご案内いたします。その方法は大きく分けて、以下の 3 つがございます。&lt;br&gt;① スタンドアロンの Power Automate ライセンスを購入する。&lt;br&gt;② フロー作成、あるいは最終実行日から 120 日以内に 1 度以上実行する。&lt;br&gt;③ フローの最終更新日から 30 日以内に 1 度以上更新する。&lt;/p&gt;
&lt;p&gt;以降ではそれらについて詳細にご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>Excel エクスポート時の列幅が規定値で出力される件について</title>
    <link href="https://jpdynamicscrm.github.io/blog/information/ExportExcel-widtherror/"/>
    <id>https://jpdynamicscrm.github.io/blog/information/ExportExcel-widtherror/</id>
    <published>2022-09-22T03:00:00.000Z</published>
    <updated>2023-01-13T09:30:43.208Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Dynamics 365 Customer Engagement サポートの木村です。<br>本ブログでは、Excel エクスポート時の列幅が規定値で出力される件についてご説明いたします。</p><span id="more"></span><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-excelexport-widhtherror">Excel エクスポート時の列幅が規定値で出力される件について</a></li><li><a href="#anchor-futurefix">今後の修正予定について</a></li><li><a href="#anchor-finish">おわりに</a></li></ol><p><a id='anchor-intro'></a></p><hr><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>2022年6月11日 (土) に日本環境に適用したアップデートが原因で、Excel エクスポート時の列幅が規定値で出力される事象が発生しております。<br>こちらの事象の詳細と今後の修正予定につきまして、当ブログにてご説明いたします。</p><hr><p><a id='anchor-excelexport-widhtherror'></a></p><h2 id="Excel-エクスポート時の列幅が規定値で出力される件について"><a href="#Excel-エクスポート時の列幅が規定値で出力される件について" class="headerlink" title="Excel エクスポート時の列幅が規定値で出力される件について"></a>Excel エクスポート時の列幅が規定値で出力される件について</h2><p>アップデート内容と致しましては、「列の編集」でビューに列を追加した際、その追加した列も出力したExcel に表示されるよう動作変更が行われました。<br>上記機能追加に伴い、追加リグレッションが発生していることから、ビューから出力されたファイルの表示幅が規定値 (294ピクセル) になるという不具合が発生しております。<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-2.png">  </p><p>また、高度な検索から出力した場合には、ビューの列幅設定が反映されることを確認しております。</p><ul><li>高度な検索にてExcel を出力する方法</li></ul><ol><li>対象の画面の上部にある […] を押下し、 [ビューの作成] を開く<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-6.png"> </li><li>[結果] を押下する<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-3.png"> </li><li>全ての行を選択し、 [Excel にエクスポート] を押下する<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-4.png"> </li><li>Excel ファイルが出力される<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-5.png"> </li></ol><p>※下記公開資料に記載のある「最新の高度な検索」がON になっている場合<br><a href="https://learn.microsoft.com/ja-jp/power-platform-release-plan/2022wave2/power-apps/modern-advanced-find-turned-default">最新の高度な検索が既定でオンになっている</a></p><ol><li>画面上部にある [歯車] を押下し、[詳細設定]を押下する<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-7.png"> </li><li>画面上部にある、 [ろうと]を押下し、高度な検索画面を開く<br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-8.png"><br><img src="/blog/information/ExportExcel-widtherror/ExportExcel-widtherror-9.png"><br>それ以降の手順は上記No.2 以降と同様になります。</li></ol><hr><p><a id='anchor-futurefix'></a></p><h2 id="今後の修正予定について"><a href="#今後の修正予定について" class="headerlink" title="今後の修正予定について"></a>今後の修正予定について</h2><p>2022年10月3日 (月) 現在<br>修正方法については、検討段階であるため決定事項ではございませんが、修正には少なくとも2週間ほど見積もっており、その他の修正も併せて日本リージョンへの展開まで1か月以上先になる見込みでございます</p><p><a id='anchor-finish'></a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>こちらのブログでは現在弊社にて確認されているExcelエクスポート時の列幅が規定値で出力される件についてご案内いたしました。<br>今後の修正予定につきましては、更新がございましたら「今後の修正予定について」の内容を更新いたします。<br>ご不便をいたしますが、修正完了および展開について今しばらくお待ちくださいませ。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Dynamics 365 Customer Engagement サポートの木村です。&lt;br&gt;本ブログでは、Excel エクスポート時の列幅が規定値で出力される件についてご説明いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Dynamics 365 Customer Engagement" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics-365-Customer-Engagement/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate でテキストファイルの文字化けを回避する</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Avoid-Character-Corruption-Methods/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Avoid-Character-Corruption-Methods/</id>
    <published>2022-09-21T00:07:00.000Z</published>
    <updated>2023-01-13T09:30:43.236Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、 Power Platform サポートの竹内です。<br>今回は、 Power Automate で起きる日本語テキスト ファイルの文字化け事例と対処法から、特に多くお問い合わせをいただくものを 2 つご紹介します。<br>① Power Automate 内で作成した CSV ファイルを Excel で開く際に文字化けを起こさない方法<br>② 文字コードが ANSI (Shift_JIS) であるテキスト ファイルを Power Automate で文字化けを起こさずに扱う方法</p><h3 id="前提条件"><a href="#前提条件" class="headerlink" title="[前提条件]"></a>[前提条件]</h3><p>現在 Power Automate はテキスト ファイルの文字コードを UTF-8 として扱います。Power Automate で Shift_JIS  など他の文字コードでのテキスト ファイルを作成することはできません。</p><span id="more"></span><h2 id="①-Power-Automate-内で作成した-CSV-ファイルを-Excel-で開く際に文字化けを起こさない方法"><a href="#①-Power-Automate-内で作成した-CSV-ファイルを-Excel-で開く際に文字化けを起こさない方法" class="headerlink" title="① Power Automate 内で作成した CSV ファイルを Excel で開く際に文字化けを起こさない方法"></a>① Power Automate 内で作成した CSV ファイルを Excel で開く際に文字化けを起こさない方法</h2><h3 id="事象"><a href="#事象" class="headerlink" title="[事象]"></a>[事象]</h3><p>例として下図のように、Power Automate で JSON を CSV として変換して OneDrive for Business に保存するフローを考えます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image001.png">  </p><p>このフローをそのまま実行し、 OneDrive for Business に保存された CSV ファイルを Excel Online で開いてみると、下図のように文字化けしてしまいます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image002.png"><br><br /></p><h3 id="原因"><a href="#原因" class="headerlink" title="[原因]"></a>[原因]</h3><p>これは Power Automate によって作成された CSV 形式のテキスト ファイルは文字コードが UTF-8 であるのに対し、 Excel Online は文字コードが ANSI (Shift_JIS) であると見なして処理してしまうためです。先ほどのフローで OneDrive for Business 上に保存された CSV ファイルをダウンロードして Windows 標準のメモ帳アプリで開くと、下図のように文字コードが UTF-8 であることが確認できます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image003.png"><br><br /></p><h3 id="対処法"><a href="#対処法" class="headerlink" title="[対処法]"></a>[対処法]</h3><p>Excel Online が文字コードを正しく判断できていないことが原因なので、文字コードが UTF-8 であることを教えてあげるための記号として、BOM (Byte Order Mark) を付けます。<br>UTF-8 の BOM は「0xEF 0xBB 0xBF」の 3 バイトの文字列なので、これをテキスト ファイルの先頭に付与します。<br><br /><br>では、先ほどのフローを下図のように編集してみます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image004.png"></p><p>[OneDrive for Business] コネクタの [ファイルの作成] アクションの「ファイル コンテンツ」の入力項目を以下のように変更しました。  </p><p><code>concat(decodeUriComponent(&#39;%EF%BB%BF&#39;),body(&#39;CSV_テーブルの作成&#39;))</code>  </p><p>これで BOM 付きの CSV ファイルを作成することができました。では、このフローを実行して作成されたファイルを開いてみましょう。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image005.png"></p><p>上図のように日本語が文字化けすることなく表示されている様子を確認することができます。<br><br /><br>ひとつ目の事例は以上となります。<br><br /><br><br /></p><h2 id="②-文字コードが-ANSI-Shift-JIS-であるテキストファイルを-Power-Automate-で文字化けを起こさずに扱う方法"><a href="#②-文字コードが-ANSI-Shift-JIS-であるテキストファイルを-Power-Automate-で文字化けを起こさずに扱う方法" class="headerlink" title="② 文字コードが ANSI (Shift_JIS) であるテキストファイルを Power Automate で文字化けを起こさずに扱う方法"></a>② 文字コードが ANSI (Shift_JIS) であるテキストファイルを Power Automate で文字化けを起こさずに扱う方法</h2><h3 id="事象-1"><a href="#事象-1" class="headerlink" title="[事象]"></a>[事象]</h3><p>例として下図のような CSV ファイルを Power Automate で扱うことを考えます。<br>特徴として以下の 2 つが挙げられます。  </p><ol><li>日本語が含まれている。  </li><li>文字コードが ANSI (Shift_JIS) である。  </li></ol><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image006.png">  </p><p>OneDrive for Business に格納してあるこの CSV ファイルを下図のようなフローで扱います。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image007.png">  </p><p>このフローを実行し、出力されたファイルをダウンロードして表示すると、下図のように日本語が文字化けしている様子が見られます。</p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image008.png">  </p><p>フローの実行履歴を確認すると、下図のように [ファイル コンテンツの取得] のアクションで日本語が文字化けしていることが分かります。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image009.png"><br><br /></p><h3 id="原因-1"><a href="#原因-1" class="headerlink" title="[原因]"></a>[原因]</h3><p>Power Automate はテキスト ファイルのファイル コンテンツ取得時に、 “コンテンツ タイプの推測” オプションにより読み込むファイルが UTF-8 で符号化されているテキスト ファイルであると自動的に判断し、変換処理を行います。このため、 UTF-8 以外の文字コードで記述されているテキスト ファイルのコンテンツを読み込む際に正しく変換処理を行うことができず、文字化けが発生してしまいます。<br><br /></p><h3 id="対処法-1"><a href="#対処法-1" class="headerlink" title="[対処法]"></a>[対処法]</h3><p>“コンテンツ タイプの推測” オプションを無効にすることで、 UTF-8 であると自動的に判断して変換する動作を回避し、元のファイル コンテンツをそのまま扱うことができるようになります。<br>以降ではその設定方法をご紹介します。<br>下図のように [OneDrive for Business] コネクタの [ファイル コンテンツの取得] アクションで、「詳細オプションを表示する」を選択してください。</p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image010.png">  </p><p>すると、下図のように「コンテンツ タイプの推測」という項目が表示されます。これが既定では「はい」になっているところを、「いいえ」に変更してください。<br><br /><br>(変更前)</p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image011.png">  </p><p>(変更後)</p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image012.png">  </p><p>この状態で先ほどの下図のフローをもう一度実行してみます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image013.png">  </p><p>実行履歴を確認してみると、下図のように結果が変化していることを確認できます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image014.png">  </p><p>また、出力されたファイルを確認してみると、下図のように ①日本語が文字化けしていないこと ②文字コードが ANSI のままであること、を確認することができます。  </p><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image015.png"><br><br /></p><h3 id="注釈"><a href="#注釈" class="headerlink" title="[注釈]"></a>[注釈]</h3><p>上記では [OneDrive for Business] コネクタの [ファイル コンテンツの取得] アクションを例に取り上げましたが、類似のアクションでは同様の設定項目があります。以下に例を示します。<br><br /></p><ol><li>[SharePoint] コネクタの [ファイル コンテンツの取得]</li></ol><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image016.png"></p><ol start="2"><li>[File System] コネクタの [ファイル コンテンツの取得]</li></ol><p><img src="/blog/powerautomate/Avoid-Character-Corruption-Methods/image017.png"></p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>以上、Power Automate で日本語のテキスト ファイルを扱う際に文字化けを回避する方法をご紹介いたしました。<br>参考になりましたら幸いです。  </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、 Power Platform サポートの竹内です。&lt;br&gt;今回は、 Power Automate で起きる日本語テキスト ファイルの文字化け事例と対処法から、特に多くお問い合わせをいただくものを 2 つご紹介します。&lt;br&gt;① Power Automate 内で作成した CSV ファイルを Excel で開く際に文字化けを起こさない方法&lt;br&gt;② 文字コードが ANSI (Shift_JIS) であるテキスト ファイルを Power Automate で文字化けを起こさずに扱う方法&lt;/p&gt;
&lt;h3 id=&quot;前提条件&quot;&gt;&lt;a href=&quot;#前提条件&quot; class=&quot;headerlink&quot; title=&quot;[前提条件]&quot;&gt;&lt;/a&gt;[前提条件]&lt;/h3&gt;&lt;p&gt;現在 Power Automate はテキスト ファイルの文字コードを UTF-8 として扱います。Power Automate で Shift_JIS  など他の文字コードでのテキスト ファイルを作成することはできません。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
</feed>
