<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  
  <subtitle>日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</subtitle>
  <link href="https://jpdynamicscrm.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpdynamicscrm.github.io/blog/"/>
  <updated>2021-06-18T13:13:37.033Z</updated>
  <id>https://jpdynamicscrm.github.io/blog/</id>
  
  <author>
    <name>Japan Dynamics CRM &amp; Power Platform Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Power Automate Desktop で「フローなし」と表示される場合の対処法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktop-NoFlow/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktop-NoFlow/</id>
    <published>2021-06-07T03:00:00.000Z</published>
    <updated>2021-06-18T13:13:37.033Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Automate サポートの清水です。</p><p>今回は、Power Automate Desktop で「フローなし」のエラーが表示される場合の対処法についてご紹介します。</p><span id="more"></span><p>Power Automate Desktop をインストールした後、いざデスクトップ フローを作成しよう！とサインインすると、<br>以下のような エラーが表示される場合があります。</p><p><img src="/blog/powerautomate/PowerAutomateDesktop-NoFlow/Error.png"></p><p>今回は上記のエラー解消に向けての確認ポイントをご案内します。</p><h2 id="1-ネットワーク環境の確認"><a href="#1-ネットワーク環境の確認" class="headerlink" title="1. ネットワーク環境の確認"></a>1. ネットワーク環境の確認</h2><p>Power Automate Desktop を使用するには、いくつかのエンドポイントを許可していただく必要がございます。<br>プロキシを経由して通信を行っている場合や、ファイアウォールで通信の制御を行っている場合には、<br>以下の IP アドレスやドメインが許可されているかをご確認ください。<br><a href="https://docs.microsoft.com/ja-jp/power-automate/ip-address-configuration">IP アドレスの構成 - Power Automate | Microsoft Docs</a></p><h2 id="2-既定の環境でのユーザーの状態の確認"><a href="#2-既定の環境でのユーザーの状態の確認" class="headerlink" title="2. 既定の環境でのユーザーの状態の確認"></a>2. 既定の環境でのユーザーの状態の確認</h2><p>Power Automate Desktop に最初にログインした際には、テナントの既定の環境にアクセスいたします。</p><p>そのため、既定の環境でユーザーが無効な状態になっている場合にエラーが発生する場合がございますので、<br>ログインしているユーザーが有効な状態になっているかをご確認ください。</p><p>&lt;確認手順&gt;</p><ol><li><p>全体管理者アカウントにて、<a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a>にアクセスし、既定の環境をクリックします。</p></li><li><p>[設定] から、[ユーザーとアクセス許可] &gt; [ユーザー] を開きます。</p></li><li><p>ユーザー一覧に該当のユーザーが存在するかを確認し、存在しない場合は [ユーザーの追加] ボタンをクリックします。</p></li><li><p>対象ユーザーアカウントのメールアドレスを指定し、[追加] をクリックします。</p></li><li><p>ユーザー追加が完了しましたら、ユーザーの設定ページを開き、下図のように状態が “有効” であることを確認します。<br><img src="/blog/powerautomate/PowerAutomateDesktop-NoFlow/UserStatus.png"></p></li><li><p>ユーザーが有効なことが確認できたら、再度 Power Automate Desktop でのフロー作成を試します。</p></li></ol><p>なお、過去に一度も Power Automate にアクセスしたことがない場合は、<a href="https://japan.flow.microsoft.com/">Power Automate ポータル</a>にアクセスすると、<br>自動で既定の環境に追加されます。<br>管理者でのユーザーの確認が難しい場合は、一度 Power Automate ポータルにアクセスしてから<br>少し時間を置いて Powre Automate Desktop にアクセスするなどの操作もお試しください。</p><h2 id="3-Dataverse-旧名-Common-Data-Service-のライセンスの確認"><a href="#3-Dataverse-旧名-Common-Data-Service-のライセンスの確認" class="headerlink" title="3. Dataverse (旧名: Common Data Service) のライセンスの確認"></a>3. Dataverse (旧名: Common Data Service) のライセンスの確認</h2><p>Power Automate Desktop で作成されたフローは既定の環境の Dataverse に保存されるため、<br>Power Automate Desktop を使用するには、有効な Dataverse のライセンスが必要となります。</p><p>通常は、Power Automate のライセンスを持っていないユーザーであっても、初めて Power Automate にアクセスした際に<br>全てのユーザーに無償版の「Power Automate Free」というライセンスが付与されます。<br>そのため、この無償のライセンスによって Dataverse へのアクセスが可能となり、Power Automate Desktop を使用できます。</p><p>しかし、テナント内で無償版のライセンスを禁止としている場合には、Power Automate Free ライセンスが使用できないため、<br>有効なライセンスがないことから、Power Automate Desktop が使用できないケースがございます。</p><p>この場合、一度テナントの管理者にご連絡いただき、Power Automate Free もしくは Power Automate for Office 365 などのライセンスを付与していただくようお願いいたします。</p><h2 id="4-Power-Automate-Desktop-のバージョンの確認"><a href="#4-Power-Automate-Desktop-のバージョンの確認" class="headerlink" title="4. Power Automate Desktop のバージョンの確認"></a>4. Power Automate Desktop のバージョンの確認</h2><p>以下のリンクから、Power Automate Desktopの最新バージョンをインストールし、<br>事象が解消するかどうかをご確認ください。<br><a href="https://go.microsoft.com/fwlink/?linkid=2102613">https://go.microsoft.com/fwlink/?linkid=2102613</a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>Power Automate Desktop で「フローなし」のエラーが発生する場合の確認点についてご説明いたしました。<br>Power Automate Desktop を初めて使用するユーザーにとって、少しでもお役に立つ情報がございましたら幸いです。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Automate サポートの清水です。&lt;/p&gt;
&lt;p&gt;今回は、Power Automate Desktop で「フローなし」のエラーが表示される場合の対処法についてご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop Flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-Flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>SharePointの内部列名を確認する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Look-up-internal-column-names-in-SPO/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Look-up-internal-column-names-in-SPO/</id>
    <published>2021-06-01T02:30:00.000Z</published>
    <updated>2021-06-18T13:13:37.033Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。</p><br>今回はSharePointリストを利用したフローを作成するときに、必ず知っておくべき内部列名とその確認方法をご案内します。<br><p>内部列名を使いこなせれば、トリガー条件やフィルタークエリを使って、SharePointを更に便利に使いこなせます！<br></p><p>便利な使い方は別の機会にたくさん紹介しますので、今回は内部列名の確認方法についてしっかり覚えていきましょう。</p><br><p>この記事の対象者</p><ul><li>Power Automateをはじめたばかりの方</li><li>SharePointリストとPower Automateの連携に興味のある方</li></ul><br>私たちMicrosoftはすべての人が開発者になる未来を目指しています。<br>Power Automateを使って、一緒にビジネスを加速させましょう！<br><br><br><span id="more"></span><hr><p>#目次</p><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-what-is-internal-column">内部列名って何？</a></li><li><a href="#anchor-how-to-look-up-internal-column">内部列名の確認方法</a></li></ol><br><p><a id='anchor-Intro'></a></p><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><br><h3 id="こんなことしたいなって思ったことありませんか？"><a href="#こんなことしたいなって思ったことありませんか？" class="headerlink" title="こんなことしたいなって思ったことありませんか？"></a>こんなことしたいなって思ったことありませんか？</h3><ul><li>SharePointリストの期限列と現在日時を比較して、期限間近のアイテムをTeamsやメールでリマインドしたい</li><li>ステータス列が「完了」以外のときだけフローを実行したい</li></ul><br>Power Automateを使えば、「期限列」や「ステータス列」の値を利用して、～この列が〇〇のとき～のような条件式を簡単に作成することができます!<br><br>詳しい方法はまた別の機会にblogとして更新しますので、今回は列を指定するときに必要な内部列名について学んでいきます。<br><br   >それでは早速SharePointリストの内部列名とは何かから、学んでいきましょう！<br><p>基礎知識は飛ばして確認方法を知りたいという方は<a href="#anchor-how-to-look-up-internal-column">内部列名の確認方法</a>へ進んでください。<br><br><br><br></p><p><a id='anchor-what-is-internal-column'></a></p><h2 id="内部列名って何"><a href="#内部列名って何" class="headerlink" title="内部列名って何?"></a>内部列名って何?</h2><p>内部列名はシステム側で列を特定するためのキー項目です。<br><br><br></p><h3 id="内部列名がないと・・・"><a href="#内部列名がないと・・・" class="headerlink" title="内部列名がないと・・・"></a>内部列名がないと・・・</h3><br><p>例えば、以下のようなデータがあったとします。<br>| 列名 | 値 |<br>| :- | :- |<br>| Title | A社様見積もり |<br>| 承認者 | 〇〇部長 |<br>| 期限 | 2021/06/01 |</p><br><br>ここに、二次承認者を加えることになりました。<br>そこで「承認者」と「期限」の列名を変更することにしました。<br><br><table><thead><tr><th align="left">表示上の列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left">A社様見積もり</td></tr><tr><td align="left"><font color=red>一次</font>承認者</td><td align="left">？</td></tr><tr><td align="left"><font color=red>一次承認</font>期限</td><td align="left">？</td></tr><tr><td align="left">二次承認者</td><td align="left">-</td></tr><tr><td align="left">二次承認期限</td><td align="left">-</td></tr></tbody></table><br><p>「承認者」と「期限」という列名がなくなってしまったので、システム側が元々の値を見つけられなくなってしまいます。<br><br>では、二次承認を加える前のデータに内部列名を追加してみましょう。<br><br></p><table><thead><tr><th align="left">表示上の列名</th><th align="left">内部列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left"><font color=red>Title</font></td><td align="left">A社様見積もり</td></tr><tr><td align="left">承認者</td><td align="left"><font color=red>Approver</font></td><td align="left">〇〇部長</td></tr><tr><td align="left">期限</td><td align="left"><font color=red>deadline</font></td><td align="left">2021/06/01</td></tr></tbody></table><br>次に、「承認者」と「期限」の列名を変更して、二次承認者の情報を増やします。<br><table><thead><tr><th align="left">表示上の列名</th><th align="left">内部列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left">Title</td><td align="left">A社様見積もり</td></tr><tr><td align="left"><font color=red>一次</font>承認者</td><td align="left"><font color=red>Approver</font></td><td align="left">〇〇部長</td></tr><tr><td align="left"><font color=red>一次承認</font>期限</td><td align="left"><font color=red>deadline</font></td><td align="left">2021/06/01</td></tr><tr><td align="left">二次承認者</td><td align="left">Secondary Approver</td><td align="left">-</td></tr><tr><td align="left">二次承認期限</td><td align="left">Secondary Approve deadline</td><td align="left">-</td></tr></tbody></table><br>表示上の列名が変更されても内部列名が変わらないので、システム側も値を見つけることができますね。<br><br>Power AutomateからSharePointの列を扱うときも、同様の理由で表示名ではなく、内部列名を利用します。<br>この仕組みがあるから誰かが表示上の列名を変更された場合でも、フローを編集する必要はありませんね。<br><br>今回は説明の便宜上わかりやすい内部列名を利用しましたが、SharePoint登録時に内部列名を利用者が設定することはできません。<br>例えば、「承認期限」という名前で列を作ると、「_x627f__x8a8d__x671f__x9650_」という内部列名が自動で作成されます。<br><br><p>一見取っつきにくい表記に思えますが、どの列かを識別するためのものなので、列を表す記号と捉えて次に進みましょう。<br><br><br><br></p><p><a id='anchor-to-use-internal-column'></a></p><h2 id="内部列名をPower-Automateで利用するために"><a href="#内部列名をPower-Automateで利用するために" class="headerlink" title="内部列名をPower Automateで利用するために"></a>内部列名をPower Automateで利用するために</h2><br>Powre Automate利用時に注意が必要になるのが、内部列名はそのままで利用できる場合と、加工が必要な場合があります。<br>決まりなので覚えていきましょう。<br><br>以下の列を持つリストを例にして、確認していきます。<p><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/SPO-list.png"></p><br><br>各列の内部列名を確認していくと、以下のようになります。<br><ul><li>文字の種類がアルファベットの場合は、<strong><font color=red>OData_</font></strong> という接頭辞が<font color=blue>不要</font></li><li>文字の種類がアルファベットの場合<font color=red>以外</font>は、<strong><font color=red>OData_</font></strong> という接頭辞が<font color=blue>必要</font></li></ul><br><br><table><thead><tr><th align="center">文字の種類</th><th align="center">列名</th><th align="center">内部列名</th><th align="center">Power Automate 利用時</th></tr></thead><tbody><tr><td align="center">アルファベット</td><td align="center">Details</td><td align="center">Details</td><td align="center">Details</td></tr><tr><td align="center">日本語</td><td align="center">承認期限</td><td align="center">_x627f__x8a8d__x671f__x9650_</td><td align="center"><font color=red>OData_</font>_x627f__x8a8d__x671f__x9650_</td></tr><tr><td align="center">記号 ( 2byte )</td><td align="center">・</td><td align="center">_x30fb_</td><td align="center"><font color=red>OData_</font>_x30fb_</td></tr><tr><td align="center">記号 ( 1byte )</td><td align="center">///</td><td align="center">_x002f__x002f__x002f_</td><td align="center"><font color=red>OData_</font>_x002f__x002f__x002f_</td></tr><tr><td align="center">数値</td><td align="center">123456</td><td align="center">_x0031_23456</td><td align="center"><font color=red>OData_</font>_x0031_23456</td></tr></tbody></table><br><br><p><a id='anchor-how-to-look-up-internal-column'></a></p><h2 id="内部列名の確認方法"><a href="#内部列名の確認方法" class="headerlink" title="内部列名の確認方法"></a>内部列名の確認方法</h2><br>では実際に、内部列名を確認していきましょう。<br><br><ol><li>SharePointにて、内部列名を確認したいリストを表示します。</li><li>歯車アイコンからリストの設定を開きます。<br><br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/open-list-setting.png"></li><li>列の一覧から、確認したい列を選択します。<br><br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/open-column-setting.png"></li><li>URL の <strong>Field= </strong>以降の値が内部列名となります。<br><br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-internal-name.png"></li><li>最後に以下の表の規則に従い、アルファベット以外の場合には OData_ を付与します。<br></li></ol><br><br><table><thead><tr><th align="center">文字の種類</th><th align="center">列名</th><th align="center">内部列名</th><th align="center">SharePoint 列の設定での表示</th><th align="center">Power Automate 利用時</th></tr></thead><tbody><tr><td align="center">アルファベット</td><td align="center">Details</td><td align="center">Details</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-alfabet.png"></td><td align="center">Details</td></tr><tr><td align="center">日本語</td><td align="center">承認期限</td><td align="center">_x627f__x8a8d__x671f__x9650_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-deadline.png"></td><td align="center"><font color=red>OData_</font>_x627f__x8a8d__x671f__x9650_</td></tr><tr><td align="center">記号 ( 2byte )</td><td align="center">・</td><td align="center">_x30fb_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-mark-2byte.png"></td><td align="center"><font color=red>OData_</font>_x30fb_</td></tr><tr><td align="center">記号 ( 1byte )</td><td align="center">///</td><td align="center">_x002f__x002f__x002f_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-slash.png"></td><td align="center"><font color=red>OData_</font>_x002f__x002f__x002f_</td></tr><tr><td align="center">数値</td><td align="center">123456</td><td align="center">_x0031_23456</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-num.png"></td><td align="center"><font color=red>OData_</font>_x0031_23456</td></tr></tbody></table><br><br>これで内部列を取得することができました。<br>内部列名についてのご案内は以上となります。<br><br>いかがでしたでしょうか。<br>内部列名を使えるとSharePointリストを使ったフローの幅を広げることができますので、どんどん使っていってくださいね。<br><hr><p>Hope to acceralate your business with Power Automate!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;/p&gt;
&lt;br&gt;
今回はSharePointリストを利用したフローを作成するときに、必ず知っておくべき内部列名とその確認方法をご案内します。&lt;br&gt;

&lt;p&gt;内部列名を使いこなせれば、トリガー条件やフィルタークエリを使って、SharePointを更に便利に使いこなせます！&lt;br&gt;&lt;/p&gt;
&lt;p&gt;便利な使い方は別の機会にたくさん紹介しますので、今回は内部列名の確認方法についてしっかり覚えていきましょう。&lt;/p&gt;
&lt;br&gt;

&lt;p&gt;この記事の対象者&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Power Automateをはじめたばかりの方&lt;/li&gt;
&lt;li&gt;SharePointリストとPower Automateの連携に興味のある方&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
私たちMicrosoftはすべての人が開発者になる未来を目指しています。&lt;br&gt;
Power Automateを使って、一緒にビジネスを加速させましょう！&lt;br&gt;
&lt;br&gt;
&lt;br&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="PowerAutomate" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerAutomate/"/>
    
    <category term="SharePointOnline" scheme="https://jpdynamicscrm.github.io/blog/tags/SharePointOnline/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse for Teams 環境の管理方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/</id>
    <published>2021-04-27T02:30:00.000Z</published>
    <updated>2021-06-18T13:13:37.037Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの清水です。</p><p>今回は、2020 年 9 月に 新たに Teams に統合された Power Platform の機能について、その管理・制御方法やよくお問合せいただく内容に関して、詳しくご説明いたします。</p><p>ライセンスが Teams に組み込まれているという性質上、管理にお困りの方も多いかと思います。<br>この記事が皆様のお役に立ちましたら幸いです。</p><span id="more"></span><h2 id="Dataverse-for-Teams-の概要"><a href="#Dataverse-for-Teams-の概要" class="headerlink" title="Dataverse for Teams の概要"></a>Dataverse for Teams の概要</h2><hr><p>Dataverse for Teams 環境とは、Teams のチームに紐づく Power Platform の環境です。<br>チームの所有者が環境の管理者となり、チームのメンバーは環境上でアプリやフロー、チャットボットを作成・使用することができます。<br>参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/about-teams-environment">Microsoft Dataverse for Teams 環境について | Microsoft Docs</a></p><p>Dataverse for Teams の環境は、Teams を通してのみ作成されます。<br>例えば以下のような場合に、選択したチームの Dataverse for Teams 環境が自動で作成されます。</p><ul><li>Teams 上の Power Apps アプリを使用して、で初めて環境に紐づくアプリを作成したとき</li><li>Teams 上の Power Virtual Agents アプリを使用して、初めて環境に紐づくボットを作成したとき</li><li>Teams のアプリ カタログから初めて Power Apps アプリ (※1) をインストールしたとき</li></ul><p>なお、Teams のチームと Dataverse for Teams の環境は 1:1 で紐づけらます。<br>そのため、一つのチームで複数の環境を持つことはできません。<br>また、異なるチームの Dataverse for Teams 環境にアクセスすることもできません。</p><h3 id="環境の制限"><a href="#環境の制限" class="headerlink" title="環境の制限"></a>環境の制限</h3><p>Dataverse for Teams 環境には以下の制限があります。</p><ul><li><p>Microsoft 365 のライセンス数に応じたテナント毎の環境数の制限<br>  テナント毎の環境数の上限は以下の式で決定されます。</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5 + (1 * Microsoft 365 のライセンス数 / 20)</span><br></pre></td></tr></table></figure><p>  また、ライセンス数に関わらず、環境数の上限は 10,000 (※2) となります。</p></li><li><p>環境ごとのストレージ制限<br>  各環境は、最大で 2 GB または 100 万行のデータを格納することが可能です。</p></li><li><p>テナントごとのストレージ制限<br>  テナント毎のストレージ容量の上限は以下の式で決定されます。</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10 GB + (環境数 * 2 GB)</span><br></pre></td></tr></table></figure><p>  また、ストレージ容量の上限は 19.5 TB となります。</p></li></ul><p>各テナントで作成可能な環境数は、Power Platform 管理センターからご確認ください。</p><p>Power Platform 管理センター &gt; リソース &gt; キャパシティ &gt; Microsoft Teams<br><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/limitation.png"></p><p>制限を超えて環境やストレージ容量を使用したい場合、<a href="https://docs.microsoft.com/en-us/power-platform/admin/about-teams-environment#upgrade-process">Dataverse へのアップグレード</a>をご検討ください。</p><h3 id="環境へのゲストアクセス"><a href="#環境へのゲストアクセス" class="headerlink" title="環境へのゲストアクセス"></a>環境へのゲストアクセス</h3><p>Teams チームにゲストユーザーを招待している場合、ゲストユーザーは以下のような権限を持ちます。</p><ul><li>アプリやボット、その他リソースの閲覧</li><li>アプリやボットの実行</li><li>自身が作成したレコードへのフルアクセス<br>  ※他のユーザーが作成したレコードへのアクセス権は持ちません。</li></ul><h2 id="特定のユーザーにだけ環境を作成させたい"><a href="#特定のユーザーにだけ環境を作成させたい" class="headerlink" title="特定のユーザーにだけ環境を作成させたい"></a>特定のユーザーにだけ環境を作成させたい</h2><hr><p>最初に説明した通り、Dataverse for Teams 環境は、Teams 上でのアプリやボットの作成を通して作成されます。<br>そのため、環境を作成させたくない場合、Teams 上でのアプリやボットの作成を禁止する、すなわち、Teams からのPower Apps および Power Virtual Agents の使用を禁止する必要がございます。</p><p>Temas からの Power Apps/Power Virtual Agents の使用を禁止するには、Teams 管理センターからアプリのアクセス許可ポリシーの設定を行い、環境作成を許可しても良いユーザーにだけ以下 2 つのアプリを許可するよう設定してください。</p><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/Teams-app-policy.png"><br>参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/teams-app-permission-policies">Microsoft Teams のアプリのアクセス許可ポリシーを管理する | Microsoft Docs</a></p><h2 id="環境の作成は禁止してアプリやボットを使用させる-2-つの方法"><a href="#環境の作成は禁止してアプリやボットを使用させる-2-つの方法" class="headerlink" title="環境の作成は禁止してアプリやボットを使用させる 2 つの方法"></a>環境の作成は禁止してアプリやボットを使用させる 2 つの方法</h2><hr><p>まず、アプリやボットの使用許可するには、組織全体のカスタム アプリ設定にて、カスタムアプリとの対話を許可してください。<br>参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/teams-custom-app-policies-and-settings#org-wide-custom-app-setting">Microsoft Teams のカスタム アプリのポリシーと設定を管理する #組織全体のカスタム アプリ設定 | Microsoft Docs</a></p><h3 id="1-同僚が作成-からアプリを使用する"><a href="#1-同僚が作成-からアプリを使用する" class="headerlink" title="1. [同僚が作成] からアプリを使用する"></a>1. [同僚が作成] からアプリを使用する</h3><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/built-by-your-colleagues.png"><br>以下のいずれかの条件に合致するアプリまたはボットは、Teams の[アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] からインストールすることが可能です。</p><table><thead><tr><th>Power Apps</th><th>Power Virtual Agents</th></tr></thead><tbody><tr><td>1. ユーザーが作成したアプリ<br>2. ユーザーに直接共有されたアプリ (グループや組織全体への共有は NG)<br>3. 直近 1 週間以内に使用したアプリ</td><td>1. ユーザーが作成したボット<br>2. ユーザーが所属するグループで作成されたボット</td></tr></tbody></table><p>Dataverse for Teams 環境で作成したアプリやボットを [同僚が作成] からユーザーがインストールできるようにするには、それぞれ以下の Teams アプリを許可してください。</p><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/Teams-app-policy-Shared.png"></p><p>これらの Teams アプリと、先に説明した環境作成が行われる Teams アプリの違いは、それぞれ以下の通りです。</p><table><thead><tr><th>アプリ</th><th>機能</th></tr></thead><tbody><tr><td>Power Apps</td><td>Power Apps 自体の機能を提供します。<br> アプリの作成や編集、管理は全てこのアプリにより行われます。</td></tr><tr><td>Shared Power Apps</td><td>Power Apps で作成されたアプリを表示・使用する機能を提供します。<br>このアプリを使用することで、Teams 上の [アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] にアプリが表示されるようになり、個人の Teams 上で使用することが可能になります。</td></tr></tbody></table><table><thead><tr><th>アプリ</th><th>機能</th></tr></thead><tbody><tr><td>Power Virtual Agents</td><td>Power Virtual Agents 自体の機能を提供します。<br> ボットの作成や編集、管理は全てこのアプリにより行われます。</td></tr><tr><td>Shared Power Virtual Agents</td><td>Power Virtual Agents で作成されたボットを表示・使用する機能を提供します。<br>このアプリを使用することで、Teams 上の [アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] にボットが表示されるようになり、個人の Teams 上で使用することが可能になります。</td></tr></tbody></table><p>※参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/manage-power-platform-apps">Microsoft Teams 管理センターで Microsoft Power Platform アプリを管理する | Microsoft Docs</a></p><h3 id="2．カスタム-アプリとしてアプリやボットをアップロードする"><a href="#2．カスタム-アプリとしてアプリやボットをアップロードする" class="headerlink" title="2．カスタム アプリとしてアプリやボットをアップロードする"></a>2．カスタム アプリとしてアプリやボットをアップロードする</h3><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/built-by-your-org.png"></p><p>カスタム アプリとして Teams にアップロードされ、管理者により承認されたアプリは、Teams の [アプリ] &gt; [テナント向けに構築] &gt; [組織によって構築されている] からインストールすることが可能です。<br>なお、この [組織によって構築されている] には、アプリやボットへのアクセス権に関わらず、全てのユーザーにアップロードされたアプリが表示されます。(アプリのアクセス許可ポリシーにより制御されている場合を除く。)<br>※ Power Apps のキャンバス アプリの場合は、アプリがユーザーに共有されていないと使用できないため、アプリのアップロードに加え、任意のユーザーへの共有も行ってください。</p><p>アプリのアップロード方法はそれぞれ以下の通りです。</p><ul><li>Power Apps のキャンバスアプリ<br>  <a href="https://docs.microsoft.com/ja-jp/powerapps/teams/embed-teams-app">Teams でキャンバス アプリを個人用アプリとして埋め込む | Microsoft Docs</a> を参照</li><li>Power Virtual Agents のチャットボット<br>  <a href="https://docs.microsoft.com/ja-jp/power-virtual-agents/teams/publication-add-bot-to-microsoft-teams-teams#share-the-bot-with-your-organization">Teams で Microsoft Teams にボットを追加する #ボットを組織と共有する | Microsoft Docs</a> を参照</li></ul><p>管理者による Teams 管理センターからのアプリのアップロードや承認方法は以下をご参照ください。<br><a href="https://docs.microsoft.com/ja-jp/microsoftteams/upload-custom-apps">アプリ パッケージをアップロードしてカスタム アプリを発行する | Microsoft Docs</a></p><h2 id="環境を監視するには？"><a href="#環境を監視するには？" class="headerlink" title="環境を監視するには？"></a>環境を監視するには？</h2><hr><p>センター オブ エクセレンス (CoE) キットを使用すると、Dataverse for Teams の環境の監視およびクリーン アップが可能となります。<br>参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/guidance/coe/teams-governance">Microsoft Dataverse for Teams 環境管理 | Microsoft Docs</a></p><p>CoE スターター キットとは、Power Platform での管理や開発を支援するためのツールです。<br><a href="https://github.com/microsoft/powerapps-tools/tree/master/Administration/CoEStarterKit">GitHub リポジトリ</a> からダウンロードでき、Power Platform のソリューションとしてインストールされます。<br>詳細については、<a href="https://docs.microsoft.com/ja-jp/power-platform/guidance/coe/overview">公開情報</a> をご参照ください。</p><p>※注意事項<br><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/CoE-disclaimer.png"></p><h2 id="注釈"><a href="#注釈" class="headerlink" title="注釈"></a>注釈</h2><p>(※1) <a href="https://docs.microsoft.com/ja-jp/powerapps/teams/use-sample-apps-from-teams-store">公開情報</a>に記載のサンプル アプリをインストールすると、Dataverse for Teams 環境が自動で作成されます。<br>(※2) Microsoft 365 のライセンス数が 200,000 を超えるテナントに関しては、上限を引き上げたい場合、サポートまでお問合せください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの清水です。&lt;/p&gt;
&lt;p&gt;今回は、2020 年 9 月に 新たに Teams に統合された Power Platform の機能について、その管理・制御方法やよくお問合せいただく内容に関して、詳しくご説明いたします。&lt;/p&gt;
&lt;p&gt;ライセンスが Teams に組み込まれているという性質上、管理にお困りの方も多いかと思います。&lt;br&gt;この記事が皆様のお役に立ちましたら幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="Management" scheme="https://jpdynamicscrm.github.io/blog/tags/Management/"/>
    
    <category term="Dataverse for Teams" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse-for-Teams/"/>
    
  </entry>
  
  <entry>
    <title>キャンバス アプリ の委任について</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-delegation/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-delegation/</id>
    <published>2021-04-19T15:00:00.000Z</published>
    <updated>2021-06-18T13:13:37.029Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの清水です。<br>今回は、Power Apps のキャンバス アプリを使用する際に引っ掛かりがちな「委任」の制限について、かみ砕いてご説明いたします。</p><p>公開情報は<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/delegation-overview">こちら</a>。</p><span id="more"></span><h2 id="そもそも委任って何？"><a href="#そもそも委任って何？" class="headerlink" title="そもそも委任って何？"></a>そもそも委任って何？</h2><p>「委任」とは、Power Apps 上でのデータ操作 (Filter クエリなど) をアプリ上で行わず、データソース側で行い、キャンバス アプリはその結果のみを取得することで、アプリのパフォーマンスを向上させる仕組みのことを言います。</p><p>Power Apps で扱う業務データは非常に膨大になることも少なくないので、全てのデータを取得してから、アプリ上で Filter や Sort を行うことは現実的ではございません。<br>したがって、データ量を抑えて効率的なアプリを作成するために、データソースに委任できる処理はデータソース側でやってもらい、アプリでは処理結果を受け取るだけにしましょうね、という仕組みを提供しています。</p><h2 id="委任可能なデータソースと関数"><a href="#委任可能なデータソースと関数" class="headerlink" title="委任可能なデータソースと関数"></a>委任可能なデータソースと関数</h2><p>とはいえ、データソース側でも全ての処理を実行できるわけではございませんので、Power Apps から委任できるデータソースや処理の内容は限られています。</p><p>委任可能なデータソースは、現時点では以下のデータソースのみです。<br>それぞれ、委任可能な関数がデータソースによって異なりますので、コネクタのリファレンスをご参照ください。</p><ul><li><a href="https://docs.microsoft.com/ja-jp/connectors/commondataservice/#power-apps-delegable-functions-and-operations-for-dataverse">Microsoft Dataverse (旧名: Common Data Service)</a><br>※Dataverse では、プレビュー機能として CountRows, CountIf, First, in 演算子の委任もサポートしています。<br><img src="/blog/canvasapp/Canvas-app-delegation/img00.png"><br>(この設定は、既定でオンになっています。)</li><li><a href="https://docs.microsoft.com/ja-jp/connectors/sharepointonline/#power-apps-delegable-functions-and-operations-for-sharepoint">SharePoint</a></li><li><a href="https://docs.microsoft.com/ja-jp/connectors/sql/#power-apps-delegable-functions-and-operations-for-sql-server">SQL Server</a></li></ul><h2 id="委任できない場合どうなるの？"><a href="#委任できない場合どうなるの？" class="headerlink" title="委任できない場合どうなるの？"></a>委任できない場合どうなるの？</h2><p>委任できないデータソースや関数を使用した場合、Power Apps では、一度データソースから全てのデータをメモリ上にダウンロードします。<br>ただし、あまりにも大量のデータを取得すると、アプリのパフォーマンスに大きな影響が出るため、取得できるデータ量は限られています。</p><p>一度に取得できるデータ件数の最大は、アプリの「委任できないクエリのデータ行の制限」の設定項目から確認できます。</p><p>[ファイル] &gt; [設定] &gt; [詳細設定]<br><img src="/blog/canvasapp/Canvas-app-delegation/img01.png"></p><p>データ行の制限は、既定で 500 、最大で 2000 まで変更可能ですので、キャンバス アプリに一度で取得できるデータの最大行数は 2000 行となります。</p><p>つまり、委任できないデータソースを使用している場合、また委任できない関数や演算子を使用している場合、データソースから上位 2000 件のみを取得し、アプリ上でクエリ処理を実行することとなります。</p><p>以下の例を見てみましょう。</p><p><img src="/blog/canvasapp/Canvas-app-delegation/img02.png"></p><p>データソースには全部で 510 件のデータがあり、「委任できないクエリのデータ行の制限」は 500 に設定されています。<br>Filter 処理により、300 番目のデータと 510 番目のデータが取得されると仮定すると、</p><ul><li>委任がサポートされている場合、Power Apps では、Filter 処理の結果である 2 行のみを取得できます。</li><li>委任がサポートされていない場合、データソースの上位 500 行をアプリ上に取得してから Filter 処理が行われるため、得られる結果は 300 番目のデータのみとなり、510 番目のデータを得ることができません。</li></ul><p>※ただし、ギャラリーを使用している場合は、Items プロパティの式が委任できるように記述されていれば、スクロールに伴って随時データソースと通信し、データの取得を行う動作となるので、ご安心ください。</p><h2 id="委任可能なケースの落とし穴"><a href="#委任可能なケースの落とし穴" class="headerlink" title="委任可能なケースの落とし穴"></a>委任可能なケースの落とし穴</h2><p>「委任ができるデータソース・関数を使用しているから問題ない」と思っている方、実は、委任できるからと言って、どんなに大量のデータでも取得できるわけではないので、要注意です。</p><p>「委任できないクエリのデータ行の制限」という設定項目について説明しましたが、これは、委任ができるデータにも当てはまります。<br>つまり、Power Apps が一度に取得できるデータ行は、結局は最大で 2000 件なのです。<br>そのため、データソースにクエリを委任した結果、データ件数が 2500 件になってしまった場合、クエリ結果のうち 2000 件までしか取得できないので、残りの 500 件については置き去りにされてしまいます。</p><h3 id="では、どうすれば良いのか？？"><a href="#では、どうすれば良いのか？？" class="headerlink" title="では、どうすれば良いのか？？"></a>では、どうすれば良いのか？？</h3><p>「委任できないクエリのデータ行の制限」は、あくまでも<strong>一度に</strong>取得可能なデータ行の制限です。<br>2000 行を超えるデータを取得したい場合は、複数回に分けてデータを取得し、コレクションに追加するようにしましょう。<br>コレクションには、格納できるデータ件数に上限はございません。</p><p><img src="/blog/canvasapp/Canvas-app-delegation/img03.png"></p><h3 id="Tips-複数回に分けてデータをコレクションに取得？？"><a href="#Tips-複数回に分けてデータをコレクションに取得？？" class="headerlink" title="Tips - 複数回に分けてデータをコレクションに取得？？"></a>Tips - 複数回に分けてデータをコレクションに取得？？</h3><p>複数回に分けてデータを取得する動作は、例えば以下のような数式で実現できます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 委任可能件数以上に格納するためのコレクション</span><br><span class="line">Clear(col) </span><br><span class="line"></span><br><span class="line">// 委任制限まで件数を分割するためのコレクション (委任制限が 100 件の場合)</span><br><span class="line">// Sequence は繰り返しの件数を指定 (例では 100 件 * 10 回なので、 999 件まで対応可能)</span><br><span class="line">ClearCollect(Num, </span><br><span class="line">    AddColumns(</span><br><span class="line">        Sequence(10), </span><br><span class="line">        &quot;Min&quot;, (Value - 1) * 100, </span><br><span class="line">        &quot;Max&quot;, Value * 100</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// 複数回に分けてアイテムを取得</span><br><span class="line">ForAll(Num,</span><br><span class="line">    Collect(Col, FIlter(データソース, IDCount &lt; Max, IDCount &gt;= Min));</span><br><span class="line">)</span><br><span class="line">/*</span><br><span class="line">SharePoint の ID 列は数値だが=以外の演算子の委任をサポートしていないため、ID と同じ値を持つ IDCount 列を作成して使用。</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><p><img src="/blog/canvasapp/Canvas-app-delegation/img04.png"><br>※サンプルコードなので、動作検証はしっかりと行ってください。</p><p>ご参考まで。</p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>以上、Power Apps キャンバス アプリの委任の動作についてご説明しました。<br>公開情報を読むと、小難しい制限に思われるかもしれませんが、理解してしまえば簡単ですよね。<br>委任をしっかりと理解し、正しくキャンバス アプリを作成する手助けになりましたら幸いです。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの清水です。&lt;br&gt;今回は、Power Apps のキャンバス アプリを使用する際に引っ掛かりがちな「委任」の制限について、かみ砕いてご説明いたします。&lt;/p&gt;
&lt;p&gt;公開情報は&lt;a href=&quot;https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/delegation-overview&quot;&gt;こちら&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    
    <category term="CanvasApp" scheme="https://jpdynamicscrm.github.io/blog/tags/CanvasApp/"/>
    
    <category term="delegation" scheme="https://jpdynamicscrm.github.io/blog/tags/delegation/"/>
    
  </entry>
  
  <entry>
    <title>Japan Dynamics CRM &amp; Power Platform Support Blog 開設のお知らせ</title>
    <link href="https://jpdynamicscrm.github.io/blog/information/test/"/>
    <id>https://jpdynamicscrm.github.io/blog/information/test/</id>
    <published>2021-03-31T15:00:00.000Z</published>
    <updated>2021-06-18T13:13:37.033Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、日本マイクロソフト Dynamics CRM &amp; Power Platform サポート チームです。</p><p>この度、GitHub Blog にてサポートブログを開設いたしました！<br>本ブログでは、日本マイクロソフト Dynamics CRM &amp; Power Platform サポート チームに所属する社員より、皆様のお役に立てる情報の発信に努めてまいりますので、ぜひご参照いただけますと幸いです。</p><span id="more"></span><p>なお、これまで Microsoft Technet に掲載していた記事は、随時本 GitHub Blog の Archive に移行を進めてまいります。<br>製品の特性上、情報が古くなってしまった記事につきましては移行しない場合がございますため、あらかじめご了承ください。</p><p>本 Blog が、皆様のお役にたてれば幸いです。<br>今後ともよろしくお願いたします。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、日本マイクロソフト Dynamics CRM &amp;amp; Power Platform サポート チームです。&lt;/p&gt;
&lt;p&gt;この度、GitHub Blog にてサポートブログを開設いたしました！&lt;br&gt;本ブログでは、日本マイクロソフト Dynamics CRM &amp;amp; Power Platform サポート チームに所属する社員より、皆様のお役に立てる情報の発信に努めてまいりますので、ぜひご参照いただけますと幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Information" scheme="https://jpdynamicscrm.github.io/blog/tags/Information/"/>
    
  </entry>
  
</feed>
