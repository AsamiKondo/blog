<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  
  <subtitle>日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</subtitle>
  <link href="https://jpdynamicscrm.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpdynamicscrm.github.io/blog/"/>
  <updated>2022-09-14T03:11:01.138Z</updated>
  <id>https://jpdynamicscrm.github.io/blog/</id>
  
  <author>
    <name>Japan Dynamics CRM &amp; Power Platform Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>非アクティブな Microsoft Dataverse for Teams 環境の自動削除について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/</id>
    <published>2022-09-06T03:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.138Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br><br>今回は、Dataverse for Teams 環境の自動削除について、下記項目の順にご説明いたします。<br>・Dataverse for Teams環境の自動無効化/削除メカニズムとは<br>・自動無効化/削除条件<br>・自動無効化/削除メカニズム自体の無効化の可否<br>・無効化/削除された環境の復元<br>・ご案内メール<br>・ご案内メールを受信された際の対応<br>・よくあるご質問  </p><p>下記公開情報を基にご説明いたします。<br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/inactive-teams-environment">非アクティブな Microsoft Dataverse for Teams 環境の自動削除</a><br>各項目について公開情報内にも詳細を記載しておりますのでご参照ください。   </p><p>なお、対象はあくまでDataverse for Teams環境となります。<br>環境が紐づいているチーム自体が削除されるわけではございませんので、ご安心ください。   </p><span id="more"></span>  <h2 id="lt-初めに-本メカニズムの停止について-gt"><a href="#lt-初めに-本メカニズムの停止について-gt" class="headerlink" title="&lt;初めに -本メカニズムの停止について-&gt;"></a><strong>&lt;初めに -本メカニズムの停止について-&gt;</strong></h2><p>本メカニズムのメール通知について多数のお客様からのお問い合わせをいただいており、<br>メール通知の内容に分かりづらい点が多く混乱を招く状況となっております。<br><br><br>そのため、2022年9月14日時点、すでに展開されているDataverse for Teams環境の無効化に関する本メカニズムは停止されております。<br>本メカニズムの公開は一旦延期されることになりました。<br><br><br>メール通知を受け取られたお客様には大変ご心配をおかけしておりますが、送付されましたDataverse for Teams環境の削除に<br>関する通知につきましては、無視いただいても問題ございませんのでご安心ください。<br><br><br>改めて本メカニズムが公開される際にはメッセージセンター等にて通知させていただく予定でございますので、<br>その際にはご確認いただけますと幸いでございます。<br><br></p><p>なお、本メカニズムの停止に伴いまして、後述の「環境活動をトリガーする」機能も無効化されております。<br>しかしながら、Power Platform 管理センター上の無効化の警告、および「環境活動をトリガーする」機能は表示されたままとなっており、<br>「環境活動をトリガーする」を実行しても無効化の警告表示が消えないとのお問い合わせを受けております。<br>本メカニズム自体が停止されているため、本来は無効化の警告自体も表示されないべきですが、<br>本記事執筆時点では警告が表示されたままとなってしまっております。<br><br><br>ご混乱をお招きし大変申し訳ございません。<br>無効化の警告が表示されていても無視していただいて問題ございませんので、ご安心ください。<br><br></p><p>再度本メカニズムが有効化された際には、その7日後に対象環境が無効化される動きとなる予定でございますので、<br>再有効化後に「環境活動をトリガーする」をご実行いただけますと幸いでございます。<br><br></p><p>下図は本メカニズムの停止に関するメッセージセンターの通知となります。<br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/message-center-rollout.png"><br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除メカニズムとは-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除メカニズムとは-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除メカニズムとは&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除メカニズムとは&gt;</strong></h2><p>本メカニズムは2022年８月末より徐々に展開されております。<br>設定された一定期間（非アクティブ期間）中、ユーザーによる活動のないDataverse for Teams環境が無効化されます。<br>無効化状態が30日継続しますと、対象環境が自動削除されます。<br></p><p>無効化された環境では、アプリやフロー、チャットボット等がご利用いただけません。<br></p><p>設定可能な非アクティブ期間は次の通りでございます。<br>・15 日、30 日、45 日、60 日、および 90 日間<br></p><p>デフォルトでは90日となっております。<br></p><p>ただし、現時点では期間変更機能は未リリースであり、今後追ってリリースされる予定でございます。<br>恐れ入りますが、機能の展開をお待ちくださいますようお願い申し上げます。<br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除条件-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除条件-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除条件&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除条件&gt;</strong></h2><p>対象環境におけるユーザーのアプリ起動などの活動が設定期間中に実施されない場合、自動削除の対象となります。<br><br>対象の活動は下記の通りです。<br><br>・ユーザーの活動: アプリの起動、フローの実行、Power Virtual Agents ボットとのチャット<br><br>・作成者の活動: アプリ、フロー 、Power Virtual Agents ボット、カスタムコネクタの作成、読み取り、更新、削除<br><br>・管理者の活動: コピー、削除、バックアップ、復元、リセットなどの環境操作<br><br><br></p><h2 id="lt-Dataverse-for-Teams環境の自動無効化-削除メカニズム自体の無効化の可否-gt"><a href="#lt-Dataverse-for-Teams環境の自動無効化-削除メカニズム自体の無効化の可否-gt" class="headerlink" title="&lt;Dataverse for Teams環境の自動無効化/削除メカニズム自体の無効化の可否&gt;"></a><strong>&lt;Dataverse for Teams環境の自動無効化/削除メカニズム自体の無効化の可否&gt;</strong><br></h2><p>本メカニズムは無効化いただくことが出来ません。<br><br>何卒ご理解いただけますと幸いでございます。<br><br><br></p><h2 id="lt-自動無効化-削除された環境の復元-gt"><a href="#lt-自動無効化-削除された環境の復元-gt" class="headerlink" title="&lt;自動無効化/削除された環境の復元&gt; "></a><strong>&lt;自動無効化/削除された環境の復元&gt;</strong> <br></h2><p>環境無効化後、30日以内であれば環境の再有効化が可能でございます。<br><br>また、環境削除後も、7日以内であれば環境の復元が可能でございます。<br><br>どちらもPower Platform 管理センターよりご実施いただけます。<br></p><p>・無効にした Dataverse for Teams 環境の再有効化<br><br>①Power Platform 管理センター にサインイン<br><br>②環境　＞　無効化された Dataverse for Teams 環境を選択<br><br>③環境ページで 「環境を再度有効にする」 を選択<br></p><p>・削除された Dataverse for Teams 環境の復元<br><br>①Power Platform 管理センター にサインイン<br><br>②環境　＞　削除された環境を復元する　を選択<br><br>③回復する環境　＞　回復 を選択<br><br><br> 　　  </p><h2 id="lt-ご案内メール-gt"><a href="#lt-ご案内メール-gt" class="headerlink" title="&lt;ご案内メール&gt; "></a><strong>&lt;ご案内メール&gt;</strong> <br></h2><p>対象環境の無効化が実施される７日前より、その旨についてのご案内メールが次のユーザーに通知されます。<br><br>・対象Dataverse for Teams環境のチームの所有者<br><br>・対象Dataverse for Teams環境の作成者<br><br>・システム管理者<br><br></p><p>環境が無効化される旨のご案内メールは下図のようなものになります。<br><br>黒塗りのマスキング部分に対象環境名が記載されます。<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/announce-mail.jpg"><br><br><br></p><h2 id="lt-無効化対象のご案内メールを受信された際の対応-gt"><a href="#lt-無効化対象のご案内メールを受信された際の対応-gt" class="headerlink" title="&lt;無効化対象のご案内メールを受信された際の対応&gt;"></a><strong>&lt;無効化対象のご案内メールを受信された際の対応&gt;</strong><br></h2><p>下記2通りの方法にて、無効化対象となる非アクティブな期間のカウントを一旦リセットいただけます。<br><br>・対象環境において、アプリやフローのご実行など上述のユーザー活動を実施<br><br>・Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」を実行<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/trigger-button.png"><br><br></p><h2 id="lt-よくあるご質問-gt"><a href="#lt-よくあるご質問-gt" class="headerlink" title="&lt;よくあるご質問&gt; "></a><strong>&lt;よくあるご質問&gt;</strong> <br></h2><p>Q：メッセージセンターの番号は?<br><br>A：MC415083 となります。<br><br>該当メッセージURL:<a href="https://admin.microsoft.com/adminportal/home?ref=MessageCenter/:/messages/MC415083">https://admin.microsoft.com/adminportal/home?ref=MessageCenter/:/messages/MC415083</a><br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/message-center.png"><br><br><br></p><p>Q：Dataverse for Teams環境とは何か。無効化された場合、どのような影響があるか?<br><br>A：Microsoft Dataverse for Teams 環境は、チームにDataverse機能を使用したアプリを追加した場合や、<br><br>チーム内にチャットボットやPower Appsキャンバスアプリ等を作成した場合に作成される環境です。<br><br>無効化されると、環境内に作成されていたアプリやフロー、チャットボット等がご利用いただけなくなります。<br><br>具体的なシナリオや詳細について、以下の記事にて解説しておりますので、よろしければご参照ください。<br><br><a href="https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/">Dataverse for Teams 環境の管理方法</a><br><br><br></p><p>Q：Dataverse for Teams環境にて無効化される際に配信される通知メールを配信停止することは可能か?<br><br>A：恐れ入りますが、メール配信を停止することのできる機能はございません。<br><br>製品動作としてご理解賜りますようお願い申し上げます。<br><br><br></p><p>Q：Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」の実効は、通常ユーザにて操作可能なものか?<br><br>A：Power Platform管理センターにてDataverse for Teams環境の「環境活動をトリガーする」を実行できるユーザーは以下の通りでございます。<br><br>・対象Dataverse for Teams環境のチームの所有者<br><br>・対象Dataverse for Teams環境の作成者<br><br>・グローバル管理者<br><br>・Power Platform管理者<br><br>・Dynamics 365管理者<br><br><br></p><p>Q：「環境活動をトリガーする」を実行すると、有効期限は何日まで延びるのか?<br><br>A：有効期限は90日間延長され、その90日の期間中に、対象環境におけるユーザーのアプリ起動などの活動が実施されない場合、<br><br>再び自動削除の対象となり、7日前（トリガー実行から83日後）にメールにて通知されます。<br><br><br></p><p>Q：無効化される環境内のアプリ当の詳細については、どこから確認できるか?<br><br>A：下記より対象環境内のアプリ等をご確認いただけます。<br><br>Power Platform 管理センター　＞　環境　＞　対象環境　＞　リソース　＞　Power Apps/フロー<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Microsoft-Dataverse-for-Teams-environments/resources.png"><br><br><br></p><p>Q：再有効化した場合、無効化前の情報が維持されるか?<br><br>A：再有効化後または復元後は、無効前の情報が維持されます。<br><br>削除されてしまいますと、無効化前の情報は復元できなくなりますのでご注意ください。<br><br><br></p><p>免責事項<br><br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br&gt;&lt;br&gt;今回は、Dataverse for Teams 環境の自動削除について、下記項目の順にご説明いたします。&lt;br&gt;・Dataverse for Teams環境の自動無効化/削除メカニズムとは&lt;br&gt;・自動無効化/削除条件&lt;br&gt;・自動無効化/削除メカニズム自体の無効化の可否&lt;br&gt;・無効化/削除された環境の復元&lt;br&gt;・ご案内メール&lt;br&gt;・ご案内メールを受信された際の対応&lt;br&gt;・よくあるご質問  &lt;/p&gt;
&lt;p&gt;下記公開情報を基にご説明いたします。&lt;br&gt;&lt;a href=&quot;https://docs.microsoft.com/ja-jp/power-platform/admin/inactive-teams-environment&quot;&gt;非アクティブな Microsoft Dataverse for Teams 環境の自動削除&lt;/a&gt;&lt;br&gt;各項目について公開情報内にも詳細を記載しておりますのでご参照ください。   &lt;/p&gt;
&lt;p&gt;なお、対象はあくまでDataverse for Teams環境となります。&lt;br&gt;環境が紐づいているチーム自体が削除されるわけではございませんので、ご安心ください。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerApps" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerApps/"/>
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="DataverseforTeams" scheme="https://jpdynamicscrm.github.io/blog/tags/DataverseforTeams/"/>
    
  </entry>
  
  <entry>
    <title>PowerAutomateからPowerAppsへのデータ送信について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerapps/Send_data_from_automate_to_apps/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerapps/Send_data_from_automate_to_apps/</id>
    <published>2022-08-31T03:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.078Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Apps サポートの深津です。<br>今回は、Power Automate から Power Apps へデータを送信する方法についてご説明いたします。</p><span id="more"></span><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-premium-connecter">プレミアムコネクタを使用する場合</a></li><li><a href="#anchor-standard-connecter">標準コネクタを使用する場合</a></li><li><a href="#anchor-finish">おわりに</a></li></ol><p><a id='anchor-Intro'></a></p><hr><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>Power Automate で取得したデータを Power Apps で表示したい時があると思います。<br>今回はプレミアムコネクタを使用する場合と標準コネクタを使用する場合の２種類の方法をご説明いたします。<br>ライセンス状況に基づいて方法を選択していただければと思います。</p><h4 id="今回送信するデータ"><a href="#今回送信するデータ" class="headerlink" title="今回送信するデータ"></a>今回送信するデータ</h4><p>SharePointのリストに格納されている商品名、金額、個数の3列からなるデータを Power Automate で取得し、 Power Apps に送信することを想定します。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/sample_sharepoint_list.PNG">  </p><hr><p><a id='anchor-premium-connecter'></a></p><h2 id="プレミアムコネクタを使用する場合"><a href="#プレミアムコネクタを使用する場合" class="headerlink" title="プレミアムコネクタを使用する場合"></a>プレミアムコネクタを使用する場合</h2><h4 id="必要なライセンス"><a href="#必要なライセンス" class="headerlink" title="必要なライセンス"></a>必要なライセンス</h4><p>今回作成するフローではプレミアム コネクタを使用するため、 <a href="https://powerapps.microsoft.com/ja-jp/pricing/">PowerAppsの有償ライセンス</a>が必要です。  </p><h4 id="Power-Automate-の説明"><a href="#Power-Automate-の説明" class="headerlink" title="Power Automate の説明"></a>Power Automate の説明</h4><p>フローの全体図は下記の通りです。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/premium_connecter_flow_1.PNG"><img src="/blog/powerapps/Send_data_from_automate_to_apps/premium_connecter_flow_2.PNG"></p><p>フローの流れについてご説明いたします。</p><ol><li>Power Apps からフローを呼び出せるように Power Apps (V2)トリガーを挿入します。</li><li>「変数を初期化する」のアクションでSharePointの商品リストを格納するための変数を定義します。以後この変数を商品リスト変数と呼ぶことにします。</li><li>「複数の項目を取得」のアクションでSharePointの商品リストの情報を取得します。</li><li>「作成」のアクションで必要な情報（Title、金額、個数）の JSONを定義し、「配列変数に追加」のアクションで商品リスト変数に追加します。</li><li>「変数を初期化する２」のアクションで商品リスト変数のアレイ型の構造を確認します。</li><li>「応答」のアクションで商品リストの情報を Power Apps に送信します。また、応答アクション内のパラメータは以下の手順で設定します。<br>　　6-1. まず、一度フローを実行し、手順５の実行結果の値をコピーします。</li></ol><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/item_array.PNG"></p><p>　　6-2. 応答アクションのサンプルから生成をクリックし、先程コピーした値をペースト、完了ボタンを押します。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/outou_parameter.PNG"></p><p>　　6-3. 完了すると以下の画像のようにJSONスキーマが定義されていることが確認できます。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/outou_flow.PNG"></p><h2 id="Power-Apps-の説明"><a href="#Power-Apps-の説明" class="headerlink" title="Power Apps の説明"></a>Power Apps の説明</h2><p>今回、Power Appsで簡単なアプリを作成しました。ボタンをクリックすることで先程作成したフローが動き、商品リストが表示されるものです。<br>ボタンのOnselectプロパティーにClearCollect(適当な変数名, Power Automate のフロー名.Run())を記載することで変数にフローの出力データを格納することが可能です。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/powerapps_result.PNG"></p><p><a id='anchor-standard-connecter'></a></p><hr><h2 id="標準コネクタを使用する場合"><a href="#標準コネクタを使用する場合" class="headerlink" title="標準コネクタを使用する場合"></a>標準コネクタを使用する場合</h2><h4 id="Power-Automate-の説明-1"><a href="#Power-Automate-の説明-1" class="headerlink" title="Power Automate の説明"></a>Power Automate の説明</h4><p>次は、標準コネクタを使用する場合についてご説明いたします。<br>フローの全体図は下記の通りです。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/standard_connecter_flow.PNG"></p><p>標準コネクタでは「応答」アクションの代わりに「PowerApp または Flow に応答する」アクションを使用します。<br>フロー作成手順についてはプレミアムコネクタの説明の１～５までは同様です。その続きは以下の手順になります。<br>6. 「データ操作＞ JSON の解析」のアクションを追加します。「サンプルから生成」に手順５の実行結果を入力します。<br>7. 「データ操作＞選択」のアクションで手順６の結果を文字列に変換します。今回は、商品名、金額、個数の値が欲しいため、それらの値をマップの内容とします。このときにマップのキーの値を英数字や記号等の半角文字で記載することに注意してください。後にPower Appsで受け取った文字列をMatchAll関数で解析する際に日本語判定ができないためです。<br>8. 「PowerApp または Flow に応答する」のアクションで商品リストの情報を Power Apps に送信します。<br>パラメータとして名称には任意の値、式には「出力」（手順７の出力結果）を選択します。その際に、「出力」という動的なコンテンツが出てこない場合があります。その時は、以下の画像のように式で（）を挿入してから動的なコンテンツに戻ることで「出力」という動的なコンテンツが出てきます。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/outou_standard_point.PNG"></p><h4 id="Power-Apps-の説明-1"><a href="#Power-Apps-の説明-1" class="headerlink" title="Power Apps の説明"></a>Power Apps の説明</h4><p>プレミアムコネクタの時と同様にボタンをクリックすることで先程作成したフローが動き、商品リストが表示されるものを作成しました。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/powerapps_result.PNG"></p><p>プレミアムコネクタを使用する場合と比較して標準コネクタを使用する場合は Power Apps 上で文字列を正規表現で解析する必要があります。<br>作成手順は以下の通りです。</p><ol><li>ボタンの設置、Power Automate のフローの読み込みを行います。</li><li>ボタンのOnSelectプロパティを以下のように設定します。<br>　　2-1. 初めに、Set(変数,フロー名.Run())で Power Automate のフローの出力を変数に格納します。<br>　　2-2. 次に、MatchAll関数を用いて文字列を正規表現で解析し、テーブルに格納します。黄色の部分の正規表現は適宜ご変更ください。正規表現を作成の際のヒントをこの章の最下部に載せています。ご参考になれば幸いです。<br>　　2-3. 最後に、テーブルの行が1行以上ある場合、ClearCollect関数を用いて必要な列からなるテーブルを作成します。紫色の部分についても必要な列に応じてご変更ください。</li></ol><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/standard_botton_onselect_1.PNG"><br><img src="/blog/powerapps/Send_data_from_automate_to_apps/standard_botton_onselect_2.PNG"><br><img src="/blog/powerapps/Send_data_from_automate_to_apps/standard_botton_onselect_3.PNG"></p><p>正規表現作成の際のヒントを記載します。<br>下記画像の文字列①の情報をテーブルに変換する際の正規表現は正規表現①、文字列②の場合は正規表現②になります。<br>ここで注意していただきたいのが文字列の色がついている部分です。この部分は「取得したい文字列」の次にある文字を示しており、それに伴い正規表現のカラー部分も変更する必要があります。<br>例えば文字列①のように取得したい値の次の文字が「”」の場合、正規表現も緑の色のように「””」で表します。<br>また、文字列②の黄色の部分のように取得したい文字列の次の文字が「,」の場合、正規表現中の黄色の部分は「,」、水色の部分のように取得したい文字列の次の文字が「}」の場合、正規表現中の水色の部分は「\＋}」で表します。<br>※水色の部分を「}」ではなく「\＋}」と表す理由は、正規表現では、「}」は特殊文字なので「}」自体として扱わず、「\＋}」と表記することで「}」それ自体を表すためです。</p><p><img src="/blog/powerapps/Send_data_from_automate_to_apps/seikihyougen_hint.PNG"></p><hr><p><a id='anchor-finish'></a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>今回紹介した方法を使用することでPower Automate で取得した様々な情報を Power Apps で表示することができます。<br>ぜひ、色々なシーンで活用してみてください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Apps サポートの深津です。&lt;br&gt;今回は、Power Automate から Power Apps へデータを送信する方法についてご説明いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="PowerAutomate" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerAutomate/"/>
    
  </entry>
  
  <entry>
    <title>モデル駆動型アプリにアクセスできないときの対処法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Cannot-Access-Model-Driven-Apps/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Cannot-Access-Model-Driven-Apps/</id>
    <published>2022-08-26T06:50:00.000Z</published>
    <updated>2022-09-14T03:11:01.142Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの鎌田です。</p><p>本記事では、モデル駆動型アプリにアクセスできないときの対処法についてご案内いたします。</p><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#app-access-checker-%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%8B%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B">App Access Checker を使ってユーザーがアプリにアクセスできるか確認する</a></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6">ライセンスの割り当て</a></li><li><a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3-%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6">セキュリティ ロールの割り当て</a></li><li><a href="#%E8%A3%9C%E8%B6%B3">補足</a></li><li><a href="#%E6%B3%A8%E9%87%88">注釈</a></li><li><a href="#%E5%8F%82%E8%80%83%E6%83%85%E5%A0%B1">参考情報</a></li></ul><h2 id="App-Access-Checker-を使ってユーザーがアプリにアクセスできるか確認する"><a href="#App-Access-Checker-を使ってユーザーがアプリにアクセスできるか確認する" class="headerlink" title="App Access Checker を使ってユーザーがアプリにアクセスできるか確認する"></a>App Access Checker を使ってユーザーがアプリにアクセスできるか確認する</h2><p>モデル駆動型アプリをユーザーが閲覧するためには、以下の2点が必要となります。</p><ul><li>ユーザーにアプリを使用するための<strong>ライセンス</strong>が割り当てられていること</li><li>ユーザーにアプリを使用できる<strong>セキュリティ ロール</strong> <a href="#%E6%B3%A8%E9%87%88">(※1)</a> が割り当てられていること</li></ul><p><strong>App Access Checker</strong> を使用することで、ユーザーがアプリを使用するためのライセンスとセキュリティの条件を満たしているかを確認することができます。<br>以下の手順では、App Access Checker を使って、ユーザーのアプリ使用に関するライセンスとセキュリティを確認する方法についてご説明いたします。</p><ol><li><p>全体管理者権限を持ったユーザー アカウントで、<a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a> へサインインします。</p></li><li><p>左ペインより [環境] をクリックし、ユーザーがアプリにアクセスできない事象が発生しているインスタンスをクリックします。</p></li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/00_environments.png"></p><ol start="3"><li>事象が発生しているインスタンスが開いたら、画面右の [アクセス] タブ内から [ユーザー] の下の [すべて表示] をクリックします。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/01_users.png"></p><ol start="4"><li>設定ページへの遷移後、[アプリ アクセス チェッカーに移動します。] のリンクをクリックします。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/02_setting-user.png"></p><ol start="5"><li>App Access Checker のページへ遷移したら、左上のテキスト ボックスに、アプリにアクセスできないアカウントのユーザー ID またはメール アドレスを入力し、[Search] ボタンをクリックすることで、ユーザー アカウントのアプリ使用に関する情報を閲覧することができます。<br>このとき、License および Security が Yes と表示されていれば、Visible も Yes となり、当該ユーザー アカウントでインスタンス内のアプリを使用できることを意味します。<br>License または Security で No と表示されている場合、次の <a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6">ライセンスの割り当て</a> または <a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3-%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6">セキュリティ ロールの割り当て</a> の操作をお試しください。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/03_access-checker.png"></p><h2 id="ライセンスの割り当て"><a href="#ライセンスの割り当て" class="headerlink" title="ライセンスの割り当て"></a>ライセンスの割り当て</h2><p>App Access Checker にて、アカウントの License が No と表示されている場合、適切なライセンス <a href="#%E6%B3%A8%E9%87%88">(※2)</a> の割り当てが必要です。<br>以下の手順でライセンスの割り当てが可能です。</p><ol><li><p>ライセンス割り当ての権限を持つ管理者アカウントを使用して、<a href="https://admin.microsoft.com/">Microsoft 365 管理センター</a> にアクセスします。</p></li><li><p>左ペインより、[ユーザー] &gt; [アクティブなユーザー] に移動し、ライセンスを割り当てるユーザーを選択します。そのユーザーの設定がポップアップで開きます。</p></li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/04_active-users.png"></p><ol start="3"><li>ポップアップの [ライセンスとアプリ] タブを選択し、ユーザーに割り当てたいライセンスにチェックをつけ、[変更の保存] をクリックすることで、ユーザーへライセンスの割り当てが完了します。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/05_license.png"></p><h2 id="セキュリティ-ロールの割り当て"><a href="#セキュリティ-ロールの割り当て" class="headerlink" title="セキュリティ ロールの割り当て"></a>セキュリティ ロールの割り当て</h2><p>App Access Checker にて、アカウントの Security が No と表示されている場合、適切なセキュリティ ロールの割り当てが必要です。<br>以下の手順でセキュリティ ロールの割り当てが可能です。</p><ol><li><p>管理者権限を持ったユーザー アカウントで、<a href="https://make.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc">Power Apps</a> にサインインします。</p></li><li><p>左ペインから [アプリ] を選択後、ユーザーにアクセスを許可したいアプリの […] を押して出現するポップアップの [共有] をクリックします。</p></li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/06_apps_num.png"></p><ol start="3"><li>この操作により、指定したセキュリティ ロールが割り当てられたユーザー アカウントに対して、一括でこのアプリへのアクセスを許可することができます。<br>3-1. アプリ名左にチェックをつけ、下図②のテキスト ボックスをクリックすると、中央にカスタム ロールの管理をするポップアップが現れます。<br>3-2. アプリへのアクセスを許可するセキュリティ ロールにチェックをつけ、[共有] ボタンを押して変更を保存します。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/07_security-role_num.png"></p><ol start="4"><li>手順 3 では、特定のセキュリティ ロールを持つユーザー アカウントをまとめてアクセスできるように指定する方法を紹介しましたが、個別のユーザーごとにアクセスを許可する方法についても紹介します。<br>4-1. [ユーザー] の下のテキスト ボックスからアクセスを許可したいアカウントを検索し、下図②のようにチェックを入れます。<br>4-2. 下図③をクリックすると、アプリケーションへのアクセスが許可されているセキュリティ ロールが表示されるため、アクセスを許可したいアカウントへ割り当てたいセキュリティ ロールにチェックをつけて [共有] ボタンを押すことで変更を保存します。</li></ol><p><img src="/blog/powerplatform/Cannot-Access-Model-Driven-Apps/08_security-role2_num.png"></p><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><ul><li>App Access Checker は次のように URL を編集してアクセスすることも可能です。<br>&lt;orgURL&gt;/WebResources/msdyn_AppAccessChecker.html<br>例 : <a href="https://sample.crm7.dynamics.com//WebResources/msdyn_AppAccessChecker.html">https://sample.crm7.dynamics.com//WebResources/msdyn_AppAccessChecker.html</a><br>※ sample の部分を適切な文字列に置き換えてください。</li></ul><h2 id="注釈"><a href="#注釈" class="headerlink" title="注釈"></a>注釈</h2><ul><li>(※1) セキュリティ ロールとは、営業担当者などの異なるユーザーが異なる種類のレコードにどのようにアクセスできるかを定義する機能のことです。詳しくは、<a href="https://docs.microsoft.com/ja-jp/power-platform/admin/security-roles-privileges#security-roles">こちら</a> をご覧ください。</li><li>(※2) アプリへのアクセスに必要なライセンスについては以下をご覧ください。<ul><li><a href="https://dynamics.microsoft.com/ja-jp/pricing/">価格 | Microsoft Dynamics 365</a></li><li><a href="https://powerapps.microsoft.com/ja-jp/pricing/">価格 - Power Apps</a></li><li><a href="https://go.microsoft.com/fwlink/p/?LinkId=866544">Licensing Guideのダウンロードリンク</a></li></ul></li></ul><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><table><thead><tr><th>リンク</th><th>内容</th></tr></thead><tbody><tr><td><a href="https://community.dynamics.com/crm/f/microsoft-dynamics-crm-forum/427100/how-to-access-app-access-checker-to-see-role-privileges-needed-for-appmodule-entity-to-see-and-launch-model-app">How to access “App Access Checker” to see Role &amp; Privileges needed for AppModule Entity to see and launch model app</a></td><td>本記事で紹介した App Access Checker のアクセスについて解説している英語記事です。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/dynamics365/marketing/admin-users-licenses-roles">Manage user accounts, user licenses, and security roles</a></td><td>Dynamics 365 のモデル駆動型アプリに必要な、ライセンスとセキュリティ ロールの割り当てについて解説している英語記事です。</td></tr><tr><td><a href="https://docs.microsoft.com/ja-jp/power-apps/maker/model-driven-apps/model-app-faq">モデル駆動型アプリのよく寄せられる質問</a></td><td>解説している内容としてはタイトルの通りですが、インスタンス内のアプリがユーザーに表示されない原因について触れています。</td></tr><tr><td><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/security-roles-privileges">セキュリティ ロールおよび特権</a></td><td>本記事でアプリのアクセスを許可するために使用したセキュリティ ロールについて解説をしております。</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの鎌田です。&lt;/p&gt;
&lt;p&gt;本記事では、モデル駆動型アプリにアクセスできないときの対処法についてご案内いたします。&lt;/p&gt;
&lt;h2 id=&quot;目次&quot;&gt;&lt;a href=&quot;#目次&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="App Access Checker" scheme="https://jpdynamicscrm.github.io/blog/tags/App-Access-Checker/"/>
    
    <category term="ライセンス" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9/"/>
    
    <category term="セキュリティ ロール" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3-%E3%83%AD%E3%83%BC%E3%83%AB/"/>
    
  </entry>
  
  <entry>
    <title>サポート インスタンスの提供</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Provide-Support-Instance/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Provide-Support-Instance/</id>
    <published>2022-08-22T06:50:00.000Z</published>
    <updated>2022-09-14T03:11:01.206Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの鎌田です。</p><p>本記事では弊社サポート サービスでお問合せいただいたお客様に向けてご案内していますサポート インスタンスを紹介します。</p><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>サポート インスタンスとは、お客様の問題を再現、解決するためのインスタンスです。サポート インスタンスには、マイクロソフトのサポート部門や開発部門が管理者権限でアクセスを行うことができます。そのため、お客様より事象が発生しているインスタンスをサポート インスタンスに向けてコピー作業を実施していただくことで、弊社にてご事象の再現と調査を一貫して行うことが可能です。</p><h2 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h2><p>サポート インスタンスの作成には、事前にお客様の組織 URL (***.crm*.dynamics.com) が必要です。<br>お問合せの際にご共有くださいますようお願いします。</p><p>エンジニアよりサポート インスタンスの作成後、後述の手順 4 のカラムの設定をあわせてご案内いたしております。</p><ul><li><strong>上書きコピー</strong> : “すべて” もしくは、”カスタマイズとスキーマのみ”</li><li><strong>上書きする環境を選択します</strong> :  通常、お問合せ番号を含むインスタンス名</li></ul><p>こちらを確認の上、以下を実施してください。</p><ol><li><p>全体管理者権限を持ったユーザーにて、 <a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a> へサインインします。</p></li><li><p>左ペインより [環境] をクリックし、さらに、事象が発生しているインスタンスをクリックします。</p></li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/00_choose-environment.png"></p><ol start="3"><li>事象が発生しているインスタンスが開いたら、上部メニューの [コピー] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/01_copy_environment.png"></p><ol start="4"><li>[環境のコピー] が右ペインに表示されます。[上書きコピー] や [上書きする環境を選択します] を設定します。設定は担当のサポート エンジニアより指定された項目をお選びください <a href="#%E6%B3%A8%E9%87%88">(※1)</a> 。その後、「私は、Microsoft がオンライン サービスの運用に…」 からはじまる注意書きを確認、チェックをつけた後に、最下段の [コピー] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/02_copy_environment_setting.png"></p><ol start="5"><li>確認のダイアログでは [確認] をクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/03_overwrite_confirm.png"></p><ol start="6"><li>コピーが開始されますので、お待ちください。各フェイズが [開始前] [進行中] [成功] と進展していきます。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/04_processing.png"></p><ol start="7"><li>コピーが完了しましたら、以下の [編集] ボタンをクリックします。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/05_edit_environment.png"></p><ol start="8"><li>[管理モード] を [有効] から [無効] にし [保存] をクリックします <a href="#%E6%B3%A8%E9%87%88">(※2)</a> 。</li></ol><p><img src="/blog/powerplatform/Provide-Support-Instance/06_edit_environment_setting.png"></p><ol start="9"><li>提供手順は終了です。担当エンジニアまで完了の旨をご連絡ください。</li></ol><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><ul><li>本手順は執筆時点の弊社検証環境でのユーザー インターフェイスを基に紹介しております。不明点がございましたら、担当のサポート エンジニアまでご相談ください。</li><li>作成したインスタンスはお客様のテナントのストレージ容量には影響ございません。</li><li>監査ログはコピーするか否かを選択することができます。監査ログをコピーすると、環境のコピーにかかる時間が大幅に長くなる可能性があり、既定では実行されません。 <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/copy-environment#copying-audit-logs">こちらのページ</a> の操作を実行することで、環境コピーに監査ログを含めることができます。</li><li>サポート インスタンスは、既定では7日間で自動削除されますが、サポート エンジニアの調査状況により削除が延長される場合があります。この場合についても、調査が終了した後に自動削除されます。</li></ul><h2 id="注釈"><a href="#注釈" class="headerlink" title="注釈"></a>注釈</h2><ul><li>(※1) [環境のコピー] で、サポート インスタンス名が長すぎることなどが原因で、サポート インスタンスを見つけられない場合は、Ctrl + F で検索が可能です。この操作を行ってもサポート インスタンスが見つからない場合、また、サポート インスタンスへの環境のコピーができない場合は、管理者権限がないことが考えられます。システム管理者権限を付与致しますので、担当エンジニアまで、環境のコピーを実行したいアカウント名と併せてご連絡ください。</li><li>(※2) 一部のお客様より [管理モード] が変更できない動作をお寄せいただいております。その場合、データ センター上で同作業を行いますため、担当のサポート エンジニアまでご相談ください。</li></ul><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><table><thead><tr><th>リンク</th><th>内容</th></tr></thead><tbody><tr><td><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/support-environment#what-are-support-environments">サポート環境とは</a></td><td>サポートインスタンス全般の解説をしております。</td></tr><tr><td><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/copy-environment">環境のコピー</a></td><td>完全コピー (すべて) や最小限のコピー (カスタマイズとスキーマのみ) について解説をしております。</td></tr><tr><td><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/copy-environment#copying-audit-logs">監査ログのコピー</a></td><td>環境コピー時に監査ログをコピーする手順について解説をしております。</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの鎌田です。&lt;/p&gt;
&lt;p&gt;本記事では弊社サポート サービスでお問合せいただいたお客様に向けてご案内していますサポート インスタンスを紹介します。&lt;/p&gt;
&lt;h2 id=&quot;概要&quot;&gt;&lt;a href=&quot;#概要&quot; class</summary>
      
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dataverse for Teams" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse-for-Teams/"/>
    
    <category term="環境" scheme="https://jpdynamicscrm.github.io/blog/tags/%E7%92%B0%E5%A2%83/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で CSV ファイルを取り込む</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Import-Csv-With-Standard-Connectors/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Import-Csv-With-Standard-Connectors/</id>
    <published>2022-08-19T09:40:17.000Z</published>
    <updated>2022-09-14T03:11:01.094Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。<br>今回は、Power Automate で CSV ファイルを取り込む方法をご紹介します。<br>標準コネクタのみで実現する方法なので、多くの方に活用していただけます。</p><span id="more"></span><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><ul><li>CSV ファイルの文字コードは UTF-8 に対応しています。<ul><li>Shift_JIS など他の文字コードでは、日本語が文字化けしますのでご注意ください。</li></ul></li><li>CSV ファイルの列数・行数はあまり多くないことを前提としています。<ul><li>列数・行数が増えると、その分アクション数が増えてフローも長大になる可能性があるのでご注意ください。</li></ul></li></ul><h2 id="今回取り込む-CSV-ファイル"><a href="#今回取り込む-CSV-ファイル" class="headerlink" title="今回取り込む CSV ファイル"></a>今回取り込む CSV ファイル</h2><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image001.png"></p><p>上図が今回使用した Excel シートです。これを、ファイルの種類を「CSV UTF (コンマ区切り)」へ変更して保存しました。その CSV ファイルをメモ帳で開いた様子が下図です。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image002.png"></p><p>特徴は下記の通りです：</p><ul><li>ヘッダー行 ： 無し</li><li>引用符 ： 無し</li><li>文字コード ： UTF-8 (BOM付き)</li><li>改行コード ： CRLF</li></ul><h2 id="フローの例"><a href="#フローの例" class="headerlink" title="フローの例"></a>フローの例</h2><p>今回の例では、以下の状況を想定しています。</p><ul><li>トリガー： CSV ファイルが OneDrive に作成されたとき</li><li>やりたいこと：SharePoint リストに CSV ファイルの内容を登録する</li></ul><p>↓やりたいことイメージ図<br><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image017.png"></p><p>フローの全体図は下記の通りです。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image003.png"></p><p>ここから、フローの詳細を順を追って解説いたします。</p><h3 id="CSVファイルの内容を行ごとに分割する"><a href="#CSVファイルの内容を行ごとに分割する" class="headerlink" title="CSVファイルの内容を行ごとに分割する"></a>CSVファイルの内容を行ごとに分割する</h3><p>CSV ファイルを処理する前に、まずは改行を格納する変数を用意します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image018.png"></p><p>式：<code>decodeUriComponent(&#39;%0D%0A&#39;)</code></p><p>今回の例では、<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#decodeUriComponent">decodeUriComponent 関数</a> を使用します。パラメータの <code>%0D%0A</code> は改行コード (CRLF) を表しています。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image005.png"></p><p>次に、トリガーアクションの「ファイルコンテンツ」を変数「CSVコンテンツ」に格納します。その後、「CSVコンテンツ」を「改行コード」で分割してアレイ変数に格納します。<br>指定の文字で分割するには、<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#split">split 関数</a> を使います。</p><p>式：<code>split(variables(&#39;CSVコンテンツ&#39;), variables(&#39;改行コード&#39;))</code></p><h3 id="列ごとの値を入れる変数の準備"><a href="#列ごとの値を入れる変数の準備" class="headerlink" title="列ごとの値を入れる変数の準備"></a>列ごとの値を入れる変数の準備</h3><p>次に、列を分割した後の値を入れるアレイ変数 (列配列) と、CSV ファイルに定義されている列と同じ変数を初期化します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image006.png"></p><p>今回は 商品、単価、個数の3つの列があるので、それぞれ同じ名前で変数を作りました。</p><h3 id="空の行を取り込まないようにする分岐"><a href="#空の行を取り込まないようにする分岐" class="headerlink" title="空の行を取り込まないようにする分岐"></a>空の行を取り込まないようにする分岐</h3><p>ここから、行ごとの繰り返し処理 (Apply To Each) に入ります。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image007.png"></p><p>繰り返し処理の初めに条件を指定し、行が空ではないときだけ「はいの場合」が実行されるようにします。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image008.png"></p><p>条件式の左辺：<code>length(item())</code></p><p>「<code>length(item())</code> が 0 より大きい」ときに「はい」になるようにしています。<code>item()</code> は行配列の各要素を表しているので、行が空でなければ「はい」になります。<br>この条件を入れておくと、CSV ファイルの最後の行が空の場合に、空のまま取り込んでしまうのを防止できます。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image009.png"></p><p>この条件分岐なしでフローを作成すると、取込先の SharePoint リストに空のデータが入ってしまいます。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image010.png"></p><h3 id="カンマごとに列を分割する"><a href="#カンマごとに列を分割する" class="headerlink" title="カンマごとに列を分割する"></a>カンマごとに列を分割する</h3><p>ここからは、条件分岐の「はいの場合」のときの処理です。</p><p>まず、行データをカンマで分割し、「列配列」変数へ格納します。その後、列配列の各要素を、商品、単価、個数の変数へ格納します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image011.png"></p><p>それぞれの変数名と値は下記の通りです。</p><ul><li>列配列 ： <code>@&#123;split(item(), &#39;,&#39;)&#125;</code></li><li>商品 ： <code>@&#123;variables(&#39;列配列&#39;)?[0]&#125;</code></li><li>単価 ： <code>@&#123;variables(&#39;列配列&#39;)?[1]&#125;</code></li><li>個数 ： <code>@&#123;variables(&#39;列配列&#39;)?[2]&#125;</code></li></ul><h3 id="分割した値を取り込む"><a href="#分割した値を取り込む" class="headerlink" title="分割した値を取り込む"></a>分割した値を取り込む</h3><p>最後に 商品、単価、個数を SharePoint リストへ登録します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image012.png"></p><p>あらかじめ作成しておいた SharePoint リストを選択すれば自動的に列が表示されますので、それぞれ対応した変数を指定します。</p><p>詳細の解説は以上です。</p><h2 id="ヘッダー行がある場合"><a href="#ヘッダー行がある場合" class="headerlink" title="ヘッダー行がある場合"></a>ヘッダー行がある場合</h2><p>先ほどの例は CSV ファイルにヘッダー行がありませんでしたが、ヘッダー行がある場合は、ヘッダー行を取り込んでしまわないような処理が必要です。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image013.png"></p><p>例えば、CSV ファイルの行を読み取るたびに何行目かをカウントし、1行目だけ読み飛ばすようにします。そのために、まずは先ほどのフローの Apply to each の前に、新しい変数の初期化を挿入します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image014.png"></p><ul><li>名前 ： 行カウンタ</li><li>種類 ： 整数</li><li>値 ： 1</li></ul><p>次に、Apply to each の中の条件分岐の条件式を追加します。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image015.png"></p><p>「行カウンタが1より大きい」となるように条件を設定します。<br>これで、行カウンタが1のときは「いいえの場合」になるので SharePoint リストへの登録が行われなくなります。</p><p><img src="/blog/powerautomate/Import-Csv-With-Standard-Connectors/image016.png"></p><p>最後に、条件分岐が終わった後に「変数の値を増やす」アクションを追加します。行配列を読み込むごとに、1ずつカウントアップします。これで、2行目以降は 「はいの場合」になります。</p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>以上、Power Automate で CSV ファイルを取り込む方法をご紹介いたしました。<br>SharePoint リストへの登録の部分を他のアクションへ置き換えることで、様々な状況で活用していただけます。参考になりましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;br&gt;今回は、Power Automate で CSV ファイルを取り込む方法をご紹介します。&lt;br&gt;標準コネクタのみで実現する方法なので、多くの方に活用していただけます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>DLP ポリシーに設定されているコネクタの一覧を出力する</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Output-dlp-policy-connector-list/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Output-dlp-policy-connector-list/</id>
    <published>2022-08-19T02:43:28.000Z</published>
    <updated>2022-09-14T03:11:01.202Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。</p><p>この記事では、データ消失防止 (DLP) ポリシー に設定されたコネクタの一覧を、CSV ファイルに出力する方法をご案内いたします。</p><span id="more"></span><h2 id="DLP-ポリシーとコネクタ"><a href="#DLP-ポリシーとコネクタ" class="headerlink" title="DLP ポリシーとコネクタ"></a>DLP ポリシーとコネクタ</h2><p>データ消失防止 (DLP) ポリシーとは、テナントや環境単位でコネクタの利用を制限できる、管理者向けの機能です。<br><a href="https://admin.powerplatform.microsoft.com/home">Power Platform 管理センター</a> よりアクセスいただけます。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-17-17-29-40.png"></p><p>参考：<a href="https://docs.microsoft.com/ja-jp/power-platform/admin/wp-data-loss-prevention">データ消失防止ポリシー - Power Platform | Microsoft Docs</a></p><p>しかし、提供されているコネクタは非常に数が多く、DLP ポリシーを設定する画面ではすべてを把握するのが難しいのが現状です。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-16-35-50.png"><br>(2022年8月某日に確認した時点で800個以上)</p><p>こんな時は、コネクタの一覧をファイルに出力できると、より把握しやすくなるのではないでしょうか。Power Platform の管理者向けの PowerShell コマンドレットを活用すれば、コネクタの一覧を CSV ファイルに出力できます。</p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>Power Platform の PowerShell コマンドレットのご利用には、事前準備が必要です。詳しい手順は下記公開情報の「インストール」の章をご参照ください。</p><p><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell">PowerShell のサポート - Power Platform | Microsoft Docs</a></p><p><code>Install-Module</code> に失敗する場合は、インストールに必要な設定が不足している可能性が考えられます。その設定については、弊社 Windows サポートチームによる記事にまとめられていますので、こちらもぜひご覧ください。</p><p><a href="https://jpwinsup.github.io/blog/2021/06/14/UserInterfaceAndApps/PowerShell/how-to-setup-install-module/">PowerShell Gallery からモジュールをインストールするために必要な設定 | Microsoft Japan Windows Technology Support Blog</a></p><h2 id="サンプル"><a href="#サンプル" class="headerlink" title="サンプル"></a>サンプル</h2><p>今回は、<a href="https://docs.microsoft.com/ja-jp/powershell/module/microsoft.powerapps.administration.powershell/get-dlppolicy?view=pa-ps-latest">Get-DlpPolicy</a> を使用します。</p><p>このコマンドレットは DLP ポリシーの一覧や DLP ポリシーの詳細情報を取得できます。これを <code>Export-Csv</code> と組み合わせ、CSV ファイルを作成します。</p><p>以下に、サンプルコードを記載いたします。</p><div class="alert is-info"><p class="alert-title">Note</p><p>説明のためのサンプルであり、エラー処理などは含まれておりません。ご使用の際は、十分にご検証いただきますようお願いします。</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">特定のDLPポリシーに設定されているコネクタの一覧をcsvファイルに出力します</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="built_in">Import-Module</span> Microsoft.PowerApps.Administration.PowerShell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$filePath</span> = <span class="string">&quot;[CSVファイルパス]&quot;</span></span><br><span class="line"><span class="comment"># ポリシーのID</span></span><br><span class="line"><span class="variable">$policyId</span> = <span class="string">&quot;[DLPポリシーのID]&quot;</span></span><br><span class="line"><span class="comment"># メールアドレス</span></span><br><span class="line"><span class="variable">$mailAddress</span> = <span class="string">&quot;[メールアドレス]&quot;</span></span><br><span class="line"><span class="comment"># パスワード</span></span><br><span class="line"><span class="variable">$plainPassword</span> = <span class="string">&quot;[パスワード]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># サインイン</span></span><br><span class="line"><span class="variable">$pass</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$plainPassword</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">Add-PowerAppsAccount</span> <span class="literal">-Username</span> <span class="variable">$mailAddress</span> <span class="literal">-Password</span> <span class="variable">$pass</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$DLPPolicy</span> = <span class="built_in">Get-DlpPolicy</span> <span class="literal">-PolicyName</span> <span class="variable">$policyId</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$connectors</span> = <span class="selector-tag">@</span>()</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$group</span> <span class="keyword">in</span> <span class="variable">$DLPPolicy</span>.connectorGroups) &#123;</span><br><span class="line">    <span class="variable">$groupName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># データグループの名前を分かりやすいものに置き換えます</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;Confidential&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;Business&quot;</span></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;General&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;NonBusiness&quot;</span></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$group</span>.classification <span class="operator">-eq</span> <span class="string">&quot;Blocked&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$groupName</span> = <span class="string">&quot;Blocked&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$connector</span> <span class="keyword">in</span> <span class="variable">$group</span>.connectors) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="built_in">New-Object</span> PSObject</span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> Policy <span class="literal">-Value</span> <span class="variable">$DLPPolicy</span>.displayName</span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> <span class="built_in">Group</span>  <span class="literal">-Value</span> <span class="variable">$groupName</span></span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> Name   <span class="literal">-Value</span> <span class="variable">$connector</span>.name</span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> ID     <span class="literal">-Value</span> <span class="variable">$connector</span>.id</span><br><span class="line">        <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> <span class="built_in">Type</span>   <span class="literal">-Value</span> <span class="variable">$connector</span>.type</span><br><span class="line">        <span class="variable">$connectors</span> += <span class="variable">$obj</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$connectors</span> | <span class="built_in">Export-Csv</span> <span class="literal">-Path</span> <span class="variable">$filePath</span> <span class="literal">-Encoding</span> UTF8 <span class="literal">-NoTypeInformation</span></span><br></pre></td></tr></table></figure><p>サンプル中の <code>[DLPポリシーのID]</code> は DLP ポリシーの編集画面の URL から取得できます。</p><p><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-17-24-45.png"></p><p>そして、サンプルを実行すると、以下のような CSV ファイルを出力できます。DLP ポリシーでどのようにコネクタを分類しているか、より把握しやすくなりました。<br><img src="/blog/powerplatform/Output-dlp-policy-connector-list/2022-08-18-16-56-37.png"></p><h2 id="画面で確認できるコネクタと件数が異なるとき"><a href="#画面で確認できるコネクタと件数が異なるとき" class="headerlink" title="画面で確認できるコネクタと件数が異なるとき"></a>画面で確認できるコネクタと件数が異なるとき</h2><p>PowerShell の <code>Get-DlpPolicy</code> で取得できるコネクタの顔ぶれと Power Platform 管理センター で確認できるコネクタの顔ぶれが異なる場合があります。</p><p>これは両者に以下の違いがあるためです。</p><ul><li>PowerShell で取得できるコネクタ　：　ポリシーに明示的に追加されたコネクタのみを取得できます。</li><li>Power Platform 管理センターで見るコネクタ　：　現時点で有効なコネクタが表示されます (ポリシー作成以降に追加/廃止されたコネクタが表示/非表示になります)。</li></ul><p>つまり、以下のような現象が起きます。</p><ul><li>ポリシー作成以降に新しいコネクタが追加された場合、Power Platform 管理センターではそのコネクタが表示され数にも含まれます。しかし、新しいコネクタは自動的にポリシーに追加されないため、PowerShell で取得した結果には含まれません。<ul><li>したがって、Power Platform 管理センター での数 ＞ PowerShell で取得した数 となります。</li></ul></li><li>ポリシー作成以降に廃止されたコネクタがある場合、Power Platform 管理センターではそのコネクタが表示されなくなりますが、PowerShell で取得した結果には残ります。<ul><li>したがって、Power Platform 管理センター での数 ＜ PowerShell で取得した数 となります。</li></ul></li></ul><p>表示上の不一致はありますが、ポリシー作成以降に追加されたコネクタは既定のデータグループの設定に従って制御されるため、ポリシーは想定通り動作しますのでご安心ください。</p><p>なお、Power Platform 管理センターで対象のポリシーを編集し保存し直していただくと、両者の数の不一致が解消されます。<br>少しお手数ではありますが、不一致を解消したい場合は再保存をお試しください。</p><p> 参考：</p><ul><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/dlp-connector-classification#default-data-group-for-new-connectors">新しいコネクタの既定データ グループ について</a></li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/prevent-data-loss#change-the-default-data-group">既定のデータ グループの変更</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;/p&gt;
&lt;p&gt;この記事では、データ消失防止 (DLP) ポリシー に設定されたコネクタの一覧を、CSV ファイルに出力する方法をご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="PowerShell" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerShell/"/>
    
  </entry>
  
  <entry>
    <title>MC362053 Power Automate フローの IP アドレスのファイアウォール構成を 2022 年 5 月 15 日までに更新する</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/MC362053/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/MC362053/</id>
    <published>2022-05-11T00:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.098Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、日本マイクロソフト Power Automate サポートチームです。<br>この記事では、4 月 20 日にメッセージセンターより通知されたの「MC362053」の内容と対処方法についてご案内致します。  </p><p>「MC362053：Power Automate フローの IP アドレスのファイアウォール構成を 2022 年 5 月 15 日までに更新する」</p><p>なお、本通知は 1 つまたは複数のフローが変更の影響を受ける可能性があるテナントへ送信されています。  </p><span id="more"></span><h2 id="メッセージセンター通知内容の日本語訳"><a href="#メッセージセンター通知内容の日本語訳" class="headerlink" title="メッセージセンター通知内容の日本語訳"></a>メッセージセンター通知内容の日本語訳</h2><hr><blockquote><p>Azure Logic Apps に新しい IP アドレスが追加され、Power Automate フローの回復力と可用性を高めるためのアベイラビリティゾーンがサポートされるようになりました。<br>フローからの呼び出しが直接 Azure Logic App サービスを経由する場合があるため、一部の Power Automate フローに影響があります。<br>Logic Apps の IP アドレスとの通信を許可するファイアウォール設定がある場合、Logic Apps と Connector の新しいアドレスに更新する必要があります。</p><p>アベイラビリティゾーンの詳細については、こちらの記事を参照してください。 </p><p>どのような影響がありますか？   </p><p>このメールを受け取っているのは、1つまたは複数のフローが変更の影響を受ける可能性があるためです。<br>5月15日以降、これらの新しいIPアドレスは、新規および既存のフローにも使用される可能性があり、それらのためにファイアウォールの設定を更新する必要があります。 </p><p>どのような対処が必要ですか？<br>フローが期待通りに動作するように、できるだけ早くLogic AppsとConnectorの両方のIPアドレスを含むようにファイアウォールの設定を更新してください。   </p><p>このようなファイアウォール設定をしていない場合は、この変更の影響を受けませんので、何もする必要はありません。   </p><p>ご質問がある場合は、IPアドレスの設定を参照するか、Microsoftサポートにお問い合わせください。</p></blockquote><h2 id="影響"><a href="#影響" class="headerlink" title="影響"></a>影響</h2><hr><p>この度、 <a href="https://techcommunity.microsoft.com/t5/integrations-on-azure-blog/azure-logic-apps-availability-zone-support-is-coming-soon/ba-p/3254456">Azure Logic Apps における可用性ゾーンのサポート</a>（データセンターを物理的に分散し地震・洪水等による障害からの復旧を容易にする機能のサポート）開始により、Logic Apps で使用される IP アドレスの範囲が追加されました。<br>Power Automate では内部的に Logic Apps のサービスを使用しているため、これにより、Power Automate につきましても以下の影響がございます。</p><h3 id="フロー実行時の影響"><a href="#フロー実行時の影響" class="headerlink" title="フロー実行時の影響"></a>フロー実行時の影響</h3><p>Power Automate にてコネクタを使用して自動化を行うと、弊社コネクタ サーバーまたは Azure Logic Apps からリソースへのアクセスが行われます。<br>そのため、Azure Logic Apps が使用する IP アドレスが追加となることで、フロー実行時にエラーが発生する恐れがございます。</p><p>例えば、フローにて SQL Server コネクタを使用している場合、SQL Server 側でファイアウォールを構成して特定の IP アドレスからのリクエストのみを許可する設定としていると、許可されていない IP アドレスからのアクセスが行われることが原因でフロー実行時にエラーが発生する可能性がございます。</p><h2 id="対応方法"><a href="#対応方法" class="headerlink" title="対応方法"></a>対応方法</h2><hr><h3 id="＜対応が必要なケース＞"><a href="#＜対応が必要なケース＞" class="headerlink" title="＜対応が必要なケース＞"></a>＜対応が必要なケース＞</h3><p><u>フローからの接続先のサービス</u> にて IP アドレスのフィルタリングを行っている場合  </p><h3 id="＜対応方法＞"><a href="#＜対応方法＞" class="headerlink" title="＜対応方法＞"></a>＜対応方法＞</h3><p>以下の公開情報をご確認いただき、フローからの接続先サービスにおいて、ご利用いただいているリージョンの IP アドレスへの通信が全て許可されているかご確認をお願いいたします。</p><ul><li><a href="https://docs.microsoft.com/en-us/connectors/common/outbound-ip-addresses">Managed connectors outbound IP addresses </a>の以下の項に記載されている IP アドレス<ul><li>「Power Platform」  </li></ul></li><li><a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/logic-apps-limits-and-config?tabs=azure-portal#firewall-ip-configuration-considerations">Azure Logic Apps の制約と構成の参考文献#ファイアウォールの IP 構成に関する考慮事項</a>の以下の項に記載されている IP アドレス<ul><li>「送信 IP アドレス」  </li></ul></li></ul><p>なお、上記公開情報に記載がございますように、Azure Logic Apps ではセキュリティ規則作成時の煩雑さを軽減するため<a href="https://docs.microsoft.com/ja-jp/azure/virtual-network/service-tags-overview">サービスタグ</a>をご用意しておりますので、必要に応じてご利用ください。  </p><p>また、個々のフローにて接続しているサービスが IP アドレスのフィルタリングを行っているかどうかは管理者側で一括して確認することが難しい場合もあるかと存じますので、ユーザー様に IP アドレスの許可リストの見直しを行っていただくよう、周知いただけますと幸いでございます。  </p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、日本マイクロソフト Power Automate サポートチームです。&lt;br&gt;この記事では、4 月 20 日にメッセージセンターより通知されたの「MC362053」の内容と対処方法についてご案内致します。  &lt;/p&gt;
&lt;p&gt;「MC362053：Power Automate フローの IP アドレスのファイアウォール構成を 2022 年 5 月 15 日までに更新する」&lt;/p&gt;
&lt;p&gt;なお、本通知は 1 つまたは複数のフローが変更の影響を受ける可能性があるテナントへ送信されています。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Cloud flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flows/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps 試用版ライセンスについて</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerapps/About-Trial-License/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerapps/About-Trial-License/</id>
    <published>2022-05-06T03:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.070Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br/><br>今回は、Power Apps の試用版ライセンスについて、下記項目の順にご説明いたします。<br>&lt;試用版ライセンスの概要&gt;<br>&lt;試用版ライセンスの種類について&gt;<br>&lt;ライセンス利用状況の確認方法について&gt;<br>&lt;Microsoft 365 (Office 365) ライセンスとの機能の違い&gt;<br>&lt;Power Apps 有償ライセンスについて&gt;  </p><span id="more"></span> <h2 id="lt-試用版ライセンスの概要-gt"><a href="#lt-試用版ライセンスの概要-gt" class="headerlink" title="&lt;試用版ライセンスの概要&gt;"></a><strong>&lt;試用版ライセンスの概要&gt;</strong></h2><p>試用版ライセンスでは、プレミアム機能 (プレミアムコネクタやオンプレミスデータゲートウェイなど) を含む Power Apps の全ての機能をご利用いただけます。<br>試用版ライセンスはユーザー毎に 1 回 30 日間のご利用が可能でございます。<br>2 回までの延長が可能でございますので、合計最大 90 日までご利用いただけます。<br>その他詳細については下記公開情報をご参照ください。<br><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/signup-for-powerapps">Power Apps 30 日間の無料試用版</a>  </p><h2 id="lt-試用版ライセンスの種類について-gt"><a href="#lt-試用版ライセンスの種類について-gt" class="headerlink" title="&lt;試用版ライセンスの種類について&gt;"></a><strong>&lt;試用版ライセンスの種類について&gt;</strong></h2><p>試用版ライセンスには、下記の 2 種類がございます。<br>①Microsoft 365 管理センター上でご確認いただけるライセンス<br>②Microsoft 365 管理センター上でご確認いただけないライセンス  </p><p><strong>①Microsoft 365 管理センター上でご確認いただけるライセンス</strong><br>下記公開情報に記載の方法にて、Microsoft 365 管理センター上にてご確認いただける試用版ライセンスがご取得いただけます。<br><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/signup-for-powerapps#get-a-license-from-scratch">最初からライセンスを取得する</a>  </p><p>または、Microsoft 365 管理センターにて、対象ユーザーに付与することでご利用いただけます。<br><img src="/blog/powerapps/About-Trial-License/assign-trial-license-on-ppac.png"><br>ライセンス付与の対象ユーザーが既に Power Apps サービスへアクセスしたことがある場合は、<br>ライセンスを付与したタイミングから 30 日間ご利用いただけます。<br>ライセンス付与の対象ユーザーがまだ Power Apps サービスへアクセスしたことがない場合は、<br>初回アクセス時に表示される下図の「作業の開始」を実行いただいたタイミングから 30 日間ご利用いただけます。<br><img src="/blog/powerapps/About-Trial-License/start-button-screen.png">  </p><p><strong>②Microsoft 365 管理センター上でご確認いただけないライセンス</strong><br>Power Apps が有効なライセンスが付与されていない状態で、任意のアプリを実行しようとすると下図のメッセージが表示されます。<br>「試用版の開始」よりサインインし、試用版ライセンスのセットアップ手続きを行います。<br>管理センター上に表示されない試用版ライセンスが対象ユーザーにおいて取得され、利用開始となります。<br><img src="/blog/powerapps/About-Trial-License/screen-of-demanding-license.png"><br><img src="/blog/powerapps/About-Trial-License/license-set-up.png">   　  　  </p><h2 id="lt-ライセンス利用状況の確認方法について-gt"><a href="#lt-ライセンス利用状況の確認方法について-gt" class="headerlink" title="&lt;ライセンス利用状況の確認方法について&gt;"></a><strong>&lt;ライセンス利用状況の確認方法について&gt;</strong></h2><p>管理センター上に表示されない試用版ライセンスは、下記の PowerShell での Power Apps 管理コマンドをご利用いただくことでご確認いただけます。<br>Power Apps 管理 コマンドをご実行いただくとライセンス利用状況の CSV ファイルをご取得いただけます。  </p><p>ただし、コマンドの出力には、Power Platform サービスにアクセスしたユーザーのライセンスのみが含まれます。<br>ライセンスが割り当てられていても、Power Platform サービスにアクセスしたことがないユーザーは、CSV ファイルにライセンスが含まれません。<br>また、最近サービスにアクセスしていないユーザーの場合、出力に反映されるまでに最大で 7 日かかる場合がございます。<br>予めご承知おきいただけますと幸いでございます。  　  </p><h3 id="lt-PowerShell-コマンド実行手順-gt"><a href="#lt-PowerShell-コマンド実行手順-gt" class="headerlink" title="&lt;PowerShell コマンド実行手順&gt;"></a>&lt;PowerShell コマンド実行手順&gt;</h3><p>⓪これまでに Power Apps 管理モジュールをご利用頂いたことがない場合は、<br>　管理者権限で PowerShell を起動し、初めに以下のコマンドでモジュールをインストールください。<br>　Install-Module -Name Microsoft.PowerApps.Administration.PowerShell -Force  </p><p>①下記 Power Apps 管理コマンドを実行  </p><pre><code class="CMD">　Get-AdminPowerAppLicenses -OutputFilePath &#39;&lt;licenses.csv&gt;&#39;  </code></pre><p>  　　<br>　詳細につきましては、下記公開情報もご参照ください。<br>　<a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#export-a-list-of-assigned-user-licenses">割り当てられたユーザー ライセンスのリストをエクスポートする</a><br>　<br>　実行イメージ：<br>　<img src="/blog/powerapps/About-Trial-License/sample-image-of-Get-AdminPowerAppLicenses.png"><br>　<br>上記コマンドで取得できる CSV ファイルの内容は下図例の様になります。<br><img src="/blog/powerapps/About-Trial-License/sample-result-of-Get-AdminPowerAppLicenses.png">   </p><ul><li>C列”Service”：「Power Apps Per User Plan trial」となっているものが管理センター上でご確認いただける試用版ライセンス  </li><li>D列”License”：「Power Apps Per User Plan trial」となっているものが管理センター上でご確認いただけない試用版ライセンス  </li><li>E列”License Assigned Date”：対象ユーザーの試用版ライセンスの開始時期  </li><li>G列”Expiration Date”：対象ユーザーの試用版ライセンスの終了時期  　  </li></ul><h2 id="lt-Microsoft-365-Office-365-ライセンスとの機能の違い-gt"><a href="#lt-Microsoft-365-Office-365-ライセンスとの機能の違い-gt" class="headerlink" title="&lt;Microsoft 365 (Office 365) ライセンスとの機能の違い&gt;"></a><strong>&lt;Microsoft 365 (Office 365) ライセンスとの機能の違い&gt;</strong></h2><p>Office 365 E3 ライセンスなどの Microsoft 365 (Office 365) には Power Apps の一部の使用権が含まれておりますが、<br>試用版ライセンスに含まれるプレミアム機能は含まれておりません。<br>そのため、プレミアム コネクタ等を利用しているアプリは Microsoft 365 ではご実行いただくことができません。  </p><p>Microsoft 365 ライセンスに含まれる Power Apps 使用権の詳細については下記のライセンスガイドをご参照ください。<br>　※クリックすると PDF のダウンロードが開始します。<br>　<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&clcid=0x411">Microsoft Power Apps、Microsoft Power Automate、Microsoft Power Virtual Agents ライセンスガイド</a>  </p><p>Microsoft 365 ライセンスに含まれる Power Apps の使用権は、<br>プレミアム コネクタ等が含まれておらず、限定された機能となります。<br><img src="/blog/powerapps/About-Trial-License/about-m365-license.png"><br>※ライセンスガイドより抜粋。2022 年 4 月時点のものとなります。  　　  </p><p>　　  </p><h2 id="lt-試用版ライセンスの期限を迎えた場合-gt"><a href="#lt-試用版ライセンスの期限を迎えた場合-gt" class="headerlink" title="&lt;試用版ライセンスの期限を迎えた場合&gt;"></a><strong>&lt;試用版ライセンスの期限を迎えた場合&gt;</strong></h2><h3 id="プレミアム機能を利用していないアプリの場合"><a href="#プレミアム機能を利用していないアプリの場合" class="headerlink" title="-プレミアム機能を利用していないアプリの場合"></a>-プレミアム機能を利用していないアプリの場合</h3><p>試用版ライセンスのみが付与されているユーザーがアプリを実行しようとすると、下図の様なメッセージが表示されアプリをご実行いただけません。<br><img src="/blog/powerapps/About-Trial-License/screen-of-demanding-license.png">     </p><p>対象アプリを引き続きご実行いただくには、以下の 2 通りの対応が必要となります。<br>①試用版ライセンスを延長いただく (※ただし、上述の通り、延長は各ユーザーにつき 2 回までとなります。)<br>②Microsoft 365 ライセンス、およびライセンスに含まれる Power Apps 使用権を対象ユーザーに付与いただく  </p><h3 id="プレミアム機能を利用しているアプリの場合"><a href="#プレミアム機能を利用しているアプリの場合" class="headerlink" title="-プレミアム機能を利用しているアプリの場合"></a>-プレミアム機能を利用しているアプリの場合</h3><p>アプリを実行しようとすると有償ライセンスが必要であるメッセージが表示され、アプリをご実行いただけません。  </p><p>プレミアム機能を利用しているため、Microsoft 365 ライセンスに含まれる Power Apps 使用権をユーザーへ付与してもアプリはご実行いただけません。<br>そのため、対象アプリを引き続きご実行いただくには、以下の 2 通りの対応が必要となります。<br>①試用版ライセンスを延長いただく (※ただし、上述の通り、延長は各ユーザー 2 回までとなります。)<br>②Power Apps の有償ライセンスをご利用いただく (※詳細については、後述致します。)  </p><p>※対象アプリがプレミアム機能を必要とするかの判断方法については下記公開情報もご参照ください。<br><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/license-designation#check-app-license-designation-from-app-settings">アプリのライセンス指定の確認方法</a>   </p><p>上記公開情報に記載のライセンス指定情報 = 設定画面上の「ライセンスの名称」が「プレミアム」となっている場合には、<br>プレミアム機能が有効なライセンスが必要となります。<br><img src="/blog/powerapps/About-Trial-License/required-license-normal.png"><br><img src="/blog/powerapps/About-Trial-License/required-license-premium.png">  </p><h2 id="lt-Power-Apps有償ライセンスについて-gt"><a href="#lt-Power-Apps有償ライセンスについて-gt" class="headerlink" title="&lt;Power Apps有償ライセンスについて&gt;"></a><strong>&lt;Power Apps有償ライセンスについて&gt;</strong></h2><p>試用版ライセンスと同様に Power Apps の全ての機能をご利用いただくには、<br>下記 2 種の Power Apps の有償ライセンスのどちらかが必要となります。<br>①Power Apps per app プラン<br>②Power Apps per user プラン  </p><p>各ライセンスの内容は以下の通りとなります。<br>更なる詳細については上述のライセンスガイドを併せてご確認ください。  </p><p><strong>①Power Apps per app プラン</strong><br>　1 ライセンスで 1 ユーザーが 1 アプリをご利用いただけます。<br>　利用されたいアプリが 2 つある場合には、利用されたいアプリ数分のライセンスが必要となります。<br>　また、1つのアプリを複数ユーザーにてご利用されたい場合には、<br>　利用されるユーザー数分のライセンスが必要となります。  </p><p><strong>②Power Apps per user プラン</strong><br>　割り当てられた対象ユーザーがアプリ数の制限なく、Power Apps をご利用いただけるライセンスとなっております。<br>　ご利用いただくユーザー数分のライセンスが必要となります。  </p><p>その他、ライセンス詳細につきましては、下記公開情報もご参照ください  </p><ul><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/pricing-billing-skus">Microsoft Power Platform ライセンスの概要 </a>  </li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/about-powerapps-perapp">アプリごとの Power Apps プラン </a>  </li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/pay-as-you-go-overview">従量課金制プランの概要 </a>  </li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-flow-licensing-faq">Power Apps と Power Automate のライセンスに関する FAQ </a>  </li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br/&gt;&lt;br&gt;今回は、Power Apps の試用版ライセンスについて、下記項目の順にご説明いたします。&lt;br&gt;&amp;lt;試用版ライセンスの概要&amp;gt;&lt;br&gt;&amp;lt;試用版ライセンスの種類について&amp;gt;&lt;br&gt;&amp;lt;ライセンス利用状況の確認方法について&amp;gt;&lt;br&gt;&amp;lt;Microsoft 365 (Office 365) ライセンスとの機能の違い&amp;gt;&lt;br&gt;&amp;lt;Power Apps 有償ライセンスについて&amp;gt;  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="PowerShell" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerShell/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate お問い合わせの際の情報取得手順</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/</id>
    <published>2022-03-16T00:30:00.000Z</published>
    <updated>2022-09-14T03:11:01.102Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。<br>本記事では Power Automate 関連のお問い合わせの際の、情報取得手順についてご案内致します。</p><span id="more"></span><ol><li><a href="#anchor-intro">概要</a></li><li><a href="#anchor-how-to-collect">情報取得手順詳細</a><ol><li><a href="#anchor-flowpackage">フローのパッケージ</a><ol><li><a href="#anchor-flowpackage-myflow">フローのパッケージ (マイフロー)</a></li><li><a href="#anchor-flowpackage-in-solution">フローのパッケージ (ソリューションフロー)</a></li><li><a href="#anchor-flowpackage-in-dv4t">フローのパッケージ (Dataverse for Teams)</a></li></ol></li><li><a href="#anchor-flowid">フロー識別子</a></li><li><a href="#anchor-flowrunhistory-csv">実行履歴 CSV</a></li><li><a href="#anchor-flowrunhistory-url">フロー実行履歴 URL</a></li><li><a href="#anchor-error-message-in-run-history">実行履歴に表示されるエラーメッセージ</a></li><li><a href="#anchor-raw-input-output">アクションの未加工入力、未加工出力 </a></li><li><a href="#anchor-tenantInfo">テナント情報</a></li><li><a href="#anchor-environmentid">環境 ID</a></li></ol></li></ol><p><a id='anchor-intro'></a></p><h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p>Power Automate に関するサポートサービスのお問い合わせの際の、情報取得手順についてご案内致します。</p><p><a id='anchor-how-to-collect'></a></p><h1 id="情報取得手順詳細"><a href="#情報取得手順詳細" class="headerlink" title="情報取得手順詳細"></a>情報取得手順詳細</h1><p><a id='anchor-flowpackage'></a></p><h2 id="フローのパッケージ"><a href="#フローのパッケージ" class="headerlink" title="フローのパッケージ"></a>フローのパッケージ</h2><p>フローの作成方法により取得手順が異なります。フローを作成した方法から手順を選択し、パッケージファイルを取得してください。</p><ul><li>マイ フローに作成した場合　-　<a href="#anchor-flowpackage-myflow">フローのパッケージ (マイ フロー)</a></li><li>ソリューションに作成した場合 - <a href="#anchor-flowpackage-in-solution">フローのパッケージ (ソリューションフロー)</a></li><li>Teams の Power Apps アプリから作成した場合 - <a href="#anchor-flowpackage-in-dv4t">フローのパッケージ (Dataverse for Teams)</a></li></ul><p><a id='anchor-flowpackage-myflow'></a></p><h3 id="フローのパッケージ-マイ-フロー"><a href="#フローのパッケージ-マイ-フロー" class="headerlink" title="フローのパッケージ (マイ フロー)"></a>フローのパッケージ (マイ フロー)</h3><p>   エクスポートしたフローのパッケージ (zip) ファイルをご提供ください。</p><ul><li>マイ フロー &gt; (フローを選択) &gt; … &gt; エクスポート &gt; パッケージ (zip)<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow.png">  </li></ul><p><a id='anchor-flowpackage-in-solution'></a></p><h3 id="フローのパッケージ-ソリューションフロー"><a href="#フローのパッケージ-ソリューションフロー" class="headerlink" title="フローのパッケージ (ソリューションフロー)"></a>フローのパッケージ (ソリューションフロー)</h3><p>   ソリューション内に作成したフローの場合は、エクスポートしたソリューション ファイル (zip) をご提供ください。  </p><ul><li>ソリューション &gt;  (ソリューションを選択) &gt; エクスポート<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-solution2.png">  </li></ul><p>   ソリューション全体の提供が難しい場合は、必要なコンポーネントのみが含まれる新しいソリューションを作成し、ご提供ください。<br>   ※弊社環境にインポートできるよう、依存関係のあるコンポーネントを含めてご提供をお願い致します  </p><ol><li>ソリューション &gt; ＋新しいソリューション &gt; (必須項目の入力) &gt; 作成<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-solution.png">  </li><li>(作成したソリューションを選択) &gt; 編集<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-solution3.png">  </li><li>既存を追加 &gt; 自動化 &gt; クラウド フロー から対象のフローを追加<br>　　※依存関係のあるコンポーネントがあれば、一緒に追加してください。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-solution4.png">  </li></ol><p><a id='anchor-flowpackage-in-dv4t'></a></p><h3 id="フローのパッケージ-Dataverse-for-Teams"><a href="#フローのパッケージ-Dataverse-for-Teams" class="headerlink" title="フローのパッケージ (Dataverse for Teams)"></a>フローのパッケージ (Dataverse for Teams)</h3><p>   Teams の Power Apps アプリで作成したフローの場合は、エクスポートしたソリューションファイル (zip) をご提供ください。  </p><ol><li>Power Apps アプリ &gt; ビルド &gt; (チーム選択) &gt; すべて表示<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-dv4t.png">  </li><li>(フローを選択) &gt; エクスポート &gt; Export solution<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-dv4t2.png">  </li><li>「すべての依存関係をエクスポートする」を選択し、「zip形式でエクスポート」<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flow-dv4t3.png">  </li></ol><p><a id='anchor-flowid'></a></p><h2 id="フロー識別子"><a href="#フロー識別子" class="headerlink" title="フロー識別子"></a>フロー識別子</h2><ol><li>フロー詳細画面 &gt; エクスポート &gt; フロー識別子を取得する<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flowid.png">  </li><li>「クリックしてコピー」 で取得したテキストをご提供ください。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flowid2.png">  </li></ol><p><a id='anchor-flowrunhistory-csv'></a></p><h2 id="フロー実行履歴CSV"><a href="#フロー実行履歴CSV" class="headerlink" title="フロー実行履歴CSV"></a>フロー実行履歴CSV</h2><ol><li>フローの詳細画面を開き、「28 日間の実行履歴」から「すべての実行」を選択します。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flowrunhistory.png">  </li><li>「.csv ファイルを取得」を選択し、取得した CSV ファイルをご提供ください。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flowrunhistory2.png">  </li></ol><p><a id='anchor-flowrunhistory-url'></a></p><h2 id="フロー実行履歴URL"><a href="#フロー実行履歴URL" class="headerlink" title="フロー実行履歴URL"></a>フロー実行履歴URL</h2><ol><li><b>Power Automate</b> ポータル画面にアクセスし、以下の手順でフロー詳細画面を開きます<br>※Power Apps ポータルや Teams からだと正しくURLが表示されないため、Power Automate ポータルをご利用ください。<ul><li>マイ フローに作成した場合　-　マイ フロー (①) &gt; (フロー選択)  </li><li>ソリューションに作成した場合　-　ソリューション(②) &gt; (ソリューションを選択)   &gt; (フロー選択)  </li><li>Teams の Power Automate アプリから作成した場合　-　(default環境を選択) (③) &gt; マイ フロー(①) &gt; (フロー選択)  </li><li>Teams の Power Apps アプリから作成した場合　-　(Teams環境を選択) (③) &gt; ソリューション(②) &gt; Common Data Services Default Solution &gt; (フロー選択)<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/export-flowrunhistory3.png">  </li></ul></li><li>「28 日間の実行履歴」から履歴を選択します。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/flowrunurl1.png"></li><li>開いた画面の URL をご提供ください。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/flowrunurl2.png"></li></ol><p><a id='anchor-error-message-in-run-history'></a></p><h2 id="実行履歴に表示されるエラーメッセージ"><a href="#実行履歴に表示されるエラーメッセージ" class="headerlink" title="実行履歴に表示されるエラーメッセージ"></a>実行履歴に表示されるエラーメッセージ</h2><p>  実行履歴を開き、エラーメッセージがわかるスクリーンショットと、⑥エラーの詳細のテキストコピーの 2 点をご提供ください。<br>  またスクリーンショットには 6 点の情報が表示されていることをご確認ください。  </p><ol><li>フローの実行時刻  </li><li>フローのエラーメッセージ  </li><li>エラーになったアクション名  </li><li>アクション内のエラーメッセージ  </li><li>エラーメッセージ  </li><li>エラーの詳細<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/error-message.png"></li></ol><p><a id='anchor-raw-input-output'></a></p><h2 id="アクションの未加工入力、未加工出力"><a href="#アクションの未加工入力、未加工出力" class="headerlink" title="アクションの未加工入力、未加工出力"></a>アクションの未加工入力、未加工出力</h2><p>  実行履歴から該当アクションを展開し、入力および出力として表示されるテキストをコピーし、ご提供ください。  </p><ul><li><p>未加工入力の表示<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/raw-input.png"><br>未加工入力として表示されるテキストが多い場合は、「クリックしてダウンロードします」と表示されます。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/raw-input-output-note.png">  </p></li><li><p>未加工出力の表示<br> <img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/raw-output.png"><br>  未加工出力として表示されるテキストが多い場合は、「クリックしてダウンロードします」と表示されます。<br> <img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/raw-input-output-note2.png">  </p></li></ul><p><a id='anchor-tenantInfo'></a></p><h2 id="テナント情報"><a href="#テナント情報" class="headerlink" title="テナント情報"></a>テナント情報</h2><ul><li>フロー詳細画面を開き、「Ctrl＋Alt＋A」を押し、別ウィンドウに表示されるテキストをご提供ください。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/tenantinfo.png">  </li></ul><p><a id='anchor-environmentid'></a></p><h2 id="環境ID"><a href="#環境ID" class="headerlink" title="環境ID"></a>環境ID</h2><p>  以下の手順で環境 ID を取得し、ご提供ください。</p><ul><li>Power Automate ポータル &gt; (任意の環境選択) &gt; マイフロー を開きます。URL の environments/  と  /flows の間の文字列が環境 ID です。<br><img src="/blog/powerautomate/helpful-information-for-powerautomate-sr/environmentid.png">  </li></ul><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;br&gt;本記事では Power Automate 関連のお問い合わせの際の、情報取得手順についてご案内致します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>キャンバス アプリ所有者の退職・異動への備え</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/canvas-app-change-app-owner/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/canvas-app-change-app-owner/</id>
    <published>2022-02-16T15:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.062Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの谷です。<br/><br>今回は、キャンバス アプリ所有者の退職・異動に際し、Power Apps のキャンバス アプリ所有者を変更する方法についてご説明します。</p><span id="more"></span><h2 id="アプリの所有者・共同所有者・ユーザーとは？"><a href="#アプリの所有者・共同所有者・ユーザーとは？" class="headerlink" title="アプリの所有者・共同所有者・ユーザーとは？"></a>アプリの所有者・共同所有者・ユーザーとは？</h2><p>キャンバス アプリを作成・実行するためには以下の 3 種類の権限があります。<br/><br>それぞれ、役割に応じた権限を割り当て、安全にアプリを運用していきます。</p><p><strong>所有者</strong></p><p>アプリ作成者は自動的に所有者となります。<br>アプリの実行、編集、削除、共有設定を行うことが可能です。</p><p><strong>共同所有者</strong></p><p>アプリの実行、編集、共有設定を行うことが可能です。<br>アプリの削除は行うことができません。</p><p><strong>ユーザー</strong></p><p>アプリの実行を行うことが可能です。</p><h2 id="アプリ作成者-所有者-が退職あるいは離任する場合はどうしたらいいか？"><a href="#アプリ作成者-所有者-が退職あるいは離任する場合はどうしたらいいか？" class="headerlink" title="アプリ作成者 (所有者) が退職あるいは離任する場合はどうしたらいいか？"></a>アプリ作成者 (所有者) が退職あるいは離任する場合はどうしたらいいか？</h2><p>退職や異動により、アプリ所有者のアカウントが削除された場合、アプリ自体は削除されません。<br/><br>アプリを実行することは可能な状態ですが、所有者、及び共同所有者が一人も存在しないアプリは編集や削除ができません。</p><p>以下のケースごとに対応方法をご説明します。<br/></p><ul><li>ケース 1：アプリ作成者 (所有者) が退職してしまったがアプリを継続して利用 (編集) したい</li><li>ケース 2：アプリ作成者 (所有者) が退職してしまったのでアプリを削除したい</li></ul><h3 id="ケース-1-アプリ作成者-所有者-が退職してしまったがアプリを継続して利用したい"><a href="#ケース-1-アプリ作成者-所有者-が退職してしまったがアプリを継続して利用したい" class="headerlink" title="ケース 1 アプリ作成者 (所有者) が退職してしまったがアプリを継続して利用したい"></a>ケース 1 アプリ作成者 (所有者) が退職してしまったがアプリを継続して利用したい</h3><p>アプリ作成者 (所有者) のアカウントを削除後も、アプリを実行/編集するには、下記の対応が必要となります。</p><p><strong>&lt;共同所有者がいない場合&gt;</strong></p><ul><li>対応方法 1 管理者向け Power Apps コマンドレットで新たな所有者を割り当てる</li><li>対応方法 2 Power Platform 管理センターでアプリの共同所有者、あるいはユーザーを割り当てる</li></ul><p><strong>&lt;共同所有者がいる場合&gt;</strong></p><ul><li>必要な対応はございません。引き続き、アプリを実行いただけます。</li></ul><h3 id="ケース-2-アプリ作成者-所有者-が退職してしまったのでアプリを削除したい"><a href="#ケース-2-アプリ作成者-所有者-が退職してしまったのでアプリを削除したい" class="headerlink" title="ケース 2 アプリ作成者 (所有者) が退職してしまったのでアプリを削除したい"></a>ケース 2 アプリ作成者 (所有者) が退職してしまったのでアプリを削除したい</h3><p>新たな所有者、あるいは Power Platform 管理者などの管理者がアプリを削除することができます。</p><ul><li>対応方法 1 管理者用 Power Apps コマンドレットで新たな所有者を割り当て、所有者としてアプリを削除する</li><li>対応方法 2 Power Platform 管理センターで、管理者としてアプリを削除する</li></ul><p>以降では、それぞれの対応方法の詳細についてご説明いたします。</p><h2 id="管理者用-Power-Apps-コマンドレットでアプリの所有者を変更する方法"><a href="#管理者用-Power-Apps-コマンドレットでアプリの所有者を変更する方法" class="headerlink" title="管理者用 Power Apps コマンドレットでアプリの所有者を変更する方法"></a>管理者用 Power Apps コマンドレットでアプリの所有者を変更する方法</h2><p>グローバル管理者、Azure Active Directory グローバル管理者、Dynamics 365 管理者などの管理者はアプリの所有者を変更することができます。<br/><br>当コマンドレットは所有者のアカウントが存在する場合でも所有者を変更することが可能です。</p><p>なお、管理者用 Power Apps コマンドレットをご利用前に PowerShell モジュールをインストールいただく必要があります。<br/><br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation">https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation</a></p><p><strong>実行例</strong></p><ol><li>(事前準備) 管理者向け Power Apps コマンドレットをインストールします</li><li>管理者として PowerShell を実行します</li><li>以下のコマンドを実行します</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-AdminPowerAppOwner –AppName &#x27;&lt;アプリの GUID&gt;&#x27; -AppOwner &#x27;&lt;新たな所有者の GUID&gt;&#x27; –EnvironmentName &#x27;&lt;環境の GUID&gt;&#x27;</span><br></pre></td></tr></table></figure><p><strong>実行コマンドで指定する各種引数について</strong></p><ul><li>&lt;アプリの GUID&gt;、&lt;環境の GUID&gt;<ul><li>管理者用 Power Apps コマンドレット「<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powerapps.administration.powershell/get-adminpowerapp?view=pa-ps-latest">Get-AdminPowerApp</a>」コマンドでご取得ください</li><li><img src="/blog/canvasapp/canvas-app-change-app-owner/image01.png"></li></ul></li><li>&lt;新たな所有者の GUID&gt;<ul><li>「<a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/view-user-accounts-with-microsoft-365-powershell?view=o365-worldwide#view-additional-property-values-for-a-specific-account">Get-AzureADUser</a>」コマンド、あるいは Azure Active Directory 管理センターご確認ください</li><li>Get-AzureADUser 実行例<ul><li>例えば、以下のとおり実行いただきますとテナント内の全ユーザーについて ObjectId (AppOwner に指定する値) が取得できます。</li><li><pre><code>Get-AzureADUser | Select DisplayName, UserPrincipalName, ObjectId</code></pre></li><li><img src="/blog/canvasapp/canvas-app-change-app-owner/image02.png"></li></ul></li><li>Azure Active Directory 管理センターにおけるユーザーの GUID の確認例<ul><li><a href="https://aad.portal.azure.com/">Azure Active Directory 管理センター</a> &gt; ユーザー &gt; 対象のユーザー</li><li><img src="/blog/canvasapp/canvas-app-change-app-owner/image03.png"></li></ul></li></ul></li></ul><h2 id="Power-Platform-管理センターでアプリの共同所有者を追加する、あるいは削除する方法"><a href="#Power-Platform-管理センターでアプリの共同所有者を追加する、あるいは削除する方法" class="headerlink" title="Power Platform 管理センターでアプリの共同所有者を追加する、あるいは削除する方法"></a>Power Platform 管理センターでアプリの共同所有者を追加する、あるいは削除する方法</h2><p><strong>実行例</strong></p><ol><li>管理者の役割を持つユーザーで <a href="https://admin.powerplatform.com/">Power Platform 管理センター</a> にアクセスします</li><li>対象の環境の「…」メニューから「Power Apps」を選択します<br> <img src="/blog/canvasapp/canvas-app-change-app-owner/image04.png"></li><li>対象のアプリの「…」メニューから、共同所有者を追加する場合「共有」を、アプリを削除する場合「削除」を選択します<br> <img src="/blog/canvasapp/canvas-app-change-app-owner/image05.png"></li></ol><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><ul><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#set-logged-in-user-as-the-owner-of-a-canvas-app">キャンバス アプリのオーナーとしてログイン ユーザーを設定する</a></li><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/admin-manage-apps">Power Appsの管理</a></li><li><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/delete-app">キャンパス アプリを削除する</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの谷です。&lt;br/&gt;&lt;br&gt;今回は、キャンバス アプリ所有者の退職・異動に際し、Power Apps のキャンバス アプリ所有者を変更する方法についてご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Canvas app" scheme="https://jpdynamicscrm.github.io/blog/tags/Canvas-app/"/>
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="PowerShell" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerShell/"/>
    
  </entry>
  
  <entry>
    <title>WS-Trust による Dataverse への接続は、2022 年 4 月以降、非推奨（廃止）になります</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Deprecation-WS-Trust/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Deprecation-WS-Trust/</id>
    <published>2022-01-24T00:30:00.000Z</published>
    <updated>2022-09-14T03:11:01.194Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートチームの金子です。<br>2022 年 4 月以降、すべての Dataverse 環境にて、クライアントプログラムから WS-Trust (Office365) プロトコルによる認証が廃止されます。結果、ログインに失敗する可能性がございますので、該当する場合、プログラム対応をお願いいたします。<br>この記事では WS-Trust プロトコル利用有無の確認方法や対処方法についてご案内します。  </p><span id="more"></span><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-schedule">スケジュール</a></li><li><a href="#anchor-impacts">影響範囲</a></li><li><a href="#anchor-how-do-i-know">WS-Trust 利用有無確認方法</a></li><li><a href="#anchor-fix">対処方法</a></li></ol><p><a id='anchor-Intro'></a></p><h1 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h1><hr><p>2020 年 2 月に、セキュリティ観点により、クライアントプログラムからの WS-Trust 認証プロトコルによる Dataverse への接続が非推奨になることがアナウンスされ、段階的に廃止されています。<br>現時点では一部の Dynamics 365 や Power Platform 環境では、引き続き WS-Trust プロトコルにて認証可能ですが、2022 年 4 月以降、すべての環境で非推奨（廃止）となります。その結果、クライアントプログラムから Dataverse 環境へのログインに失敗する可能性がございます。  </p><p><a href="https://docs.microsoft.com/ja-jp/power-platform/important-changes-coming#deprecation-of-office365-authentication-type-and-organizationserviceproxy-class-for-connecting-to-dataverse">Dataverse に接続するための Office365 認証の種類と OrganizationServiceProxy クラスの廃止</a> </p><p><a id='anchor-schedule'></a></p><h1 id="スケジュール"><a href="#スケジュール" class="headerlink" title="スケジュール"></a>スケジュール</h1><hr><p>2020 年より、クライアントプログラムからの Dataverse への接続において、WS-Trust による認証は段階的に廃止されています。  </p><ul><li>2020 年 10 月以降に新規に作成されたテナントでは利用不可。以前に作成された既存テナントでは継続利用可能。</li><li>2021 年 4 月以降に新規に作成された環境は利用不可。以前に作成された既存環境では継続利用可能。</li><li>2022 年 4 月以降は、利用可能であった既存環境も含め、すべての環境で利用できなくなります。</li></ul><p><a id='anchor-impacts'></a></p><h1 id="影響範囲"><a href="#影響範囲" class="headerlink" title="影響範囲"></a>影響範囲</h1><hr><p>WS-Trust 廃止による影響範囲は以下の通りです。 </p><ul><li>Microsoft Dataverse へ接続するクライアントアプリケーションにのみ影響があります。</li><li>プラグイン、ワークフロー、オンプレミス/IFD 接続には影響を与えません。</li></ul><p>一例として、CrmServiceClient で接続文字列 AuthType=Office365 を指定するサンプルプログラムの動作を Fiddler でキャプチャした様子を以下に示します。<br>※ Fiddler はクライアント・サーバー間の HTTP/HTTPS 通信ログを取得して調査するためのツールです。具体的なログ採取方法は <a href="https://social.technet.microsoft.com/Forums/exchange/ja-JP/fe5f977a-2992-44c3-b643-38ad570a3d18/fiddler-12525124641239825505214622516338918?forum=DCRMSupport">Fiddler ログの採取手順</a> に紹介されています。  </p><p>2021 年 4 月以前に作成された環境へ WS-Trust プロトコルで認証する場合：<br>現時点で WS-Trust プロトコルが利用可能であるため、HTTP 200 が返却されています。<br><img src="/blog/powerplatform/Deprecation-WS-Trust/enabled.png">  </p><p>2021 年 4 月以降に作成された環境へ WS-Trust プロトコルで認証する場合：<br>既に WS-Trust プロトコルが利用不可であるため、ログインに失敗します。HTTP 500 エラーが発生し、下記メッセージが返却されます。<br>An error occurred when processing the security tokens in the message:You are using Ws-Trust authentication which has been deprecated and no longer supported in your environment. Please use OAuth2.0 authentication.<br><img src="/blog/powerplatform/Deprecation-WS-Trust/disabled.png"><br>Response Body 情報<br><img src="/blog/powerplatform/Deprecation-WS-Trust/disabled_XML.png">  </p><p><a id='anchor-how-do-i-know'></a></p><h1 id="WS-Trust-利用有無確認方法"><a href="#WS-Trust-利用有無確認方法" class="headerlink" title="WS-Trust 利用有無確認方法"></a>WS-Trust 利用有無確認方法</h1><hr><p>テナントにおいて、WS-Trust を用いた Dataverse への接続が発生している場合、<a href="https://admin.microsoft.com/#/MessageCenter">Microsoft 365 メッセージ センター</a> にて下記タイトルのメッセージが配信されている可能性があります。<br>Microsoft Dynamics 365: WS-Trust authentication protocol for connecting to Dataverse is being deprecated</p><p>なお、メッセージが配信されていない場合であっても、下記処理を実装している場合、WS-Trust を利用しています。</p><ul><li>   CrmServiceClientクラスを接続文字列で使用しており、AuthType=Office365 を指定している</li><li>   OrganizationServiceProxy クラスを使用している</li><li>   CrmServiceClient.OrganizationServiceProxy を使用している</li></ul><p>下記公開情報も併せてご参照のうえ、プログラムのご確認をお願いいたします。<br><a href="https://docs.microsoft.com/ja-jp/powerapps/developer/data-platform/authenticate-office365-deprecation#how-do-i-know-if-my-code-or-application-is-using-ws-trust">コードやアプリケーションが WS-Trust を使用しているかどうかを確認するにはどうすればよいですか？</a></p><p><a id='anchor-fix'></a></p><h1 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h1><hr><p>下記公開情報を参考に、接続インターフェイスの変更や、認証タイプ OAuth へ移行をご検討ください。<br><a href="https://docs.microsoft.com/ja-jp/powerapps/developer/data-platform/authenticate-office365-deprecation#what-should-i-do-to-fix-my-application-code-if-affected">この影響を受けた場合、アプリケーションのコードを修正するにはどうすればよいですか。</a></p><p>2021 年 4 月以降に作成された環境では WS-Trust が利用できないため、改修後の認証接続テストにご利用ください。必要に応じて、既存の運用環境を WS-Trust プロトコル利用不可環境へコピーしてテストをお願いいたします。</p><hr><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>より詳細な情報が必要な場合、弊社テクニカルサポート、Customer Success Account Manager (CSAM), Customer Engineer (CE) までお問い合わせください。 </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートチームの金子です。&lt;br&gt;2022 年 4 月以降、すべての Dataverse 環境にて、クライアントプログラムから WS-Trust (Office365) プロトコルによる認証が廃止されます。結果、ログインに失敗する可能性がございますので、該当する場合、プログラム対応をお願いいたします。&lt;br&gt;この記事では WS-Trust プロトコル利用有無の確認方法や対処方法についてご案内します。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
    <category term="重要な変更点 (廃止)" scheme="https://jpdynamicscrm.github.io/blog/tags/%E9%87%8D%E8%A6%81%E3%81%AA%E5%A4%89%E6%9B%B4%E7%82%B9-%E5%BB%83%E6%AD%A2/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop のサポート範囲について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/</id>
    <published>2022-01-20T03:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.102Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポート チームの 王 です。<br>今日は Power Automate for desktop のサポート範囲についてご案内いたします。  </p><span id="more"></span><h2 id="初めに"><a href="#初めに" class="headerlink" title="初めに"></a>初めに</h2><p>Power Automate for desktop は Windows 10 をご利用のお客様であればどなたでも追加費用なしでご利用いただける RPA ツールです。2021年3月3日(日本時間)に公開されました。<br><a href="https://docs.microsoft.com/ja-jp/power-automate/desktop-flows/introduction">Power Automate for desktop の概要</a>  </p><p>今回は Power Automate for desktop のサポート範囲についてご案内します。  </p><h2 id="Power-Automate-for-desktop-のサポートについて"><a href="#Power-Automate-for-desktop-のサポートについて" class="headerlink" title="Power Automate for desktop のサポートについて"></a>Power Automate for desktop のサポートについて</h2><p>Windows のライセンスに含まれる Power Automate for desktop は、PC にインストールして使用する無料のアプリケーションです。<br>このアプリケーションには、SLA や Microsoft サポートが含まれないため、ビジネスクリティカルな用途で使用すべきではありません。<br>Power Automate for desktop をビジネスクリティカルな用途で使用する場合、サポートが含まれる適切な Microsoft ライセンスの購入をご検討ください。<br>対象となるライセンスは以下です ※2022/1 時点<br>・Power Automate per user plan with attended RPA<br>・Power Automate unattended RPA add-on（前提としてPower Automate per user with attended RPA または Power Automate per flow が必要）  </p><p>ライセンスのご購入状況は、Microsoft 365 管理センターの [課金情報] - [サービスを購入する] からご確認いただけます。<br>上記ライセンスで Power Automate for desktopご利用されていないお客様は、サポートにお問い合わせをいただいた場合もご支援することができません。<br>ライセンスをお持ちでない場合は、以下のコミュニティをご活用ください。<br><a href="https://powerusers.microsoft.com/t5/Microsoft-Power-Automate/ct-p/MPACommunity">Microsoft Power Automate Community</a></p><p>また、お問い合わせをいただく際には、弊社にてライセンスのチェックを行わせていただく場合がございますので、Power Automate for desktop を使用しているアカウントの UPN を添えてお問い合わせいただけますと幸いでございます。</p><p>サポート範囲については以下ライセンスガイドからもご確認いただくことが可能です。<br>英語版　：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409</a><br>日本語版：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411</a>  </p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>Power Autoamte for desktop で弊社サポートをご利用いただけるライセンスにについてご案内いたしました。<br>製品やライセンスに関する情報は随時更新されるため、最新の情報については公開情報もしくは上記ライセンスガイドをご参照ください。  </p><p>–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポート チームの 王 です。&lt;br&gt;今日は Power Automate for desktop のサポート範囲についてご案内いたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>「電源フローのロジック アプリ フロー テンプレートが無効です。」 エラーについて</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/logic-app-flow-template-was-invalid-error/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/logic-app-flow-template-was-invalid-error/</id>
    <published>2022-01-20T00:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.110Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、日本マイクロソフト Power Automate サポートの清水です。<br>この記事では、Power Automate の一部のインスタント フローで表示される以下のエラーに関してご説明します。  </p><p><code>電源フローのロジック アプリ フロー テンプレートが無効です。The &#39;type&#39; property of template trigger &#39;manual&#39; at line &#39;1&#39; and column &#39;#####&#39; has the value &#39;Manual&#39; which is deprecated in schema version &#39;2016-04-01-preview&#39; and onwards.</code></p><span id="more"></span><hr><p>2021 年 11 月 8 日頃、Power Automate のクラウド フローに新たな機能としてコメント機能が追加されました。  </p><p>ブログ: <a href="https://powerautomate.microsoft.com/ja-jp/blog/collaborative-comments-in-power-automate/">Collaborative comments in Power Automate | Power Automate ブログ (microsoft.com)​​​​​​​</a><br>公開情報: <a href="https://docs.microsoft.com/en-us/power-automate/multi-step-logic-flow#add-comments-to-actions-and-triggers">Add an advanced option and multiple actions - Power Automate | Microsoft Docs</a>  </p><p>この変更により、当該機能のリリース前に作成されたフローでは、機能の追加後初めてフローの編集画面を開いた際、一度だけフローの自動保存が行われる動作となりました。<br>これは、コメント機能を有効にするためのメタデータを追加するための作業です。<br>※編集画面を開くと、フローの読み込み時に保存メッセージが表示されます。<br><img src="/blog/powerautomate/logic-app-flow-template-was-invalid-error/img01.png">  </p><p>この際、一部のインスタント フローでは、フローの読み込みが完了する前にフローの保存が実行されることが原因で、保存時に以下のエラーが発生する場合があります。  </p><p><img src="/blog/powerautomate/logic-app-flow-template-was-invalid-error/img02.png">  </p><p>上述の通り、フローの保存に失敗したことで発生するエラーのため、エラーが発生した場合でもフローの動作への影響はありません。<br>また、自動保存の動作は、既存のフローへコメントの機能を追加するために一度のみ実行されるため、<br>エラーが発生した場合には、手動でフローを再保存することで以降はエラーが解消します。  </p><p>そのため、上記のエラーが発生した場合には、一度手動でフローを保存しエラーが解消されるかをご確認ください。  </p><p>また、エラーが解消しない場合や、ご不明点がある場合には、弊社サポート窓口までお問い合わせください。  </p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、日本マイクロソフト Power Automate サポートの清水です。&lt;br&gt;この記事では、Power Automate の一部のインスタント フローで表示される以下のエラーに関してご説明します。  &lt;/p&gt;
&lt;p&gt;&lt;code&gt;電源フローのロジック アプリ フロー テンプレートが無効です。The &amp;#39;type&amp;#39; property of template trigger &amp;#39;manual&amp;#39; at line &amp;#39;1&amp;#39; and column &amp;#39;#####&amp;#39; has the value &amp;#39;Manual&amp;#39; which is deprecated in schema version &amp;#39;2016-04-01-preview&amp;#39; and onwards.&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Cloud flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flows/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate クラウド フローを使用して、Microsoft Graph API を実行する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Graph-API/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Graph-API/</id>
    <published>2022-01-11T00:30:00.000Z</published>
    <updated>2022-09-14T03:11:01.090Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの清水です。<br>この記事では、Power Automate を使用して、Microsoft Graph API を実行する方法についてご紹介いたします。</p><span id="more"></span><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-license-requirement">必要なライセンス</a></li><li><a href="#anchor-decide-the-API">使用する API を決定する</a></li><li><a href="#anchor-check-the-permission">必要なアクセス許可を確認する</a></li><li><a href="#anchor-use-HTTP-with-Azure-AD-Connector">HTTP with Azure AD コネクタを使用する</a></li><li><a href="#anchor-use-HTTP-connector">HTTP コネクタを使用する</a></li></ol><p><a id='anchor-Intro'></a></p><h1 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h1><hr><p>Power Automate では、コネクタを使用して様々な操作を自動化することができますが、目的の操作がコネクタでは用意されていない場合、API を使用することでフローでの自動化が実現可能な場合があります。  </p><p>ここでは、Microsoft Graph API を使用して API リクエストを送信する 2 つの方法について、ご説明いたします。</p><p><a id='anchor-license-requirement'></a></p><h1 id="必要なライセンス"><a href="#必要なライセンス" class="headerlink" title="必要なライセンス"></a>必要なライセンス</h1><hr><p>今回作成するフローではプレミアム コネクタを使用するため、以下のいずれかのライセンスが必要です。  </p><ul><li>Power Automate per user</li><li>Power Automate per flow</li><li>Power Automate per user with attended RPA</li></ul><p><a id='anchor-decide-the-API'></a></p><h1 id="使用する-API-を決定する"><a href="#使用する-API-を決定する" class="headerlink" title="使用する API を決定する"></a>使用する API を決定する</h1><hr><p>まずは使用する API を決定します。<br><a href="https://docs.microsoft.com/ja-jp/graph/api/overview?view=graph-rest-1.0">Microsoft Graph API のリファレンス</a> から、目的に合った API を探してください。  </p><p>本記事では、よくあるお問い合わせの一つとして、「テキスト形式でメールを送信する」処理を例にとって進めていきたいと思います。<br>Power Automate の Office 365 Outlook コネクタ「メールを送信する (V2)」アクションでは、HTML 形式のメールしか送信できませんが、Graph API を使用することで、テキスト形式でメールを送信することも可能です。<br>今回使用する API はこちらです。<br><a href="https://docs.microsoft.com/ja-jp/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http">メールを送信する - Microsoft Graph v1.0 | Microsoft Docs</a>  </p><p><a id='anchor-check-the-permission'></a></p><h1 id="必要なアクセス許可を確認する"><a href="#必要なアクセス許可を確認する" class="headerlink" title="必要なアクセス許可を確認する"></a>必要なアクセス許可を確認する</h1><hr><p>公開情報には、必ず API を呼び出すために必要なアクセス許可が記されているので、「アクセス許可」のセクションにて必要なアクセス許可が何かを確認してください。   </p><p>アクセス許可の選択方法などの詳細については、<a href="https://docs.microsoft.com/ja-jp/graph/permissions-reference">Microsoft Graph のアクセス許可のリファレンス | Microsoft Docs</a>をご参照ください。<br>今回使用する API では、以下のアクセス許可が必要です。  </p><p><img src="/blog/powerautomate/Graph-API/img01.png">  </p><p>ここで、アクセス許可には「委任」と「アプリケーション」の 2 種類があります。  </p><ul><li>委任されたアクセス許可<br>ユーザーの代わりにアクセスする際に使用いたします。<br>API を実際に実行するアプリケーションに対し、サインインしているユーザーとして動作するためのアクセス許可が委任されます。  </li><li>アプリケーションのアクセス許可<br>ユーザーなしでアクセスする際に使用いたします。<br>API を実行するアプリケーション自体にアクセス許可を付与します。  </li></ul><p>委任されたアクセス許可が使用できる場合は、ユーザーに変わって API を実行する HTTP with Azure AD コネクタが、<br>アプリケーションのアクセス許可が使用できる場合は、ユーザーなしで API を実行する HTTP コネクタが使用できます。  </p><p>それぞれのコネクタの使い方について説明します。  </p><p><a id='anchor-use-HTTP-with-Azure-AD-Connector'></a></p><h1 id="HTTP-with-Azure-AD-コネクタを使用する"><a href="#HTTP-with-Azure-AD-コネクタを使用する" class="headerlink" title="HTTP with Azure AD コネクタを使用する"></a>HTTP with Azure AD コネクタを使用する</h1><hr><p>HTTP with Azure AD コネクタでは、接続でサインインしたユーザーに代わって API を実行できます。    </p><ol><li><p>HTTP with Azure AD コネクタの「HTTP 要求を呼び出します」アクションを挿入します。</p></li><li><p>コネクタを初めて使用する場合、接続を作成します。<br>今回は Graph API を実行するため、「基本リソース URL」と「Azure AD リソース URL」の両方に以下の URL を設定し、[サインイン] をクリックします。  </p><ul><li>URL: <a href="https://graph.microsoft.com/">https://graph.microsoft.com</a>  </li></ul><p><img src="/blog/powerautomate/Graph-API/img02.png"><br>※ここでサインインしたユーザーのアクセス許可が委任され、API が実行されます。  </p></li><li><p><a href="https://docs.microsoft.com/ja-jp/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http#http-request">API のリファレンス</a> を参考に、リクエストを作成します。  </p><p><img src="/blog/powerautomate/Graph-API/img03.png">  </p><p>&lt;補足&gt;<br>本文の指定方法は、各リソースのリファレンスを参考に変更してください。<br>今回は、Message リソースを使用するので、下記の公開情報を参照しました。<br><a href="https://docs.microsoft.com/ja-jp/graph/api/resources/message?view=graph-rest-1.0">メッセージ リソースの種類 - Microsoft Graph | Microsoft Docs</a>  </p><p>また、テキスト形式でメールを送信することが目的なので、 <code>message.body.contentType</code> を <code>Text</code> に設定します。  </p><p><img src="/blog/powerautomate/Graph-API/img04.png">  </p></li><li><p>フローを実行し、正常に実行されるか確認します。  </p></li></ol><div class="alert is-info"><p class="alert-title">Note</p><p>必要なアクセス許可の種類によっては、HTTP with Azure AD コネクタでは API が実行できない場合があります。</p><p>HTTP with Azure AD コネクタで実行できる権限スコープの一覧は現時点では公開されておりませんが、フローを実行した際に権限エラーが発生する場合、HTTP with Azure AD コネクタでは実行できない可能性がございますので、HTTP コネクタでの実行をお試しください。  </p></div><p><a id='anchor-use-HTTP-connector'></a></p><h1 id="HTTP-コネクタを使用する"><a href="#HTTP-コネクタを使用する" class="headerlink" title="HTTP コネクタを使用する"></a>HTTP コネクタを使用する</h1><hr><p>HTTP コネクタでは、ユーザーのサインインなしに、Azure AD に登録したアプリから API を実行できます。  </p><ol><li>Azure AD にアプリを登録します。<br><a href="https://docs.microsoft.com/ja-jp/graph/auth-register-app-v2?context=graph/api/1.0&view=graph-rest-1.">アプリを Azure AD v2.0 エンドポイントに登録する - Microsoft Graph | Microsoft Docs</a> にしたがって、 Azure AD にアプリを登録します。<br>また、登録したアプリの [API のアクセス許可] のページにて、「必要なアクセス許可を確認する」の手順で確認したアプリケーションのアクセス許可を追加し、管理者の同意を与えます。  <img src="/blog/powerautomate/Graph-API/img07.png">   </li><li>HTTP コネクタの「HTTP」アクションを挿入します。<br>2-1. <a href="https://docs.microsoft.com/ja-jp/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http#http-request">API のリファレンス</a> を参考に、リクエストを作成します。<br>   HTTP コネクタを使用する場合、サインイン中のユーザーがいないため、<code>/me/sendMail</code>ではなく、<code>/users/&#123;id | userPrincipalName&#125;/sendMail</code> の要求方法を使用することに注意してください。     <img src="/blog/powerautomate/Graph-API/img06.png">  2-2. 認証を「Active Directory OAuth」に設定し、Azure AD に登録したアプリから取得した情報を設定します。  <ul><li>テナント: ディレクトリ (テナント) ID  </li><li>対象ユーザー: <a href="https://graph.microsoft.com/">https://graph.microsoft.com</a>  </li><li>クライアント ID: アプリケーション (クライアント) ID  </li><li>資格情報の種類: シークレット  </li><li>シークレット: [証明書とシークレット] より、新しいクライアントシークレットを発行し、発行された「値」  </li></ul><img src="/blog/powerautomate/Graph-API/img05.png">  </li><li>フローを実行し、正常に実行されるか確認します。  </li></ol><hr><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>Power Automate から Graph API を実行することで、様々な操作を自動化することができます。<br>ぜひ、色々なシーンで活用してみてください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの清水です。&lt;br&gt;この記事では、Power Automate を使用して、Microsoft Graph API を実行する方法についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Graph API" scheme="https://jpdynamicscrm.github.io/blog/tags/Graph-API/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse グループ チームの活用方法＆注意点</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/About-group-team-in-Dataverse/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/About-group-team-in-Dataverse/</id>
    <published>2022-01-07T04:45:00.000Z</published>
    <updated>2022-09-14T03:11:01.126Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの島です。</p><p>Dataverse では、Azure AD グループ チームを作成することで、セキュリティ グループへのユーザー所属状態によって、ロールを自動的に付け外しすることができます。<br>「特定の管理者用セキュリティ グループに所属するユーザーに、自動的にシステム管理者ロールを付与する」というような運用も可能です。</p><span id="more"></span><p>つまり、Azure AD グループ チームを利用いただくことで、<strong>グループ チーム配下の Dataverse ユーザーを、Azure AD グループから一元管理</strong>することが可能となります。</p><p>そこでこの記事では、使い方、またサポートでよくいただくグループ チーム関連のご質問についてご案内します。</p><h2 id="そもそも、チームとは？"><a href="#そもそも、チームとは？" class="headerlink" title="そもそも、チームとは？"></a>そもそも、チームとは？</h2><hr><p>Dataverse では、グループ チームを含め、4 種類のチームという概念を持ち、この中にユーザーを所属させることができます。<br>それぞれについて簡単にご紹介します。</p><p><strong>1. 所有者チーム</strong><br>セキュリティ ロールを割り当てることのでき、レコードを所有できるチームです。<br>グループ チームと似ていますが、Azure AD グループとは連動しないため、ユーザーを明示的に指定して追加する必要があります。<br>またDataverse 上の「部署」というオブジェクトに紐づいて自動作成されます。(なのでグループ チームの操作を何もしていなくても、環境に最低ひとつはこの所有者チームが存在します。)<br><strong>2. アクセス チーム</strong><br>セキュリティ ロールを割り当てることができず、レコードも所有しないチームです。<br>ただ、アクセス チーム自体がレコードへのアクセス権を持つため、セキュリティ ロールに依存しないアクセス権制御を行うことができます。<br>将来削除される予定があり、レコードを所有させたくないような一時的なチーム (プロジェクトなど) に適したチームと言えます。<br><strong>3. Azure AD グループ チーム (Office グループ / セキュリティ グループ)</strong><br>セキュリティ ロールを割り当てることのでき、レコードを所有できるチームです。また、Azure AD グループと連動します。<br>種類として Office グループ チームと セキュリティ グループ チームの 2 つに分かれますが、記事執筆時点ではグループの種類による機能差はありません。</p><p>上記の内容をまとめると、以下のように各チームを比較できます。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image01-compareTeam.png"></p><p>Azure AD グループチームの特色は、文字通り Azure AD グループと連携でき、<strong>グループ チーム配下の Dataverse ユーザーを、Azure AD グループから一元管理</strong>できることです。</p><h2 id="Azure-AD-グループチームで具体的にできること"><a href="#Azure-AD-グループチームで具体的にできること" class="headerlink" title="Azure AD グループチームで具体的にできること"></a>Azure AD グループチームで具体的にできること</h2><hr><p>Azure AD グループチームでできること、メリットについて具体的にご紹介します。</p><h3 id="1-Azure-AD-グループとの連携"><a href="#1-Azure-AD-グループとの連携" class="headerlink" title="1. Azure AD グループとの連携"></a>1. Azure AD グループとの連携</h3><p>Azure AD グループチームでは、セキュリティ グループや Office グループとの同期が可能です。<br>Azure AD グループチームは Power Platform 管理センターから作成することができますが、このときに対応するAzure AD グループを選択することで、チームとグループを紐づけることができます。</p><p><strong>【手順】</strong></p><ol><li>Power Platform 管理センターで 設定 &gt; ユーザーとアクセス許可 &gt; チーム を選択ください。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image02-PPAC01.png"></li><li>「チームの作成」を選択ください。</li><li>作成時の入力項目を以下の通り入力ください。この後チームを作成することで、入力したグループとチーム同士が紐づきます。<br>・チームの種類 : AAD セキュリティ グループ または AAD Office グループを選択ください。<br>・グループ名 : 対応するAzure AD グループ名を選択ください。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image03-PPAC02.png"><br>ちなみに、以下の項目はグループ チームとは関係がありませんが、ご参考までに入力内容を紹介いたします。<br>・チーム名、説明 : 任意のものを入力ください。<br>・部署 : Dataverse の部署を作成いただいている場合は適宜ご要件に合わせて選択ください。作成していない場合はデフォルトの部署が 1 つだけ表示されますので、その部署を選択ください。<br>・管理者 : ご要件に合わせて管理者となるユーザーをご選択ください。<br>・メンバーシップの種類 : Azure AD グループ メンバーシップを入力する欄です。<strong>後のセクションでもご説明します！</strong></li></ol><p>チームを作成すると、紐づけた Azure AD グループのメンバーのうち環境に対してアクセス権があるユーザーが、自動的に Dataverse のグループ チームに追加されます。<br>また、異動などでチームのメンバーでなくなったユーザーは、自動的にグループ チームのメンバーからも削除されます。</p><h4 id="2-セキュリティ-ロールの紐づけ"><a href="#2-セキュリティ-ロールの紐づけ" class="headerlink" title="2. セキュリティ ロールの紐づけ"></a>2. セキュリティ ロールの紐づけ</h4><p>Azure AD グループ チームに対してセキュリティ ロールを紐づけることで、配下の Dataverse のユーザーに対してそのロールを継承させることができます。</p><p><strong>[手順]</strong></p><ol><li>Power Platform 管理センターで 設定 &gt; ユーザーとアクセス許可 &gt; チーム を選択後、任意のチームを選択ください。</li><li>セキュリティ ロールの管理 を選択ください。</li><li>下図のように割り当てるセキュリティ ロールの一覧が表示されるので、任意のロールを選択ください。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image04-PPACeditRole.png"></li></ol><p>このセキュリティ ロールの割り当て機能により、「管理者用のグループ チームにはシステム管理者ロールを付与する」「開発者用のグループ チームには Environment Makerを付与する」というように、チームごとに一括でロールを割り当てることが可能になります。<br>加えて 1 でご説明したように、チームのメンバーは Azure AD と同期して自動で決定されるので、この 2 つの機能を組み合わせることで、要件に即したロールの一括付与を自動で実行できるようになります。</p><h2 id="よくいただくお問合せ"><a href="#よくいただくお問合せ" class="headerlink" title="よくいただくお問合せ"></a>よくいただくお問合せ</h2><hr><p>上記の通り、Azure AD グループ チームは、ユーザーおよびロールの一元管理が可能な強力な機能です。<br>こちらの機能をよりご活用いただきたいため、サポート チームでよくいただく質問をおまとめいたしました。ぜひご確認ください。</p><h3 id="グループ-チーム作成時、メンバーシップに何を指定すればよいのかわからない"><a href="#グループ-チーム作成時、メンバーシップに何を指定すればよいのかわからない" class="headerlink" title="グループ チーム作成時、メンバーシップに何を指定すればよいのかわからない"></a>グループ チーム作成時、メンバーシップに何を指定すればよいのかわからない</h3><p>グループ チームのメンバーシップは、Azure AD 側のグループのメンバーシップに対応するものです。<br>選択肢ごとにの具体的な設定内容は以下の通りです。<br>(1) メンバー ： Azure AD グループに所属するメンバー (ゲストユーザーを除く) です。<br>(2) ゲスト : Azure AD グループに所属するゲストユーザーです。<br>(3) メンバーとゲスト : (1)と(2)の両方をメンバーとする選択肢です。<br>(4) 所有者 : Azure AD グループの所有者です。通常、管理者など要件に合わせたユーザーを明示的に指定することで割り当てられます。</p><p>グループ チームをご活用いただく場合、通常はメンバーのロールを一元管理することが目的の場合が多いので、(1)または(3)を選んでいただくケースが最も多いかと存じます。</p><h3 id="Azure-AD-グループに所属するメンバーのうち、一部のメンバーしかグループ-チームに所属していない"><a href="#Azure-AD-グループに所属するメンバーのうち、一部のメンバーしかグループ-チームに所属していない" class="headerlink" title="Azure AD グループに所属するメンバーのうち、一部のメンバーしかグループ チームに所属していない"></a>Azure AD グループに所属するメンバーのうち、一部のメンバーしかグループ チームに所属していない</h3><p>グループ チームを作成したタイミングと、実際に Dataverse 上のユーザーオブジェクトがグループに割り当てられるタイミングが異なることで、メンバーが一部しか所属していないように見えている可能性があります。<br>実際に、Dataverse 上のユーザーオブジェクトがグループに所属するのは、グループ チーム作成後、当該ユーザーが最初に環境のキャンバス アプリまたはモデル駆動アプリにアクセスしたタイミングです。<br>そのため、グループ チームを作成したあと、チームのメンバーを以下のように確認された際には、グループ チーム作成後にアプリにアクセスしたことのあるメンバーしか表示されません。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image06-teamMember.png"></p><p>チームのメンバーがアプリにアクセスしていくことで、いずれは全員がメンバーに追加されますので、ご安心ください。</p><h3 id="ユーザーに対してロールが継承されていないように見える"><a href="#ユーザーに対してロールが継承されていないように見える" class="headerlink" title="ユーザーに対してロールが継承されていないように見える"></a>ユーザーに対してロールが継承されていないように見える</h3><p>Power Platform 管理センターまたはユーザーの設定画面で、ユーザーのセキュリティ ロールをご確認いただけますが、こちらの画面ではあくまでユーザー本人に対して直接割り当てられたセキュリティ ロールのみが表示されます。<br>そのためチームから継承されたロールをご確認いただくことができませんが、正しい手順を実施いただき、かつユーザーがアプリに既にアクセスしていれば、ユーザーに対してロールが継承されますので、ご安心ください。</p><p>ユーザーに対して直接付与されたロールと継承されたロールの両方を確認されたい場合には、特定データのフォームを開いた上で上部リボンの「アクセス権の確認」を選択いただくことで、当該データに関連するユーザーのすべての権限をご確認いただくことが可能です。<br><img src="/blog/powerplatform/About-group-team-in-Dataverse/image05-accessCheck.png"></p><h3 id="入れ子のAzure-AD-グループにグループ-チームを作成する際の留意点について"><a href="#入れ子のAzure-AD-グループにグループ-チームを作成する際の留意点について" class="headerlink" title="入れ子のAzure AD グループにグループ チームを作成する際の留意点について"></a>入れ子のAzure AD グループにグループ チームを作成する際の留意点について</h3><p>Azure AD グループが入れ子になっており、かつ親グループと紐づくグループ チームが作成された場合、子グループのメンバーもグループ チーム内に追加されます。<br>なお、<strong>「入れ子のうち子セキュリティ グループのメンバーを環境に自動で追加したい・セキュリティ ロールを割り振りたい」</strong>というお問合せをよくいただきますが、その際にこの入れ子のグループ チームの手法を応用することができます。<br>環境にセキュリティ グループを追加し、かつセキュリティ グループに子となるセキュリティ グループが存在する場合、子グループのメンバーは環境に事前に追加されません。<br>ただし、親グループを含むグループにグループ チームが作成されている場合には、子グループのメンバーも自動で事前に追加されます。<br>(ご参考 : <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/control-user-access">環境へのユーザー アクセスのコントロール: セキュリティ グループおよびライセンス</a>)<br><em>環境セキュリティ グループ内の入れ子のセキュリティ グループのメンバーは、事前にプロビジョニングされたり、Dataverse 環境に自動的に追加されたりすること は、ありません。 ただし、入れ子のセキュリティ グループに Dataverse グループ チーム を作成すると、環境に追加できます。</em></p><p>つまり、<strong>親グループのグループ チームを作成することで、子グループのメンバーも自動で環境に追加される</strong>ようになります<br>これにより、メンバーが環境にアクセスする前に、子グループのメンバーを自動で環境に追加し、セキュリティ ロール追加やレコード共有などの追加の設定を行うことができるようになります。</p><h2 id="関連する公開情報"><a href="#関連する公開情報" class="headerlink" title="関連する公開情報"></a>関連する公開情報</h2><hr><p>・<a href="https://docs.microsoft.com/ja-jp/power-platform/admin/manage-teams">Microsoft Dataverse チームの管理</a> : グループ チームを含め、Dataverse の各チームについてご案内しています。<br>・<a href="https://docs.microsoft.com/ja-jp/power-platform/admin/control-user-access">グループ チームを管理する</a> : グループ チームの概要、また作成・編集手順をご案内しています。</p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><hr><p>以上、Azure AD グループ チームの概要、およびよくいただくお問合せについてご案内しました。<br>グループ チームを利用しない場合、ユーザーひとりひとりにアクセス権を付与する必要があるため、ユーザー数やセキュリティ ロール数が多い組織だと運用が煩雑になりがちです。<br>ぜひグループ チームを運用に導入いただき、効率的なユーザー管理にご活用ください！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの島です。&lt;/p&gt;
&lt;p&gt;Dataverse では、Azure AD グループ チームを作成することで、セキュリティ グループへのユーザー所属状態によって、ロールを自動的に付け外しすることができます。&lt;br&gt;「特定の管理者用セキュリティ グループに所属するユーザーに、自動的にシステム管理者ロールを付与する」というような運用も可能です。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Model-driven app" scheme="https://jpdynamicscrm.github.io/blog/tags/Model-driven-app/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
  </entry>
  
  <entry>
    <title>2021 年 Wave2 で追加されたモデル駆動アプリの検索方法まとめ</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/2021-wave2-added-search/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/2021-wave2-added-search/</id>
    <published>2021-11-16T04:45:00.000Z</published>
    <updated>2022-09-14T03:11:01.110Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの島です。</p><p>Power Platform の半期に一度の大規模リリース (Wave2) が日本リージョンで 10 月 11 日 (月) から一般公開されました。<br>本記事では、このリリース内で行われた更新のうち、モデル駆動型アプリ / Dynamics 365 における検索についてご案内いたします。</p><span id="more"></span><p>Wave2 では、以下 2 つの検索方法が追加・更新されております。</p><ol><li>Dataverse 検索 (関連性検索)</li><li>高度なルックアップ</li></ol><p>サポートチームでもたくさんのお問合せをいただいているこれらの検索方法について、それぞれ詳しくご紹介いたします！</p><h2 id="Dataverse-検索"><a href="#Dataverse-検索" class="headerlink" title="Dataverse 検索"></a>Dataverse 検索</h2><hr><p>Wave2 より、運用環境において既定で Dataverse 検索が有効化されるようになりました。</p><h3 id="そもそも、Dataverse-検索とは？"><a href="#そもそも、Dataverse-検索とは？" class="headerlink" title="そもそも、Dataverse 検索とは？"></a>そもそも、Dataverse 検索とは？</h3><p>以下のキャプチャのように、画面上部のヘッダに表示されている検索欄が Dataverse 検索 (関連性検索) です。<br><img src="/blog/powerplatform/2021-wave2-added-search/00_dataverse_search.png"></p><p>実際にこちらを検索してみると、以下のようにキーワードを入力するだけで関連エンティティを含めた検索ができます。<br><img src="/blog/powerplatform/2021-wave2-added-search/01_dataverse_search_content.png"></p><p>ちなみに、Wave2 以前では、この検索欄は「カテゴリ別検索」または「簡易検索」と呼ばれ、ヘッダの虫眼鏡マークからご利用いただくことができました。<br><img src="/blog/powerplatform/2021-wave2-added-search/02_federation_search.png"></p><p>このカテゴリ別検索から、より検索性や操作性を向上させた機能が Dataverse 検索です。</p><h3 id="Dataverse-検索では具体的に何を検索しているのか？"><a href="#Dataverse-検索では具体的に何を検索しているのか？" class="headerlink" title="Dataverse 検索では具体的に何を検索しているのか？"></a>Dataverse 検索では具体的に何を検索しているのか？</h3><p>Dataverse 検索で検索対象を決定する仕組みについてご案内いたします。</p><p>Dataverse 検索では、<strong>テーブル (エンティティ) × 列 (フィールド)</strong> をそれぞれ検索対象として指定できます。</p><p><strong>1. 検索対象のテーブル</strong><br>Dataverse 検索では、検索対象のテーブルを指定することができます。<br>環境の詳細設定画面、または Power Apps のソリューション設定画面から指定ができるのですが、今回はソリューション設定画面をご紹介いたします。<br>Power Apps (<a href="https://make.powerapps.com/">https://make.powerapps.com</a>) からソリューションを選択し、「概要」&gt; 「Dataverse 検索」&gt;「検索インデックスの管理」より、検索対象のテーブルを指定いただけます。<br>なお、Dataverse 検索の対象テーブル自体はソリューションに含まれる要素ではないため、ソリューションは任意のものをご選択いただければ問題ございません。<br><img src="/blog/powerplatform/2021-wave2-added-search/03_dataverse_table.png"></p><p><strong>2. 検索対象の列</strong><br>検索対象の列も、環境の詳細設定画面の他、Power Apps のテーブル設定画面からご確認いただけます。<br>テーブルの各列を選択し「検索可能」をチェックいただくことで、検索対象に指定される列を指定いただけます。<br><img src="/blog/powerplatform/2021-wave2-added-search/04_dataverse_index.png"></p><p>既定の状態でも、主要なテーブル・主要な列は検索対象として指定されていますが、<br>カスタムテーブルなどを作成いただいている場合にはぜひ検索対象に追加の上、検索をご活用ください。</p><h2 id="高度なルックアップ"><a href="#高度なルックアップ" class="headerlink" title="高度なルックアップ"></a>高度なルックアップ</h2><hr><p>Wave2 より、検索 (ルックアップ) 列の入力時に高度なルックアップをご利用いただけるようになりました。</p><ol><li><p>列の入力時に虫眼鏡マークをクリック後、「高度な検索」を選択ください。<br><img src="/blog/powerplatform/2021-wave2-added-search/05_advanced_search.png"></p></li><li><p>図のように、高度なルックアップウィンドウが表示されます。<br><img src="/blog/powerplatform/2021-wave2-added-search/06_advanced_search_content.png"></p></li></ol><p>高度なルックアップウィンドウでは、入力フィールドに適したテーブルのビューから、登録したいデータを選択することができます。<br>今までも、1. の画面で表示されている小さいウィンドウから対象データを検索することができましたが、大画面かつビューを選択できるようになったことで、よりデータの絞り込みがしやすくなりました。<br>複数選択や、複数テーブルの検索もできますので、ぜひご利用ください。</p><h4 id="よくいただくお問合せ"><a href="#よくいただくお問合せ" class="headerlink" title="よくいただくお問合せ"></a>よくいただくお問合せ</h4><hr><h3 id="各検索方法を無効化する方法"><a href="#各検索方法を無効化する方法" class="headerlink" title="各検索方法を無効化する方法"></a>各検索方法を無効化する方法</h3><p>Dataverse 検索に関しては、以下の画像のように、Power Platform 管理センターから有効 / 無効を切り替えることができます。<br><img src="/blog/powerplatform/2021-wave2-added-search/07_dataverse_search_setting.png"></p><p>高度なルックアップに関しては通常の方法で無効化することはできません。<br>セキュリティ リスクの懸念から無効化を検討されている場合には、どちらの検索もユーザーに適切な権限が付与されているレコードのみ検索することができるので、ぜひご安心いただければと思います。</p><h3 id="一部の環境で-Dataverse-検索が有効化されていない"><a href="#一部の環境で-Dataverse-検索が有効化されていない" class="headerlink" title="一部の環境で Dataverse 検索が有効化されていない"></a>一部の環境で Dataverse 検索が有効化されていない</h3><p>現在のところ、Dataverse 検索は運用環境 (Production 環境) のみで有効化されています。<br>サンドボックス環境など、その他の環境では既定で機能が無効化されています。これらの環境で Dataverse 検索をご利用の場合には、「各検索方法を無効化する方法」でご紹介した画面から機能を有効化することができるので、ぜひお試しください。<br>なお、設定を有効化してから、実際に検索に利用するインデックスが構築されるまでには数時間以上 (きわめて大規模な環境の場合、最大数日) かかる場合があります。</p><h3 id="Dataverse-検索を有効にするとキャパシティの使用量が増えた"><a href="#Dataverse-検索を有効にするとキャパシティの使用量が増えた" class="headerlink" title="Dataverse 検索を有効にするとキャパシティの使用量が増えた"></a>Dataverse 検索を有効にするとキャパシティの使用量が増えた</h3><p>Dataverse 検索では内部的に検索インデックスを作成していますが、この検索インデックスは Dataverse ストレージ容量内部のデータベースの容量を使用します。<br>そのため、Dataverse 検索を有効化した後、検索インデックスが構築されることでキャパシティ (Dataverse ストレージ容量) が増加します。<br>具体的な増加量については、インデックス構築対象のテーブル・列・データ量にもよるためご案内をしておりません。<br>ただし増加量は RelevanceSearch テーブルに反映されますので、もし環境ごとのキャパシティをご確認いただいた際に当該テーブルの使用量が増加している場合には、Dataverse 検索の対象となるテーブル・列を減らしていただくことをご検討ください。<br>なお、Dataverse 検索の対象を減らしていただいた後、実際に削減がキャパシティに反映されるまでに最大 24 時間が必要です。</p><p>公開情報 <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/capacity-storage#faq">新しい容量ストレージモデル</a> より「よくあるご質問」&gt;「DataverseSearch テーブルとは、またどうすればそれを減らすことができますか」にもご案内がございますので、ぜひご参照ください。<br>※本記事公開時点では、DataverseSearch を RelevanceSearch と読み替えいただけますと幸いです。</p><h2 id="関連する公開情報"><a href="#関連する公開情報" class="headerlink" title="関連する公開情報"></a>関連する公開情報</h2><hr><p>・Dataverse 検索の概要について<br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/configure-relevance-search-organization">自分の環境に Dataverse 検索を構成する</a><br>・Dataverse 検索のリリースについて<br><a href="https://docs.microsoft.com/ja-jp/power-platform-release-plan/2021wave2/power-apps/simplified-dataverse-search-configuration-admins-model-driven-app-makers">管理者およびモデル駆動型アプリ開発者向けの簡素化された Dataverse 検索の構成</a><br>・高度なルックアップのリリースについて<br><a href="https://docs.microsoft.com/ja-jp/power-platform-release-plan/2021wave2/power-apps/advanced-lookup-capabilities-all-end-users-model-driven-power-apps">モデル駆動型 Power Apps のすべてのユーザー向けの高度なルックアップ機能</a><br>・2021年 Wave2 を含む、リリース計画の全体<br><a href="https://docs.microsoft.com/ja-jp/dynamics365/release-plans/">Dynamics 365 および Microsoft Power Platform のリリース計画</a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><hr><p>以上、Wave2 で追加された 2 種類の検索方法についてご紹介いたしました。<br>Power Platform / Dynamics 365 では、今後も様々な機能追加が予定されています。<br>こちらのブログでも追加機能をご紹介していきますので、ぜひご活用いただけますと幸いです！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの島です。&lt;/p&gt;
&lt;p&gt;Power Platform の半期に一度の大規模リリース (Wave2) が日本リージョンで 10 月 11 日 (月) から一般公開されました。&lt;br&gt;本記事では、このリリース内で行われた更新のうち、モデル駆動型アプリ / Dynamics 365 における検索についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Model-driven app" scheme="https://jpdynamicscrm.github.io/blog/tags/Model-driven-app/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse 環境のアクセス権制御方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/About-security-role-in-Dataverse/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/About-security-role-in-Dataverse/</id>
    <published>2021-10-11T04:45:00.000Z</published>
    <updated>2022-09-14T03:11:01.130Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの島です。</p><p>今回は、Power Platform、特に Dataverse を作成した環境に対して、セキュリティ グループやセキュリティ ロールを使ってアクセスを制御する方法についてご紹介いたします。</p><span id="more"></span><p>ビジネスユースで Dynamics 365 CRM やモデル駆動アプリを導入する場合、セキュアな環境管理のために必須となるのがこのアクセス権制御です。<br>特に今 Dataverse の導入にあたりセキュリティ面を検討されている方は、ぜひご覧ください！</p><h2 id="アクセス権制御方法の概要"><a href="#アクセス権制御方法の概要" class="headerlink" title="アクセス権制御方法の概要"></a>アクセス権制御方法の概要</h2><hr><p>Dataverse 環境のアクセス権は、おおまかに以下の構造で制御されています。</p><ol><li><strong>ライセンス</strong> : テナントごとに、<strong>各ユーザーが Power Platform 製品を利用できるか</strong>を決定します。</li><li><strong>セキュリティ グループ</strong> : テナントの各環境ごとに、<strong>ユーザーがその環境を利用できるか</strong>を決定します。</li><li><strong>セキュリティ ロール</strong> : 環境の Dataverse 内の各テーブルごとに、<strong>環境における具体的なユーザーのアクセス権</strong>を決定します。</li></ol><p><img src="/blog/powerplatform/About-security-role-in-Dataverse/img00-overall.PNG"></p><p>図に表すとこのようなイメージです。<br>たとえば同じテナント内に、<br>・グループ A (サポート部門) とグループ B (管理部門)<br>・環境A (サポート部門用の環境) と環境 B (管理部門用の環境)<br>があり、A 同士 / B 同士でそれぞれ環境にグループが割り当てられているとします。このとき、</p><ol><li><strong>ライセンス</strong> :<br>グループ A 内のサポート部門のユーザーは、ライセンスを所有しているため、Power Platform 製品を利用できます。<br>グループ B 内のユーザーは、今回の図の場合ライセンスを保有していないため、Power Platform 製品を利用できません。</li><li><strong>セキュリティ グループ</strong> :<br>グループ A のユーザーは、サポート部門用の環境 A にアクセスすることができますが、管理部門用の環境 B にはアクセスすることができません。</li><li><strong>セキュリティ ロール</strong> :<br>グループ A のユーザーは、セキュリティ ロールによってアクセスするテーブルや、実行可能な操作を制限されます。<br>たとえば図中のユーザーにサポート部門用のセキュリティ ロールが割り当てられ、システム管理者が割り当てられていないとき、ユーザーはシステム管理に使うテーブルにはアクセスができません。</li></ol><p>1 から 3 を組み合わせることで、ユーザーに対してどの環境でのどのような操作を許可するかを制御できます。<br>今回の記事では 2 と 3 をより詳しく見ていきます。</p><h3 id="環境へのセキュリティ-グループの割り当て"><a href="#環境へのセキュリティ-グループの割り当て" class="headerlink" title="環境へのセキュリティ グループの割り当て"></a>環境へのセキュリティ グループの割り当て</h3><hr><p>Power Platform 環境には、デフォルトではテナントに所属する全ユーザーがアクセスできますが、<br>環境にセキュリティ グループを割り当てることで、<strong>割り当てられたセキュリティ グループに所属するユーザーのみにアクセスを限定</strong>することができます。<br>たとえば、「IT部門」用の環境を作成したときに、「IT部門」のセキュリティ グループを割り当てることで、その他の営業部門などのユーザーのアクセスを禁止する…というように、グループごとに環境の利用可否が異なる場合に、ぜひ設定いただきたい項目です。</p><p>セキュリティ グループの割り当ては、環境作成時にオプションで指定できる他、Power Platform 管理センターから既存の環境に対しても指定できます。<br>ただし、既存の環境にセキュリティ グループを割り当てた場合、セキュリティ グループに所属していないユーザーはすべて無効化されるのでご注意ください。<br><img src="/blog/powerplatform/About-security-role-in-Dataverse/img01-SGsetting.PNG"></p><h3 id="セキュリティ-ロールの設定"><a href="#セキュリティ-ロールの設定" class="headerlink" title="セキュリティ ロールの設定"></a>セキュリティ ロールの設定</h3><hr><p>上記でご説明したセキュリティ グループでは、ユーザーに対して環境単位でのアクセス可否を決定します。<br>これに対して、ユーザーに割り当てることで、<strong>環境内でユーザーが行える操作を決定</strong>するのがセキュリティ ロールです。<br>Power Platform では、要件に合わせたさまざまな既定のセキュリティ ロールが存在します。一例をご紹介します。</p><ul><li>システム管理者 : 環境におけるすべての操作を実行できるロール。</li><li>Basic User : 環境における一般的なアプリの利用ができるロール。管理操作が制限される他、自分以外のユーザーが作成したデータに対するアクセスも制限されます。</li><li>システム カスタマイザー : 環境をカスタマイズするためのロール。多くの管理操作を実行できますが、自分以外のユーザーが作成したデータを参照できません。</li></ul><p>またこちらの公開情報にも、より多くのセキュリティ ロールのご説明が記載されているので、ぜひご覧ください。<br>ご参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/database-security">環境のリソースに対するユーザー セキュリティの構成</a></p><h3 id="セキュリティ-ロールの仕組みとカスタマイズ"><a href="#セキュリティ-ロールの仕組みとカスタマイズ" class="headerlink" title="セキュリティ ロールの仕組みとカスタマイズ"></a>セキュリティ ロールの仕組みとカスタマイズ</h3><hr><p>セキュリティ ロールは、初期状態では、ユーザーのライセンスやMicrosoft 365 管理者役割に応じて自動的にユーザーに割り振られています。<br>ただ、デフォルトで割り当てられるセキュリティ ロールではなく、もっと具体的にアクセス権を管理したいという方に向けて、セキュリティ ロールの仕組みとカスタマイズ方法をご紹介します。</p><p>セキュリティ ロールの実体は、Dataverse 上の各テーブルに対するアクセス権の集合体です。<br>セキュリティ ロール編集画面にて、各セキュリティ ロールごとに、以下のようなイメージでアクセス権が定義されているのが確認できます。<br><img src="/blog/powerplatform/About-security-role-in-Dataverse/img02-rolesetting.PNG"></p><p>上図左の列に記載されているのがDataverse の各テーブルの名称、右側の列に記載されているのがテーブルに対する操作です。<br>このマトリクスに対して、アクセス許可レベルを設定することで、<strong>「(行)どのテーブルに対して × (列)どの操作を許可するか」</strong>を定義することができます。<br>たとえば上図の「お知らせ」テーブルで言えば、Basic User セキュリティ ロールではお知らせの読み込みは完全に許可されている一方で、お知らせの作成・書き込み・削除・追加…など、他の操作は禁止されている、ということが定義されています。</p><p>また、上図では丸の色・塗られ方が権限によって様々ですが、これはアクセス許可のレベルを表現しています。<br>Power Platform ではアクセス許可レベルを 5 段階で設定しています。以下の公開情報に詳しく掲載されているので、ぜひご覧ください。<br>ご参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/security-roles-privileges">セキュリティ ロールおよび特権</a></p><p>このアクセス権の定義方法は、セキュリティ ロールのカスタマイズの考え方にもつながります。<br>例えば、</p><ul><li>サポート部門の担当者には、自分が担当する「サポート案件」を参照可とする</li><li>サポート部門の管理者は、全員のサポート案件を参照可とする</li><li>経理部門の担当者には、サポート案件自体参照させたくない</li></ul><p>というような要件がある場合、サポート案件に対するアクセス許可を変更したロールを 3 種類作成し、各ユーザーに割り当てることで要件が実現できます。</p><p>なお、セキュリティ ロールをカスタマイズする際は、既存のセキュリティ ロールは変更後に元々の状態にリセットできないので、<br>万が一に備えてカスタマイズ用のセキュリティ ロールを別途用意いただくことを推奨しています。<br>また、既存のセキュリティ ロールでは、内部処理に使われているさまざまなテーブルについても多数のアクセス制御が設定されています。<br>そのため、セキュリティ ロールを別途用意するときには、既存のセキュリティ ロールをコピーした上で、特定のテーブルのアクセス制御のみ変更することをお勧めいたします。</p><h2 id="本記事からの発展"><a href="#本記事からの発展" class="headerlink" title="本記事からの発展"></a>本記事からの発展</h2><hr><p>Dataverse では、これまでご案内してきたように、ライセンスやセキュリティ グループ、セキュリティ ロールの組み合わせでアクセス制御を行っています。<br>本記事では詳しくご紹介していませんが、より発展的な内容についても、公開情報をご案内いたします。</p><h4 id="チーム単位でのセキュリティ-ロールの割り当て"><a href="#チーム単位でのセキュリティ-ロールの割り当て" class="headerlink" title="チーム単位でのセキュリティ ロールの割り当て"></a>チーム単位でのセキュリティ ロールの割り当て</h4><p>ユーザーが所属するDataverse 上の「チーム」に対してセキュリティ ロールを設定することで、ユーザーにもチームのセキュリティ ロールが引き継がれます。<br>また、この「チーム」を、Azure AD のセキュリティ グループと紐づけることで、Azure AD 側とのユーザー管理の一元化も可能です。<br>セキュリティ ロールをユーザーごとに設定するのは少し大変……という場合には、ぜひチームの導入をご検討ください。<br>ご参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/manage-teams">チームを管理する</a></p><h4 id="フィールドレベルのセキュリティ付与"><a href="#フィールドレベルのセキュリティ付与" class="headerlink" title="フィールドレベルのセキュリティ付与"></a>フィールドレベルのセキュリティ付与</h4><p>本記事でご案内したユーザーごとのアクセス制御とは別に、Dataverse の各列ごとにアクセス制御を設定することができます。<br>住所や電話番号など、ユーザーを問わず隠しておきたいようなデータに対して、ぜひご設定ください。<br>ご参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/field-level-security">アクセスを制御するフィールド レベルのセキュリティ</a></p><h4 id="セキュリティ-グループを環境に割り当てた際のメンバー同期"><a href="#セキュリティ-グループを環境に割り当てた際のメンバー同期" class="headerlink" title="セキュリティ グループを環境に割り当てた際のメンバー同期"></a>セキュリティ グループを環境に割り当てた際のメンバー同期</h4><p>セキュリティ グループを環境に割り当てると、グループに所属するうちライセンスを保有するユーザーが、自動的に環境に追加されるようになります。<br>ただし以下のように、注意が必要な挙動もあります。</p><ul><li>ライセンスを保有しないユーザーは環境に追加されない</li><li>入れ子のセキュリティ グループのメンバーは、グループに「Azure AD グループ チーム」が割り当てられている場合を除いて、自動的に環境に追加されない</li><li>ユーザーがグループから削除された際、Power Platform 側のユーザーは無効化される</li></ul><p>以下の公開情報に注意点が列挙されていますので、ぜひご参照ください。<br>ご参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/control-user-access">環境に対するユーザー アクセスを構成する</a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><hr><p>以上、Dataverse でのユーザーアクセスの制御についてご案内いたしました。<br>こちらの記事が皆様のセキュアな環境管理のお役に立ちましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの島です。&lt;/p&gt;
&lt;p&gt;今回は、Power Platform、特に Dataverse を作成した環境に対して、セキュリティ グループやセキュリティ ロールを使ってアクセスを制御する方法についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Model-driven app" scheme="https://jpdynamicscrm.github.io/blog/tags/Model-driven-app/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
  </entry>
  
  <entry>
    <title>クラウド フローでのエラーハンドリングの方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/CloudFlow-ErrorHandling/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/CloudFlow-ErrorHandling/</id>
    <published>2021-09-23T15:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.082Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの三宅です。<br>  今回は、 Power Automate でクラウド フローでエラー処理を行う方法についてご紹介いたします。</p>  <span id="more"></span><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#anchor-configure-runafter">実行条件を構成してエラーを検知する</a></li><li><a href="#anchor-configure-parallel-actions">アクションの成否によって後続のアクションを変更する</a></li><li><a href="#anchor-get-error-message">エラー情報を取得する</a></li><li><a href="#anchor-try-catch">スコープを用いてフロー全体を監視する</a></li></ol><p><a id='anchor-configure-runafter'></a></p><h2 id="実行条件を構成してエラーを検知する"><a href="#実行条件を構成してエラーを検知する" class="headerlink" title="実行条件を構成してエラーを検知する"></a>実行条件を構成してエラーを検知する</h2><hr><p>クラウド フローの「実行条件の構成」機能では、直前のアクションの終了状態に応じてアクションの実行の有無を制御できます。<br>エラーの予測されるアクションがある場合、後続アクションの実行条件を構成することで、エラーの有無にかかわらずフローを最後まで実行させることができます。  </p><p><strong>[手順]</strong>  </p><ol><li>アクションの [メニュー] から、[実行条件の構成] を選択します。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img1.png"> 　</li><li>アクションが実行されるタイミングについて、チェックボックスの任意の値を選んで [完了] をクリックします。<br>以下の例では、「カレンダーの取得(V2)」アクションが成功または失敗した時に「Apply to each」処理が実行されます。<br>タイムアウトまたはスキップした時には実行されません。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img2.png">  </li></ol><p>各実行条件の説明は以下の通りです。 </p><ul><li>に成功しました・・既定値。前のアクションが成功した時に実行されます。  </li><li>に失敗しました・・前のアクションがエラーになったときに実行されます。  </li><li>がスキップされます・・前のアクションがスキップされたときに実行されます。  </li><li>がタイムアウトしました・・フロー自体のタイムアウト、またはアクションごとのタイムアウト（アクションの設定）に該当した場合に実行されます。</li></ul><p><a id='anchor-configure-parallel-actions'></a></p><h2 id="アクションの成否によって後続のアクションを変更する"><a href="#アクションの成否によって後続のアクションを変更する" class="headerlink" title="アクションの成否によって後続のアクションを変更する"></a>アクションの成否によって後続のアクションを変更する</h2><hr><p>並列分岐を用いることで、アクションが成功した場合と失敗した場合とで異なる処理を行うことも可能です。</p><p>例として、エラーが予測されるアクションの後にステップがある場合、[並列分岐の追加] から、前のアクションが失敗した場合にメールを送るステップを追加します。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img3.png">  </p><p><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img4.png"></p><p><a id='anchor-get-error-message'></a></p><h2 id="エラー情報を取得する"><a href="#エラー情報を取得する" class="headerlink" title="エラー情報を取得する"></a>エラー情報を取得する</h2><hr><h3 id="実行履歴の-URL-の取得"><a href="#実行履歴の-URL-の取得" class="headerlink" title="実行履歴の URL の取得"></a>実行履歴の URL の取得</h3><p>式にて<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#workflow">ワークフロー関数</a>を使用することで、実行履歴の URL を生成し、メール等で送付することが可能です。  </p><p>実行履歴の URL は下記のような構成となっております。<br><a href="https://japan.flow.microsoft.com/manage/environments/%7B%E7%92%B0%E5%A2%83ID%7D/flows/%7BFlowName%7D/runs/%7B%E5%AE%9F%E8%A1%8CID%7D">https://japan.flow.microsoft.com/manage/environments/{環境ID}/flows/{FlowName}/runs/{実行ID}</a>  </p><p>各値を取得する式は、以下の通りです。  </p><ul><li>環境ID : workflow().tags.environmentName  </li><li>FlowName : workflow().name  </li><li>実行ID : workflow().run.name  </li><li>フロー表示名 : - workflow().tags.flowDisplayName  </li></ul><p>「メールの送信(V2)」アクションでの使用例：<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img7.png">  </p><h3 id="エラーメッセージの取得"><a href="#エラーメッセージの取得" class="headerlink" title="エラーメッセージの取得"></a>エラーメッセージの取得</h3><p>実行時のアクションの出力を返す outputs 関数を用いることで、エラー情報を取得することが可能です。<br>例えば、「式」にて以下のように記述することで、エラーメッセージを取得することができます。<br><code>outputs(&#39;&lt;アクション名&gt;&#39;).body.error.message</code>  </p><p>「失敗しました」側のアクションでの使用例:<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img5.png"><br>参考：<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#outputs">式関数のリファレンス ガイド</a></p><p>なお、アクションによっては上記の式でエラーメッセージを取得できない場合もありますので、想定されるエラーについて応答 body の json の構造を確認して、適切な式をご設定ください。<br>参考：<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#outputs">式関数のリファレンス ガイド</a></p><p><a id='anchor-try-catch'></a></p><h2 id="スコープを用いてフロー全体を監視する"><a href="#スコープを用いてフロー全体を監視する" class="headerlink" title="スコープを用いてフロー全体を監視する"></a>スコープを用いてフロー全体を監視する</h2><hr><p>実行条件を用いる方法ではアクション単位でのエラー検知が必要でしたが、コントロール コネクタの [スコープ] を用いると、フロー全体を監視することが可能です。  </p><p>スコープアクションには、複数のアクションを格納することができます。<br>また、スコープ内のいずれかのアクションが失敗して終了した場合、スコープアクション自体もエラーで終了するため、スコープの直後にエラー検知のアクションを設定することで、スコープ内のどのアクションが失敗した場合でもエラーを検知して通知を行うことができます。  </p><p>以下、Try、Catch、Finally テンプレートによるエラー処理の手順をご紹介いたします。<br><a href="https://flow.microsoft.com/en-us/galleries/public/templates/e8e028c6df7b4eb786abdf510e4f1da3/try-catch-and-finally-template/">Try、Catch、Finally テンプレート</a><br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img6.png">  </p><p><strong>[手順]</strong>  </p><ol><li>Try スコープ内に、メインとなるアクションを挿入します。  </li><li>Catch スコープの実行条件は Try ブロックが失敗した際に実行するように設定されています。Try ブロックが失敗した際は、Catch スコープ内のアクションによりメールが送信されます。  </li><li>Finally スコープ内には、前のアクションの成否にかかわらず実行されるアクションを挿入します。  </li></ol><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><p><a href="https://powerautomateweb.microsoft.com/en-us/blog/error-handling/">Error handling steps, counters, a new flow details experience and more</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの三宅です。&lt;br&gt;  今回は、 Power Automate でクラウド フローでエラー処理を行う方法についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Cloud flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flows/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps Portal 上で意図せずデータが外部から参照される</title>
    <link href="https://jpdynamicscrm.github.io/blog/portal/OData-risk-in-portal/"/>
    <id>https://jpdynamicscrm.github.io/blog/portal/OData-risk-in-portal/</id>
    <published>2021-09-01T03:00:00.000Z</published>
    <updated>2022-09-14T03:11:01.066Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポート チームの 王 です。<br>先日公開された Power Apps Portal で意図せず外部からデータが参照されてしまう問題についてご案内させていただきます。</p><span id="more"></span><h2 id="初めに"><a href="#初めに" class="headerlink" title="初めに"></a>初めに</h2><p>Power Apps Portal において、利用者によって正しく設定が行われていない場合に、意図せず内部の情報が匿名ユーザーから取得できてしまう問題が、外部セキュリティ機関の UpGuard により米国時間2021年8月23日に<a href="https://www.upguard.com/breaches/power-apps">発表</a>されました。<br>この問題について、自身がご利用されている環境がこの問題に該当しているか確認する方法および該当している場合の対処方法についてご案内いたします。</p><h2 id="影響範囲について"><a href="#影響範囲について" class="headerlink" title="影響範囲について"></a>影響範囲について</h2><p>この問題は Power Apps Portal のみ影響を受けるものです。<br>Power Apps Portal は既定で構成されないため、ご利用されていない場合は対象となる設定自体が存在せず、本件について対処の必要はございません。<br>同様に、その他の Power Apps における キャンバスアプリ や モデル駆動型アプリ なども本件の対象外です。</p><h2 id="発表された問題について"><a href="#発表された問題について" class="headerlink" title="発表された問題について"></a>発表された問題について</h2><p>今回指摘された問題は以下２つの設定によって発生いたします。<br>・リストのアクセス制御有効化の設定 (<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/configure/entity-lists#securing-lsists">リストをセキュリティで保護する</a>)<br>　リストレコードの “全般” タブにて設定できる [<strong>エンティティのアクセス許可を有効にする</strong>] の設定は、対象のリストにアクセスするユーザーに対してWeb ロールを使用した権限制御を有効化する設定です。こちらが無効の場合、匿名ユーザーがデータを表示することが可能となります。  </p><p>・リストのOData フィードの有効化状態 (<a href="https://docs.microsoft.com/en-us/powerapps/maker/portals/configure/entity-lists#list-odata-feeds">リストの OData フィード</a>)<br>　リストレコードの “OData フィード” タブにて設定できる [<strong>有効</strong>] の設定は、リストを API サービスとして外部に公開しデータ連携などの用途で利用するための設定です。設定が有効な場合、ユーザーは API を使用してデータの取得を要求することが可能です。  </p><p>[<strong>エンティティのアクセス許可を有効にする</strong>] の設定が無効化状態かつ、”OData フィード” タブの [<strong>有効</strong>] にチェックが入っている場合、匿名のユーザーが API を使用してポータルへアクセスすると、対象のリストのデータを取得することができてしまいます。</p><h2 id="ご利用の環境が上記問題に該当するか確認する方法について"><a href="#ご利用の環境が上記問題に該当するか確認する方法について" class="headerlink" title="ご利用の環境が上記問題に該当するか確認する方法について"></a>ご利用の環境が上記問題に該当するか確認する方法について</h2><p>・メッセージセンターにおける通知<br>　上記条件に該当するリストの設定を行っているお客様に対し、Microsoft 365 管理センターのメッセージID MC277597 にて通知を行っています。<br><img src="/blog/portal/OData-risk-in-portal/MC277597.png"></p><p>・<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/admin/portal-checker">ポータルチェッカーの実行</a><br>　Power Apps Portal 管理センターよりポータルチェッカーを実行することで、対象のポータルに構成されているリストのうち、条件に該当するものが存在するか確認することができます。<br>　該当するリストが存在する場合、以下の様な警告とともに対象のリストのIDが表示されます。<br><img src="/blog/portal/OData-risk-in-portal/portalchecker.png"></p><p>・高度な検索を使用した手動確認<br>　手動で上記条件に該当するリストをご確認頂く場合、高度な検索を使用して以下の条件で検索いただくことで、該当のエンティティリストが存在しているかご確認いただくことが可能です。<br><img src="/blog/portal/OData-risk-in-portal/advancedfind.png"></p><h2 id="対処方法について"><a href="#対処方法について" class="headerlink" title="対処方法について"></a>対処方法について</h2><p>意図せずリストのデータが公開状態になっていた場合、対処を行う必要がございます。<br>匿名ユーザーがアクセスできない様にするためには、以下いずれかの対処をご実施頂く必要がございます。  </p><p>・「エンティティのアクセス許可を有効にする」にチェックを入れてWeb ロールの設定を正しく構成する<br>　有効な権限を保持していない匿名ユーザーに対するデータ表示を制限することが可能です。<br>　Web ロールの設定内容についてはお客様運用に合わせてご検討ください。  </p><p>・OData フィードタブの「有効」からチェックを外す<br>　API によるデータへのアクセスが不可能となります。  </p><p>また、本件に対する製品側の対処として、リストのアクセス許可設定を無効化することとなりました。<br>これにより、今後は同様の事象が発生しなくなります。  </p><p><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/admin/portal-checker-analysis#anonymous-access-to-basicadvanced-forms-and-lists">基本/詳細フォームおよびリストへの匿名アクセス</a><br><img src="/blog/portal/OData-risk-in-portal/deprication.png"></p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>一般サイトで案内されている内容については一部不適切な表記がされていたり、具体的にご自身の環境が対象となっているか判断が難しいかと存じますので、こちらの記事がご確認の参考になりましたら幸いです。<br>その他ご不明点などがございましたら、弊社サポートまでお気軽にご相談ください。  </p><p>–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポート チームの 王 です。&lt;br&gt;先日公開された Power Apps Portal で意図せず外部からデータが参照されてしまう問題についてご案内させていただきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Apps portal" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps-portal/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate/Power Appsの試用版・無償版を利用不可にする方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/How-to-block-free-and-trial-licenses/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/How-to-block-free-and-trial-licenses/</id>
    <published>2021-08-31T02:30:00.000Z</published>
    <updated>2022-09-14T03:11:01.198Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。</p><br>今回はよく寄せられるお問い合わせの一つ、Power Automate、Power Apps の無償版・試用版を利用不可にする方法についてご案内いたします。<br><br><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、 本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください</p></div><span id="more"></span><hr><h1 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h1><ol><li><a href="#anchor-license">対象ライセンス</a></li><li><a href="#anchor-license-type">ライセンスの種類</a></li><li><a href="#anchor-preparation">事前準備</a></li><li><a href="#anchor-command">コマンドの実行</a></li><li><a href="#anchor-result">実行結果</a></li><li><a href="#anchor-faq">FAQ</a></li></ol><br><p><a id='anchor-license'></a></p><h2 id="対象ライセンス"><a href="#対象ライセンス" class="headerlink" title="対象ライセンス"></a>対象ライセンス</h2><p>ご案内するコマンドを実行しますと、以下のすべてのライセンスが制限されます。</p><ul><li>Power Automate Free</li><li>Power Apps コミュニティプラン</li><li>Power Automate 試用版</li><li>Power Apps 試用版</li></ul><br><p><a id='anchor-license-type'></a></p><h2 id="ライセンスの種類"><a href="#ライセンスの種類" class="headerlink" title="ライセンスの種類"></a>ライセンスの種類</h2><p>ライセンスにはInternalライセンスとViralライセンスの２つがあります。<br></p><ul><li><p>Internal ：Power Automate / Power Apps ポータルからユーザーが自身で取得する無償版・試用版ライセンス<br></p></li><li><p>Viral： 管理者により付与される無償版・試用版ライセンス、および <a href="https://signup.microsoft.com/">https://signup.microsoft.com/</a> からユーザーが自身で取得する無償版・試用版ライセンス<br></p><p>   参考情報： <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#block-trial-licenses-commands">試用ライセンスのブロックコマンド</a></p></li></ul><p><a id='anchor-preparation'></a></p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><h3 id="PowerShell-モジュールのインストール"><a href="#PowerShell-モジュールのインストール" class="headerlink" title="PowerShell モジュールのインストール"></a>PowerShell モジュールのインストール</h3><ol><li>Power Apps の PowerShell モジュールを <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation">こちらの手順</a> に従ってインストールします。</li></ol><h3 id="現在の設定を確認"><a href="#現在の設定を確認" class="headerlink" title="現在の設定を確認"></a>現在の設定を確認<br></h3><ol><li>以下のコマンドを実行し、無償版・試用版が無効化されているかどうか確認します。<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AllowedConsentPlans</span></span><br></pre></td></tr></table></figure>※Internal と Viral のライセンスが共に有効である場合（＝無償版、試用版が利用可能な状態）<br><br> <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Get-AllowedConsentPlans.png"><br><br>※Internal と Viral のライセンスが共に無効である場合（＝無償版、試用版が利用不可の状態）<br><br> <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Get-AllowedConsentPlans-false.png"><br><br></li><li>ライセンス一覧を表示するコマンドを実行し、テナント内に無償版、試用版ライセンスを利用しているユーザーがいるかどうかを確認します。<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AdminPowerAppLicenses</span> <span class="literal">-OutputFilePath</span> &lt;ファイルパス＋ファイル名&gt;</span><br></pre></td></tr></table></figure></li></ol><p><a id='anchor-command'></a></p><h2 id="コマンドの実行"><a href="#コマンドの実行" class="headerlink" title="コマンドの実行"></a>コマンドの実行</h2><p>以下のコマンドを実行し、無償版、試用版のライセンスを無効化し、利用停止にします。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Remove-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Internal&quot;</span></span><br><span class="line"><span class="built_in">Remove-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Viral&quot;</span></span><br></pre></td></tr></table></figure><p>以下のように確認メッセージが表示されるので、”y”と入力し、Enterキーを押してください。<br>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Confirmation-message.png"><br></p><br>試用版、無償版の利用を許可する場合は、下記のコマンドを実行してください。<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Internal&quot;</span></span><br><span class="line"><span class="built_in">Add-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Viral&quot;</span></span><br></pre></td></tr></table></figure><p><a id='anchor-result'></a></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>ライセンスを持たないアカウントで Power Automate ポータルへ接続を試みます。</p><p>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/power-automate-portal.png"><br><br>   以下のようにエラーが表示され、ポータル画面へアクセスすることができません<br><br>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/error1.png"><br></p><p><a id='anchor-faq'></a></p><h2 id="既知の問題と制限事項"><a href="#既知の問題と制限事項" class="headerlink" title="既知の問題と制限事項"></a>既知の問題と制限事項</h2><p>コマンド実行後、 Microsoft 365 管理センターからライセンス付与状況を確認すると無償版・試用版のライセンスが付与されているように見える場合がありますが、内部的には無償版・試用版のライセンスが無効化されております。<br>無効化作業をした後のライセンス状況の確認は、以下の「テナント内のユーザーとライセンスの一覧を確認するコマンド」にてご確認ください。<br><br> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AdminPowerAppLicenses</span> <span class="literal">-OutputFilePath</span> &lt;ファイルパス＋ファイル名&gt;</span><br></pre></td></tr></table></figure></p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q-コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか"><a href="#Q-コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか" class="headerlink" title="Q. コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか"></a><font color=blue>Q. コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか</font></h3><p>   コマンド実行時に付与済みのライセンスがはく奪され、利用できなくなります。<br><br>   <br></p><h3 id="Q-コマンド実行前に有償ライセンスや-Office-365-Microsoft-365-付帯ライセンスが付与されている場合はどうなるのか"><a href="#Q-コマンド実行前に有償ライセンスや-Office-365-Microsoft-365-付帯ライセンスが付与されている場合はどうなるのか" class="headerlink" title="Q. コマンド実行前に有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスが付与されている場合はどうなるのか"></a><font color=blue>Q. コマンド実行前に有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスが付与されている場合はどうなるのか</font></h3><p>   有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスには影響を与えませんので、引き続きご利用いただけます。<br><br>   <br></p><h3 id="Q-コマンド実行後に有償ライセンスの購入に影響は与えるか"><a href="#Q-コマンド実行後に有償ライセンスの購入に影響は与えるか" class="headerlink" title="Q. コマンド実行後に有償ライセンスの購入に影響は与えるか"></a><font color=blue>Q. コマンド実行後に有償ライセンスの購入に影響は与えるか</font></h3><p>   有償ライセンスには影響を与えませんので、引き続き購入いただけます。<br><br>   <br></p><h3 id="Q-コマンド実行後にもPower-Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。"><a href="#Q-コマンド実行後にもPower-Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。" class="headerlink" title="Q. コマンド実行後にもPower Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。"></a><font color=blue>Q. コマンド実行後にもPower Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。</font></h3><p>   Power Apps は “アプリの実行時” にライセンスの有無が確認される製品となっております。<br>そのため、Power Apps へのアクセス、アプリの作成・編集はライセンスを所持していないユーザーでも可能となっており、ライセンスの付与の有無で制御することはできません。<br>   <br></p><h3 id="Q-コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか"><a href="#Q-コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか" class="headerlink" title="Q. コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか"></a><font color=blue>Q. コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか</font></h3><p>   フローやアプリは削除されず残り続けます。<br><br>   <b>＜Power Apps＞</b><br>   アプリを実行するユーザーに Office 365 / Microsoft 365 付帯ライセンスなど他の Power Apps のライセンスが付与されている場合は、コマンド実行前と変わらずアプリの実行を行うことができます。他の Power Apps のライセンスが付与されていない場合はアプリを実行できなくなります。<br>なお、Power Apps はアプリの実行時にライセンスを必要とする製品となっておりますため、コマンド実行後にもアプリの作成・編集は可能となります。<br>   <br><br>   <b>＜Power Automate＞</b><br>   作成者に Office 365 / Microsoft 365 付帯ライセンス など他の Power Automate のライセンスが付与されている場合は、コマンド実行前と変わらずフローの編集・実行を行うことができます。<br>作成者に Power Automate のライセンスが一つも付与されていない場合は、バックグラウンド処理にてフローがオフになります。<br>   <br></p><h3 id="Q-コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか"><a href="#Q-コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか" class="headerlink" title="Q. コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか"></a><font color=blue>Q. コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか</font></h3><p>   フローやアプリは削除されず残り続けます。<br><br>   <b>＜Power Apps＞</b><br>   アプリを実行するユーザーに <a href="https://powerapps.microsoft.com/ja-jp/pricing/">Power Apps の有償ライセンス</a>が付与されている場合は、コマンド実行前と変わらずアプリの実行を行うことができます。<br>なお、Power Apps はアプリの実行時にライセンスを必要とする製品となっておりますため、コマンド実行後にも<u><b>アプリの作成・編集は可能</b></u>となります。<br>ただし、作成・編集ユーザーに Power Apps の有償ライセンスが付与されていない場合、ゲートウェイなど一部のプレミアム機能がご利用いただけない可能性がございます。<br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/about-powerapps-perapp#for-users-expected-to-use-a-power-apps-per-app-plan-why-are-users-that-use-an-app-shared-with-them-prompted-to-start-a-power-apps-trial">こちらの公開情報</a>にもございます通り、この制限は最終的には削除される予定です。<br>最新の動作については公開情報及び、製品動作をご確認ください。<br>   <br><br>   <b>＜Power Automate＞</b><br>   [フローの編集]<br>     <u>作成者</u>に <a href="https://flow.microsoft.com/ja-jp/pricing/">Power Automate の有償ライセンス</a>が付与されている場合は、コマンド実行前と変わらずフローの編集を行うことができます。<br>作成者に Power Automate の有償ライセンスが付与されていない場合は、プレミアムコネクタなど有償ライセンスが必要な機能がご利用できなくなります。また、作成者が有償ライセンスを持たず、有償ライセンスが必要な機能を利用しているフローはバックグラウンド処理にてフローがオフになります。<br><br>     ※ Power Apps トリガーの場合は、Power Apps の有償ライセンスのみで Power Automate の有償ライセンスが必要な機能をご利用できます。</p><p>   [フローの実行]<br>   <u>実行者に有償ライセンス</u>が必要となります。実行者が有償ライセンスを持たない場合は、フローを実行することができなくなります。</p><ul><li>自動化フロー<br>フローの実行者は作成者となるため、<u><b>作成者</b></u>に Power Automate の有償ライセンスが必要です。</li><li>ボタンフローなどの手動フロー<br><u><b>フロー実行者</b></u>に Power Automate の有償ライセンスが必要です。</li><li>Power Apps トリガー<br><u><b>Power Apps 実行者</b></u>に <u><b>Power Apps</b></u> の有償ライセンスが必要です。<br>Power Automate の使用権は Power Apps の有償ライセンスに含まれているため、Power Automate のライセンスは必要ありません。<br></li></ul><h3 id="Q-コマンド実行すると他の製品には影響を与えないか"><a href="#Q-コマンド実行すると他の製品には影響を与えないか" class="headerlink" title="Q. コマンド実行すると他の製品には影響を与えないか"></a><font color=blue>Q. コマンド実行すると他の製品には影響を与えないか</font></h3><p>   <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/enterprise-users/directory-self-service-signup">Azure のセルフサービスサインアップ</a>を無効にしていると、Dynamicsの試用版が無効になる場合がございます。<br>Azure のセルフサービスサインアップを無効にしていない場合は、Power Automate 、 Power Apps の無償版、試用版のみに影響があります。<br><br>   <br></p><br><hr><p>Hope to acceralate your business with Power Automate!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;/p&gt;
&lt;br&gt;
今回はよく寄せられるお問い合わせの一つ、Power Automate、Power Apps の無償版・試用版を利用不可にする方法についてご案内いたします。&lt;br&gt;
&lt;br&gt;

&lt;blockquote&gt;
&lt;p&gt;[!IMPORTANT]&lt;br&gt;本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、 本記事編集時点と実際の機能に相違がある場合がございます。&lt;br&gt;最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
</feed>
