<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  
  <subtitle>日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</subtitle>
  <link href="https://jpdynamicscrm.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpdynamicscrm.github.io/blog/"/>
  <updated>2021-09-24T01:06:19.568Z</updated>
  <id>https://jpdynamicscrm.github.io/blog/</id>
  
  <author>
    <name>Japan Dynamics CRM &amp; Power Platform Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/CloudFlow-ErrorHandling/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/CloudFlow-ErrorHandling/</id>
    <published>2021-09-24T01:06:26.888Z</published>
    <updated>2021-09-24T01:06:19.568Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの三宅です。<br>  今回は、 Power Automate でクラウド フローにエラー処理のステップを組み込む方法についてご紹介いたします。</p><h2 id="実行条件を構成する"><a href="#実行条件を構成する" class="headerlink" title="実行条件を構成する"></a>実行条件を構成する</h2><p>エラーの予測されるアクションがある場合、後続アクションの実行条件を構成することで、エラーの有無にかかわらずフローを最後まで実行させることができます。  </p><p><strong>[手順]</strong>  </p><ol><li>アクションの [メニュー] から、[実行条件の構成] を選択します。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img1.png"> 　</li><li>アクションが実行されるタイミングについて、チェックボックスの任意の値を選んで [完了] をクリックします。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img2.png">  </li></ol><h2 id="アクションの成否によって後続のアクションを変更する"><a href="#アクションの成否によって後続のアクションを変更する" class="headerlink" title="アクションの成否によって後続のアクションを変更する"></a>アクションの成否によって後続のアクションを変更する</h2><p>並列分岐を用いることで、アクションが成功した場合と失敗した場合とで異なる処理を行うことも可能です。</p><p>例として、エラーが予測されるアクションの後にステップがある場合、[並列分岐の追加] から、前のアクションが失敗した場合にメールを送るステップを追加します。<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img3.png">  </p><p><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img4.png"></p><p>また、実行時のアクションの出力を返す outputs 関数を用いることで、エラー情報を取得することが可能です。<br>例えば、「式」にて以下のように記述することで、エラーメッセージを取得することができます。<br><code>outputs(&#39;&lt;アクション名&gt;&#39;).body.error.message</code>  </p><p>「失敗しました」側のアクションでの使用例:<br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img5.png"><br>参考：<a href="https://docs.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#outputs">式関数のリファレンス ガイド</a></p><h2 id="スコープを用いてフロー全体を監視する"><a href="#スコープを用いてフロー全体を監視する" class="headerlink" title="スコープを用いてフロー全体を監視する"></a>スコープを用いてフロー全体を監視する</h2><p>実行条件を用いる方法ではアクション単位でのエラー検知が必要でしたが、コントロール コネクタの [スコープ] を用いるとフロー全体をまとめて処理することができます。<br>以下、Try、Catch、Finally テンプレートによるエラー処理の手順をご説明いたします。<br><a href="https://flow.microsoft.com/en-us/galleries/public/templates/e8e028c6df7b4eb786abdf510e4f1da3/try-catch-and-finally-template/">Try、Catch、Finally テンプレート</a><br><img src="/blog/powerautomate/CloudFlow-ErrorHandling/img6.png">  </p><p><strong>[手順]</strong>  </p><ol><li>Try スコープ内に、メインとなるアクションを挿入します。  </li><li>Catch スコープの実行条件は Try ブロックが失敗した際に実行するように設定されています。Try ブロックが失敗した際は、Catch スコープ内のアクションによりメールが送信されます。  </li><li>Finally スコープ内には、前のアクションの成否にかかわらず実行されるアクションを挿入します。  </li></ol><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><p><a href="https://powerautomateweb.microsoft.com/en-us/blog/error-handling/">Error handling steps, counters, a new flow details experience and more</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの三宅です。&lt;br&gt;  今回は、 Power Automate でクラウド フローにエラー処理のステップを組み込む方法についてご紹介いたします。&lt;/p&gt;
&lt;h2 id=&quot;実行条件を構成する&quot;&gt;&lt;a href=&quot;#実行条</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Power Apps Portal 上で意図せずデータが外部から参照される</title>
    <link href="https://jpdynamicscrm.github.io/blog/portal/OData-risk-in-portal/"/>
    <id>https://jpdynamicscrm.github.io/blog/portal/OData-risk-in-portal/</id>
    <published>2021-09-01T03:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.568Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポート チームの 王 です。<br>先日公開された Power Apps Portal で意図せず外部からデータが参照されてしまう問題についてご案内させていただきます。</p><span id="more"></span><h2 id="初めに"><a href="#初めに" class="headerlink" title="初めに"></a>初めに</h2><p>Power Apps Portal において、利用者によって正しく設定が行われていない場合に、意図せず内部の情報が匿名ユーザーから取得できてしまう問題が、外部セキュリティ機関の UpGuard により米国時間2021年8月23日に<a href="https://www.upguard.com/breaches/power-apps">発表</a>されました。<br>この問題について、自身がご利用されている環境がこの問題に該当しているか確認する方法および該当している場合の対処方法についてご案内いたします。</p><h2 id="影響範囲について"><a href="#影響範囲について" class="headerlink" title="影響範囲について"></a>影響範囲について</h2><p>この問題は Power Apps Portal のみ影響を受けるものです。<br>Power Apps Portal は既定で構成されないため、ご利用されていない場合は対象となる設定自体が存在せず、本件について対処の必要はございません。<br>同様に、その他の Power Apps における キャンバスアプリ や モデル駆動型アプリ なども本件の対象外です。</p><h2 id="発表された問題について"><a href="#発表された問題について" class="headerlink" title="発表された問題について"></a>発表された問題について</h2><p>今回指摘された問題は以下２つの設定によって発生いたします。<br>・リストのアクセス制御有効化の設定 (<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/configure/entity-lists#securing-lsists">リストをセキュリティで保護する</a>)<br>　リストレコードの “全般” タブにて設定できる [<strong>エンティティのアクセス許可を有効にする</strong>] の設定は、対象のリストにアクセスするユーザーに対してWeb ロールを使用した権限制御を有効化する設定です。こちらが無効の場合、匿名ユーザーがデータを表示することが可能となります。  </p><p>・リストのOData フィードの有効化状態 (<a href="https://docs.microsoft.com/en-us/powerapps/maker/portals/configure/entity-lists#list-odata-feeds">リストの OData フィード</a>)<br>　リストレコードの “OData フィード” タブにて設定できる [<strong>有効</strong>] の設定は、リストを API サービスとして外部に公開しデータ連携などの用途で利用するための設定です。設定が有効な場合、ユーザーは API を使用してデータの取得を要求することが可能です。  </p><p>[<strong>エンティティのアクセス許可を有効にする</strong>] の設定が無効化状態かつ、”OData フィード” タブの [<strong>有効</strong>] にチェックが入っている場合、匿名のユーザーが API を使用してポータルへアクセスすると、対象のリストのデータを取得することができてしまいます。</p><h2 id="ご利用の環境が上記問題に該当するか確認する方法について"><a href="#ご利用の環境が上記問題に該当するか確認する方法について" class="headerlink" title="ご利用の環境が上記問題に該当するか確認する方法について"></a>ご利用の環境が上記問題に該当するか確認する方法について</h2><p>・メッセージセンターにおける通知<br>　上記条件に該当するリストの設定を行っているお客様に対し、Microsoft 365 管理センターのメッセージID MC277597 にて通知を行っています。<br><img src="/blog/portal/OData-risk-in-portal/MC277597.png"></p><p>・<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/admin/portal-checker">ポータルチェッカーの実行</a><br>　Power Apps Portal 管理センターよりポータルチェッカーを実行することで、対象のポータルに構成されているリストのうち、条件に該当するものが存在するか確認することができます。<br>　該当するリストが存在する場合、以下の様な警告とともに対象のリストのIDが表示されます。<br><img src="/blog/portal/OData-risk-in-portal/portalchecker.png"></p><p>・高度な検索を使用した手動確認<br>　手動で上記条件に該当するリストをご確認頂く場合、高度な検索を使用して以下の条件で検索いただくことで、該当のエンティティリストが存在しているかご確認いただくことが可能です。<br><img src="/blog/portal/OData-risk-in-portal/advancedfind.png"></p><h2 id="対処方法について"><a href="#対処方法について" class="headerlink" title="対処方法について"></a>対処方法について</h2><p>意図せずリストのデータが公開状態になっていた場合、対処を行う必要がございます。<br>匿名ユーザーがアクセスできない様にするためには、以下いずれかの対処をご実施頂く必要がございます。  </p><p>・「エンティティのアクセス許可を有効にする」にチェックを入れてWeb ロールの設定を正しく構成する<br>　有効な権限を保持していない匿名ユーザーに対するデータ表示を制限することが可能です。<br>　Web ロールの設定内容についてはお客様運用に合わせてご検討ください。  </p><p>・OData フィードタブの「有効」からチェックを外す<br>　API によるデータへのアクセスが不可能となります。  </p><p>また、本件に対する製品側の対処として、リストのアクセス許可設定を無効化することとなりました。<br>これにより、今後は同様の事象が発生しなくなります。  </p><p><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/portals/admin/portal-checker-analysis#anonymous-access-to-basicadvanced-forms-and-lists">基本/詳細フォームおよびリストへの匿名アクセス</a><br><img src="/blog/portal/OData-risk-in-portal/deprication.png"></p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>一般サイトで案内されている内容については一部不適切な表記がされていたり、具体的にご自身の環境が対象となっているか判断が難しいかと存じますので、こちらの記事がご確認の参考になりましたら幸いです。<br>その他ご不明点などがございましたら、弊社サポートまでお気軽にご相談ください。  </p><p>–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポート チームの 王 です。&lt;br&gt;先日公開された Power Apps Portal で意図せず外部からデータが参照されてしまう問題についてご案内させていただきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Apps Portal" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps-Portal/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate/Power Appsの試用版・無償版を禁止する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/How-to-block-free-and-trial-licenses/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/How-to-block-free-and-trial-licenses/</id>
    <published>2021-08-31T02:30:00.000Z</published>
    <updated>2021-09-24T01:06:19.580Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。</p><br>今回はよく寄せられるお問い合わせの一つ、Power Automate、Power Apps の無償版・試用版を利用不可にする方法についてご案内いたします。<br><br><span id="more"></span><hr><h1 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h1><ol><li><a href="#anchor-license">対象ライセンス</a></li><li><a href="#anchor-license-type">ライセンスの種類</a></li><li><a href="#anchor-preparation">事前準備</a></li><li><a href="#anchor-command">コマンドの実行</a></li><li><a href="#anchor-result">実行結果</a></li><li><a href="#anchor-faq">FAQ</a></li></ol><br><p><a id='anchor-license'></a></p><h2 id="対象ライセンス"><a href="#対象ライセンス" class="headerlink" title="対象ライセンス"></a>対象ライセンス</h2><p>ご案内するコマンドを実行しますと、以下のすべてのライセンスが制限されます。</p><ul><li>Power Automate Free</li><li>Power Apps コミュニティプラン</li><li>Power Automate 試用版</li><li>Power Apps 試用版</li></ul><br><p><a id='anchor-license-type'></a></p><h2 id="ライセンスの種類"><a href="#ライセンスの種類" class="headerlink" title="ライセンスの種類"></a>ライセンスの種類</h2><p>ライセンスにはユーザーが自身で取得するライセンスと管理者により付与されるライセンスの２つがあります。<br></p><ul><li>Internal ：ユーザーが自身で取得する無償版・試用版ライセンス<br></li><li>Viral： 管理者により付与される無償版・試用版ライセンス<br></li></ul><p><a id='anchor-preparation'></a></p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><h3 id="PowerShell-モジュールのインストール"><a href="#PowerShell-モジュールのインストール" class="headerlink" title="PowerShell モジュールのインストール"></a>PowerShell モジュールのインストール</h3><ol><li>Power Apps の PowerShell モジュールを <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell#installation">こちらの手順</a> に従ってインストールします。</li></ol><h3 id="現在の設定を確認"><a href="#現在の設定を確認" class="headerlink" title="現在の設定を確認"></a>現在の設定を確認<br></h3><ol><li>以下のコマンドを実行し、無償版・試用版が無効化されているかどうか確認します。<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AllowedConsentPlans</span></span><br></pre></td></tr></table></figure>※Internal と Viral のライセンスが共に有効である場合（＝無償版、試用版が利用可能な状態）<br><br> <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Get-AllowedConsentPlans.png"><br><br>※Internal と Viral のライセンスが共に無効である場合（＝無償版、試用版が利用不可の状態）<br><br> <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Get-AllowedConsentPlans-false.png"><br><br></li><li>ライセンス一覧を表示するコマンドを実行し、テナント内に無償版、試用版ライセンスを利用しているユーザーがいるかどうかを確認します。<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AdminPowerAppLicenses</span> <span class="literal">-OutputFilePath</span> &lt;ファイルパス＋ファイル名&gt;</span><br></pre></td></tr></table></figure></li></ol><p><a id='anchor-command'></a></p><h2 id="コマンドの実行"><a href="#コマンドの実行" class="headerlink" title="コマンドの実行"></a>コマンドの実行</h2><p>以下のコマンドを実行し、無償版、試用版のライセンスを無効化し、利用停止にします。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Remove-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Internal&quot;</span></span><br><span class="line"><span class="built_in">Remove-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Viral&quot;</span></span><br></pre></td></tr></table></figure><p>以下のように確認メッセージが表示されるので、”y”と入力し、Enterキーを押してください。<br>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/Confirmation-message.png"><br></p><p>ユーザーが自身で取得することは禁止し、管理者からの無償版・試用版ライセンス付与は許可したい場合には、Internal のみを無効化してください。<br><br><br><br>試用版、無償版の利用を許可する場合は、下記のコマンドを実行してください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Internal&quot;</span></span><br><span class="line"><span class="built_in">Add-AllowedConsentPlans</span> <span class="literal">-Types</span> <span class="string">&quot;Viral&quot;</span></span><br></pre></td></tr></table></figure><p><a id='anchor-result'></a></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>ライセンスを持たないアカウントで Power Automate ポータルへ接続を試みます。</p><p>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/power-automate-portal.png"><br><br>   以下のようにエラーが表示され、ポータル画面へアクセスすることができません<br><br>   <img src="/blog/powerplatform/How-to-block-free-and-trial-licenses/error1.png"><br></p><p><a id='anchor-faq'></a></p><h2 id="既知の問題と制限事項"><a href="#既知の問題と制限事項" class="headerlink" title="既知の問題と制限事項"></a>既知の問題と制限事項</h2><p>コマンド実行後、 Microsoft 365 管理センターからライセンス付与状況を確認すると無償版・試用版のライセンスが付与されているように見える場合がありますが、内部的には無償版・試用版のライセンスが無効化されております。<br>無効化作業をした後のライセンス状況の確認は、以下の「テナント内のユーザーとライセンスの一覧を確認するコマンド」にてご確認ください。<br><br> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AdminPowerAppLicenses</span> <span class="literal">-OutputFilePath</span> &lt;ファイルパス＋ファイル名&gt;</span><br></pre></td></tr></table></figure></p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q-コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか"><a href="#Q-コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか" class="headerlink" title="Q. コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか"></a><font color=blue>Q. コマンド実行前に取得された無償版、試用版のライセンスはどうなるのか</font></h3><p>   コマンド実行時に付与済みのライセンスがはく奪され、利用できなくなります。<br><br>   <br></p><h3 id="Q-コマンド実行前に有償ライセンスや-Office-365-Microsoft-365-付帯ライセンスが付与されている場合はどうなるのか"><a href="#Q-コマンド実行前に有償ライセンスや-Office-365-Microsoft-365-付帯ライセンスが付与されている場合はどうなるのか" class="headerlink" title="Q. コマンド実行前に有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスが付与されている場合はどうなるのか"></a><font color=blue>Q. コマンド実行前に有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスが付与されている場合はどうなるのか</font></h3><p>   有償ライセンスや Office 365 / Microsoft 365 付帯ライセンスには影響を与えませんので、引き続きご利用いただけます。<br><br>   <br></p><h3 id="Q-コマンド実行後にもPower-Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。"><a href="#Q-コマンド実行後にもPower-Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。" class="headerlink" title="Q. コマンド実行後にもPower Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。"></a><font color=blue>Q. コマンド実行後にもPower Appsへの接続が可能です。またアプリの作成と編集もできましたが、制御することはできないのでしょうか。</font></h3><p>   Power Apps は “アプリの実行時” にライセンスの有無が確認される製品となっております。<br>そのため、Power Apps へのアクセス、アプリの作成・編集はライセンスを所持していないユーザーでも可能となっており、ライセンスの付与の有無で制御することはできません。<br>   <br></p><h3 id="Q-コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか"><a href="#Q-コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか" class="headerlink" title="Q. コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか"></a><font color=blue>Q. コマンド実行前に「無償版」ライセンスで作成したフローやアプリはどうなるのか</font></h3><p>   フローやアプリは削除されず残り続けます。<br><br>   <b>＜Power Apps＞</b><br>   アプリを実行するユーザーに Office 365 / Microsoft 365 付帯ライセンスなど他の Power Apps のライセンスが付与されている場合は、コマンド実行前と変わらずアプリの実行を行うことができます。他の Power Apps のライセンスが付与されていない場合はアプリを実行できなくなります。<br>なお、Power Apps はアプリの実行時にライセンスを必要とする製品となっておりますため、コマンド実行後にもアプリの作成・編集は可能となります。<br>   <br><br>   <b>＜Power Automate＞</b><br>   作成者に Office 365 / Microsoft 365 付帯ライセンス など他の Power Automate のライセンスが付与されている場合は、コマンド実行前と変わらずフローの編集・実行を行うことができます。<br>作成者に Power Automate のライセンスが一つも付与されていない場合は、バックグラウンド処理にてフローがオフになります。<br>   <br></p><h3 id="Q-コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか"><a href="#Q-コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか" class="headerlink" title="Q. コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか"></a><font color=blue>Q. コマンド実行前に「試用版」ライセンスで作成したフローやアプリはどうなるのか</font></h3><p>   フローやアプリは削除されず残り続けます。<br><br>   <b>＜Power Apps＞</b><br>   アプリを実行するユーザーに <a href="https://powerapps.microsoft.com/ja-jp/pricing/">Power Apps の有償ライセンス</a>が付与されている場合は、コマンド実行前と変わらずアプリの実行を行うことができます。<br>なお、Power Apps はアプリの実行時にライセンスを必要とする製品となっておりますため、コマンド実行後にも<u><b>アプリの作成・編集は可能</b></u>となります。<br>ただし、作成・編集ユーザーに Power Apps の有償ライセンスが付与されていない場合、ゲートウェイなど一部のプレミアム機能がご利用いただけない可能性がございます。<br><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/about-powerapps-perapp#for-users-expected-to-use-a-power-apps-per-app-plan-why-are-users-that-use-an-app-shared-with-them-prompted-to-start-a-power-apps-trial">こちらの公開情報</a>にもございます通り、この制限は最終的には削除される予定です。<br>最新の動作については公開情報及び、製品動作をご確認ください。<br>   <br><br>   <b>＜Power Automate＞</b><br>   [フローの編集]<br>     <u>作成者</u>に <a href="https://flow.microsoft.com/ja-jp/pricing/">Power Automate の有償ライセンス</a>が付与されている場合は、コマンド実行前と変わらずフローの編集を行うことができます。<br>作成者に Power Automate の有償ライセンスが付与されていない場合は、プレミアムコネクタなど有償ライセンスが必要な機能がご利用できなくなります。また、作成者が有償ライセンスを持たず、有償ライセンスが必要な機能を利用しているフローはバックグラウンド処理にてフローがオフになります。<br><br>     ※ Power Apps トリガーの場合は、Power Apps の有償ライセンスのみで Power Automate の有償ライセンスが必要な機能をご利用できます。</p><p>   [フローの実行]<br>   <u>実行者に有償ライセンス</u>が必要となります。実行者が有償ライセンスを持たない場合は、フローを実行することができなくなります。</p><ul><li>自動化フロー<br>フローの実行者は作成者となるため、<u><b>作成者</b></u>に Power Automate の有償ライセンスが必要です。</li><li>ボタンフローなどの手動フロー<br><u><b>フロー実行者</b></u>に Power Automate の有償ライセンスが必要です。</li><li>Power Apps トリガー<br><u><b>Power Apps 実行者</b></u>に <u><b>Power Apps</b></u> の有償ライセンスが必要です。<br>Power Automate の使用権は Power Apps の有償ライセンスに含まれているため、Power Automate のライセンスは必要ありません。<br></li></ul><h3 id="Q-コマンド実行すると他の製品には影響を与えないか"><a href="#Q-コマンド実行すると他の製品には影響を与えないか" class="headerlink" title="Q. コマンド実行すると他の製品には影響を与えないか"></a><font color=blue>Q. コマンド実行すると他の製品には影響を与えないか</font></h3><p>   <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/enterprise-users/directory-self-service-signup">Azure のセルフサービスサインアップ</a>を無効にしていると、Dynamicsの試用版が無効になる場合がございます。<br>Azure のセルフサービスサインアップを無効にしていない場合は、Power Automate 、 Power Apps の無償版、試用版のみに影響があります。<br><br>   <br></p><br><hr><p>Hope to acceralate your business with Power Automate!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;/p&gt;
&lt;br&gt;
今回はよく寄せられるお問い合わせの一つ、Power Automate、Power Apps の無償版・試用版を利用不可にする方法についてご案内いたします。&lt;br&gt;
&lt;br&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="PowerAutomate" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerAutomate/"/>
    
    <category term="PowerApps" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerApps/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate Desktop のサポート範囲について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktopSupportability/</id>
    <published>2021-08-26T03:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.580Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポート チームの 王 です。<br>今日は Power Automate Desktop のサポート範囲についてご案内させていただきます。  </p><span id="more"></span><h2 id="初めに"><a href="#初めに" class="headerlink" title="初めに"></a>初めに</h2><p>Power Automate Desktopは Windows 10 をご利用のお客様であればどなたでも追加費用なしでご利用いただける RPA ツールです。2021年3月3日(日本時間)に公開されました。<br><a href="https://docs.microsoft.com/ja-jp/power-automate/desktop-flows/introduction">Power Automate Desktop の概要</a>  </p><p>今回は Power Automate Desktop のサポート対象についてご案内します。  </p><h2 id="Power-Automate-Desktop-のサポートについて"><a href="#Power-Automate-Desktop-のサポートについて" class="headerlink" title="Power Automate Desktop のサポートについて"></a>Power Automate Desktop のサポートについて</h2><p>Windows の Power Automate Desktop は、PC にインストールして使用する無料のアプリケーションです。<br>このアプリケーションには、SLA や Microsoft サポートが含まれないため、ビジネスクリティカルな用途で使用すべきではありません。<br>Power Automate Desktop をビジネスクリティカルで使用する場合、サポートが含まれる適切な Microsoft ライセンスの購入をご検討ください。<br>対象となるライセンスは以下です ※2021/8 時点<br>・Power Automate per user plan with attended RPA<br>・Power Automate unattended RPA add-on（前提としてPower Automate per user または Power Automate per flow が必要）  </p><p>ライセンスのご購入は、Microsoft 365 管理センターの [課金情報] - [サービスを購入する] からご確認いただけます。<br>上記ライセンスでPower Automate Desktopご利用されていないお客様は、サポートにお問い合わせをいただいた場合もご支援することができません。<br>ライセンスをお持ちでない場合は、以下のコミュニティをご活用ください。<br><a href="https://powerusers.microsoft.com/t5/Microsoft-Power-Automate/ct-p/MPACommunity">Microsoft Power Automate Community</a></p><p>サポート範囲については以下ライセンスガイドからもご確認いただくことが可能です。<br>英語版　：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x409</a><br>日本語版：<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411">https://go.microsoft.com/fwlink/?LinkId=2085130&amp;clcid=0x411</a>  </p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>Power Autoamte Desktop で弊社サポートをご利用いただけるライセンスにについてご案内させていただきました。<br>製品やライセンスに関する情報は随時更新されるため、最新の情報については公開情報もしくは上記ライセンスガイドをご参照ください。  </p><p>–</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポート チームの 王 です。&lt;br&gt;今日は Power Automate Desktop のサポート範囲についてご案内させていただきます。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop Flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-Flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate から PowerShell を実行する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Execute-PowerShell/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Execute-PowerShell/</id>
    <published>2021-08-16T02:30:00.000Z</published>
    <updated>2021-09-24T01:06:19.572Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。</p><br>今回は、Power Automate から PowerShell を実行する方法についてご案内致します。<br>Power Automate と PowerShell と連携させることで、業務自動化の幅を広げていきましょう。<br><br><span id="more"></span><h1 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h1><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-license">必要なライセンス</a></li><li><a href="#anchor-setup-steps">手順</a><ol><li><a href="#anchor-preparation">事前準備</a></li><li><a href="#anchor-create-runbook">Runbookの作成</a></li><li><a href="#anchor-create-flow">フローの作成</a></li><li><a href="#anchor-resutls">実行結果</a></li></ol></li><li><a href="#anchor-faq">FAQ</a></li><li><a href="#anchor-powershell-links">Power Shellリンク集</a></li></ol><p><a id='anchor-intro'></a></p><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>Azure Automation Runbook という機能をご存じでしょうか。<br><br>Azure 上で PowerShell や Python などを実行することができる機能です。<br><br><br><br>この Runbook を利用すると、Power Automate のフローに PowerShell を組み込むことができます。<br><br>Power Automate と組み合わせることによって、例えば以下のようなフローを構築し、業務を自動化できます。<br></p><ul><li>Microsoft Forms で Microsoft 365 管理センター のロール申請を行い、承認されたら、 PowerShell でロール付与する<br><br></li></ul><p>申請者は申請だけを、承認者は承認だけをすれば、ロール付与ができるようになります。ロール付与にかけていた時間で重要な業務に集中できるようになりますね！<br><br></p><p><a id='anchor-license'></a></p><h2 id="必要なライセンス"><a href="#必要なライセンス" class="headerlink" title="必要なライセンス"></a>必要なライセンス</h2><p>実行には、 Power Automate の有償ライセンスと、Azure のサブスクリプションが必要です。<br><br>それぞれの概要については、以下のページをご参照ください。</p><ul><li><a href="https://flow.microsoft.com/ja-jp/pricing/">Power Automateの有償ライセンス</a></li><li><a href="https://azure.microsoft.com/ja-jp/pricing/details/automation/">Azure Automation の価格</a></li></ul><br><p><a id='anchor-setup-steps'></a></p><h2 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h2><p>＜<a href="https://docs.microsoft.com/ja-jp/connectors/azureautomation/">参考：Azure Automation コネクタ</a>＞</p><p><a id='anchor-preparation'></a></p><h3 id="■事前準備"><a href="#■事前準備" class="headerlink" title="■事前準備"></a>■事前準備</h3><ol><li>Azure Automation アカウントを作成します <br><br><a href="https://docs.microsoft.com/ja-jp/azure/automation/automation-quickstart-create-account">「Automation アカウントを作成する」</a> を実施してください。</li></ol><p><a id='anchor-create-runbook'></a></p><h3 id="■Runbookの作成"><a href="#■Runbookの作成" class="headerlink" title="■Runbookの作成"></a>■Runbookの作成</h3><ol><li><p>Runbook を作成します <br><br><a href="https://docs.microsoft.com/ja-jp/azure/automation/automation-quickstart-create-runbook">「Runbook の作成」</a> を実施してください。</p></li><li><p>Runbook の 「編集」 からPower Shellを作成します。<br><br>実行したい処理を記載してください。<br><br>「Param」 を指定することでフローからパラメータを渡すことができます。<br><br>サンプルでは、String型の 「Name」 パラメータを受け取り、コンソールに表示します。<br></p><p><img src="/blog/powerautomate/Execute-PowerShell/runbook-script.png">　　 </p></li><li><p>Runbookを「保存」後「公開」を押下します<br><br><img src="/blog/powerautomate/Execute-PowerShell/publish-runbook.png"></p></li></ol><p><a id='anchor-create-flow'></a></p><h3 id="■フローの作成"><a href="#■フローの作成" class="headerlink" title="■フローの作成"></a>■フローの作成</h3><p>ボタンを押したときに、 PowerShell を実行するフローを作成します。<br></p><ol><li><p>トリガーに 「手動でフローをトリガーします」 を設定します。<br><br>実行時の入力項目に 「テキスト」 を追加します。<br><br><img src="/blog/powerautomate/Execute-PowerShell/button-trigger.png"></p></li><li><p>PowerShell を実行する処理を作成します。<br><br>Azure Automation コネクタの 「ジョブの作成」 を追加します。各項目に Runbook の値を指定します。<br></p><br>サンプルでは PowerShell にフロー実行時に入力したテキストを渡したいと思いますので<br>「Runbook Parameter name」 に動的なコンテンツ 「入力」 を設定します。<br><p><img src="/blog/powerautomate/Execute-PowerShell/azure-automation-create-job.png"></p></li></ol><p><a id='anchor-resutls'></a></p><h3 id="■実行結果"><a href="#■実行結果" class="headerlink" title="■実行結果"></a>■実行結果</h3><ol><li><p>フローを実行します。<br><br>入力欄に 「PowerShell」 と入れ、 「フローの実行」 を押します。<br><br><img src="/blog/powerautomate/Execute-PowerShell/test.png"> <br><br>フローが正常終了したことを確認します。<br><br><img src="/blog/powerautomate/Execute-PowerShell/test2.png"></p></li><li><p>Azure 上で PowerShell が実行されたか確認します。<br><br>ジョブの状態が完了になっていることを確認します。<br><br><img src="/blog/powerautomate/Execute-PowerShell/result.png"><br></p><br>コンソールに実行時に入力した 「PowerShell」 の文字が表示されていることが確認できます。<br><p><img src="/blog/powerautomate/Execute-PowerShell/result2.png"></p></li></ol><p>　　<br>　<br><a id='anchor-faq'></a></p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q1-ジョブの完了を待ちたい"><a href="#Q1-ジョブの完了を待ちたい" class="headerlink" title="Q1. ジョブの完了を待ちたい"></a>Q1. ジョブの完了を待ちたい</h3><p>  「ジョブの待機」 を 「はい」 に変更してください。<br><br>   <img src="/blog/powerautomate/Execute-PowerShell/wait-job.png"><br>　<br><a id='anchor-powershell-links'></a></p><h2 id="Power-Shell-リンク集"><a href="#Power-Shell-リンク集" class="headerlink" title="Power Shell リンク集"></a>Power Shell リンク集</h2><ul><li><a href="https://docs.microsoft.com/ja-jp/power-platform/admin/powerapps-powershell">Power Apps/Power Automate</a></li><li><a href="https://docs.microsoft.com/ja-jp/powershell/azure/?view=azps-6.3.0&viewFallbackFrom=azps-3.0.0">Azure</a></li><li><a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/getting-started-with-microsoft-365-powershell?view=o365-worldwide">Microsoft 365</a></li><li><a href="https://docs.microsoft.com/ja-jp/microsoftteams/teams-powershell-overview">Teams</a></li><li><a href="https://docs.microsoft.com/ja-jp/powershell/sharepoint/?view=sharepoint-ps">SharePoint</a></li></ul><br>PowerShell と Power Automate を組み合わせることで、みなさまの業務自動化が進むことを楽しみにしています。<br>自動化のアイデアを共有してもいいよという方がいましたら、ぜひ私たちに共有してくださいね。<hr><p>Hope to acceralate your business with Power Automate!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;/p&gt;
&lt;br&gt;
今回は、Power Automate から PowerShell を実行する方法についてご案内致します。&lt;br&gt;
Power Automate と PowerShell と連携させることで、業務自動化の幅を広げていきましょう。&lt;br&gt;
&lt;br&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="PowerAutomate" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerAutomate/"/>
    
    <category term="PowerShell" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerShell/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で接続が「無効な接続」になる原因</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Invalid-Connection/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Invalid-Connection/</id>
    <published>2021-07-21T00:30:00.000Z</published>
    <updated>2021-09-24T01:06:19.576Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、日本マイクロソフト Power Automate サポートの清水です。</p><p>今回は、Power Automate で Azure AD 認証の「接続」が無効になってしまうケースとその仕組みについてご説明いたします。</p><span id="more"></span><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>Power Automate を業務で使用するうえで、気になるのが「接続」の有効期限です。</p><p>Power Automate の「接続」は、ユーザーの資格情報を使用して Azure AD からトークンを取得しています。<br>そのため、資格情報に変更があった場合に接続が無効となる場合があることは、ご存じの方も多いかと存じますが、</p><p>「実際にパスワードを変更しても接続が切れない」<br>「認証情報は変更していないのに、突然接続が無効になってしまった」</p><p>といったお問い合わせをいただくことが多々ございます。</p><p>この記事では、接続が無効になるケース、ならないケースと、接続が無効になるまでの仕組みについて、詳細にご説明いたします。</p><h2 id="Power-Autoamte-で「無効な接続」と表示される原因"><a href="#Power-Autoamte-で「無効な接続」と表示される原因" class="headerlink" title="Power Autoamte で「無効な接続」と表示される原因"></a>Power Autoamte で「無効な接続」と表示される原因</h2><p>実際に接続が無効になるケース、ならないケースは以下の通りです。</p><table><thead><tr><th>接続が無効になるケース</th><th>接続が無効にならないケース</th></tr></thead><tbody><tr><td><li>ユーザーまたは管理者による PowerShell での更新 トークンの無効化</li><li>管理者による Microsoft 365 管理センターでのパスワードのリセット</li><li>条件付きアクセス ポリシーや多要素認証の設定変更</li><li>接続が長期間 (90 日以上) 使用されていない</li><li>接続先サービス側の一時的な不具合</li></td><td><li>パスワードの有効期限切れ</li><li>ユーザーによるパスワード変更</li><li>ユーザーによる セルフサービス パスワード リセット</li><li>Web 上でのシングルサインアウト</li></td></tr></tbody></table><h2 id="Power-Automate-での認証の仕組み"><a href="#Power-Automate-での認証の仕組み" class="headerlink" title="Power Automate での認証の仕組み"></a>Power Automate での認証の仕組み</h2><p>さて、具体的な Power Autoamte での認証の仕組みについて、ご説明します。</p><p>Power Automate で使用するコネクタは、Azure AD での認証を行うことで、下記 2 種類のトークンを取得しています。</p><ul><li>リソースに対するトークン (アクセス トークン)</li><li>継続的なアクセスを行うためのトークン (更新 トークン)</li></ul><p>トークンの取得後、コネクタは上記のうちアクセス トークンを利用してリソースにアクセスします。<br>なお、<a href="https://docs.microsoft.com/ja-jp/azure/active-directory/develop/active-directory-configurable-token-lifetimes#access-tokens">アクセス トークンは取り消すことはできず、有効期限が切れるまでの間は使用可能</a>です。</p><p>アクセス トークンの有効期限なそれほど長くないため、有効期限が切れた場合には、<br>更新 トークンを利用してアクセス トークンを更新することで、継続的にリソースに対してアクセス可能な仕組みとなっています。</p><p>また、更新 トークンには、認証を行った際の IP アドレスや条件付きアクセス ポリシーの情報など、<br>内部的にユーザーがどのような認証を行ったかの情報が含まれています。</p><p>したがって、更新 トークンを使用してアクセストークンを更新する際、<br>条件付きアクセス ポリシーや多要素認証などの設定が認証時と異なっていると、アクセス トークンの更新は失敗し、<br>接続が「無効な接続」となってしまいます。</p><p>また、資格情報の変更や管理者の操作により、更新 トークン自体が無効となる場合もございます。<br>原因として表に挙げた例の中では、以下が当てはまります。</p><ul><li><p>ユーザーまたは管理者が PowerShell を使用して更新トークンを無効化<br> Power Automate の接続は、「機密クライアントのトークン」として認識されます。<br> そのため、<a href="https://docs.microsoft.com/ja-jp/azure/active-directory/develop/access-tokens#revocation">公開情報の表</a>に記載の通り、更新トークンを無効化した場合のみトークンが取り消されます。<br> パスワード変更や期限切れでは、更新 トークンは無効となりません。</p></li><li><p>接続が長期間 (90 日以上) 使用されていない<br><a href="https://docs.microsoft.com/ja-jp/azure/active-directory/develop/active-directory-configurable-token-lifetimes#refresh-and-session-token-lifetime-policy-properties">更新 トークンの最大非アクティブ時間</a>の制限により、接続が 90 日以上使用されていない場合、更新 トークンは失効いたします。</p></li></ul><p>上記の場合、更新 トークンが失効してアクセス トークンの更新ができないため、「無効な接続」となってしまいます。</p><p>ご説明した動作をまとめると、Power Automate では、</p><ol><li>アクセス トークンの有効期限が切れ、</li><li>更新 トークンが失効した</li></ol><p>場合に、リソースにアクセスするためのアクセス トークンの更新ができず、「無効な接続」が発生します。</p><h3 id="補足-時間が経ってから接続が無効になる"><a href="#補足-時間が経ってから接続が無効になる" class="headerlink" title="(補足) 時間が経ってから接続が無効になる"></a>(補足) 時間が経ってから接続が無効になる</h3><p>上述の仕組みからお分かりの通り、接続が無効になるまでには、</p><ol><li>アクセス トークンの有効期限切れ</li><li>更新 トークンの失効</li></ol><p>の 2 つのステップがあります。</p><p>そのため、実際に接続が切れるような操作を行ってから接続が無効となるまで、<br>アクセス トークンの有効期限に応じて、期間が空く場合があることにご留意ください。</p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>以上、Power Autoamte での認証の仕組みについてご説明しました。<br>認証が切れるケースに該当するような操作を行う場合は、Power Autoamte での接続の再認証もお忘れないよう、ご留意ください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、日本マイクロソフト Power Automate サポートの清水です。&lt;/p&gt;
&lt;p&gt;今回は、Power Automate で Azure AD 認証の「接続」が無効になってしまうケースとその仕組みについてご説明いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Connection" scheme="https://jpdynamicscrm.github.io/blog/tags/Connection/"/>
    
  </entry>
  
  <entry>
    <title>キャンバス アプリのモニターログ取得手順</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-monitor/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-monitor/</id>
    <published>2021-06-16T15:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.568Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの清水です。<br>今回は、Power Apps のキャンバス アプリの調査の際に必要なモニター ログの取得方法についてご説明します。</p><span id="more"></span><p>モニター ログは、アプリの編集時のものと再生時のものがどちらも取得可能ですので、状況に応じて必要なログを取得してください。</p><h2 id="編集画面でのモニター-ログ取得方法"><a href="#編集画面でのモニター-ログ取得方法" class="headerlink" title="編集画面でのモニター ログ取得方法"></a>編集画面でのモニター ログ取得方法</h2><p><strong>[手順]</strong></p><ol><li>アプリを編集画面から開き、[高度なツール] ＞ [モニターを開く] をクリックします。<br><img src="/blog/canvasapp/Canvas-app-monitor/img01.png"></li><li>別タブにてモニターが開きますので、事象発生部分を編集モードで実行します。</li><li>ログの記録が確認できたら、モニター画面にて [ダウンロード] をクリックします。<br><img src="/blog/canvasapp/Canvas-app-monitor/img02.png"></li><li>Json ファイルがダウンロードされますので、弊社までお寄せください。</li></ol><h2 id="再生画面でのモニター-ログ取得方法"><a href="#再生画面でのモニター-ログ取得方法" class="headerlink" title="再生画面でのモニター ログ取得方法"></a>再生画面でのモニター ログ取得方法</h2><p><strong>事前準備</strong>: アプリ再生時の情報を取得するために、アプリを編集画面で開き、<br>[設定] &gt; [全般] にて「公開されたアプリのデバッグ」をオンに設定します。<br><img src="/blog/canvasapp/Canvas-app-monitor/img03.png"></p><p><strong>[手順]</strong></p><ol><li>エラーが発生するユーザーにて Power Apps にサインインし、[アプリ] をクリックします。</li><li>エラーの発生するアプリの […] &gt; [監視] をクリックします。<br><img src="/blog/canvasapp/Canvas-app-monitor/img04.png"></li><li>別タブにてモニターが開きますので、[公開したアプリの再生] をクリックします。<br><img src="/blog/canvasapp/Canvas-app-monitor/img05.png"></li><li>アプリが再生されるので、事象発生部分を実行します。</li><li>ログの記録が確認できたら、モニター画面にて [ダウンロード] をクリックします。<br><img src="/blog/canvasapp/Canvas-app-monitor/img02.png"></li><li>Json ファイルがダウンロードされますので、弊社までお寄せください。</li></ol><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><p><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/monitor-overview">モニターの概要 | Microsoft Docs</a><br><a href="https://docs.microsoft.com/ja-jp/powerapps/maker/monitor-canvasapps">モニターでキャンバス アプリをデバッグする | Microsoft Docs</a></p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの清水です。&lt;br&gt;今回は、Power Apps のキャンバス アプリの調査の際に必要なモニター ログの取得方法についてご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="CanvasApp" scheme="https://jpdynamicscrm.github.io/blog/tags/CanvasApp/"/>
    
    <category term="Monitor" scheme="https://jpdynamicscrm.github.io/blog/tags/Monitor/"/>
    
    <category term="情報採取" scheme="https://jpdynamicscrm.github.io/blog/tags/%E6%83%85%E5%A0%B1%E6%8E%A1%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate Desktop で「フローなし」と表示される場合の対処法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktop-NoFlow/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/PowerAutomateDesktop-NoFlow/</id>
    <published>2021-06-07T03:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.576Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Automate サポートの清水です。</p><p>今回は、Power Automate Desktop で「フローなし」のエラーが表示される場合の対処法についてご紹介します。</p><span id="more"></span><p>Power Automate Desktop をインストールした後、いざデスクトップ フローを作成しよう！とサインインすると、<br>以下のような エラーが表示される場合があります。</p><p><img src="/blog/powerautomate/PowerAutomateDesktop-NoFlow/Error.png"></p><p>今回は上記のエラー解消に向けての確認ポイントをご案内します。</p><h2 id="1-ネットワーク環境の確認"><a href="#1-ネットワーク環境の確認" class="headerlink" title="1. ネットワーク環境の確認"></a>1. ネットワーク環境の確認</h2><p>Power Automate Desktop を使用するには、いくつかのエンドポイントを許可していただく必要がございます。</p><p>プロキシを経由して通信を行っている場合や、ファイアウォールで通信の制御を行っている場合には、<br>以下の IP アドレスやドメインが許可されているかをご確認ください。<br><a href="https://docs.microsoft.com/ja-jp/power-automate/ip-address-configuration">IP アドレスの構成 - Power Automate | Microsoft Docs</a></p><h2 id="2-既定の環境でのユーザーの状態の確認"><a href="#2-既定の環境でのユーザーの状態の確認" class="headerlink" title="2. 既定の環境でのユーザーの状態の確認"></a>2. 既定の環境でのユーザーの状態の確認</h2><p>Power Automate Desktop に最初にログインした際には、テナントの既定の環境にアクセスいたします。</p><p>そのため、既定の環境でユーザーが無効な状態になっている場合にエラーが発生する場合がございますので、<br>ログインしているユーザーが有効な状態になっているかをご確認ください。</p><p>&lt;確認手順&gt;</p><ol><li>全体管理者アカウントにて、<a href="https://admin.powerplatform.microsoft.com/">Power Platform 管理センター</a>にアクセスし、既定の環境をクリックします。</li><li>[設定] から、[ユーザーとアクセス許可] &gt; [ユーザー] を開きます。</li><li>ユーザー一覧に該当のユーザーが存在するかを確認し、存在しない場合は [ユーザーの追加] ボタンをクリックします。</li><li>対象ユーザーアカウントのメールアドレスを指定し、[追加] をクリックします。</li><li>ユーザー追加が完了しましたら、ユーザーの設定ページを開き、下図のように状態が “有効” であることを確認します。<br><img src="/blog/powerautomate/PowerAutomateDesktop-NoFlow/UserStatus.png"></li><li>ユーザーが有効なことが確認できたら、再度 Power Automate Desktop でのフロー作成を試します。</li></ol><p>なお、過去に一度も Power Automate にアクセスしたことがない場合は、<a href="https://japan.flow.microsoft.com/">Power Automate ポータル</a>にアクセスすると、<br>自動で既定の環境に追加されます。<br>管理者でのユーザーの確認が難しい場合は、一度 Power Automate ポータルにアクセスしてから<br>少し時間を置いて Powre Automate Desktop にアクセスするなどの操作もお試しください。</p><h2 id="3-Dataverse-旧名-Common-Data-Service-のライセンスの確認"><a href="#3-Dataverse-旧名-Common-Data-Service-のライセンスの確認" class="headerlink" title="3. Dataverse (旧名: Common Data Service) のライセンスの確認"></a>3. Dataverse (旧名: Common Data Service) のライセンスの確認</h2><p>Power Automate Desktop で作成されたフローは既定の環境の Dataverse に保存されるため、<br>Power Automate Desktop を使用するには、有効な Dataverse のライセンスが必要となります。</p><p>通常は、Power Automate のライセンスを持っていないユーザーであっても、初めて Power Automate にアクセスした際に<br>全てのユーザーに無償版の「Power Automate Free」というライセンスが付与されます。<br>そのため、この無償のライセンスによって Dataverse へのアクセスが可能となり、Power Automate Desktop を使用できます。</p><p>しかし、テナント内で無償版のライセンスを禁止としている場合には、Power Automate Free ライセンスが使用できないため、<br>有効なライセンスがないことから、Power Automate Desktop が使用できないケースがございます。</p><p>この場合、一度テナントの管理者にご連絡いただき、Power Automate Free もしくは Power Automate for Office 365 などのライセンスを付与していただくようお願いいたします。</p><h2 id="4-Power-Automate-Desktop-のバージョンの確認"><a href="#4-Power-Automate-Desktop-のバージョンの確認" class="headerlink" title="4. Power Automate Desktop のバージョンの確認"></a>4. Power Automate Desktop のバージョンの確認</h2><p>以下のリンクから、Power Automate Desktopの最新バージョンをインストールし、<br>事象が解消するかどうかをご確認ください。<br><a href="https://go.microsoft.com/fwlink/?linkid=2102613">https://go.microsoft.com/fwlink/?linkid=2102613</a></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>Power Automate Desktop で「フローなし」のエラーが発生する場合の確認点についてご説明いたしました。<br>Power Automate Desktop を初めて使用するユーザーにとって、少しでもお役に立つ情報がございましたら幸いです。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Automate サポートの清水です。&lt;/p&gt;
&lt;p&gt;今回は、Power Automate Desktop で「フローなし」のエラーが表示される場合の対処法についてご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop Flows" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-Flows/"/>
    
    <category term="Power Automate Desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>SharePointの内部列名を確認する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/Look-up-internal-column-names-in-SPO/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/Look-up-internal-column-names-in-SPO/</id>
    <published>2021-06-01T02:30:00.000Z</published>
    <updated>2021-09-24T01:06:19.576Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。</p><p>今回はSharePointリストを利用したフローを作成するときに、必ず知っておくべき内部列名とその確認方法をご案内します。<br>内部列名を使いこなせれば、トリガー条件やフィルタークエリを使って、SharePointを更に便利に使いこなせます！<br>便利な使い方は別の機会にたくさん紹介しますので、今回は内部列名の確認方法についてしっかり覚えていきましょう。</p><p>この記事の対象者</p><ul><li>Power Automateをはじめたばかりの方</li><li>SharePointリストとPower Automateの連携に興味のある方</li></ul><p>Power Automateを使って、一緒にビジネスを加速させましょう！</p><span id="more"></span><hr><h1 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h1><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-what-is-internal-column">内部列名って何？</a></li><li><a href="#anchor-how-to-look-up-internal-column">内部列名の確認方法</a></li></ol><p><a id='anchor-Intro'></a></p><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><h3 id="こんなことしたいなって思ったことありませんか？"><a href="#こんなことしたいなって思ったことありませんか？" class="headerlink" title="こんなことしたいなって思ったことありませんか？"></a>こんなことしたいなって思ったことありませんか？</h3><ul><li>SharePointリストの期限列と現在日時を比較して、期限間近のアイテムをTeamsやメールでリマインドしたい</li><li>ステータス列が「完了」以外のときだけフローを実行したい</li></ul><p>Power Automateを使えば、「期限列」や「ステータス列」の値を利用して、～この列が〇〇のとき～のような条件式を簡単に作成することができます!</p><p>詳しい方法はまた別の機会にblogとして更新しますので、今回は列を指定するときに必要な内部列名について学んでいきます。</p><p>それでは早速SharePointリストの内部列名とは何かから、学んでいきましょう！</p><p>基礎知識は飛ばして確認方法を知りたいという方は<a href="#anchor-how-to-look-up-internal-column">内部列名の確認方法</a>へ進んでください。</p><p><a id='anchor-what-is-internal-column'></a></p><h2 id="内部列名って何"><a href="#内部列名って何" class="headerlink" title="内部列名って何?"></a>内部列名って何?</h2><p>内部列名はシステム側で列を特定するためのキー項目です。<br></p><h3 id="内部列名がないと・・・"><a href="#内部列名がないと・・・" class="headerlink" title="内部列名がないと・・・"></a>内部列名がないと・・・</h3><p>例えば、以下のようなデータがあったとします。</p><table><thead><tr><th align="left">列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left">A社様見積もり</td></tr><tr><td align="left">承認者</td><td align="left">〇〇部長</td></tr><tr><td align="left">期限</td><td align="left">2021/06/01</td></tr></tbody></table><p>ここに、二次承認者を加えることになりました。<br><br>そこで「承認者」と「期限」の列名を変更することにしました。<br><br><br></p><table><thead><tr><th align="left">表示上の列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left">A社様見積もり</td></tr><tr><td align="left"><font color=red>一次</font>承認者</td><td align="left">？</td></tr><tr><td align="left"><font color=red>一次承認</font>期限</td><td align="left">？</td></tr><tr><td align="left">二次承認者</td><td align="left">-</td></tr><tr><td align="left">二次承認期限</td><td align="left">-</td></tr></tbody></table><br>「承認者」と「期限」という列名がなくなってしまったので、システム側が元々の値を見つけられなくなってしまいます。<br>では、二次承認を加える前のデータに内部列名を追加してみましょう。<br><table><thead><tr><th align="left">表示上の列名</th><th align="left">内部列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left"><font color=red>Title</font></td><td align="left">A社様見積もり</td></tr><tr><td align="left">承認者</td><td align="left"><font color=red>Approver</font></td><td align="left">〇〇部長</td></tr><tr><td align="left">期限</td><td align="left"><font color=red>deadline</font></td><td align="left">2021/06/01</td></tr></tbody></table><br>次に、「承認者」と「期限」の列名を変更して、二次承認者の情報を増やします。<br><table><thead><tr><th align="left">表示上の列名</th><th align="left">内部列名</th><th align="left">値</th></tr></thead><tbody><tr><td align="left">Title</td><td align="left">Title</td><td align="left">A社様見積もり</td></tr><tr><td align="left"><font color=red>一次</font>承認者</td><td align="left"><font color=red>Approver</font></td><td align="left">〇〇部長</td></tr><tr><td align="left"><font color=red>一次承認</font>期限</td><td align="left"><font color=red>deadline</font></td><td align="left">2021/06/01</td></tr><tr><td align="left">二次承認者</td><td align="left">Secondary Approver</td><td align="left">-</td></tr><tr><td align="left">二次承認期限</td><td align="left">Secondary Approve deadline</td><td align="left">-</td></tr></tbody></table><br>表示上の列名が変更されても内部列名が変わらないので、システム側も値を見つけることができますね。<br><br>Power AutomateからSharePointの列を扱うときも、同様の理由で表示名ではなく、内部列名を利用します。<br>この仕組みがあるから誰かが表示上の列名を変更された場合でも、フローを編集する必要はありませんね。<br><br>今回は説明の便宜上わかりやすい内部列名を利用しましたが、SharePoint登録時に内部列名を利用者が設定することはできません。<br>例えば、「承認期限」という名前で列を作ると、「_x627f__x8a8d__x671f__x9650_」という内部列名が自動で作成されます。<br><br><p>一見取っつきにくい表記に思えますが、どの列かを識別するためのものなので、列を表す記号と捉えて次に進みましょう。<br><br><br><a id='anchor-to-use-internal-column'></a></p><h2 id="内部列名をPower-Automateで利用するために"><a href="#内部列名をPower-Automateで利用するために" class="headerlink" title="内部列名をPower Automateで利用するために"></a>内部列名をPower Automateで利用するために</h2><p>Powre Automate利用時に注意が必要になるのが、内部列名はそのままで利用できる場合と、加工が必要な場合があります。<br><br>決まりなので覚えていきましょう。<br></p><br>以下の列を持つリストを例にして、確認していきます。<p><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/SPO-list.png"></p><br>各列の内部列名を確認していくと、以下のようになります。<br><ul><li>文字の種類がアルファベットからはじまる場合は、<strong><font color=red>OData_</font></strong> という接頭辞が<font color=blue>不要</font></li><li>文字の種類がアルファベット以外からはじまる場合<font color=red>以外</font>は、<strong><font color=red>OData_</font></strong> という接頭辞が<font color=blue>必要</font></li></ul><br><table><thead><tr><th align="center">文字の種類</th><th align="center">列名</th><th align="center">内部列名</th><th align="center">Power Automate 利用時</th></tr></thead><tbody><tr><td align="center">アルファベット</td><td align="center">Details</td><td align="center">Details</td><td align="center">Details</td></tr><tr><td align="center">アルファベット×日本語</td><td align="center">Details_承認内容</td><td align="center">Details__x627f__x8a8d__x5185__x5</td><td align="center">Details__x627f__x8a8d__x5185__x5</td></tr><tr><td align="center">日本語</td><td align="center">承認期限</td><td align="center">_x627f__x8a8d__x671f__x9650_</td><td align="center"><font color=red>OData_</font>_x627f__x8a8d__x671f__x9650_</td></tr><tr><td align="center">記号 ( 2byte )</td><td align="center">・</td><td align="center">_x30fb_</td><td align="center"><font color=red>OData_</font>_x30fb_</td></tr><tr><td align="center">記号 ( 1byte )</td><td align="center">///</td><td align="center">_x002f__x002f__x002f_</td><td align="center"><font color=red>OData_</font>_x002f__x002f__x002f_</td></tr><tr><td align="center">数値</td><td align="center">123456</td><td align="center">_x0031_23456</td><td align="center"><font color=red>OData_</font>_x0031_23456</td></tr></tbody></table><br><br><p><a id='anchor-how-to-look-up-internal-column'></a></p><h2 id="内部列名の確認方法"><a href="#内部列名の確認方法" class="headerlink" title="内部列名の確認方法"></a>内部列名の確認方法</h2><p>では実際に、内部列名を確認していきましょう。</p><ol><li><p>SharePointにて、内部列名を確認したいリストを表示します。</p></li><li><p>歯車アイコンからリストの設定を開きます。<br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/open-list-setting.png"></p></li><li><p>列の一覧から、確認したい列を選択します。<br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/open-column-setting.png"></p></li><li><p>URL の <strong>Field= </strong>以降の値が内部列名となります。<br> <img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-internal-name.png"></p></li><li><p>最後に以下の表の規則に従い、アルファベットからはじまる場合以外は OData_ を付与します。</p><table><thead><tr><th align="center">文字の種類</th><th align="center">列名</th><th align="center">内部列名</th><th align="center">SharePoint 列の設定での表示</th><th align="center">Power Automate 利用時</th></tr></thead><tbody><tr><td align="center">アルファベット</td><td align="center">Details</td><td align="center">Details</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-alfabet.png"></td><td align="center">Details</td></tr><tr><td align="center">アルファベット×日本語</td><td align="center">Details_承認内容</td><td align="center">Details__x627f__x8a8d__x5185__x5</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-alfabet_japanese.png"></td><td align="center">Details__x627f__x8a8d__x5185__x5</td></tr><tr><td align="center">日本語</td><td align="center">承認期限</td><td align="center">_x627f__x8a8d__x671f__x9650_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-deadline.png"></td><td align="center"><font color=red>OData_</font>_x627f__x8a8d__x671f__x9650_</td></tr><tr><td align="center">記号 ( 2byte )</td><td align="center">・</td><td align="center">_x30fb_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-mark-2byte.png"></td><td align="center"><font color=red>OData_</font>_x30fb_</td></tr><tr><td align="center">記号 ( 1byte )</td><td align="center">///</td><td align="center">_x002f__x002f__x002f_</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-slash.png"></td><td align="center"><font color=red>OData_</font>_x002f__x002f__x002f_</td></tr><tr><td align="center">数値</td><td align="center">123456</td><td align="center">_x0031_23456</td><td align="center"><img src="/blog/powerautomate/Look-up-internal-column-names-in-SPO/column-num.png"></td><td align="center"><font color=red>OData_</font>_x0031_23456</td></tr></tbody></table></li></ol><p>これで内部列を取得することができました。<br><br><br>内部列名についてのご案内は以上となります。<br></p><br>いかがでしたでしょうか。<br>内部列名を使えるとSharePointリストを使ったフローの幅を広げることができますので、どんどん使っていってくださいね。<br><hr><p>Hope to acceralate your business with Power Automate!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;/p&gt;
&lt;p&gt;今回はSharePointリストを利用したフローを作成するときに、必ず知っておくべき内部列名とその確認方法をご案内します。&lt;br&gt;内部列名を使いこなせれば、トリガー条件やフィルタークエリを使って、SharePointを更に便利に使いこなせます！&lt;br&gt;便利な使い方は別の機会にたくさん紹介しますので、今回は内部列名の確認方法についてしっかり覚えていきましょう。&lt;/p&gt;
&lt;p&gt;この記事の対象者&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Power Automateをはじめたばかりの方&lt;/li&gt;
&lt;li&gt;SharePointリストとPower Automateの連携に興味のある方&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Power Automateを使って、一緒にビジネスを加速させましょう！&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="PowerAutomate" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerAutomate/"/>
    
    <category term="SharePointOnline" scheme="https://jpdynamicscrm.github.io/blog/tags/SharePointOnline/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse for Teams 環境の管理方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Manage-Dataverse-for-Teams/</id>
    <published>2021-04-27T02:30:00.000Z</published>
    <updated>2021-09-24T01:06:19.580Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの清水です。</p><p>今回は、2020 年 9 月に 新たに Teams に統合された Power Platform の機能について、その管理・制御方法やよくお問合せいただく内容に関して、詳しくご説明いたします。</p><p>ライセンスが Teams に組み込まれているという性質上、管理にお困りの方も多いかと思います。<br>この記事が皆様のお役に立ちましたら幸いです。</p><span id="more"></span><h2 id="Dataverse-for-Teams-の概要"><a href="#Dataverse-for-Teams-の概要" class="headerlink" title="Dataverse for Teams の概要"></a>Dataverse for Teams の概要</h2><hr><p>Dataverse for Teams 環境とは、Teams のチームに紐づく Power Platform の環境です。</p><p>チームの所有者が環境の管理者となり、チームのメンバーは環境上でアプリやフロー、チャットボットを作成・使用することができます。<br>参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/admin/about-teams-environment">Microsoft Dataverse for Teams 環境について | Microsoft Docs</a></p><p>Dataverse for Teams の環境は、Teams を通してのみ作成されます。<br>例えば以下のような場合に、選択したチームの Dataverse for Teams 環境が自動で作成されます。</p><ul><li>Teams 上の Power Apps アプリを使用して、で初めて環境に紐づくアプリを作成したとき</li><li>Teams 上の Power Virtual Agents アプリを使用して、初めて環境に紐づくボットを作成したとき</li><li>Teams のアプリ カタログから初めて Power Apps アプリ (※1) をインストールしたとき</li></ul><p>なお、Teams のチームと Dataverse for Teams の環境は 1:1 で紐づけらます。<br>そのため、一つのチームで複数の環境を持つことはできません。<br>また、異なるチームの Dataverse for Teams 環境にアクセスすることもできません。</p><h3 id="環境の制限"><a href="#環境の制限" class="headerlink" title="環境の制限"></a>環境の制限</h3><p>Dataverse for Teams 環境には以下の制限があります。</p><ul><li><p>Microsoft 365 のライセンス数に応じたテナント毎の環境数の制限<br>  テナント毎の環境数の上限は以下の式で決定されます。<br>  <code>5 + (1 * Microsoft 365 のライセンス数 / 20)</code><br>  また、ライセンス数に関わらず、環境数の上限は 10,000 (※2) となります。</p></li><li><p>環境ごとのストレージ制限<br>  各環境は、最大で 2 GB または 100 万行のデータを格納することが可能です。</p></li><li><p>テナントごとのストレージ制限<br>  テナント毎のストレージ容量の上限は以下の式で決定されます。<br>  <code>10 GB + (環境数 * 2 GB)</code><br>  また、ストレージ容量の上限は 19.5 TB となります。</p></li></ul><p>各テナントで作成可能な環境数は、Power Platform 管理センターからご確認ください。</p><p>Power Platform 管理センター &gt; リソース &gt; キャパシティ &gt; Microsoft Teams<br><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/limitation.png"></p><p>制限を超えて環境やストレージ容量を使用したい場合は、<a href="https://docs.microsoft.com/en-us/power-platform/admin/about-teams-environment#upgrade-process">Dataverse へのアップグレード</a>をご検討ください。</p><h3 id="環境へのゲストアクセス"><a href="#環境へのゲストアクセス" class="headerlink" title="環境へのゲストアクセス"></a>環境へのゲストアクセス</h3><p>Teams チームにゲストユーザーを招待している場合、ゲストユーザーは以下のような権限を持ちます。</p><ul><li>アプリやボット、その他リソースの閲覧</li><li>アプリやボットの実行</li><li>自身が作成したレコードへのフルアクセス<br>  ※他のユーザーが作成したレコードへのアクセス権は持ちません。</li></ul><h2 id="特定のユーザーにだけ環境を作成させたい"><a href="#特定のユーザーにだけ環境を作成させたい" class="headerlink" title="特定のユーザーにだけ環境を作成させたい"></a>特定のユーザーにだけ環境を作成させたい</h2><hr><p>最初に説明した通り、Dataverse for Teams 環境は、Teams 上でのアプリやボットの作成を通して作成されます。<br>そのため、環境を作成させたくない場合、Teams 上でのアプリやボットの作成を禁止する、すなわち、Teams からのPower Apps および Power Virtual Agents の使用を禁止する必要がございます。</p><p>Temas からの Power Apps/Power Virtual Agents の使用を禁止するには、Teams 管理センターからアプリのアクセス許可ポリシーの設定を行い、環境作成を許可しても良いユーザーにだけ以下 2 つのアプリを許可するよう設定してください。</p><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/Teams-app-policy.png"><br>参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/teams-app-permission-policies">Microsoft Teams のアプリのアクセス許可ポリシーを管理する | Microsoft Docs</a></p><h2 id="環境の作成は禁止したいけど、アプリは使わせたい"><a href="#環境の作成は禁止したいけど、アプリは使わせたい" class="headerlink" title="環境の作成は禁止したいけど、アプリは使わせたい"></a>環境の作成は禁止したいけど、アプリは使わせたい</h2><hr><p>Teams 上の Power Apps/Power Virtual Agents アプリを禁止としても、引き続きアプリやボットを使用することは可能です。<br>まず、アプリやボットの使用許可するには、組織全体のカスタム アプリ設定にて、カスタムアプリとの対話を許可してください。<br>参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/teams-custom-app-policies-and-settings#org-wide-custom-app-setting">Microsoft Teams のカスタム アプリのポリシーと設定を管理する#組織全体のカスタム アプリ設定 | Microsoft Docs</a></p><h3 id="同僚が作成-からアプリを取得する"><a href="#同僚が作成-からアプリを取得する" class="headerlink" title="[同僚が作成] からアプリを取得する"></a>[同僚が作成] からアプリを取得する</h3><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/built-by-your-colleagues.png"><br>以下のいずれかの条件に合致するアプリまたはボットは、Teams の[アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] からインストールすることが可能です。</p><table><thead><tr><th>Power Apps</th><th>Power Virtual Agents</th></tr></thead><tbody><tr><td>1. ユーザーが作成したアプリ<br>2. ユーザーに直接共有されたアプリ (グループや組織全体への共有は NG)<br>3. 直近 1 週間以内に使用したアプリ</td><td>1. ユーザーが作成したボット<br>2. ユーザーが所属するグループで作成されたボット</td></tr></tbody></table><p>Dataverse for Teams 環境で作成したアプリやボットを [同僚が作成] からユーザーがインストールできるようにするには、それぞれ以下の Teams アプリを許可してください。</p><p><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/Teams-app-policy-Shared.png"></p><p>これらの Teams アプリと、先に説明した環境作成が行われる Teams アプリの違いは、それぞれ以下の通りです。</p><table><thead><tr><th>アプリ</th><th>機能</th></tr></thead><tbody><tr><td>Power Apps</td><td>Power Apps 自体の機能を提供します。<br> アプリの作成や編集、管理は全てこのアプリにより行われます。</td></tr><tr><td>Shared Power Apps</td><td>Power Apps で作成されたアプリを表示・使用する機能を提供します。<br>このアプリを使用することで、Teams 上の [アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] にアプリが表示されるようになり、個人の Teams 上で使用することが可能になります。</td></tr></tbody></table><table><thead><tr><th>アプリ</th><th>機能</th></tr></thead><tbody><tr><td>Power Virtual Agents</td><td>Power Virtual Agents 自体の機能を提供します。<br> ボットの作成や編集、管理は全てこのアプリにより行われます。</td></tr><tr><td>Shared Power Virtual Agents</td><td>Power Virtual Agents で作成されたボットを表示・使用する機能を提供します。<br>このアプリを使用することで、Teams 上の [アプリ] &gt; [テナント向けに構築] &gt; [同僚が作成] にボットが表示されるようになり、個人の Teams 上で使用することが可能になります。</td></tr></tbody></table><p>※参考: <a href="https://docs.microsoft.com/ja-jp/microsoftteams/manage-power-platform-apps">Microsoft Teams 管理センターで Microsoft Power Platform アプリを管理する | Microsoft Docs</a></p><h2 id="環境を監視するには？"><a href="#環境を監視するには？" class="headerlink" title="環境を監視するには？"></a>環境を監視するには？</h2><hr><p>センター オブ エクセレンス (CoE) キットを使用すると、Dataverse for Teams の環境の監視およびクリーン アップが可能となります。<br>参考: <a href="https://docs.microsoft.com/ja-jp/power-platform/guidance/coe/teams-governance">Microsoft Dataverse for Teams 環境管理 | Microsoft Docs</a></p><p>CoE スターター キットとは、Power Platform での管理や開発を支援するためのツールです。<br><a href="https://github.com/microsoft/powerapps-tools/tree/master/Administration/CoEStarterKit">GitHub リポジトリ</a> からダウンロードでき、Power Platform のソリューションとしてインストールされます。<br>詳細については、<a href="https://docs.microsoft.com/ja-jp/power-platform/guidance/coe/overview">公開情報</a> をご参照ください。</p><p>※注意事項<br><img src="/blog/powerplatform/Manage-Dataverse-for-Teams/CoE-disclaimer.png"></p><h2 id="注釈"><a href="#注釈" class="headerlink" title="注釈"></a>注釈</h2><p>(※1) <a href="https://docs.microsoft.com/ja-jp/powerapps/teams/use-sample-apps-from-teams-store">公開情報</a>に記載のサンプル アプリをインストールすると、Dataverse for Teams 環境が自動で作成されます。<br>(※2) Microsoft 365 のライセンス数が 200,000 を超えるテナントに関しては、上限を引き上げたい場合、サポートまでお問合せください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの清水です。&lt;/p&gt;
&lt;p&gt;今回は、2020 年 9 月に 新たに Teams に統合された Power Platform の機能について、その管理・制御方法やよくお問合せいただく内容に関して、詳しくご説明いたします。&lt;/p&gt;
&lt;p&gt;ライセンスが Teams に組み込まれているという性質上、管理にお困りの方も多いかと思います。&lt;br&gt;この記事が皆様のお役に立ちましたら幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerPlatform" scheme="https://jpdynamicscrm.github.io/blog/tags/PowerPlatform/"/>
    
    <category term="Management" scheme="https://jpdynamicscrm.github.io/blog/tags/Management/"/>
    
    <category term="Dataverse for Teams" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse-for-Teams/"/>
    
  </entry>
  
  <entry>
    <title>キャンバス アプリ の委任について</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-delegation/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-delegation/</id>
    <published>2021-04-19T15:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.564Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの清水です。<br>今回は、Power Apps のキャンバス アプリを使用する際に引っ掛かりがちな「委任」の制限について、かみ砕いてご説明いたします。</p><p>公開情報は<a href="https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/delegation-overview">こちら</a>。</p><span id="more"></span><h2 id="そもそも委任って何？"><a href="#そもそも委任って何？" class="headerlink" title="そもそも委任って何？"></a>そもそも委任って何？</h2><p>「委任」とは、Power Apps 上でのデータ操作 (Filter クエリなど) をアプリ上で行わず、データソース側で行い、キャンバス アプリはその結果のみを取得することで、アプリのパフォーマンスを向上させる仕組みのことを言います。</p><p>Power Apps で扱う業務データは非常に膨大になることも少なくないので、全てのデータを取得してから、アプリ上で Filter や Sort を行うことは現実的ではございません。<br>したがって、データ量を抑えて効率的なアプリを作成するために、データソースに委任できる処理はデータソース側でやってもらい、アプリでは処理結果を受け取るだけにしましょうね、という仕組みを提供しています。</p><h2 id="委任可能なデータソースと関数"><a href="#委任可能なデータソースと関数" class="headerlink" title="委任可能なデータソースと関数"></a>委任可能なデータソースと関数</h2><p>とはいえ、データソース側でも全ての処理を実行できるわけではございませんので、Power Apps から委任できるデータソースや処理の内容は限られています。</p><p>委任可能なデータソースは、現時点では以下のデータソースのみです。<br>それぞれ、委任可能な関数がデータソースによって異なりますので、コネクタのリファレンスをご参照ください。</p><ul><li><a href="https://docs.microsoft.com/ja-jp/connectors/commondataservice/#power-apps-delegable-functions-and-operations-for-dataverse">Microsoft Dataverse (旧名: Common Data Service)</a><br>※Dataverse では、プレビュー機能として CountRows, CountIf, First, in 演算子の委任もサポートしています。<br><img src="/blog/canvasapp/Canvas-app-delegation/img00.png"><br>(この設定は、既定でオンになっています。)</li><li><a href="https://docs.microsoft.com/ja-jp/connectors/sharepointonline/#power-apps-delegable-functions-and-operations-for-sharepoint">SharePoint</a></li><li><a href="https://docs.microsoft.com/ja-jp/connectors/sql/#power-apps-delegable-functions-and-operations-for-sql-server">SQL Server</a></li></ul><h2 id="委任できない場合どうなるの？"><a href="#委任できない場合どうなるの？" class="headerlink" title="委任できない場合どうなるの？"></a>委任できない場合どうなるの？</h2><p>委任できないデータソースや関数を使用した場合、Power Apps では、一度データソースから全てのデータをメモリ上にダウンロードします。<br>ただし、あまりにも大量のデータを取得すると、アプリのパフォーマンスに大きな影響が出るため、取得できるデータ量は限られています。</p><p>一度に取得できるデータ件数の最大は、アプリの「委任できないクエリのデータ行の制限」の設定項目から確認できます。</p><p>[ファイル] &gt; [設定] &gt; [詳細設定]<br><img src="/blog/canvasapp/Canvas-app-delegation/img01.png"></p><p>データ行の制限は、既定で 500 、最大で 2000 まで変更可能ですので、キャンバス アプリに一度で取得できるデータの最大行数は 2000 行となります。</p><p>つまり、委任できないデータソースを使用している場合、また委任できない関数や演算子を使用している場合、データソースから上位 2000 件のみを取得し、アプリ上でクエリ処理を実行することとなります。</p><p>以下の例を見てみましょう。</p><p><img src="/blog/canvasapp/Canvas-app-delegation/img02.png"></p><p>データソースには全部で 510 件のデータがあり、「委任できないクエリのデータ行の制限」は 500 に設定されています。<br>Filter 処理により、300 番目のデータと 510 番目のデータが取得されると仮定すると、</p><ul><li>委任がサポートされている場合、Power Apps では、Filter 処理の結果である 2 行のみを取得できます。</li><li>委任がサポートされていない場合、データソースの上位 500 行をアプリ上に取得してから Filter 処理が行われるため、得られる結果は 300 番目のデータのみとなり、510 番目のデータを得ることができません。</li></ul><p>※ただし、ギャラリーを使用している場合は、Items プロパティの式が委任できるように記述されていれば、スクロールに伴って随時データソースと通信し、データの取得を行う動作となるので、ご安心ください。</p><h2 id="委任可能なケースの落とし穴"><a href="#委任可能なケースの落とし穴" class="headerlink" title="委任可能なケースの落とし穴"></a>委任可能なケースの落とし穴</h2><p>「委任ができるデータソース・関数を使用しているから問題ない」と思っている方、実は、委任できるからと言って、どんなに大量のデータでも取得できるわけではないので、要注意です。</p><p>「委任できないクエリのデータ行の制限」という設定項目について説明しましたが、これは、委任ができるデータにも当てはまります。<br>つまり、Power Apps が一度に取得できるデータ行は、結局は最大で 2000 件なのです。<br>そのため、データソースにクエリを委任した結果、データ件数が 2500 件になってしまった場合、クエリ結果のうち 2000 件までしか取得できないので、残りの 500 件については置き去りにされてしまいます。</p><h3 id="では、どうすれば良いのか？？"><a href="#では、どうすれば良いのか？？" class="headerlink" title="では、どうすれば良いのか？？"></a>では、どうすれば良いのか？？</h3><p>「委任できないクエリのデータ行の制限」は、あくまでも<strong>一度に</strong>取得可能なデータ行の制限です。<br>2000 行を超えるデータを取得したい場合は、複数回に分けてデータを取得し、コレクションに追加するようにしましょう。<br>コレクションには、格納できるデータ件数に上限はございません。</p><p><img src="/blog/canvasapp/Canvas-app-delegation/img03.png"></p><h3 id="Tips-複数回に分けてデータをコレクションに取得？？"><a href="#Tips-複数回に分けてデータをコレクションに取得？？" class="headerlink" title="Tips - 複数回に分けてデータをコレクションに取得？？"></a>Tips - 複数回に分けてデータをコレクションに取得？？</h3><p>複数回に分けてデータを取得する動作は、例えば以下のような数式で実現できます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 委任可能件数以上に格納するためのコレクション</span><br><span class="line">Clear(col) </span><br><span class="line"></span><br><span class="line">// 委任制限まで件数を分割するためのコレクション (委任制限が 100 件の場合)</span><br><span class="line">// Sequence は繰り返しの件数を指定 (例では 100 件 * 10 回なので、 999 件まで対応可能)</span><br><span class="line">ClearCollect(Num, </span><br><span class="line">    AddColumns(</span><br><span class="line">        Sequence(10), </span><br><span class="line">        &quot;Min&quot;, (Value - 1) * 100, </span><br><span class="line">        &quot;Max&quot;, Value * 100</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// 複数回に分けてアイテムを取得</span><br><span class="line">ForAll(Num,</span><br><span class="line">    Collect(Col, FIlter(データソース, IDCount &lt; Max, IDCount &gt;= Min));</span><br><span class="line">)</span><br><span class="line">/*</span><br><span class="line">SharePoint の ID 列は数値だが=以外の演算子の委任をサポートしていないため、ID と同じ値を持つ IDCount 列を作成して使用。</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><p><img src="/blog/canvasapp/Canvas-app-delegation/img04.png"><br>※サンプルコードなので、動作検証はしっかりと行ってください。</p><p>ご参考まで。</p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>以上、Power Apps キャンバス アプリの委任の動作についてご説明しました。<br>公開情報を読むと、小難しい制限に思われるかもしれませんが、理解してしまえば簡単ですよね。<br>委任をしっかりと理解し、正しくキャンバス アプリを作成する手助けになりましたら幸いです。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの清水です。&lt;br&gt;今回は、Power Apps のキャンバス アプリを使用する際に引っ掛かりがちな「委任」の制限について、かみ砕いてご説明いたします。&lt;/p&gt;
&lt;p&gt;公開情報は&lt;a href=&quot;https://docs.microsoft.com/ja-jp/powerapps/maker/canvas-apps/delegation-overview&quot;&gt;こちら&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    
    <category term="CanvasApp" scheme="https://jpdynamicscrm.github.io/blog/tags/CanvasApp/"/>
    
    <category term="delegation" scheme="https://jpdynamicscrm.github.io/blog/tags/delegation/"/>
    
  </entry>
  
  <entry>
    <title>Japan Dynamics CRM &amp; Power Platform Support Blog 開設のお知らせ</title>
    <link href="https://jpdynamicscrm.github.io/blog/information/test/"/>
    <id>https://jpdynamicscrm.github.io/blog/information/test/</id>
    <published>2021-03-31T15:00:00.000Z</published>
    <updated>2021-09-24T01:06:19.568Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、日本マイクロソフト Dynamics CRM &amp; Power Platform サポート チームです。</p><p>この度、GitHub Blog にてサポートブログを開設いたしました！<br>本ブログでは、日本マイクロソフト Dynamics CRM &amp; Power Platform サポート チームに所属する社員より、皆様のお役に立てる情報の発信に努めてまいりますので、ぜひご参照いただけますと幸いです。</p><span id="more"></span><p>なお、これまで Microsoft Technet に掲載していた記事は、随時本 GitHub Blog の Archive に移行を進めてまいります。<br>製品の特性上、情報が古くなってしまった記事につきましては移行しない場合がございますため、あらかじめご了承ください。</p><p>本 Blog が、皆様のお役にたてれば幸いです。<br>今後ともよろしくお願いたします。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、日本マイクロソフト Dynamics CRM &amp;amp; Power Platform サポート チームです。&lt;/p&gt;
&lt;p&gt;この度、GitHub Blog にてサポートブログを開設いたしました！&lt;br&gt;本ブログでは、日本マイクロソフト Dynamics CRM &amp;amp; Power Platform サポート チームに所属する社員より、皆様のお役に立てる情報の発信に努めてまいりますので、ぜひご参照いただけますと幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Information" scheme="https://jpdynamicscrm.github.io/blog/tags/Information/"/>
    
  </entry>
  
</feed>
