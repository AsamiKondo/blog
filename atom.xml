<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  
  <subtitle>日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</subtitle>
  <link href="https://jpdynamicscrm.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpdynamicscrm.github.io/blog/"/>
  <updated>2023-06-06T03:44:31.256Z</updated>
  <id>https://jpdynamicscrm.github.io/blog/</id>
  
  <author>
    <name>Japan Dynamics CRM &amp; Power Platform Support Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MC454715 (Power AppsとPower Platformの管理センターで使用される新しいPower PlatformのURL)</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/MC454715/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/MC454715/</id>
    <published>2023-06-06T02:30:00.000Z</published>
    <updated>2023-06-06T03:44:31.256Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの網野です。<br>2022 年 11 月 に MC454715 にて通知された内容について、お客様への影響および対応方法についてご案内いたします。</p><span id="more"></span><h2 id="MC454715-の内容"><a href="#MC454715-の内容" class="headerlink" title="MC454715 の内容"></a>MC454715 の内容</h2><hr><h3 id="機能変更の内容"><a href="#機能変更の内容" class="headerlink" title="機能変更の内容"></a>機能変更の内容</h3><p>2022 年 11 月以降 Power Platform 管理センターや Power Apps / Power Automate ポータルにて、内部的に Power Platform API という新しいアプリの利用を順次開始しています。Power Platform API アプリへのリクエストが行われるようになりますので、Power Platform API アプリへの通信が行える状態になっている必要があります。  </p><h3 id="影響するユーザー"><a href="#影響するユーザー" class="headerlink" title="影響するユーザー"></a>影響するユーザー</h3><p>以下のいずれかに該当する場合、影響が発生する可能性があります。</p><ol><li>ファイアウォールやプロキシなどで URL を制御している場合</li><li>Azure AD の条件付きアクセスで利用可能なアプリを制御している場合</li></ol><h3 id="対応方法"><a href="#対応方法" class="headerlink" title="対応方法"></a>対応方法</h3><p>以下の対応が必要です。  </p><ol><li><p><u>許可が必要な URL の確認</u><br>  ファイアウォール等で通信を制御している場合には以下の URL への通信を許可してください。</p><ul><li>*.api.powerplatform.com</li><li>api.powerplatform.com  </li></ul><p>  また、Power Apps / Power Automate をご利用いただく場合に許可が必要な URL は以下の公開情報におまとめしています。<br>  本件の対応と合わせてすべての URL が許可されているかご確認ください。 </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-apps/limits-and-config#required-services">Power Apps 必要なサービス</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-automate/ip-address-configuration#required-services">Power Automate 必要なサービス</a>  <br></li></ul></li><li><p><u>Azure AD の条件付きアクセスの確認</u><br>  Azure AD の条件付きアクセスを利用している場合、Power Platform API アプリがブロックされていないことを確認してください。<br>  Azure AD の条件付きアクセスを利用していない場合や、Power Platform API アプリをブロックしていない場合は対応は必要ございません。  </p>  <br>  また、Azure AD の条件付きアクセスを利用している場合、Power Apps / Power Automate をご利用いただくには公開情報「 [Azure AD での条件付きアクセスを設定する](https://learn.microsoft.com/ja-jp/power-platform/guidance/adoption/conditional-access)  」に記載されているアプリがすべて許可されている必要があります。    2023/06/04 時点では以下のアプリが対象となりますので、本件の対応と合わせて対象のアプリがすべてブロックされていないことをご確認ください。  * Common Data Service  * Power Platform API  * Microsoft Power Apps  * Microsoft Flow  * Microsoft Azure Management    <br><p>  Azure AD の条件付きアクセスポリシーに Power Platform API が表示されない場合は以下の公開情報に記載の PowerShell から追加することができます。<br>  <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/programmability-authentication-v2#step-2-configure-api-permissions">ステップ 2. API アクセス許可の構成</a></p>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Install the Azure AD the module</span></span><br><span class="line"><span class="built_in">Install-Module</span> AzureAD</span><br><span class="line"> </span><br><span class="line"><span class="built_in">Connect-AzureAD</span></span><br><span class="line"><span class="built_in">New-AzureADServicePrincipal</span> <span class="literal">-AppId</span> <span class="number">8578</span>e004<span class="literal">-a5c6</span><span class="literal">-46e7</span><span class="literal">-913e</span><span class="literal">-12f58912df43</span> <span class="literal">-DisplayName</span> <span class="string">&quot;Power Platform API&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="MC454715-メッセージ全文"><a href="#MC454715-メッセージ全文" class="headerlink" title="MC454715　メッセージ全文"></a>MC454715　メッセージ全文</h3><p><img src="./mc454715/messagecenter.png"></p><h2 id="よくあるご質問"><a href="#よくあるご質問" class="headerlink" title="よくあるご質問"></a>よくあるご質問</h2><h3 id="対応しないとどうなりますか？"><a href="#対応しないとどうなりますか？" class="headerlink" title="対応しないとどうなりますか？"></a>対応しないとどうなりますか？</h3><p>必要な通信が行われませんので、使用中にエラーになるなど想定外のエラーが発生する可能性がございます。</p><h3 id="いつからこの変更が適用されますか？"><a href="#いつからこの変更が適用されますか？" class="headerlink" title="いつからこの変更が適用されますか？"></a>いつからこの変更が適用されますか？</h3><p>2022年末より変更が適用されています。<br>また、機能追加に伴い、Power Platform API アプリへの通信が順次増えていますので、現在影響がなくても今後影響する可能性がございます。</p><h3 id="Microsoft-Power-Platform-API-はいつ追加されたアプリですか？"><a href="#Microsoft-Power-Platform-API-はいつ追加されたアプリですか？" class="headerlink" title="Microsoft Power Platform API はいつ追加されたアプリですか？"></a>Microsoft Power Platform API はいつ追加されたアプリですか？</h3><p>いいえ、Microsoft Power Platform API アプリは 2022 年 3 月にプレビュー機能としてリリースされた機能です。<br>Power Platform 製品の内部で利用されるだけではなく、お客様が直接 API を呼び出すこともできます。<br>詳細につきましては、開発チームの blog および公開情報をご参照ください。</p><ul><li> <a href="https://powerapps.microsoft.com/en-us/blog/introducing-microsoft-power-platform-api-preview/">Introducing Microsoft Power Platform API (preview)</a></li><li><a href="https://learn.microsoft.com/en-us/rest/api/power-platform/">Microsoft Power Platform API reference (preview)</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの網野です。&lt;br&gt;2022 年 11 月 に MC454715 にて通知された内容について、お客様への影響および対応方法についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop のインストール後に LAN が繋がらない場合の対応方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-not-connected-to-lan/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-not-connected-to-lan/</id>
    <published>2023-06-03T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.176Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの櫻井です。<br>本記事では Power Automate for desktop のインストール後に LAN が繋がらない場合の対応方法についてご案内いたします。</p><span id="more"></span><ol><li><a href="#anchor-intro">はじめに</a></li><li><a href="#anchor-reason">原因</a> </li><li><a href="#anchor-measure">対応方法</a><ol><li><a href="#anchor-measure-wireless-lan">端末ごとの証明書フィルタリング設定 (無線 LAN の場合)</a></li><li><a href="#anchor-measure-wired-lan">端末ごとの証明書フィルタリング設定 (有線 LAN の場合)</a></li><li><a href="#anchor-measure-gpo">グループ ポリシーによる証明書フィルタリング設定</a><br><br/><br/></li></ol></li></ol><p><a id='anchor-intro'></a></p><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><hr><p>「Power Automate for desktop をインストール後、社内 LAN に繋がらなくなってしまった」<br>というお問い合わせをいただくことがございます。<br>この記事では、本事象の原因と対応方法についてご案内いたします。<br><br/><br/></p><p><a id='anchor-reason'></a></p><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><hr><p>Power Automate for desktop をインストールすると、Power Automate for desktop 用の証明書がインストールされます。<br>一方、Windows の証明書のフィルタリング機能を利用していない場合、Windows にて実装されているコンピューター証明書の自動選択基準に従い、<br>LAN 接続時の証明書が選択される動作となります。  </p><p>そのため、Power Automate for desktop のインストール後、自動選択基準で LAN 接続時の証明書が選択される際、<br>従来使用されていた LAN の証明書ではなく、Power Automate for desktop の証明書が選択される可能性があります。<br>その結果、LAN 接続時に必要な証明書が選択されず、社内 LAN に繋がらない事象が発生する可能性があります。  </p><p>証明書の自動選択基準についてはこちらの Windows サポートブログにてご説明しておりますので、ご参照いただけますと幸いです。<br><a href="https://jpwinsup.github.io/blog/2021/02/02/WirelessNetwork/Wi-Fi/Selection-criteria-for-certificates-used-for-wireless-LAN-connections/">無線 LAN 接続に利用されるコンピューター証明書の選択基準について</a><br><br/><br/></p><p><a id='anchor-measure'></a></p><h2 id="対応方法"><a href="#対応方法" class="headerlink" title="対応方法"></a>対応方法</h2><hr><p>端末ごとに証明書フィルタリング設定をすることで、ネットワークに繋がらない事象を防ぐことができます。<br>また、証明書フィルタリング設定を管理者にてグループ ポリシーとして設定できます。<br><br/></p><p><a id='anchor-measure-wireless-lan'></a></p><h3 id="1-端末ごとの証明書フィルタリング設定-無線-LAN-の場合"><a href="#1-端末ごとの証明書フィルタリング設定-無線-LAN-の場合" class="headerlink" title="1. 端末ごとの証明書フィルタリング設定 (無線 LAN の場合)"></a>1. 端末ごとの証明書フィルタリング設定 (無線 LAN の場合)</h3><p>無線 LAN 接続に利用されるフィルタリング機能の設定手順については、こちらの Windows サポートブログをご参照ください。<br><a href="https://jpwinsup.github.io/blog/2021/02/02/WirelessNetwork/Wi-Fi/Filtering-of-certificates-used-for-wireless-LAN-connections/">無線 LAN 接続に利用される証明書のフィルタリングについて</a><br><br/></p><p><a id='anchor-measure-wired-lan'></a></p><h3 id="2-端末ごとの証明書フィルタリング設定-有線-LAN-の場合"><a href="#2-端末ごとの証明書フィルタリング設定-有線-LAN-の場合" class="headerlink" title="2. 端末ごとの証明書フィルタリング設定 (有線 LAN の場合)"></a>2. 端末ごとの証明書フィルタリング設定 (有線 LAN の場合)</h3><ol><li><p> [Win] キー + [R] キー を押し、[ファイル名を指定して実行] のダイアログボックスを開きます。  </p></li><li><p><code>ncpa.cpl</code> と入力し、[Ctrl] キー + [Shift] キー + [Enter] キーを押します。<br><img src="/blog/powerautomate/power-automate-desktop-not-connected-to-lan/wired-lan-filter-setting1.png"></p></li><li><p>認証設定されている有線アダプタを右クリックして [プロパティ] をクリックします。  </p></li><li><p>[ネットワークの認証方法の選択] のコンボボックスの表示を確認して、以下の操作を行います。  </p><ul><li><p>コンボボックスの隣の [設定] をクリックします。<br><img src="/blog/powerautomate/power-automate-desktop-not-connected-to-lan/wired-lan-filter-setting2.png">  </p></li><li><p>[スマートカードまたはその他の証明書] の隣に表示されている [構成] をクリックします。<br><img src="/blog/powerautomate/power-automate-desktop-not-connected-to-lan/wired-lan-filter-setting3.png"></p></li></ul></li><li><p>以下の [詳細設定] ボタンをクリックします。<br><img src="/blog/powerautomate/power-automate-desktop-not-connected-to-lan/wired-lan-filter-setting4.png"></p></li><li><p>[証明書発行者] のチェックボックスを入れて、社内ネットワークで利用したい証明書の「ルート証明機関」のチェックを入れます。<br>(※ 以下は、社内 NW で利用する証明書のルート証明機関が “Microsoft Root Certificate Authority” の場合の設定例です。)<br><img src="/blog/powerautomate/power-automate-desktop-not-connected-to-lan/wired-lan-filter-setting5.png"></p></li><li><p>[OK] ボタンですべてのプロパティ画面を閉じます。  </p><br/></li></ol><p><a id='anchor-measure-gpo'></a></p><h3 id="3-グループ-ポリシーによる証明書フィルタリング設定"><a href="#3-グループ-ポリシーによる証明書フィルタリング設定" class="headerlink" title="3. グループ ポリシーによる証明書フィルタリング設定"></a>3. グループ ポリシーによる証明書フィルタリング設定</h3><p>グループ ポリシーにて無線 LAN / 有線 LAN プロファイルを配布されている場合、ドメイン コントローラー上の [グループポリシーの管理] 機能から設定を変更することで、管理者は証明書フィルタリング設定を一元管理できます。<br>なお、今回の設定は、Windows 8 以降で実装されたものであるため、ここでは、Windows Server 2012 以上のドメイン コントローラーを利用すると仮定します。  </p><h4 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h4><ol><li><p>グループ ポリシーの管理を開き、以下のグループ ポリシー オブジェクトを編集します。  </p><ul><li><p>無線 LAN の場合：<br>[コンピューターの構成] - [Windows の設定] - [セキュリティの設定] - [ワイヤレス ネットワーク (IEEE 802.11) ポリシー] を選択し、[&lt;ポリシー名&gt;] をダブルクリックします。  </p></li><li><p>有線 LAN の場合：<br>[コンピューターの構成] - [Windows の設定] - [セキュリティの設定] - [ ワイヤードポリシー] を選択し、[&lt;ポリシー名&gt;] をダブルクリックします。  </p></li></ul></li><li><p>[全般] タブより、該当のプロファイルを選択し、[編集] ボタンをクリックします。  </p></li><li><p>[セキュリティ] タブを選択します。ここでは、お客様が設定されている認証方式により、いずれかをご選択ください。</p><ul><li><p>[スマート カードまたはその他の証明書] が選択されている場合：<br>[プロパティ] をクリックします。  </p></li><li><p>[保護された EAP (PEAP)] が選択されている場合：<br>[プロパティ] をクリックし、次の画面で、さらに [スマート カードまたはその他の証明書] の右側の [構成] ボタンをクリックします。  </p></li></ul></li><li><p>“スマートカードまたはその他の証明書のプロパティ” が表示されますので、[詳細設定] をクリックします。  </p></li><li><p>当項目が Windows 8 以降より実装された機能となります。[証明書発行者] にチェックを入れて、証明書の発行元のルート証明書を選択ください。<br>(※ ルート証明書は、ローカル コンピューターの [信頼された証明機関] ストアを参照しておりますので、予めインストールを実施ください。)</p></li><li><p>クライアント側にて <code>gpupdate /force</code> を実施します。  </p></li></ol><p>なお、設定される項目に関しては、こちらの Windows サポートブログをご参照いただけますと幸いです。<br><a href="https://jpwinsup.github.io/blog/2021/02/02/WirelessNetwork/Wi-Fi/Filtering-of-certificates-used-for-wireless-LAN-connections/">無線 LAN 接続に利用される証明書のフィルタリングについて</a></p><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの櫻井です。&lt;br&gt;本記事では Power Automate for desktop のインストール後に LAN が繋がらない場合の対応方法についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flow/"/>
    
    <category term="Power Automate for desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-for-desktop/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse テーブルに登録されている 5,000 件を超えるデータを FetchXML クエリを使用して取得する</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/fetch-xml/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/fetch-xml/</id>
    <published>2023-05-31T00:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.136Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポート 谷です。<br/><br>この記事では Dataverse テーブルに登録されている 5,000 件を超えるデータを取得する方法について、FetchXML クエリを使用した方法をご紹介します。</p><span id="more"></span><h2 id="Dataverse-テーブルから-5-000-件を超えるデータを取得する方法"><a href="#Dataverse-テーブルから-5-000-件を超えるデータを取得する方法" class="headerlink" title="Dataverse テーブルから 5,000 件を超えるデータを取得する方法"></a>Dataverse テーブルから 5,000 件を超えるデータを取得する方法</h2><p>Power Platform の Dataverse コネクタ「行を一覧にする」アクションを使用すると、取得する列の選択や行のフィルターなどを設定することで、取得されたいデータをローコードで絞り込むことができます。<br/><br>多くの場合、この方法で Dataverse からデータを取得していると思います。<br/><br>「行を一覧にする」アクションは 1 回の実行で最大 5,000 件のデータを取得しますので、 5,000 件を超えるデータを取得したい場合は、当アクションのオプション「改ページ」を設定します。<br/><br>複雑なフローを構成することなく、5,000 件を超える 100,000件(※) までのデータをページングしながら取得することができます。<br/><br>※ 100,000 件は Power Automate クラウド フローで取得可能なページ付けされた項目数の上限です。<br><br/><br><br/><br>アクションの 3 点メニュー &gt; 設定 にて改ページの設定を行います。</p><p><img src="/blog/powerautomate/fetch-xml/image01.png"> </p><p>さて、Dataverse では FetchXML という独自の XML ベースのクエリ言語を使用することができます。<br/><br>複雑なクエリでデータを検索したり、100,000 件を超える大量のデータを取得したり、柔軟できめ細やかな条件にてデータを取得することが可能になります。</p><p>しかし、FetchXML クエリをコーディングしたり、フロー側で <code>Do until</code> アクションを使用して 5,000 件を超えるデータをページングして取得するようフローを構成する必要があります。<br/><br>FetchXML を使用した実装方法をより身近に感じていただきたく、以降では、実際に FetchXML を使用して 5,000 件を超えるデータをページングしながら取得するサンプル フローをご紹介します。</p><h2 id="FetchXML-クエリで5-000-件を超えるデータを取得するサンプル-フロー"><a href="#FetchXML-クエリで5-000-件を超えるデータを取得するサンプル-フロー" class="headerlink" title="FetchXML クエリで5,000 件を超えるデータを取得するサンプル フロー"></a>FetchXML クエリで5,000 件を超えるデータを取得するサンプル フロー</h2><p>下図はサンプル フローの完成図です。 <code>Do until</code> アクションを使用して順次、対象ページのデータを取得します。</p><p><img src="/blog/powerautomate/fetch-xml/image02.png"> </p><h3 id="0-FetchXML-クエリをビルドする"><a href="#0-FetchXML-クエリをビルドする" class="headerlink" title="0. FetchXML クエリをビルドする"></a>0. FetchXML クエリをビルドする</h3><p>FetchXML クエリの作成方法は <a href="https://learn.microsoft.com/ja-jp/power-apps/developer/data-platform/use-fetchxml-construct-query">公開情報</a> に記載があるとおり、FetchXML 言語のスキーマ定義に従います。<br/></p><p><a href="https://make.powerapps.com/">Power Apps</a> や、環境の「詳細設定」から遷移できる従来の <a href="https://learn.microsoft.com/ja-jp/power-apps/user/advanced-find">高度な検索</a> を使用すると簡単にクエリをビルドできます。</p><p>i.  Power Apps 作成者 ポータル &gt; 歯車 アイコン &gt; [詳細設定] を選択します<br><img src="/blog/powerautomate/fetch-xml/image00-01.png"> </p><p>ii. フィルター アイコンを選択します<br><img src="/blog/powerautomate/fetch-xml/image00-02.png"></p><p>iii. 条件を設定し、[Fetch XML のダウンロード] を押下します<br><img src="/blog/powerautomate/fetch-xml/image00-03.png"></p><h3 id="1-ページ番号を格納するための変数を定義する"><a href="#1-ページ番号を格納するための変数を定義する" class="headerlink" title="1. ページ番号を格納するための変数を定義する"></a>1. ページ番号を格納するための変数を定義する</h3><p>次に読み込むべき、対象ページのページ番号を識別するための変数を定義します。<br>1 ページ目からデータを取得するため初期値は <code>1</code> です。</p><p>[名前] 任意の変数名を入力ください<br>[種類] 整数<br>[値] 1    </p><p><img src="/blog/powerautomate/fetch-xml/image03.png"> </p><h3 id="2-データ件数を格納するための変数を定義する"><a href="#2-データ件数を格納するための変数を定義する" class="headerlink" title="2. データ件数を格納するための変数を定義する"></a>2. データ件数を格納するための変数を定義する</h3><p>「行を一覧にする」アクションにて取得されたデータ件数を識別するための変数を定義します。<br/><br>取得されたデータ件数が 0 件になるまで後続のループ処理で Dataverse へのアクションを実行します。</p><p>[名前] 任意の変数名を入力ください<br>[種類] 整数<br>[値] 0    </p><p><img src="/blog/powerautomate/fetch-xml/image04.png"> </p><h3 id="3-全データを取得するよう繰り返しDataverseからデータを取得する"><a href="#3-全データを取得するよう繰り返しDataverseからデータを取得する" class="headerlink" title="3. 全データを取得するよう繰り返しDataverseからデータを取得する"></a>3. 全データを取得するよう繰り返しDataverseからデータを取得する</h3><p>手順 2 で定義した、 Dataverse から取得されたデータ件数が 0 件と判定されるまでループを実行し続けます。</p><p>[左辺] 手順 2 で定義した変数<br>[条件] 次の値に等しい<br>[右辺] 0    </p><p><img src="/blog/powerautomate/fetch-xml/image05.png"> </p><h3 id="4-FetchXML-を使用して-Dataverse-からデータを取得する"><a href="#4-FetchXML-を使用して-Dataverse-からデータを取得する" class="headerlink" title="4. FetchXML を使用して Dataverse からデータを取得する"></a>4. FetchXML を使用して Dataverse からデータを取得する</h3><p>FetchXML クエリを使用して Dataverse への検索を行います。<br/><br><code>page</code> プロパティに、手順 1 で定義した変数に格納しておいたページ番号を指定して、取得対象のページのデータを取得します。<br/><br>本サンプルでは検索条件などは設定していませんが、要件に応じて柔軟にクエリをカスタマイズできます。詳細は手順 0 にてご紹介しています。</p><p>[テーブル名] 対象の Dateverse テーブルを指定ください<br>[Fetch Xml クエリ]    </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">fetch</span></span></span><br><span class="line"><span class="tag">   <span class="attr">page</span>=<span class="string">&quot;【ページ番号を定義した変数名】&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">entity</span> <span class="attr">name</span>=<span class="string">&quot;【Dataverse テーブル名】&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;【取得されたい列名】&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fetch</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>ページ番号</code>は動的コンテンツから手順 1 で定義した変数名をご指定ください</p><p><img src="/blog/powerautomate/fetch-xml/image06.png"> </p><h3 id="5-ページ番号をインクリメントする"><a href="#5-ページ番号をインクリメントする" class="headerlink" title="5. ページ番号をインクリメントする"></a>5. ページ番号をインクリメントする</h3><p>次に読み込むべきページ番号を 1 ずつ増分します。</p><p>[名前] 手順 1 で定義した変数<br>[値] 1    </p><p><img src="/blog/powerautomate/fetch-xml/image07.png"> </p><h3 id="6-データ件数を最新化する"><a href="#6-データ件数を最新化する" class="headerlink" title="6. データ件数を最新化する"></a>6. データ件数を最新化する</h3><p>今回の実行で取得されたデータ件数を格納します。<br/><br>データ件数が 0 件の場合、ループを抜け処理を終了します。</p><p>[名前] 手順 2 で定義した変数<br>[値] 式に以下の数式を設定ください。取得できたデータ件数で更新します。    </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">length(outputs(&#x27;行を一覧にする&#x27;)?[&#x27;body/value&#x27;])</span><br></pre></td></tr></table></figure><p><img src="/blog/powerautomate/fetch-xml/image08.png"> </p><p>複雑な検索条件で Dataverse から取得したデータをもとにクラウド フローを実行されたい場合のご参考になりましたら幸いです。</p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><p><a href="https://learn.microsoft.com/ja-jp/power-apps/developer/data-platform/webapi/use-fetchxml-web-api#paging-with-fetchxml">Web API で FetchXml を使用する</a></p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポート 谷です。&lt;br/&gt;&lt;br&gt;この記事では Dataverse テーブルに登録されている 5,000 件を超えるデータを取得する方法について、FetchXML クエリを使用した方法をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
  </entry>
  
  <entry>
    <title>デスクトップ フローを複製・共有する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-shared-flow/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-shared-flow/</id>
    <published>2023-05-18T09:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.180Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの林です。<br>Power Automate for desktop で作成したデスクトップ フローを複製したり、他の方にも利用していただくため共有する方法についてご案内いたします。積極的に作業の自動化を推進して、業務の効率化を図りましょう。  </p><span id="more"></span><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>作成したデスクトップ フローを複製・共有する方法として、Power Automate for desktopから実行可能な方法とPower Automateポータルから実行可能な方法があります。一覧にすると以下の通りです。  </p><table><thead><tr><th>手法</th><th align="center">複製機能</th><th align="center">共同編集機能</th><th align="center">別環境への移行可</th><th align="center">要有償ライセンス※1</th></tr></thead><tbody><tr><td><strong>Power Automate for desktopから実行可能</strong></td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center"></td></tr><tr><td>1. デスクトップ フローのコピー</td><td align="center">〇</td><td align="center"></td><td align="center"></td><td align="center"></td></tr><tr><td>2. フロー デザイナーでのコピー</td><td align="center">〇※2</td><td align="center"></td><td align="center">〇</td><td align="center"></td></tr><tr><td><strong>Power Automateポータルから実行可能</strong></td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center"></td></tr><tr><td>3. デスクトップ フローの共有</td><td align="center"></td><td align="center">〇</td><td align="center"></td><td align="center">〇</td></tr><tr><td>4. ソリューションでの移行</td><td align="center">〇※2</td><td align="center"></td><td align="center">〇</td><td align="center"></td></tr></tbody></table><p>※1 アテンド型 RPA のユーザーごとのプラン<br>※2 複製結果を所有者以外のユーザーと共有することが可能  </p><p>各手法について以降で詳細にご説明させていただきます。  </p><h2 id="1-デスクトップ-フローのコピー"><a href="#1-デスクトップ-フローのコピー" class="headerlink" title="1. デスクトップ フローのコピー"></a>1. デスクトップ フローのコピー</h2><p>Power Automate for desktopのデスクトップ フローの一覧画面から “コピーを作成する” を選択することで、簡単にデスクトップ フローを同じ環境に複製することができます。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/pad-list-copy1.png"></p><p>複製したデスクトップフローは任意の名前を付けることができます。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/pad-list-copy2.png"></p><h2 id="2-フロー-デザイナーでのコピー"><a href="#2-フロー-デザイナーでのコピー" class="headerlink" title="2. フロー デザイナーでのコピー"></a>2. フロー デザイナーでのコピー</h2><p>デスクトップ フローのフロー デザイナー（編集画面）から、フロー内のアクションをコピーすることができます。<br>コピーする方法は２つございます。いずれもコピーした内容はクリップ ボードに記録されるため、テキスト ファイルに保存し、他の方と共有することができます。また、デスクトップ フローの履歴やバックアップとしても保存することもできます。  </p><h4 id="サブフロー単位でコピーする"><a href="#サブフロー単位でコピーする" class="headerlink" title="サブフロー単位でコピーする"></a>サブフロー単位でコピーする</h4><ol><li><p>コピーしたいサブ フロー上で右クリックでメニューを開き、”コピー” を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/subflow-copy-paste1.png"></p></li><li><p>サブ フローを張り付けたいデスクトップ フローを開き、右クリックから “貼り付け” を選択します。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/subflow-copy-paste2.png"></p></li><li><p>張り付けることでサブ フロー名も含めてデスクトップ フローの内容をコピーすることができます。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/subflow-copy-paste3.png"></p></li></ol><h4 id="アクション単位でコピーする"><a href="#アクション単位でコピーする" class="headerlink" title="アクション単位でコピーする"></a>アクション単位でコピーする</h4><ol><li><p>コピーしたいアクションを選択し（複数選択可）、コピーします。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/action-copy-paste1.png"></p></li><li><p>張り付け先のデスクトップ フローを開き、張り付けたい箇所の次のアクションを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/action-copy-paste2.png"></p></li><li><p>張り付けることでアクション単位でコピーすることができます。上記2でアクションを選択しない場合、一番下にコピーしたアクションが追加されます。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/action-copy-paste3.png"></p></li></ol><h4 id="補足事項"><a href="#補足事項" class="headerlink" title="補足事項"></a>補足事項</h4><ul><li>コピー対象はデスクトップ フローのステップ情報です。そのため、入出力変数の定義やフロー内のアクションで使用していない UI 要素など一部の情報はコピーの対象外となります。  </li></ul><h2 id="3-デスクトップ-フローの共有"><a href="#3-デスクトップ-フローの共有" class="headerlink" title="3. デスクトップ フローの共有"></a>3. デスクトップ フローの共有</h2><p>Power Automate ポータルからデスクトップ フローを共有することができます。デスクトップ フローの共有となるため、デスクトップ フローを修正すると共有先全てに反映される動作となります。  </p><ol><li><p>Power Automate ポータル  &gt; マイフロー &gt;  にアクセスします。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/premium1.png"></p></li><li><p>共有したいデスクトップ フローを選択し、 “共有” を押下します。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/premium2.png"></p></li><li><p>共有したいユーザーを選択し、 “保存” を押下します。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/premium3.png"></p></li></ol><p>公開情報にも手順の記載がございますので、ご参照いただけますと幸いです。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage#share-desktop-flows">デスクトップ フローの管理 - Power Automate | Microsoft Learn</a>  </p><h4 id="補足事項-1"><a href="#補足事項-1" class="headerlink" title="補足事項"></a>補足事項</h4><ul><li><p>デスクトップ フローの共有操作をするためには有償ライセンスが必要となり、有償ライセンスがない場合は以下の画面となり操作できません。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/premium4.png"></p></li><li><p>共有時点では共有先ユーザーに有償ライセンスは不要ですが、実際にデスクトップ フローを利用する時点で必要となりますのでご注意ください。有償ライセンスがない場合、共有されたデスクトップ フローを参照することができません。<br><img src="/blog/powerautomate/power-automate-desktop-shared-flow/premium5.png"></p></li></ul><h2 id="4-ソリューションでの移行"><a href="#4-ソリューションでの移行" class="headerlink" title="4. ソリューションでの移行"></a>4. ソリューションでの移行</h2><p>ソリューションにデスクトップ フローを追加することで、ソリューション単位でエクスポート、インポートによりデスクトップ フローを別環境に移行することができます。ソリューションの概要や操作方法については以下の公開情報をご確認下さい。  </p><p><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/solutions-overview">Power Apps のソリューション - Power Apps | Microsoft Learn</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/create-solution">Power Apps でソリューションを作成する - Power Apps | Microsoft Learn</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/export-solutions">ソリューションのエクスポート - Power Apps | Microsoft Learn</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/import-update-export-solutions">ソリューションのインポート - Power Apps | Microsoft Learn</a>  </p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの林です。&lt;br&gt;Power Automate for desktop で作成したデスクトップ フローを複製したり、他の方にも利用していただくため共有する方法についてご案内いたします。積極的に作業の自動化を推進して、業務の効率化を図りましょう。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
    <category term="Desktop flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flow/"/>
    
    <category term="Power Automate for desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-for-desktop/"/>
    
  </entry>
  
  <entry>
    <title>低速フローのトラブル シューティング</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/troubleshoot-throttling-flow/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/troubleshoot-throttling-flow/</id>
    <published>2023-05-16T15:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.188Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。<br>今回は、「クラウド フローの処理がいつまで経っても終わらない」ときに試していただける改善策をご案内いたします。</p><span id="more"></span><p>時間がかかるようなアクションは使っていないはずなのに、今まではすぐに処理が完了していたのに、クラウド フローが何日経っても完了しない。</p><p>そんなときは、フローが Power Automate の制限に抵触した可能性が考えられます。フローが制限に抵触すると、そのフローは実行中でも低速の状態になります。制限を超えないような速度で実行されるようになるので、数日たってもフローが実行中…ということがよくあります。</p><p>そこで今回は、フローの低速状態を避けるための改善策をご案内いたします。</p><p>＜目次＞</p><ol><li><a href="#Power-Automate-%E3%81%AE%E5%88%B6%E9%99%90">Power Automate の制限</a><ol><li><a href="#%E3%83%95%E3%83%AD%E3%83%BC%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E8%A6%81%E6%B1%82%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%81%A6%E3%81%BF%E3%82%8B">フローのアクション要求数を数えてみる</a></li></ol></li><li><a href="#%E6%94%B9%E5%96%84%E7%AD%96">改善策</a><ol><li><a href="#%E3%83%95%E3%83%AD%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A1%8C%E5%9B%9E%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99">フローの実行回数を減らす</a></li><li><a href="#%E7%B9%B0%E3%82%8A%E8%BF%94%E3%81%97%E3%81%AE%E5%9B%9E%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99">繰り返しの回数を減らす</a><ol><li><a href="#%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC-%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E4%BD%BF%E3%81%86">フィルター クエリを使う</a></li><li><a href="#%E3%82%A2%E3%83%AC%E3%82%A4%E3%81%AE%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC%E5%87%A6%E7%90%86%E3%82%92%E4%BD%BF%E3%81%86">アレイのフィルター処理を使う</a></li><li><a href="#1-%E5%BA%A6%E3%81%AB%E7%B9%B0%E3%82%8A%E8%BF%94%E3%81%99%E5%9B%9E%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99">1 度に繰り返す回数を減らす</a></li><li><a href="#%E9%9B%86%E8%A8%88%E3%81%AB-XPath-%E3%82%92%E6%B4%BB%E7%94%A8%E3%81%99%E3%82%8B">集計に XPath を活用する</a></li></ol></li><li><a href="#CSV-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%88%A9%E7%94%A8%E3%82%92%E9%81%BF%E3%81%91%E3%82%8B">CSV ファイルの利用を避ける</a></li><li><a href="#%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E5%88%86%E5%89%B2%E3%81%99%E3%82%8B">フローを分割する</a></li><li><a href="#%E9%96%A2%E6%95%B0%E3%82%92%E6%B4%BB%E7%94%A8%E3%81%99%E3%82%8B">関数を活用する</a></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%82%92%E8%B3%BC%E5%85%A5%E3%81%99%E3%82%8B">ライセンスを購入する</a></li></ol></li><li><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</a></li></ol><h2 id="Power-Automate-の制限"><a href="#Power-Automate-の制限" class="headerlink" title="Power Automate の制限"></a>Power Automate の制限</h2><p>改善策の前に、Power Automate の制限についてご案内いたします。<br>Power Automate には、サービスを皆さまへ安定的に提供するために、様々な制限が設けられています。</p><p>参考：<a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config">制限と構成 - Power Automate | Microsoft Learn</a></p><p>特にフローの実行速度に影響を与えるのは、主に以下 3 点のスループットの制限です。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config#action-request-limits">アクション要求数の制限</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config#runtime-endpoint-request-limits">ランタイム エンドポイント要求の制限</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config#content-throughput-limits">コンテンツ スループットの制限</a></li></ul><p>これらの制限に抵触すると、フローが低速になり、かつ、フローが最後まで実行されるかどうかが保証されなくなります。そのため、制限の範囲内で Power Automate をご利用いただくことが重要です。</p><h3 id="アクション要求数の制限"><a href="#アクション要求数の制限" class="headerlink" title="アクション要求数の制限"></a>アクション要求数の制限</h3><p>中でも、抵触することが多い制限として「24 時間あたりのアクション要求数」が挙げられます。今回の記事では、この「24 時間あたりのアクション要求数」の制限と、それに抵触しないようにする改善策を重点的に解説します。</p><p>まず、2023 年 5 月時点での「24 時間あたりのアクション要求数」の制限は下記の通りです。</p><table><thead><tr><th>ライセンス</th><th>パフォーマンス プロファイル</th><th>フローごとの 24 時間あたりのアクション要求数</th></tr></thead><tbody><tr><td>Power Automate Free<br>Office 365 に含まれる使用権　など</td><td>低</td><td>10,000</td></tr><tr><td>Power Automate per user など</td><td>中</td><td>100,000</td></tr><tr><td>Power Automate per flow</td><td>高</td><td>500,000</td></tr></tbody></table><p>パフォーマンス プロファイルが「低」の場合、制限値は「10,000」です。<br>例えば、1,000 行の CSV ファイルを読み込み、Apply to each で行ごとに処理をする場合、Apply to each の内側のアクションが 10 個あるだけで、実行されるアクション要求数が 10,000 を超えてしまいます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>環境の従量課金を有効にすると、アクション要求数 (Power Platform 要求数) の制限が無くなります。詳細は、下記公開情報の Power Platform 要求メーター をご参照ください。</p><p>※ 2023 年 5 月現在、プレビューの機能です。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/pay-as-you-go-overview">従量課金制プランの概要 - Power Platform | Microsoft Learn</a></p></div><div class="alert is-info"><p class="alert-title">Note</p><p>今後、アクション要求数の制限は「Power Platform 要求数の制限」になり、制限の集計単位が <strong>ユーザーごと</strong> へ移行する予定です。2023 年 5 月現在、移行時期は未定ですが、移行の予定があることをご留意ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/api-request-limits-allocations">要求の制限と割り当て - Power Platform | Microsoft Learn</a></p></div><h3 id="フローのアクション要求数を数えてみる"><a href="#フローのアクション要求数を数えてみる" class="headerlink" title="フローのアクション要求数を数えてみる"></a>フローのアクション要求数を数えてみる</h3><p>「アクション要求数」は、大まかに言うと「実行されたアクションの数」です。実行したフローのアクション要求数は、フローごとの分析のページ、または Power Platform 管理センターで確認できます。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/types#as-a-maker-what-tools-do-i-have-to-analyze-my-usage">作成者が使用状況を分析するためのどんなツールがありますか?</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/types#as-an-admin-what-tools-do-i-have-to-analyze-my-environments-usage">管理者が環境の使用状況を分析するためのどのようなツールがありますか?</a></li></ul><p>※ フローの分析のページの例 (上記公開情報より)<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image15.png"></p><p>フローをまだ実行していない、または机上でアクション要求数を求めたい場合は、下記公開情報の Power Platform 要求数の数え方をご参照ください。(アクション要求数と Power Platform 要求数は数え方が同じです)  </p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/types#what-counts-as-power-platform-request">何が Power Platform 要求と見なされますか?</a></p><p>実際のアクション要求数は再試行やページングで増えるので、見積もりの時点でフローの制限値を超えている場合は、対策が必要です。</p><h2 id="改善策"><a href="#改善策" class="headerlink" title="改善策"></a>改善策</h2><h3 id="フローの実行回数を減らす"><a href="#フローの実行回数を減らす" class="headerlink" title="フローの実行回数を減らす"></a>フローの実行回数を減らす</h3><p>例えば、1 時間に 1 回起動するスケジュールトリガーを、2 時間に 1 回起動するよう変更します。1 番簡単に実施できて最も効果がありますので、実行頻度の削減はぜひご検討ください。</p><p>自動トリガーの場合は、トリガー条件を設定して不要な起動を抑えることで、フローの実行回数を減らせます。<br>フローの先頭で、「条件」や「終了」アクションを使ってフローを中断させている場合は、トリガー条件への置き換えをご検討ください。<br>トリガー条件の詳しい情報は、当サポート チームのブログでもご案内しています。</p><p><a href="/blog/powerautomate/cloudflow-trigger-condition/">クラウド フローのトリガー条件を設定してトリガーの実行を制御する方法 | Japan Dynamics CRM &amp; Power Platform Support Blog</a></p><h3 id="繰り返しの回数を減らす"><a href="#繰り返しの回数を減らす" class="headerlink" title="繰り返しの回数を減らす"></a>繰り返しの回数を減らす</h3><p>Apply to each や Do until で処理するデータが数百件、数千件に及ぶ場合は、その繰り返し回数を減らすことをご検討ください。以下に、繰り返し回数を減らすための案をご紹介します。</p><h4 id="フィルター-クエリを使う"><a href="#フィルター-クエリを使う" class="headerlink" title="フィルター クエリを使う"></a>フィルター クエリを使う</h4><p>繰り返しを行う前に対象のデータ件数を減らしておけば、繰り返しの回数を減らせます。<br>SharePoint コネクタの「複数の項目の取得」アクションなど、フィルター クエリを指定できるアクションでは、できる限りフィルター クエリを使用して不要なデータを取得しないようにしましょう。</p><p>※ フィルター クエリを使った例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image06.png"></p><p>参考：</p><ul><li>SharePoint<ul><li><a href="https://learn.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/working-with-get-items-and-get-files#filter-queries">フィルター クエリの例</a></li><li><a href="https://learn.microsoft.com/ja-jp/sharepoint/dev/sp-add-ins/use-odata-query-operations-in-sharepoint-rest-requests#odata-query-operators-supported-in-the-sharepoint-rest-service">SharePoint REST サービスでサポートされる OData クエリ演算子</a></li></ul></li><li>Excel<ul><li><a href="https://learn.microsoft.com/ja-jp/connectors/excelonlinebusiness/#known-issues-and-limitations-with-actions">Excel Online (Business) コネクタ アクションの既知の問題と制限</a><ul><li>「フィルタリング機能」の行に、サポートされる OData クエリの記載があります。</li></ul></li></ul></li><li>Dataverse<ul><li><a href="https://learn.microsoft.com/ja-jp/power-automate/dataverse/list-rows#filter-rows">行を一覧にする アクションの使用例</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/developer/data-platform/webapi/query-data-web-api#%E7%B5%90%E6%9E%9C%E3%81%AE%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC">Web API の観点での OData クエリの例</a></li></ul></li></ul><h4 id="アレイのフィルター処理を使う"><a href="#アレイのフィルター処理を使う" class="headerlink" title="アレイのフィルター処理を使う"></a>アレイのフィルター処理を使う</h4><p>フィルター クエリを使えない場合は、代わりに「データ操作」コネクタの「アレイのフィルター処理」アクションを使って、繰り返しを行う前にデータ件数を減らすことができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>繰り返しで実行されるアクション要求数の削減には役に立ちますが、データ件数や列数が多い場合は、コンテンツ スループットの制限に抵触してしまう可能性があります。</p></div><p>※ アレイのフィルター処理を使った例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image08.png"></p><p>「アレイのフィルター処理」アクションは、この他にも、処理が異なるリストをあらかじめ 2 つに分けておく、といった活用もできます。繰り返し処理内の「条件」アクションが必要なくなるので、アクション要求数の削減になります。</p><p>※ 処理が異なるリストを分けておく例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image09.png"></p><p>参考：<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-filter-array-action">Power Automate でデータ操作を使用する (ビデオを含む) - Power Automate | Microsoft Learn</a></p><h4 id="1-度に繰り返す回数を減らす"><a href="#1-度に繰り返す回数を減らす" class="headerlink" title="1 度に繰り返す回数を減らす"></a>1 度に繰り返す回数を減らす</h4><p>例えば、1 度に全件処理するのではなく、10 件の データを 1 時間に 1 回処理するよう設計します。</p><p>フローが制限に抵触しないよう、意図的に処理をゆっくりにする考え方です。フィルター クエリと合わせて使用し、未処理のデータだけを取得する必要があります。</p><p>※ 10 件だけ処理する例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image10.png"></p><h4 id="集計に-XPath-を活用する"><a href="#集計に-XPath-を活用する" class="headerlink" title="集計に XPath を活用する"></a>集計に XPath を活用する</h4><p>例えば SharePoint リストの特定の列の合計を求めたい場合、Power Automate には配列を 1 度に集計するようなアクションや関数が無いため、繰り返し処理で集計する必要があります。しかし、Power Automate の関数、xml と xpath を活用すると繰り返し処理無しで集計ができます。つまりアクション要求数の削減になります。<br>詳しい実現方法は以下の記事で解説しています。</p><p><a href="/blog/powerautomate/aggregation-using-xpath/">XPath を活用した集計 | Japan Dynamics CRM &amp; Power Platform Support Blog</a></p><h3 id="CSV-ファイルの利用を避ける"><a href="#CSV-ファイルの利用を避ける" class="headerlink" title="CSV ファイルの利用を避ける"></a>CSV ファイルの利用を避ける</h3><p>アクション要求数を削減する観点では、フローでの CSV ファイルの読み込みは避けることをお勧めします。Power Automate には CSV ファイルを 1 つのアクションで読み込むような機能はご用意がありません。そのため、CSV ファイルを読み込む処理を作りこむ必要があります。</p><p>参考：<a href="/blog/powerautomate/Import-Csv-With-Standard-Connectors/">Power Automate で CSV ファイルを取り込む | Japan Dynamics CRM &amp; Power Platform Support Blog</a></p><p>上記記事の例からも分かる通り、変数を用意して…条件分岐して…とやっているだけでアクション要求数を消費してしまいます。</p><p>アクション要求数を削減したい場合は、SharePoint リスト、Dataverse をはじめとしたデータベース、または、Excel ファイルなどの利用をお勧めします。これらは、各コネクタにデータ読み込みのためのアクションが用意されているため、読み込み処理を自分で作る必要がありません。</p><p>活用できるアクション：</p><ul><li>Microsoft Dataverse コネクタ<ul><li><a href="https://learn.microsoft.com/ja-jp/connectors/commondataserviceforapps/#%E8%A1%8C%E3%82%92%E4%B8%80%E8%A6%A7%E3%81%AB%E3%81%99%E3%82%8B">行を一覧にする</a></li></ul></li><li>SharePoint コネクタ<ul><li><a href="https://learn.microsoft.com/ja-jp/connectors/sharepointonline/#%E9%A0%85%E7%9B%AE%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">複数の項目の取得</a></li></ul></li><li>Excel Online (Business) コネクタ<ul><li><a href="https://learn.microsoft.com/ja-jp/connectors/excelonlinebusiness/#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%86%85%E3%81%AB%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8B%E8%A1%8C%E3%82%92%E4%B8%80%E8%A6%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B">表内に存在する行を一覧表示</a></li></ul></li></ul><h3 id="フローを分割する"><a href="#フローを分割する" class="headerlink" title="フローを分割する"></a>フローを分割する</h3><p>2023 年 5 月時点の Power Automate の制限は、<strong>フローごと</strong>の制限となっています。1 つの長いフローが制限に抵触しているのであれば、それをいくつかに分割して順番に実行させることで制限を回避できる可能性があります。</p><p>※ イメージ図<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image11.png"></p><p>注意点としては、非ソリューションフローの場合は子フローの実行などができないため、それぞれのフローの最後で、次のフローの起動トリガーとなるような処理をしてあげる必要があります。<br>例えば、1番目のフローの最後に SharePoint リストへの「項目の作成」アクションを実行し、2番目のフローの「項目が作成されたとき」トリガーでその SharePoint リストを指定すれば、フローをつなげて実行する仕組みになります。</p><h3 id="関数を活用する"><a href="#関数を活用する" class="headerlink" title="関数を活用する"></a>関数を活用する</h3><p>アクションを組み合わせて作った処理が、実は関数 1 つで実現できるものだったりすることがあります。<br>Power Automate には式の入力時に使用できる関数が色々ありますので、関数の一覧のページに目を通しておくだけでも、新しい発見があるかもしれません。</p><p><a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference">式関数のリファレンス ガイド - Azure Logic Apps | Microsoft Learn</a></p><p>意外と活用できる関数の例に、<a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#join">join</a> 関数があります。配列の全ての要素をくっつけて 1 つの文字列にする関数です。例えば、SharePoint リストに保存されているメールアドレスにメールを送りたいとき、行ごとのメールアドレスをセミコロンでくっつけて送信先アドレスとしたくなります。</p><p>※ イメージ図<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image12.png"></p><p>join 関数を使わなくても、Apply to each と「文字列変数に追加」アクションを使えばやりたいことは実現できます。しかし、これまでに解説したように、繰り返しの処理はアクション要求数が多くなりがちなので避けたいところです。</p><p>※ join 関数を使わない例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image13.png"></p><p>そこで、join 関数を使うと、2 つのアクションのみでメールアドレスをセミコロンでくっつけることができます。join 関数を使う前に「選択」アクションを使う必要がありますが、メールアドレスを 1 つずつ繋げるよりは手順が減ります。</p><p>※ join 関数を使う例<br><img src="/blog/powerautomate/troubleshoot-throttling-flow/image14.png"></p><p>このように、関数を使いこなせると、より効率のよいフローの作り方ができますし、それがアクション要求数を減らすことに繋がることがあります。</p><h3 id="ライセンスを購入する"><a href="#ライセンスを購入する" class="headerlink" title="ライセンスを購入する"></a>ライセンスを購入する</h3><p>最初にご案内したように、制限値はパフォーマンス プロファイルによって決まり、パフォーマンス プロファイルはライセンスによって決まります。<br>もしパフォーマンス プロファイル「低」で制限に抵触しているのであれば、パフォーマンスプロファイル「中」や「高」に該当するライセンスの利用をご検討ください。</p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>制限に抵触するほど Power Automate を活用いただいているのは嬉しい限りではありますが、サービスの特性を理解して上手く付き合っていただけますと、より嬉しく思います。<br>この記事が皆様の Power Automate の運用にお役に立ちましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;br&gt;今回は、「クラウド フローの処理がいつまで経っても終わらない」ときに試していただける改善策をご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
  </entry>
  
  <entry>
    <title>XPath を活用した集計</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/aggregation-using-xpath/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/aggregation-using-xpath/</id>
    <published>2023-05-15T15:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.124Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。<br>今回は、クラウド フローで、なるべく少ない手順で集計をしたいときに活用いただける Tips をご紹介いたします。</p><span id="more"></span><h2 id="基本的な集計方法"><a href="#基本的な集計方法" class="headerlink" title="基本的な集計方法"></a>基本的な集計方法</h2><p>例えば、下図のような数値の列を持つ SharePoint リストがあるとします。<br><img src="/blog/powerautomate/aggregation-using-xpath/image01.png"></p><p>この amount1、amount2 の列の合計を求めたい場合、素直に考えると Apply to each で数を集計することを考えます。</p><p>※ Apply to each を使った集計の例<br><img src="/blog/powerautomate/aggregation-using-xpath/image02.png"></p><p>合計値を求めるならこれでも良いのですが、この方法では、集計するだけで少なくとも リストの行数 × 集計したい列の数 の回数アクションが実行されます。データ件数が多いときや、他にもフローで行いたい処理があるときは、アクション要求数が気になってしまいます。</p><h2 id="XPath-を使った集計方法"><a href="#XPath-を使った集計方法" class="headerlink" title="XPath を使った集計方法"></a>XPath を使った集計方法</h2><p>XPath は、XML という形式のデータの位置を指定できる言語です。関数も用意されていて、集計 (sum) や個数のカウント (count) ができます。</p><p>Power Automate 上のデータは基本的に JSON 形式で扱われます。ですが、Power Automate には、JSON 形式を XML 形式へ変換する関数と、XPath の処理を行える関数がありますので、それらを使って集計を求められます。</p><p>以下に、XML と XPath を使って、先ほどの SharePoint リストを集計するサンプルを記載いたします。Apply to each を使用していない点にご注目ください。</p><h3 id="フローの例"><a href="#フローの例" class="headerlink" title="フローの例"></a>フローの例</h3><p>※フロー全体図<br><img src="/blog/powerautomate/aggregation-using-xpath/image03.png"></p><h4 id="1-複数の項目の取得"><a href="#1-複数の項目の取得" class="headerlink" title="(1) 複数の項目の取得"></a>(1) 複数の項目の取得</h4><p><img src="/blog/powerautomate/aggregation-using-xpath/image04.png"></p><p>SharePoint コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/sharepointonline/#%E9%A0%85%E7%9B%AE%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">複数の項目の取得</a>」アクションを使用し、リストを取得します。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>サイトのアドレス</td><td>リストがあるサイトを選択します。</td></tr><tr><td>リスト名</td><td>リストの名前を選択します。</td></tr></tbody></table><h4 id="2-選択"><a href="#2-選択" class="headerlink" title="(2) 選択"></a>(2) 選択</h4><p><img src="/blog/powerautomate/aggregation-using-xpath/image05.png"></p><p>データ操作コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-select-action">選択</a>」アクションを使用し、集計に必要な列のみの配列を作成します。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>開始</td><td>「(1) 複数の項目の取得」アクションの出力「value」</td></tr><tr><td>マップ</td><td>集計に必要な列の列名と値を指定します。</td></tr></tbody></table><p>この例では amount1 列と amount2 列を集計したいので、その2つを指定します。</p><table><thead><tr><th>マップ-キー</th><th>マップ-値</th></tr></thead><tbody><tr><td>amount1</td><td>「(1) 複数の項目の取得」アクションの出力「amount1」</td></tr><tr><td>amount2</td><td>「(1) 複数の項目の取得」アクションの出力「amount2」</td></tr></tbody></table><h4 id="3-作成1"><a href="#3-作成1" class="headerlink" title="(3) 作成1"></a>(3) 作成1</h4><p><img src="/blog/powerautomate/aggregation-using-xpath/image06.png"></p><p>データ操作コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、配列をXML へ変換できる形へ整形します。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td><code>&#123;&quot;root&quot;: &#123;&quot;numbers&quot;:「(2) 選択」アクションの出力  &#125;&#125;</code></td></tr></tbody></table><p>XML はルート要素が 1 つという決まりがあるため、JSON のルートプロパティも 1 つにします。そして、ルート要素を配列にすることもできないため、もう 1 つ <code>numbers</code> というプロパティを加え、<code>numbers</code> を配列にします。</p><p>良い例：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;root&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;numbers&quot;</span>: [</span><br><span class="line">       &#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">1</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">2</span> &#125;</span><br><span class="line">      ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">3</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">4</span> &#125;</span><br><span class="line">      ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">5</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">6</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上記の XML 変換後：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">numbers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount1</span>&gt;</span>1<span class="tag">&lt;/<span class="name">amount1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount2</span>&gt;</span>2<span class="tag">&lt;/<span class="name">amount2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">numbers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">numbers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount1</span>&gt;</span>3<span class="tag">&lt;/<span class="name">amount1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount2</span>&gt;</span>4<span class="tag">&lt;/<span class="name">amount2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">numbers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">numbers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount1</span>&gt;</span>5<span class="tag">&lt;/<span class="name">amount1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">amount2</span>&gt;</span>6<span class="tag">&lt;/<span class="name">amount2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">numbers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p>エラーになる例 1：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;root&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;numbers&quot;</span>: [</span><br><span class="line">       &#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">1</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">2</span> &#125;</span><br><span class="line">      ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">3</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">4</span> &#125;</span><br><span class="line">      ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">5</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">6</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">  ,<span class="attr">&quot;root2&quot;</span>: &#123; <span class="comment">// ルート要素が2つになってしまうので NG</span></span><br><span class="line">    <span class="attr">&quot;numbers&quot;</span> : []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>エラーになる例 2：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;root&quot;</span>: [ <span class="comment">// ルート要素は配列にできないので NG</span></span><br><span class="line">     &#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">1</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">2</span> &#125;</span><br><span class="line">    ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">3</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">4</span> &#125;</span><br><span class="line">    ,&#123; <span class="attr">&quot;amount1&quot;</span>: <span class="number">5</span>, <span class="attr">&quot;amount2&quot;</span>: <span class="number">6</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-作成2"><a href="#4-作成2" class="headerlink" title="(4) 作成2"></a>(4) 作成2</h4><p>データ操作コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、先のアクションの出力を XML へ変換します。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td>以下を式として入力：<br><code>xml(outputs(&#39;作成1&#39;))</code>　※1</td></tr></tbody></table><p>※1 「作成1」は「(3) 作成1」アクションのアクション名です。</p><p>参考 (xml 関数)：<a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#xml">https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#xml</a></p><h4 id="5-作成-amount1"><a href="#5-作成-amount1" class="headerlink" title="(5) 作成-amount1"></a>(5) 作成-amount1</h4><p>データ操作コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、XML へ変換した内容と XPath を使用して amount1 列の集計を求めます。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td>以下を式として入力：<br><code>xpath(outputs(&#39;作成2&#39;), &#39;sum(/root/numbers/amount1)&#39;)</code>　※1</td></tr></tbody></table><p>※1 「作成2」は「(4) 作成2」アクションのアクション名です。</p><p>参考 (xpath 関数)：<a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#xpath">https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#xpath</a></p><h4 id="6-作成-amount2"><a href="#6-作成-amount2" class="headerlink" title="(6) 作成-amount2"></a>(6) 作成-amount2</h4><p>データ操作コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、amount1 と同じく amount2 の集計を求めます。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td>以下を式として入力：<br><code>xpath(outputs(&#39;作成2&#39;), &#39;sum(/root/numbers/amount2)&#39;)</code>　※1</td></tr></tbody></table><p>※1 「作成2」は「(4) 作成2」アクションのアクション名です。</p><p>実行結果：</p><p><img src="/blog/powerautomate/aggregation-using-xpath/image07.png"></p><p>amout1 と amount2 の集計を求められました。</p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>ローコード ツールである Power Automate はできることが少ないと思いがちですが、やりたいことを意外な方法で解決できることもあります。ぜひご活用ください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;br&gt;今回は、クラウド フローで、なるべく少ない手順で集計をしたいときに活用いただける Tips をご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
  </entry>
  
  <entry>
    <title>クラウド フローとオンプレミス環境間でデータ連携する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/gateway-install/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/gateway-install/</id>
    <published>2023-05-08T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.140Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの林です。<br>本記事では クラウド フローとオンプレミス環境間でデータ連携する方法と、一例としてローカル ファイルをクラウド フローで扱う方法についてもご紹介します。  </p><span id="more"></span><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>クラウド フローはクラウド サービスの自動化を実現するイメージをお持ちの方が多いのですが、オンプレミス環境と通信することもできます。クラウド フローとの通信を実現するには、オンプレミス環境のローカル マシンにオンプレミス データ ゲートウェイ (以下、ゲートウェイ) をインストールします。</p><p>これによりローカル ファイルが格納されたことをトリガーにクラウド フローを実行することや、クラウド フローで扱ったファイルをローカル マシンに保存することができます。その他、ローカル マシンから接続できるデータソース (SQL Server や Oracleなど) のデータ操作もできるようになります。  </p><p>今回はローカル マシンにファイルが格納されたことをトリガーにクラウド フローで SharePoint のドキュメント ライブラリにファイルを格納する方法をご紹介させていただきます。  </p><ol><li><a href="#install">ゲートウェイのインストール方法</a>  </li><li><a href="#filesystem">利用例) ファイルシステムコネクタを利用したフローの構築</a>  </li><li><a href="#trouble-shooting">よくあるトラブル</a>  </li><li><a href="#faq">FAQ</a>  </li></ol><hr><p><a id='install'></a></p><h2 id="ゲートウェイのインストール方法"><a href="#ゲートウェイのインストール方法" class="headerlink" title="ゲートウェイのインストール方法"></a>ゲートウェイのインストール方法</h2><h3 id="1-前提"><a href="#1-前提" class="headerlink" title="1. 前提"></a>1. 前提</h3><ol><li><p>要件<br>Windows 8 以降、Windows Server 2012 R2 以降の端末にインストールできます。詳細は以下の公開情報をご確認いただき、要件を満たしているかご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-install#requirements">オンプレミス データ ゲートウェイをインストールする | Microsoft Learn</a>   </p></li><li><p>必要なエンド ポイント<br>ゲートウェイは送信ポートのみを利用してクラウドサービスと通信します。<br>以下の公開情報をご確認いただき、送信ポートから全てのエンド ポイントに接続できる状態となっているかご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication#ports">オンプレミス データ ゲートウェイの通信設定を調整する | Microsoft Learn</a>  </p></li><li><p>有償ライセンス<br>ゲートウェイのインストール自体にライセンス要件はありません。ただし、ゲートウェイを Power Automate、Power Apps で利用するには、Microsoft 365 のライセンスでは利用できず、Power Platform の有償ライセンスが必要となります。<br>有償ライセンスについては以下をご確認ください。<br>・<a href="https://powerautomate.microsoft.com/ja-jp/pricing/">Power Automate の有償ライセンス</a><br>・<a href="https://powerapps.microsoft.com/ja-jp/pricing/">Power Apps の有償ライセンス</a>  </p></li></ol><h3 id="2-ゲートウェイをインストールする"><a href="#2-ゲートウェイをインストールする" class="headerlink" title="2. ゲートウェイをインストールする"></a>2. ゲートウェイをインストールする</h3><p>ゲートウェイをダウンロードしインストールします。手順については、以下の公開情報をご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-install#download-and-install-a-standard-gateway">オンプレミス データ ゲートウェイをインストールする | Microsoft Learn</a>  </p><h5 id="補足事項"><a href="#補足事項" class="headerlink" title="補足事項"></a>補足事項</h5><ul><li><p>設定時にメール アドレスを入力しますが、入力したアドレスのユーザーが管理者となります。管理者はゲートウェイの利用者の追加、複数のゲートウェイをクラスター化する権限を有します。<br><img src="/blog/powerautomate/gateway-install/address.png">  </p></li><li><p>ゲートウェイの登録情報はクラウド上に記録されます。テナントが日本の場合、登録先リージョン(以下、赤枠) が Japan East と表示されているかご確認ください。仮に、Power Platform のリージョンと異なっている場合、ゲートウェイが認識されず利用できないため、ご注意ください。<br><img src="/blog/powerautomate/gateway-install/region.png">  </p></li></ul><h3 id="3-プロキシ設定をする"><a href="#3-プロキシ設定をする" class="headerlink" title="3. プロキシ設定をする"></a>3. プロキシ設定をする</h3><p>プロキシ サーバー経由でネットワーク通信をする必要がある場合、インストールされた設定ファイルを修正します。修正対象、修正内容は以下の公開情報をご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-proxy">オンプレミス データ ゲートウェイのプロキシ設定を構成する | Microsoft Learn</a></p><hr><p><a id='filesystem'></a></p><h2 id="利用例-ファイルシステムコネクタを利用したフローの構築"><a href="#利用例-ファイルシステムコネクタを利用したフローの構築" class="headerlink" title="利用例) ファイルシステムコネクタを利用したフローの構築"></a>利用例) ファイルシステムコネクタを利用したフローの構築</h2><p>サンプルとして、以下のフォルダに追加されたファイルを SharePoint のドキュメント ライブラリに格納します。<br><img src="/blog/powerautomate/gateway-install/folder.png">  </p><h3 id="1-ファイルシステムコネクタの接続作成"><a href="#1-ファイルシステムコネクタの接続作成" class="headerlink" title="1. ファイルシステムコネクタの接続作成"></a>1. ファイルシステムコネクタの接続作成</h3><p>Power Automate ポータルの接続メニューからファイル システム コネクタの接続を作成します。<br><img src="/blog/powerautomate/gateway-install/connection.png">  </p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>Root folder</td><td>連携したいファイルの親フォルダを指定します。アクションにてサブフォルダを指定することができます。</td></tr><tr><td>Authentication Type</td><td>Windows 固定</td></tr><tr><td>Username</td><td>Windowsにログインする際のドメイン名とユーザー名を「ドメイン名\ユーザー名」の形式でご指定ください。<br>端末にログオンしているユーザーのドメインとユーザーの名は whoami コマンドから確認いただけます。<br>※ Power Automate のログインアカウントではございませんので、ご注意ください。<br>※ ドメイン名とユーザー名の間は \ (バックスラッシュ)です。/ (スラッシュ) ではない点ご注意ください。</td></tr><tr><td>Password</td><td>上記で指定したユーザーのパスワードをご指定ください。</td></tr><tr><td>ゲートウェイの選択</td><td>インストールしたゲートウェイを選択ください。</td></tr></tbody></table><h3 id="2-クラウド-フローの作成"><a href="#2-クラウド-フローの作成" class="headerlink" title="2. クラウド フローの作成"></a>2. クラウド フローの作成</h3><h5 id="全体図"><a href="#全体図" class="headerlink" title="全体図"></a>全体図</h5><p>クラウド フローの全体図です。<br><img src="/blog/powerautomate/gateway-install/overview.png">  </p><h4 id="1-ファイルが作成されたことをトリガーに起動"><a href="#1-ファイルが作成されたことをトリガーに起動" class="headerlink" title="(1) ファイルが作成されたことをトリガーに起動"></a>(1) ファイルが作成されたことをトリガーに起動</h4><p>ファイル システム コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/filesystem/#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E4%BD%9C%E6%88%90%E3%81%95%E3%82%8C%E3%81%9F%E3%81%A8%E3%81%8D-(%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E3%81%BF)">ファイルが作成されたとき (プロパティのみ)</a>」トリガーを使用します。<br><img src="/blog/powerautomate/gateway-install/trigger.png">  </p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>フォルダー</td><td>接続で指定した Root folder 配下のトリガー対象のフォルダを指定します。<br>対象フォルダのサブフォルダ内にファイルが追加された場合はトリガーしないので注意してください。</td></tr></tbody></table><h4 id="2-ファイルコンテンツの取得"><a href="#2-ファイルコンテンツの取得" class="headerlink" title="(2) ファイルコンテンツの取得"></a>(2) ファイルコンテンツの取得</h4><p>ファイル システム コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/filesystem/#%E3%83%91%E3%82%B9%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB-%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%82%92%E5%8F%96%E5%BE%97">パスを使用してファイル コンテンツを取得</a>」アクションを使用します。<br><img src="/blog/powerautomate/gateway-install/filecontents.png"></p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>ファイルパス</td><td>追加したファイルのファイル コンテンツを取得します。ファイル パスにはトリガーで取得した “Path” を指定します。</td></tr></tbody></table><h4 id="3-SharePoint-のドキュメント-ライブラリにファイルを格納"><a href="#3-SharePoint-のドキュメント-ライブラリにファイルを格納" class="headerlink" title="(3) SharePoint のドキュメント ライブラリにファイルを格納"></a>(3) SharePoint のドキュメント ライブラリにファイルを格納</h4><p>SharePoint コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/sharepointonline/#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90">ファイルの作成</a>」アクションを使用します。<br><img src="/blog/powerautomate/gateway-install/filecreate.png"></p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>サイトのアドレス</td><td>任意のサイトを指定してください。</td></tr><tr><td>フォルダーのパス</td><td>格納先のパスを指定してください。</td></tr><tr><td>ファイル名</td><td>トリガーで取得した “Name” を指定します。</td></tr><tr><td>ファイル コンテンツ</td><td>「パスによるファイル コンテンツ」で取得した”ファイル コンテンツ”を指定します。</td></tr></tbody></table><p>フローの各アクションの設定は以上です。  </p><hr><p><a id='trouble-shooting'></a></p><h2 id="よくあるトラブル"><a href="#よくあるトラブル" class="headerlink" title="よくあるトラブル"></a>よくあるトラブル</h2><h3 id="Q-ゲートウェイがオフラインのままで利用できない"><a href="#Q-ゲートウェイがオフラインのままで利用できない" class="headerlink" title="Q. ゲートウェイがオフラインのままで利用できない"></a>Q. ゲートウェイがオフラインのままで利用できない</h3><p>ゲートウェイがオフラインとなる原因はいくつかあります。よくある原因としては、以下の通りです。また最新バージョンのご利用や、再インストールを実施いただくことでも解消することがございますので、ぜひお試しください。  </p><ol><li><p>ネットワーク要件を満たしていない<br>以下の公開情報をご確認いただき、送信ポートから全てのエンドポイントに接続できる状態となっているかご確認ください。その際、マシンからのネットワークとして、プロキシ サーバーをご利用の場合はプロキシ サーバーにて通信可能となっているかも併せてご確認下さい。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication#ports">オンプレミス データ ゲートウェイの通信設定を調整する | Microsoft Learn</a>  </p></li><li><p>プロキシの設定がされていない<br>プロキシ サーバー経由でネットワーク通信をする必要がある場合、インストールされた設定ファイルを修正します。修正対象、修正内容は以下の公開情報をご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-proxy">オンプレミス データ ゲートウェイのプロキシ設定を構成する | Microsoft Learn</a>  </p></li><li><p>ゲートウェイのサービスが起動していない<br>以下の On-premises data gateway service サービスが起動しているかご確認いただき、起動していない場合は起動します。<br><img src="/blog/powerautomate/gateway-install/service.png">  </p></li></ol><h3 id="Q-ゲートウェイをインストールしたにもかかわらず、接続作成時に表示されない"><a href="#Q-ゲートウェイをインストールしたにもかかわらず、接続作成時に表示されない" class="headerlink" title="Q. ゲートウェイをインストールしたにもかかわらず、接続作成時に表示されない"></a>Q. ゲートウェイをインストールしたにもかかわらず、接続作成時に表示されない</h3><ol><li><p>ゲートウェイの登録先リージョンが異なっている<br>ゲートウェイはインストールすることでクラウド側に登録されますが、Power Platform のリージョンと同じリージョンに存在していないと表示されません。リージョンの確認方法と対応方法については以下の公開情報をご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/troubleshoot/power-platform/power-automate/check-if-gateway-is-the-right-region">ゲートウェイが適切なリージョンにあるかどうかを確認する - Power Automate | Microsoft Learn</a>  </p></li><li><p>ゲートウェイが共有されていない<br>ゲートウェイは管理者以外でも共有することでご利用できます。ゲートウェイの共有は Power Platform 管理センターから実施可能です。ゲートウェイの共有方法は以下の公開情報をご確認下さい。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/onpremises-data-gateway-management#manage-users">オンプレミスのデータ ゲートウェイの表示と管理 (プレビュー) - Power Platform | Microsoft Learn</a><br><br>現在、ユーザーへの共有時に指定できるカテゴリは以下の通りです。 </p></li></ol><table><thead><tr><th>カテゴリ</th><th>説明</th></tr></thead><tbody><tr><td>接続作成機能</td><td>データ ソースの接続作成時に当該ゲートウェイを指定することができます。</td></tr><tr><td>再共有による接続作成機能</td><td>接続作成機能に加え、ゲートウェイを共有することができます。</td></tr><tr><td>管理者</td><td>ゲートウェイの作成、削除、利用を含めたフルコントロール権限を有することができます。カスタムコネクタをゲートウェイ経由でご利用する場合は、管理者のカテゴリを指定して共有する必要があるのでご注意ください。</td></tr></tbody></table><h3 id="Q-ゲートウェイでデータ-ソース間の通信が失敗する様になった"><a href="#Q-ゲートウェイでデータ-ソース間の通信が失敗する様になった" class="headerlink" title="Q. ゲートウェイでデータ ソース間の通信が失敗する様になった"></a>Q. ゲートウェイでデータ ソース間の通信が失敗する様になった</h3><p>ゲートウェイ経由でのデータ ソースとの通信が失敗となる原因はいくつかあります。よくある原因としては、以下の通りです。エラー メッセージにも出ていることが多いので、ご確認をお願いします。  </p><ol><li>ゲートウェイがオフラインとなっている  </li><li>データ ソースが起動していない  </li><li>データ ソース側の認証情報が変わった  </li></ol><h3 id="上記以外のトラブルについては以下の公開情報もご参照ください"><a href="#上記以外のトラブルについては以下の公開情報もご参照ください" class="headerlink" title="上記以外のトラブルについては以下の公開情報もご参照ください"></a>上記以外のトラブルについては以下の公開情報もご参照ください</h3><p> <a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-tshoot">オンプレミス データ ゲートウェイのトラブルシューティング | Microsoft Learn</a>  </p><hr><p><a id='faq'></a></p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q-ゲートウェイは自動でバージョンアップされますか"><a href="#Q-ゲートウェイは自動でバージョンアップされますか" class="headerlink" title="Q. ゲートウェイは自動でバージョンアップされますか"></a>Q. ゲートウェイは自動でバージョンアップされますか</h3><p>自動ではバージョンアップされません。Microsoft は最新の 6 リリースのみを積極的にサポートしています。月に一度程度バージョン アップされるため、定期的なバージョン アップをお勧めいたします。  </p><h3 id="Q-ゲートウェイ利用時はアプリの起動が必要ですか"><a href="#Q-ゲートウェイ利用時はアプリの起動が必要ですか" class="headerlink" title="Q. ゲートウェイ利用時はアプリの起動が必要ですか"></a>Q. ゲートウェイ利用時はアプリの起動が必要ですか</h3><p>不要です。マシン起動と同時に必要なサービスが立ち上がるため、インストール後はゲートウェイを利用するための操作は不要です。  </p><h3 id="Q-ゲートウェイを利用して接続できるデータ-ソースは何ですか"><a href="#Q-ゲートウェイを利用して接続できるデータ-ソースは何ですか" class="headerlink" title="Q. ゲートウェイを利用して接続できるデータ ソースは何ですか"></a>Q. ゲートウェイを利用して接続できるデータ ソースは何ですか</h3><p>2023/5/8 現時点では以下のデータ ソースがご利用いただけます。また、カスタム コネクタについてもゲートウェイ経由で利用できます。  </p><ul><li>Apache Impala</li><li>BizTalk Server</li><li>ファイル システム</li><li>HTTP with Azure AD</li><li>IBM DB2</li><li>IBM Informix</li><li>IBM MQ</li><li>MySQL</li><li>Oracle データベース</li><li>PostgreSQL</li><li>SAP</li><li>SharePoint Server</li><li>SQL Server</li><li>Teradata</li></ul><p><a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-gateway-connection?WT.mc_id=Portal-Microsoft_Azure_EMA">オンプレミス データ ソースに接続する - Azure Logic Apps | Microsoft Learn</a>  </p><h3 id="Q-利用可能なデータ-ソースを制限することはできますか"><a href="#Q-利用可能なデータ-ソースを制限することはできますか" class="headerlink" title="Q. 利用可能なデータ ソースを制限することはできますか"></a>Q. 利用可能なデータ ソースを制限することはできますか</h3><p>ゲートウェイ共有時に、利用可能なデータ ソースのみ指定することができます。<br><img src="/blog/powerautomate/gateway-install/restrictdatasource.png">  </p><h3 id="上記以外の-FAQ-については以下の公開情報もご参照ください"><a href="#上記以外の-FAQ-については以下の公開情報もご参照ください" class="headerlink" title="上記以外の FAQ については以下の公開情報もご参照ください"></a>上記以外の FAQ については以下の公開情報もご参照ください</h3><p> <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-power-bi-faq">オンプレミス データ ゲートウェイに関するよく寄せられる質問 (FAQ) - Power BI | Microsoft Learn</a></p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの林です。&lt;br&gt;本記事では クラウド フローとオンプレミス環境間でデータ連携する方法と、一例としてローカル ファイルをクラウド フローで扱う方法についてもご紹介します。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
    <category term="オンプレミス データ ゲートウェイ" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/"/>
    
  </entry>
  
  <entry>
    <title>テーブルのリレーションシップとカスケード</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/table-relationship-behavior/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/table-relationship-behavior/</id>
    <published>2023-04-21T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.292Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチーム鈴木です。  </p><p>Datavers のテーブルとテーブルは、1:N、もしくは N:N の関連付けが可能です。<br>関連付けされたテーブル定義のことを、リレーションシップと呼びますが、今回はテーブル間のリレーションシップにおける、カスケード (伝播) 処理について、具体的な動作とともにご紹介します。  </p><span id="more"></span><h2 id="リレーションシップの確認"><a href="#リレーションシップの確認" class="headerlink" title="リレーションシップの確認"></a>リレーションシップの確認</h2><hr><p>テーブル間のリレーションシップの作成、変更、確認は、Power Apps にてテーブル &gt; リレーションシップから確認できます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image001.png">  </p><p>1:N の 1 側のテーブルから確認する場合も、N 側のテーブルから確認する場合も同じで、どちらか一方で設定を変更した場合は、もう一方の設定に引き継がれます。  </p><h2 id="カスケード設定について"><a href="#カスケード設定について" class="headerlink" title="カスケード設定について"></a>カスケード設定について</h2><hr><p>各リレーションシップのカスケード処理は、リレーションシップをクリックして表示される詳細オプションから確認できます。  </p><p>動作の種類と選択可能なカスケード処理は、以下の通りです。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image002.png"><br>    <img src="/blog/powerplatform/table-relationship-behavior/image003.png">  </p><h3 id="親子-上位下位"><a href="#親子-上位下位" class="headerlink" title="親子(上位下位)"></a>親子(上位下位)</h3><p>リレーションシップが親子に設定されているときは、親レコードから子レコードへすべての処理がカスケードされます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image004.png">  </p><h3 id="参照"><a href="#参照" class="headerlink" title="参照"></a>参照</h3><p>リレーションシップが参照に設定されているときは、削除処理のみ「リンクの削除」か「制限」を選択できます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image005.png">  </p><h3 id="カスタム"><a href="#カスタム" class="headerlink" title="カスタム"></a>カスタム</h3><p>リレーションシップがカスタムに設定されているときは、各処理を自由に定義できます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image006.png">  </p><h2 id="カスケード設定の各動作について"><a href="#カスケード設定の各動作について" class="headerlink" title="カスケード設定の各動作について"></a>カスケード設定の各動作について</h2><hr><p>各カスケード処理について 1:N の場合の動作を説明します。  </p><h3 id="削除"><a href="#削除" class="headerlink" title="削除"></a>削除</h3><hr><p>1 側のレコードを削除したときに、関連付けられた N 側のレコードはどうなるでしょうか？  </p><h4 id="・すべてにカスケード"><a href="#・すべてにカスケード" class="headerlink" title="・すべてにカスケード"></a>・すべてにカスケード</h4><p>1 側のレコードを削除すると、N 側のレコードも削除されます。  </p><h4 id="・リンクの削除"><a href="#・リンクの削除" class="headerlink" title="・リンクの削除"></a>・リンクの削除</h4><p>1 側のレコードを削除すると、N 側のレコードは削除されませんが、関連付けが解除されます。<br>つまり 1 側の参照先をもたない、N 側のレコードが残ります。  </p><h4 id="・制限"><a href="#・制限" class="headerlink" title="・制限"></a>・制限</h4><p>1側のレコードを削除しようとすると、関連付けられた N 側のレコードが存在するため、削除できません。<br>以下のようなエラーメッセージが表示されます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image007.png">  </p><h3 id="割り当て"><a href="#割り当て" class="headerlink" title="割り当て"></a>割り当て</h3><hr><p>1 側のレコードの所有者を変更したときに、関連付けられた N 側の所有者はどうなるでしょうか？  </p><h4 id="・すべてにカスケード-1"><a href="#・すべてにカスケード-1" class="headerlink" title="・すべてにカスケード"></a>・すべてにカスケード</h4><p>1 側のレコードの所有者を変更すると、N 側のレコードの所有者も 1 側と同じ所有者に変更されます。<br>※変更する所有者にN側のアクセス権がない場合は、1 側の所有者として指定することはできません。  </p><h4 id="・アクティブにカスケード"><a href="#・アクティブにカスケード" class="headerlink" title="・アクティブにカスケード"></a>・アクティブにカスケード</h4><p>1 側のレコードの所有者を変更すると、N 側のアクティブレコードの所有者は、1 側と同じ所有者に変更されます。<br>N 側が非アクティブレコードだった場合は、N 側のレコードの所有者は変更されません。<br>※変更する所有者に N 側のアクセス権がない場合は、1 側の所有者として指定することはできません。  </p><h4 id="・ユーザー所有にカスケード"><a href="#・ユーザー所有にカスケード" class="headerlink" title="・ユーザー所有にカスケード"></a>・ユーザー所有にカスケード</h4><p>1 側のレコードの所有者を変更すると、N 側のレコードの所有者が 1 側の元の所有者と同じだった場合は、1 側と同じ所有者に変更されます。<br>N 側が 1 側のレコードの元の所有者と異なる場合は、N 側のレコードの所有者は変更されません。<br>※変更する所有者に N 側のアクセス権がない場合は、1 側の所有者として指定することはできません。  </p><h4 id="・カスケードなし"><a href="#・カスケードなし" class="headerlink" title="・カスケードなし"></a>・カスケードなし</h4><p>1 側のレコードの所有者を変更しても、N 側のレコードの所有者は変更されません。  </p><h3 id="共有"><a href="#共有" class="headerlink" title="共有"></a>共有</h3><hr><p>テーブルにアクセス権のないユーザーやチームに対して、レコード毎に共有設定を行うことができます。<br>レコードの 共有 &gt; アクセスの管理 から設定できます。<br>    <img src="/blog/powerplatform/table-relationship-behavior/image008.png"><br>    <img src="/blog/powerplatform/table-relationship-behavior/image009.png">  </p><p>では、1 側のレコードを他者 (ユーザー A) に共有した場合、関連付けられた N 側のレコードへのアクセス権はどうなるでしょうか？  </p><h4 id="・すべてにカスケード-2"><a href="#・すべてにカスケード-2" class="headerlink" title="・すべてにカスケード"></a>・すべてにカスケード</h4><p>1 側のレコードをユーザー A に共有すると、ユーザー A は N 側のレコードにもアクセス権をもちます。<br>例えば、1 側に読み込み、書き込み特権を付けると、N 側のレコードにも同じく読み込み、書き込み特権をもちます。  </p><div class="alert is-success"><p class="alert-title">ヒント</p><p>1 側の共有設定 (共有設定から確認できます。)</p><p>    <img src="/blog/powerplatform/table-relationship-behavior/image010.png">  </p><p>N 側のアクセス権 (アクセスの確認からユーザーを検索して確認できます。)</p><p>    <img src="/blog/powerplatform/table-relationship-behavior/image011.png">  </p></div><h4 id="・アクティブにカスケード-1"><a href="#・アクティブにカスケード-1" class="headerlink" title="・アクティブにカスケード"></a>・アクティブにカスケード</h4><p>1 側のレコードをユーザー A に共有すると、ユーザー A は N 側のアクティブレコードにもアクセス権をもちます。<br>N 側が非アクティブレコードだった場合、ユーザー A は N 側のレコードのアクセス権をもちません。  </p><h4 id="・ユーザー所有にカスケード-1"><a href="#・ユーザー所有にカスケード-1" class="headerlink" title="・ユーザー所有にカスケード"></a>・ユーザー所有にカスケード</h4><p>1 側のレコードのユーザー A に共有すると、N 側のレコードの所有者が 1 側の元の所有者と同じだった場合、ユーザー A は N 側のレコードにもアクセス権をもちます。<br>N 側が 1 側のレコードの元の所有者と異なる場合は、1 側のレコードをユーザー A に共有しても、ユーザー A は N 側のレコードのアクセス権をもちません。  </p><h4 id="・カスケードなし-1"><a href="#・カスケードなし-1" class="headerlink" title="・カスケードなし"></a>・カスケードなし</h4><p>1 側のレコードをユーザー A に共有しても、ユーザー A は、N 側のレコードのアクセス権をもちません。  </p><h3 id="共有の解除"><a href="#共有の解除" class="headerlink" title="共有の解除"></a>共有の解除</h3><hr><p>1 側のレコードを他者 (ユーザー A) に共有し、その後共有を解除すると、関連付けられた N 側のレコードへのアクセス権はどうなるでしょうか？<br>※共有設定はカスケードされる設定を想定しています。  </p><h4 id="・すべてにカスケード-3"><a href="#・すべてにカスケード-3" class="headerlink" title="・すべてにカスケード"></a>・すべてにカスケード</h4><p>1 側のレコードをユーザー A に共有し、その後共有解除すると、ユーザー A は N 側のレコードのアクセス権も解除され、アクセスできません。  </p><h4 id="・アクティブにカスケード-2"><a href="#・アクティブにカスケード-2" class="headerlink" title="・アクティブにカスケード"></a>・アクティブにカスケード</h4><p>1 側のレコードをユーザー A に共有し、その後共有解除すると、ユーザー A は N 側のアクティブレコードのアクセス権も解除され、アクセスできません。<br>N 側が非アクティブレコードだった場合、ユーザー A は N 側のレコードのアクセス権をもち続けます。  </p><h4 id="・ユーザー所有にカスケード-2"><a href="#・ユーザー所有にカスケード-2" class="headerlink" title="・ユーザー所有にカスケード"></a>・ユーザー所有にカスケード</h4><p>1 側のレコードをユーザー A に共有し、その後共有解除すると、N 側のレコードの所有者が 1 側の元の所有者と同じだった場合、ユーザー A は N 側のレコードのアクセス権も解除され、アクセスできません。<br>N 側が 1 側のレコードの元の所有者と異なる場合は、1 側のレコードをユーザー A に共有し、その後共有解除しても、ユーザー A は N 側のレコードのアクセス権をもち続けます。  </p><h4 id="・カスケードなし-2"><a href="#・カスケードなし-2" class="headerlink" title="・カスケードなし"></a>・カスケードなし</h4><p>1 側のレコードをユーザー A に共有し、その後共有解除しても、ユーザー A は N 側のレコードのアクセス権をもち続けます。  </p><h3 id="親の関連付けの再設定-リペアレント"><a href="#親の関連付けの再設定-リペアレント" class="headerlink" title="親の関連付けの再設定(リペアレント)"></a>親の関連付けの再設定(リペアレント)</h3><hr><p>「1 側に N 側のレコードを関連付けする設定時」に N 側レコードへのアクセスに対して、1 側レコードのものを継承させるかどうか、という設定になります。<br>「共有」と「親の関連付けの再設定」の違いは、「共有」は「1 側のレコードで共有設定を行ったときにすでに関連づけられている N 側レコードに対して共有を継承させるかどうか」であることに対して、「親の関連付けの再設定」は「1 側のレコードで N 側レコードに対する関連付けを行ったときに存在する共有設定を N 側レコードに対して継承させるかどうか」です。  </p><p>では、1 側のレコードをすでに他者 (ユーザー A) に共有している場合、共有設定後に関連付けられた N 側のレコードへのアクセス権はどうなるでしょうか？  </p><h4 id="・すべてにカスケード-4"><a href="#・すべてにカスケード-4" class="headerlink" title="・すべてにカスケード"></a>・すべてにカスケード</h4><p>1 側のレコードに N 側のレコードを関連付けると、ユーザー A は N 側のレコードにアクセスできます。  </p><h4 id="・アクティブにカスケード-3"><a href="#・アクティブにカスケード-3" class="headerlink" title="・アクティブにカスケード"></a>・アクティブにカスケード</h4><p>1 側のレコードに N 側のレコードを関連付けると、ユーザー A は N 側のアクティブなレコードにアクセスできます。<br>N 側が非アクティブレコードだった場合、ユーザー A は N 側のレコードのアクセス権をもちません。  </p><h4 id="・ユーザー所有にカスケード-3"><a href="#・ユーザー所有にカスケード-3" class="headerlink" title="・ユーザー所有にカスケード"></a>・ユーザー所有にカスケード</h4><p>1 側のレコードに N 側のレコードを関連付けると、N 側のレコードの所有者が 1 側の元の所有者と同じだった場合、ユーザー A は N 側のレコードにもアクセス権をもちます。<br>N 側が 1 側のレコードの元の所有者と異なる場合は、1 側のレコードをユーザー A に共有しても、ユーザー A は N 側のレコードのアクセス権をもちません。  </p><h4 id="・カスケードなし-3"><a href="#・カスケードなし-3" class="headerlink" title="・カスケードなし"></a>・カスケードなし</h4><p>1 側のレコードに N 側のレコードを関連付けても、ユーザー A は N 側のレコードのアクセス権をもちません。  </p><h2 id="よくあるご質問"><a href="#よくあるご質問" class="headerlink" title="よくあるご質問"></a>よくあるご質問</h2><hr><h4 id="・カスケード処理の「共有」を「すべてにカスケード」から「カスケードなし」に変更しました。既存の共有設定はどうなりますか？"><a href="#・カスケード処理の「共有」を「すべてにカスケード」から「カスケードなし」に変更しました。既存の共有設定はどうなりますか？" class="headerlink" title="・カスケード処理の「共有」を「すべてにカスケード」から「カスケードなし」に変更しました。既存の共有設定はどうなりますか？"></a>・カスケード処理の「共有」を「すべてにカスケード」から「カスケードなし」に変更しました。既存の共有設定はどうなりますか？</h4><p>カスケード処理変更前に既に共有されたレコードは、既に共有レコードを管理するテーブルに共有情報が登録されているため、カスケード処理を変更しても動作が変わりません。<br>カスケード処理変更前に共有されたレコードは、一度共有を解除し、再度共有設定することで、変更後のカスケード処理を伝播します。<br>注意事項として、「共有の解除」が「カスケードなし」の設定になっている場合には共有解除したことがカスケードされないため、再共有した場合に N 側レコードの参照ができてしまいます。<br>これを防ぐためには、「共有の解除」は「カスケード」される設定にしておく必要があります。  </p><h4 id="・1-側のレコードの所有者がユーザー-A-で、N-側のレコードの所有者がユーザー-B-です。ユーザー-A-は-N-側のレコードへアクセス権をもちますか？"><a href="#・1-側のレコードの所有者がユーザー-A-で、N-側のレコードの所有者がユーザー-B-です。ユーザー-A-は-N-側のレコードへアクセス権をもちますか？" class="headerlink" title="・1 側のレコードの所有者がユーザー A で、N 側のレコードの所有者がユーザー B です。ユーザー A は N 側のレコードへアクセス権をもちますか？"></a>・1 側のレコードの所有者がユーザー A で、N 側のレコードの所有者がユーザー B です。ユーザー A は N 側のレコードへアクセス権をもちますか？</h4><p>※ユーザー A は、N 側テーブルのアクセス権をもっていない、かつ共有設定は行われていない前提です。<br>親の関連付けの再設定が「カスケード」の場合、ユーザー A は所有者の異なる N 側のレコードへアクセス権をもちます。<br>親の関連付けの再設定が「カスケードなし」の場合は、ユーザー A は所有者の異なる N 側のレコードへアクセス権をもちません。  </p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><hr><p>今回ご説明した内容に関連した公開情報について、ご紹介します。<br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/create-edit-entity-relationships#table-relationship-behavior">テーブル リレーションシップ</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/data-platform/data-platform-entity-lookup#add-advanced-relationship-behavior">テーブル間に関連付けを作成する</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/user/assign-or-share-records">行の割り当てまたは共有</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/user/share-row">ユーザーまたはチームと行を共有する</a><br><a href="https://learn.microsoft.com/ja-jp/power-apps/user/access-checker">行に対するユーザー アクセスを確認する</a>    </p><p>今回は、テーブル間のリレーションシップにおけるカスケード処理の具体的な動作についてご案内しました。<br>テーブルによっては、事前定義されたアプリケーション動作を担保するためにシステム側で予め設定されたカスケード処理が存在する場合や、カスケードは設定がない場合も製品プラグインによってカスケードに近い処理を実施している場合もありますので、ご留意ください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチーム鈴木です。  &lt;/p&gt;
&lt;p&gt;Datavers のテーブルとテーブルは、1:N、もしくは N:N の関連付けが可能です。&lt;br&gt;関連付けされたテーブル定義のことを、リレーションシップと呼びますが、今回はテーブル間のリレーションシップにおける、カスケード (伝播) 処理について、具体的な動作とともにご紹介します。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="Model-driven app" scheme="https://jpdynamicscrm.github.io/blog/tags/Model-driven-app/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (有人実行)</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/</id>
    <published>2023-04-20T08:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.156Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの原野です。<br>本記事では Power Automate for desktop で作成したデスクトップ フローをクラウド フローから呼び出して、アテンド型 (有人) でフローを実行する方法についてご案内いたします。  </p><span id="more"></span><ol><li><a href="#anchor-intro">概要</a></li><li><a href="#anchor-attend-and-unattended-automation">有人実行(アテンド型)と無人実行(非アテンド型)の違い</a></li><li><a href="#anchor-licence-for-attended-automation">有人実行に必要なライセンスについて</a></li><li><a href="#anchor-attended-automation">デスクトップ フローを有人実行する方法</a><ol><li><a href="#anchor-register-computers">端末の登録方法</a></li><li><a href="#anchor-call-desktopflow-from-cloudflow">クラウド フローからデスクトップ フローを呼び出す方法</a></li><li><a href="#anchor-notes-on-attended-automation">有人実行の際の注意事項について</a></li><li><a href="#anchor-result-of-attended-automation-flow">実行結果</a></li></ol></li></ol><p><a id='anchor-intro'></a></p><h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p>クラウド フローから Power Automate for desktop を呼び出して、デスクトップ フローを有人実行する方法についてご案内いたします。  </p><p><a id='anchor-attend-and-unattended-automation'></a></p><h1 id="有人実行-アテンド型-と無人実行-非アテンド型-の違い"><a href="#有人実行-アテンド型-と無人実行-非アテンド型-の違い" class="headerlink" title="有人実行 (アテンド型) と無人実行 (非アテンド型) の違い"></a>有人実行 (アテンド型) と無人実行 (非アテンド型) の違い</h1><p>クラウド フローから Power Automate for desktop を呼び出す方法として以下の 2 種類がございます。  </p><ul><li>有人実行 (アテンド型) ：<br>ユーザーが端末にサインインしている状態でデスクトップ フローを実行します。デスクトップ フローの実行時に画面をリアルタイムで確認することができます。  </li><li>無人実行 (非アテンド型) ：<br>ユーザーが端末からサインアウトしている状態でデスクトップ フローを実行します。  </li></ul><p>有人実行と無人実行の違いについて、公開情報もございますのでご確認いただけますと幸いです。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/guidance/planning/attended-unattended">プロセス自動化のための有人および無人のシナリオ - Power Automate | Microsoft Learn</a></p><p><a id='anchor-licence-for-attended-automation'></a></p><h1 id="有人実行に必要なライセンスについて"><a href="#有人実行に必要なライセンスについて" class="headerlink" title="有人実行に必要なライセンスについて"></a>有人実行に必要なライセンスについて</h1><p>クラウド フローからデスクトップ フローを有人実行で呼び出す際には、下記のいずれかの Power Automate 有償ライセンスが必要になります。  </p><ul><li>有人 RPA を含む Power Automate per user プラン  </li><li>従量課金制  </li></ul><p><a id='anchor-attended-automation'></a></p><h1 id="デスクトップ-フローを有人実行する方法"><a href="#デスクトップ-フローを有人実行する方法" class="headerlink" title="デスクトップ フローを有人実行する方法"></a>デスクトップ フローを有人実行する方法</h1><p>以下の方法について、順にご案内いたします。  </p><ul><li>端末の登録方法  </li><li>クラウド フローからデスクトップ フローを呼び出す方法  </li></ul><p><a id='anchor-register-computers'></a></p><h2 id="端末の登録方法"><a href="#端末の登録方法" class="headerlink" title="端末の登録方法"></a>端末の登録方法</h2><p>Power Automate コンピュータ ランタイム アプリを使用して、該当の環境にデスクトップ フローを実行する端末を登録を行います。  </p><ol><li><p>事前準備  </p><ul><li><p>セキュリティ ロール<br>コンピュータ登録には「環境作成者」または「デスクトップ フローコンピュータ所有者」のセキュリティ ロールが必要となります。<br>そのため、登録したい環境において、コンピュータ登録を実行しているアカウントに「環境作成者」または「デスクトップ フロー コンピュータ所有者」のセキュリティ ロールが付与されているかご確認ください。<br>セキュリティ ロールに関して以下の公開情報がございますので、ご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/security-roles-privileges">セキュリティ ロールおよび特権 - Power Platform | Microsoft Learn</a> </p></li><li><p>必要なエンドポイント<br>コンピュータを登録する際のネットワーク要件として、「ランタイムに必要なデスクトップ フロー サービス」がございます。<br>以下の公開情報をご確認いただき、グローバル エンドポイントと公開エンドポイントに接続できる状態となっているかご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/ip-address-configuration#desktop-flows-services-required-for-runtime">IP アドレスの構成 - Power Automate | Microsoft Learn</a>  </p></li></ul></li><li><p>Power Automate コンピュータ ランタイム アプリケーションをインストールする  </p><ul><li>Power Automate for desktop をまだインストールしていない場合<br>Power Automate for desktop のインストール時に「Power Automate コンピュータ ランタイム アプリをインストールして、Power Automate クラウド ポータルに接続する 」にチェックを入れます。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers3.png"></li><li>既にPower Automate for desktop インストールしている場合<br>設定 &gt; コンピューターの設定を開く &gt; アプリのインストールを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers.png">  </li></ul></li><li><p>Power Automate コンピュータ ランタイム アプリケーションを起動すると端末が自動的に現在の環境に登録されます。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/register-computers2.png"><br>上記の手順について公開情報にも記載がございますので、ご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage-machines#register-a-new-machine">コンピュータの管理 - Power Automate | Microsoft Learn</a>  </p></li></ol><p><a id='anchor-call-desktopflow-from-cloudflow'></a></p><h2 id="クラウド-フローからデスクトップ-フローを呼び出す方法"><a href="#クラウド-フローからデスクトップ-フローを呼び出す方法" class="headerlink" title="クラウド フローからデスクトップ フローを呼び出す方法"></a>クラウド フローからデスクトップ フローを呼び出す方法</h2><p>デスクトップ フローをクラウド フローから有人実行で呼び出す方法についてご案内いたします。  </p><ol><li><p>デスクトップ フローを作成します。<br>既にデスクトップ フローを作成済みの場合は手順 2 にお進みください。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow.png">  </p></li><li><p>デスクトップ フローを呼び出すためのクラウド フローを作成し、新しいステップ &gt; 「Desktop flows」コネクタの「デスクトップ用 Power Automate で構築したフローを実行する」アクションを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow4.png">  </p></li><li><p>デスクトップ フローへの接続を設定します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow5.png">  </p><ul><li>接続：コンピューターに直接送信をご指定ください。  </li><li>コンピューターまたはコンピューター グループ：登録済みの端末をご指定ください。  </li><li>ドメインとユーザー名：「ドメイン名\ユーザー名」の形式でご指定ください。<br>現在端末ログオンしているユーザーのドメインとユーザーの名は <code>whoami</code> コマンドから確認いただけます。<br>※ Web 版 Power Automate のログインアカウントではございませんので、ご注意ください。 </li><li>パスワード：上記で指定したユーザーのパスワードをご指定ください。  </li></ul><p> whoami コマンドについて、公開情報に詳細な記載がございますのでご確認ください。<br> <a href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/whoami">whoami | Microsoft Learn</a><br> また接続の作成方法についても、公開情報に詳細な記載がございますのでご確認ください。<br> <a href="https://learn.microsoft.com/ja-jp/power-automate/desktop-flows/manage-machines#trigger-a-desktop-flow-to-run-on-your-machine">コンピュータの管理 - Power Automate | Microsoft Learn</a>  </p></li><li><p>「デスクトップ用 Power Automate で構築したフローを実行する」アクションで呼び出したいデスクトップ フローと実行モードを選択します。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/call-desktopflow-from-cloudflow6.png">  </p><ul><li>Desktop フロー：呼び出したいデスクトップ フローをご指定ください。  </li><li>実行モード：アテンド型をご指定ください。  </li></ul></li></ol><p><a id='anchor-notes-on-attended-automation'></a></p><h2 id="有人実行の際の注意事項について"><a href="#有人実行の際の注意事項について" class="headerlink" title="有人実行の際の注意事項について"></a>有人実行の際の注意事項について</h2><p>有人実行でデスクトップ フローを呼び出す際は、フローを問題なく実行するために以下の点をご確認いただけますと幸いです。  </p><ul><li>端末にログオンしていること：接続を設定した際に指定したユーザーでログオンしているかどうかご確認ください。  </li><li>画面をロックしていないこと：有人実行する際に画面をロックしているとフローが実行できませんので、画面がロックされていないことをご確認ください。  </li></ul><p><a id='anchor-result-of-attended-automation-flow'></a></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>Power Automate for desktop で作成したデスクトップ フローをクラウド フローからアテンド型 (有人) で呼び出して実行することができました。<br><img src="/blog/powerautomate/power-automate-desktop-attand-automation/result-of-attended-automation-flow.png">  </p><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。  バージョンアップによって若干の UI の遷移など異なる場合があります。  その場合は画面の指示に従って進めてください。  </p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの原野です。&lt;br&gt;本記事では Power Automate for desktop で作成したデスクトップ フローをクラウド フローから呼び出して、アテンド型 (有人) でフローを実行する方法についてご案内いたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
    <category term="Desktop flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flow/"/>
    
    <category term="Power Automate for desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-for-desktop/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (無人実行)</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-unattand-automation/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-unattand-automation/</id>
    <published>2023-04-20T08:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.184Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの原野です。<br>本記事では Power Automate for desktop で作成したデスクトップ フローをクラウドフローから呼び出して、非アテンド型 (無人) でフローを実行する方法についてご案内いたします。  </p><p>有人実行と無人実行の違いや、アテンド型 (有人) でフローを実行する方法については以下のブログに記載がございますので、ご確認ください。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/">Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (有人実行) | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a>  </p><span id="more"></span><ol><li><a href="#anchor-intro">概要</a></li><li><a href="#anchor-licence-for-unattended-automation">無人実行に必要なライセンスについて</a></li><li><a href="#anchor-unattended-automation">デスクトップ フローを無人実行する方法</a><ol><li><a href="#anchor-unattended-add-on">無人 RPA アドオンの割り当て方</a></li><li><a href="#anchor-register-computers">端末の登録準備</a></li><li><a href="#anchor-call-desktopflow-from-cloudflow">クラウド フローからデスクトップ フローを呼び出す方法</a></li><li><a href="#anchor-notes-on-unattended-automation">無人実行の際の注意事項について</a></li><li><a href="#anchor-result-of-unattended-automation-flow">実行結果</a></li></ol></li></ol><p><a id='anchor-intro'></a></p><h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p>クラウド フローから Power Automate for desktop を呼び出して、デスクトップ フローを無人実行する方法についてご案内いたします。<br>無人実行では、ユーザーが端末からサインアウトしている状態でデスクトップ フローが実行できます。  </p><p>ユーザーが端末にサインインしている状態でデスクトップ フローを実行する有人実行の方法については以下のブログでご案内していますのでご確認いただけますと幸いです。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/">Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (有人実行) | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a>  </p><p><a id='anchor-licence-for-unattended-automation'></a></p><h1 id="無人実行に必要なライセンスについて"><a href="#無人実行に必要なライセンスについて" class="headerlink" title="無人実行に必要なライセンスについて"></a>無人実行に必要なライセンスについて</h1><ol><li><p>必要なライセンス<br> クラウド フローからデスクトップ フローを 無人実行で呼び出す際には、下記のいずれかの Power Automate 有償ライセンスが必要になります。  </p><ul><li>有人 RPA を含む Power Automate per user プラン ＋ Power Automate 無人 RPA アドオン</li><li>Power Automate per flow プラン＋ Power Automate 無人 RPA アドオン</li><li>従量課金制  </li></ul><p> なお、デスクトップ フローを無人実行する際に Office 製品を利用する場合、Office 365 無人ライセンス (E3 unattended License) を購入し、ユーザーに割り当てる必要がございます。  </p></li><li><p>無人アドオンの必要な個数<br> 1 つの環境内で同時間帯に並行でデスクトップ フローを実行したい場合は、並行で実行したいフローの数だけ、無人 RPA アドオンを環境に割り当ててご利用ください。<br>複数のデスクトップ フローを同時に実行する必要がない場合は、 1 つの無人 RPA アドオンを環境に割り当てることでフローを実行いただけます。</p></li></ol><p><a id='anchor-unattended-automation'></a></p><h1 id="デスクトップ-フローを無人実行する方法"><a href="#デスクトップ-フローを無人実行する方法" class="headerlink" title="デスクトップ フローを無人実行する方法"></a>デスクトップ フローを無人実行する方法</h1><p>以下の方法について、順にご案内いたします。  </p><ul><li>無人 RPA アドオンの割り当て方</li><li>端末の登録方法  </li><li>クラウド フローからデスクトップ フローを呼び出す方法  </li></ul><p><a id='anchor-unattended-add-on'></a></p><h2 id="無人-RPA-アドオンの割り当て方"><a href="#無人-RPA-アドオンの割り当て方" class="headerlink" title="無人 RPA アドオンの割り当て方"></a>無人 RPA アドオンの割り当て方</h2><p>無人 RPA アドオンを購入して、環境に割り当てることで、割り当てられた環境でデスクトップ フローを無人実行できるようになります。  </p><ul><li>無人 RPA アドオンを購入する<br><a href="https://admin.microsoft.com/">Microsoft 365 管理センター</a>から無人 RPA アドオンを購入する方法については以下の公開情報でご案内していますのでご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/buy-licenses#buy-unattended-add-on">Power Automate ライセンスを購入する - Power Platform | Microsoft Learn</a></li><li>無人 RPA アドオンを環境に割り当てる<br>上記で購入したアドオンを環境に割り当てる方法については以下の公開情報でご案内していますのでご確認ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/buy-licenses#assign-unattended-add-ons-to-an-environment">Power Automate ライセンスを購入する - Power Platform | Microsoft Learn</a></li></ul><p><a id='anchor-register-computers'></a></p><h2 id="端末の事前準備"><a href="#端末の事前準備" class="headerlink" title="端末の事前準備"></a>端末の事前準備</h2><ol><li>端末の登録方法<br>Power Automate コンピュータ ランタイムアプリを使用して、該当の環境にデスクトップ フローを実行する端末を登録を行います。<br>以下の記事をご参照の上でご指定ください。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/#anchor-register-computers">端末の登録方法 (有人実行) | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a>  </li><li>リモート デスクトップの設定<br>実行する端末 &gt; システムのプロパティ &gt; リモート デスクトップにて、以下のように設定します。<br><img src="/blog/powerautomate/power-automate-desktop-unattand-automation/register-computers4.png">  <ul><li>「このコンピューターへのリモート接続を許可する」を選択する  </li><li>「ネットワークレベル認証でのリモート デスクトップを実行しているコンピューターからのみ接続を許可する」のチェックを外す  </li></ul></li></ol><p><a id='anchor-call-desktopflow-from-cloudflow'></a></p><h2 id="クラウド-フローからデスクトップ-フローを呼び出す方法"><a href="#クラウド-フローからデスクトップ-フローを呼び出す方法" class="headerlink" title="クラウド フローからデスクトップ フローを呼び出す方法"></a>クラウド フローからデスクトップ フローを呼び出す方法</h2><p>以下の記事の手順 6 で実行モードを非アテンド型に変更することで、デスクトップ フローを無人実行で呼び出すことができます。<br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/#anchor-call-desktopflow-from-cloudflow">クラウド フローからデスクトップ フローを呼び出す方法 | Japan Dynamics CRM &amp; Power Platform Support Blog (jpdynamicscrm.github.io)</a></p><p><img src="/blog/powerautomate/power-automate-desktop-unattand-automation/call-desktopflow-from-cloudflow.png">  </p><ul><li>Desktop フロー：呼び出したいデスクトップ フローをご指定ください。  </li><li>実行モード：非アテンド型をご指定ください。  </li></ul><p><a id='anchor-notes-on-unattended-automation'></a></p><h2 id="無人実行の際の注意事項について"><a href="#無人実行の際の注意事項について" class="headerlink" title="無人実行の際の注意事項について"></a>無人実行の際の注意事項について</h2><p>無人実行でデスクトップ フローを呼び出す際は、フローを問題なく実行するために以下の点をご確認いただけますと幸いです。  </p><ol><li>端末からサインアウトしていること：フローを実行する際に端末からサインアウトしているかどうかご確認ください。   <ul><li>端末からサインアウトしていない場合のエラー例：  <blockquote><p>デスクトップ フローを実行できるコンピューターが見つかりません。実行を中止しています。コンピューターに接続する際にエラーが発生しました: ターゲット コンピューターにユーザー セッションが存在します。デスクトップ フローを非アテンド型で実行できません。  </p></blockquote></li></ul></li><li>リモート デスクトップの設定が適切に行われていること：本記事内の「端末の登録方法」の章の記載にしたがって設定されているかどうかご確認ください。  <ul><li>「このコンピューターへのリモート接続を許可する」が選択されていない場合のエラー例 ：  <blockquote><p>デスクトップ フローを非アテンド型で実行するセッションを作成できません。デスクトップ フローを非アテンド型で実行するには、お使いコンピューターでリモート デスクトップを有効にする必要があります。  </p></blockquote></li><li>「ネットワークレベル認証でのリモート デスクトップを実行しているコンピューターからのみ接続を許可する」のチェックが外れてない場合のエラー例：  <blockquote><p>これらの資格情報では非アテンド型セッションを作成できませんでした。AAD 資格情報を使用している場合は、リモート設定でネットワーク レベル認証 (NLA) が無効になっていることをご確認ください  </p></blockquote></li></ul></li></ol><p><a id='anchor-result-of-unattended-automation-flow'></a></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>クラウド フローからデスクトップ フローを呼び出して無人実行することができました。<br><img src="/blog/powerautomate/power-automate-desktop-unattand-automation/result-of-unattended-automation-flow.png">  </p><hr><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。</p><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの原野です。&lt;br&gt;本記事では Power Automate for desktop で作成したデスクトップ フローをクラウドフローから呼び出して、非アテンド型 (無人) でフローを実行する方法についてご案内いたします。  &lt;/p&gt;
&lt;p&gt;有人実行と無人実行の違いや、アテンド型 (有人) でフローを実行する方法については以下のブログに記載がございますので、ご確認ください。&lt;br&gt;&lt;a href=&quot;https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-attand-automation/&quot;&gt;Power Automate for desktop で作成したデスクトップ フローをクラウド フローから実行する方法 (有人実行) | Japan Dynamics CRM &amp;amp; Power Platform Support Blog (jpdynamicscrm.github.io)&lt;/a&gt;  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Desktop flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Desktop-flow/"/>
    
    <category term="Power Automate for desktop" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate-for-desktop/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps/Power Automate/Power Virtual Agents お問い合わせ時の留意事項</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/about-power-platform-support/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/about-power-platform-support/</id>
    <published>2023-04-20T06:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.288Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームです。<br>今回は、Power Apps/Power Automate/Power Virtual Agents のお問い合わせをいただく際の留意事項、ご協力いただきたい事項についてご紹介します。  </p><p>我々サポートチームといたしましては、できる限りお客様のお役に立てるよう、日々調査に努めておりますが、お客様の協力があって初めてご支援ができることも多くございます。<br>また、クラウドサービスの性質や、成長スピードの速い Power Platform という製品の性質上、また情報保護の観点から、どうしてもお客様への情報のご提供が難しい場合もございます。  </p><p>サポートをご利用いただくうえでは、以下のような点にご留意ください。   </p><span id="more"></span><h2 id="1．お客様へのご協力のお願い"><a href="#1．お客様へのご協力のお願い" class="headerlink" title="1．お客様へのご協力のお願い"></a>1．お客様へのご協力のお願い</h2><hr><p>調査を迅速に開始するため、また、コミュニケーションを円滑に進めるため、以下の点にご協力ください。  </p><h3 id="お問い合わせは、事象の発生後できるかぎりすぐにご起票ください"><a href="#お問い合わせは、事象の発生後できるかぎりすぐにご起票ください" class="headerlink" title="お問い合わせは、事象の発生後できるかぎりすぐにご起票ください"></a>お問い合わせは、事象の発生後できるかぎりすぐにご起票ください</h3><p>Power Platform では、事象の発生から 28 日が経過すると、サーバーログを破棄しています。<br>事象の発生から時間が経ってしまうと、ログが残っておらず、調査ができない場合がございますので、お問い合わせはできる限りお早めにご起票ください。  </p><h3 id="お問い合わせ内容はできる限り詳細にご記載ください"><a href="#お問い合わせ内容はできる限り詳細にご記載ください" class="headerlink" title="お問い合わせ内容はできる限り詳細にご記載ください"></a>お問い合わせ内容はできる限り詳細にご記載ください</h3><p>認識齟齬をなくすため、お問い合わせ内容はできる限り詳細に記載してください。<br>例えばエラーが発生した場合、 </p><ul><li>エラーの発生したユーザー情報</li><li>エラー画面のキャプチャ (可能であれば背景も含めた画面全体)</li><li>エラーメッセージ (テキスト形式)</li><li>再現手順</li><li>発生日時</li><li>発生頻度 (常に/たまに/一度だけ) </li><li>発生条件</li></ul><p>などをできる限り詳細に記載いただくことで、正確に事象を把握でき、調査がスムーズに進みます。<br>反対に、お問い合わせ内容にこれらの情報が不足している場合、内容を把握するだけで何回もやり取りが必要になり、日数を要してしまう場合があります。<br>また、事象の発生前後で行った操作など、弊社からはヒアリングに至れない点もございますので、お気づきの点があれば些細なことでもお知らせいただけますと幸いです。</p><h3 id="情報提供にご協力ください"><a href="#情報提供にご協力ください" class="headerlink" title="情報提供にご協力ください"></a>情報提供にご協力ください</h3><p>調査を円滑に進めるには、お客様からの情報提供が不可欠です。<br>Power Platform は、複数のサービスをつなぐという製品の性質上、Power Platform 以外の製品に関する情報や、監査ログなどの情報をご依頼する場合があります。<br>お手数をおかけしますが、以下のような点についてご理解・ご協力をお願いいたします。  </p><ul><li>お問い合わせの起票時に診断情報へのアクセスの同意を求める箇所がございますので、「診断情報へのアクセスを許可する」をご選択ください。<br>参考: <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-environment#consent-information">同意情報について</a>  </li><li>上記の診断情報へのアクセスを許可いただいていても、サポート担当者にて閲覧ができないデータもございます。この場合、弊社より必要な情報の採取をご依頼いたしますので、お客様側でのデータの取得にご協力ください。 </li><li>お問い合わせフォームに、エラー内容やフロー/アプリの URL などを質問する項目がある場合があります。<br>お問い合わせ時にこれらの項目について記載いただくことで、お問い合わせを受領してすぐに詳細調査を開始することができますので、お問い合わせフォームの項目はできるかぎりすべて入力いただくよう、ご協力をお願いいたします。  </li><li>お客様にてご作成いただいているフロー、アプリ、ボットが複雑な場合や、弊社での事象の再現が難しい場合、調査を進めるためには、お客様にて事象の切り分けをご実施いただく必要がございます。<br>製品の性質上、お客様のご協力なしに調査を進めることは難しい場合も多くございますので、ご理解・ご協力のほどお願いいたします。  </li></ul><p>また、お問い合わせ時にお寄せいただきたい情報とその情報採取手順について、ブログ記事でご紹介しています。<br>事象によって必要な情報は異なるため、すべてを添付いただく必要はございませんが、お問い合わせいただく事象に関係のありそうなものをお問い合わせ時に添付いただけますと、調査がスムーズに進みますので、ご協力をお願いいたします。  </p><p><a href="https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/">Power Apps キャンバス アプリ お問い合わせの際の情報取得手順</a><br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/helpful-information-for-powerautomate-sr/">Power Automate お問い合わせの際の情報採取手順</a><br><a href="https://jpdynamicscrm.github.io/blog/powerautomate/power-automate-desktop-helpful-information-for-sr/">Power Automate for desktop お問い合わせの際の情報取得手順</a></p><h3 id="お問い合わせの分割起票にご協力ください"><a href="#お問い合わせの分割起票にご協力ください" class="headerlink" title="お問い合わせの分割起票にご協力ください"></a>お問い合わせの分割起票にご協力ください</h3><p>テクニカル サポートでは、お客様の技術的な課題に対して、各製品の専任のエンジニアが担当となりご支援を差し上げております。<br>そのため、複数の製品に跨るご質問に関しては、製品ごとに分割してお問い合わせをご起票いただくようお願いいたします。</p><p>また、同一製品に関するご質問であっても、質問内容が多岐にわたる場合には、分割起票をご依頼することがございます。<br>課題管理やお客様とのコミュニケーションの円滑化、複数エンジニアでの並行調査を可能とするため、事象が異なる場合や観点の異なるご質問が複数ある場合には、分割してお問い合わせを起票いただくようお願いいたします。</p><h3 id="Teams-会議にご協力ください"><a href="#Teams-会議にご協力ください" class="headerlink" title="Teams 会議にご協力ください"></a>Teams 会議にご協力ください</h3><p>Power Apps や Power Automate for desktop など、クライアント端末上で動作するサービスをご利用いただいている場合、事象を正しく把握するために、Teams 会議での画面共有をしながらのコミュニケーションをご依頼する場合がございます。<br>特に、お問い合わせいただいた事象が弊社では再現できない場合、Teams 会議での事象の確認、再現手順の確認、情報採取が必要となってきますので、ご協力をお願いいたします。  </p><h2 id="2．Power-Platform-でのサポート-サービス全般に関する留意事項"><a href="#2．Power-Platform-でのサポート-サービス全般に関する留意事項" class="headerlink" title="2．Power Platform でのサポート サービス全般に関する留意事項"></a>2．Power Platform でのサポート サービス全般に関する留意事項</h2><hr><h3 id="仕様確認について"><a href="#仕様確認について" class="headerlink" title="仕様確認について"></a>仕様確認について</h3><p>仕様確認のお問い合わせについては、公開情報や現時点の動作をもとに、想定される動作をご案内いたします。<br>公開情報に記載されている以上の情報については、ご提供できない場合があることをあらかじめご承知おきください。   </p><h3 id="サードパーティサービスと連携する場合の調査について"><a href="#サードパーティサービスと連携する場合の調査について" class="headerlink" title="サードパーティサービスと連携する場合の調査について"></a>サードパーティサービスと連携する場合の調査について</h3><p>Power Platform にてサードパーティ サービスをご使用の場合、弊社では詳細な調査ができない場合があります。<br>事象に関する切り分けの結果、サードパーティ サービス側での調査が必要と判断した場合、お客様から他社様へのお問い合わせをご依頼する場合や、調査を終了とさせていただく場合がございますので、ご理解のほどお願いいたします。  </p><h3 id="再現性のない事象について"><a href="#再現性のない事象について" class="headerlink" title="再現性のない事象について"></a>再現性のない事象について</h3><p>過去の特定の時期にのみ発生していた問題や、発生頻度の少ない事象に関する調査は、事象発生時の情報が不足している場合、十分な調査を行うことができないことから、原因特定までのご支援が出来ない場合がございます。<br>そのため、確認可能な情報からのベストエフォートでの調査となりますこと、予めご了承の程お願いいたします。    </p><p>なお、クラウド製品におきましては、その特性上、一過性の障害 (サービスとのネットワーク接続が一瞬失われたり、サービスが一時的にビジー状態になる等) が発生する場合がございますが、これらの障害は自動修正され、少し時間をおいてから操作を再試行することで、高い確率で正常に実行されます。<br>このような事象においては、根本原因の究明は困難となりますこと、ご理解くださいますようお願いいたします。</p><p><strong>例）以下のようなお問い合わせは、テクニカル サポートでのご支援が難しい場合があります</strong>  </p><ul><li>キャンバスアプリにてデータを保存した際、過去に一度のみエラーが発生し、データが登録されなかった。その後発生はしていないが、エラーの理由が不明であり再現した際に備えたいため、原因と対応策を教えてほしい  </li><li>クラウドフローを編集しようとしたが、編集画面が描画されず、一時的にフローの編集ができなかった。特定のユーザでのみ発生しており、一定時間経過後に解消したが、根本原因について調査してほしい。 </li></ul><h3 id="長期にわたる修正について"><a href="#長期にわたる修正について" class="headerlink" title="長期にわたる修正について"></a>長期にわたる修正について</h3><p>調査の結果、サービス側の改修が必要となることがございますが、修正が長期にわたることが想定される場合は、お問い合わせを一旦クローズとさせていただきます。<br>定期的な修正状況の確認や、修正の進捗報告をご希望の場合は、ご確認が必要なタイミングで、その都度お問い合わせを起票いただくようお願いいたします。   </p><h3 id="リリース時期や今後の予定に関するご質問について"><a href="#リリース時期や今後の予定に関するご質問について" class="headerlink" title="リリース時期や今後の予定に関するご質問について"></a>リリース時期や今後の予定に関するご質問について</h3><p>新機能のリリース時期や修正の展開時期など、今後の予定に関するご質問には、基本的にはお答えすることができません。<br>状況に応じて、ベストエフォートで開発部門への確認を行い、目安としてご案内を差し上げることがございますが、ご案内する時期についてはあくまでもその時点での予定であり、変更となる可能性が多分にあることをご承知おきください。   </p><h3 id="お客様側での情報採取や確認にお時間がかかる場合について"><a href="#お客様側での情報採取や確認にお時間がかかる場合について" class="headerlink" title="お客様側での情報採取や確認にお時間がかかる場合について"></a>お客様側での情報採取や確認にお時間がかかる場合について</h3><p>お客様側での情報採取や、ご案内内容の確認、実装などにお時間がかかる場合には、お問い合わせを一旦クローズとさせていただきます。<br>テクニカル サポートは、短期的な課題に対してご支援を差し上げるサービスですので、2 週間程度を目安に、それ以上のお時間が必要な場合には、お問い合わせの一旦クローズにご理解ください。<br>なお、クローズ後にご質問が発生した場合には、以前のお問い合わせ番号を記載してお問い合わせいただければ、情報を引継いでご支援を再開することが可能ですので、ご安心ください。  </p><h3 id="サンプル作成やカスタマイズのご支援について"><a href="#サンプル作成やカスタマイズのご支援について" class="headerlink" title="サンプル作成やカスタマイズのご支援について"></a>サンプル作成やカスタマイズのご支援について</h3><p>アドバイザリー サービスを含むサポート契約をお持ちの場合には、ご支援が可能です。<br>サンプル作成やカスタマイズのご依頼をいただいた場合、お客様からご要件の詳細をヒアリングしたうえで、フローやアプリの作成方法についてのご支援をさせていただきますが、成果物としてサンプル アプリやサンプル フローをご提供することはできかねますので、ご了承ください。<br>なお、ご案内の過程で、一例として弊社にてサンプル フローやサンプル コードを作成し、ご案内することがございますが、あくまでも説明のためのサンプルとしてのご案内となりますので、下記の点についてご承知おきください。</p><ul><li>お客様の要望を直接満たすためのご提供ではございません。</li><li>製品の実運用環境で使用されることを前提に提供されるものではございません。</li><li>弊社にて動作の保証できかねます。</li><li>エラー処理などは含まれておりません。</li></ul><p>また、ご依頼の内容によっては別途プロアクティブ サービスなどのご紹介を差し上げる場合がございますので、ご理解ください。  </p><h3 id="パフォーマンス-チューニングについて"><a href="#パフォーマンス-チューニングについて" class="headerlink" title="パフォーマンス チューニングについて"></a>パフォーマンス チューニングについて</h3><p>サポートからは、パフォーマンスに影響する一般的な事例や対応策をご案内することは可能ですが、お客様環境固有のカスタマイズに応じたチューニングを行うことはご支援の対象外となります。<br>また、パフォーマンスへ影響を与えている処理を特定いただき、製品プラットフォーム側に原因があるかの調査は可能ですが、カスタマイズ部分に原因がある場合は、改善方法のご提案はご支援の対象外となります。  </p><p><strong>例）以下のようなお問い合わせは、テクニカル サポートのご支援の対象外となります</strong> </p><ul><li>あるキャンバスアプリにおいて、検索処理に時間を要している。<br>アプリを提供するので、パフォーマンス改善のために実施すべき内容を教えてほしい。 </li><li>特定のクラウドフローにおいて、スロットリングが頻繁に発生し、フローの処理が遅くなっている。スロットリングを発生させないようなフローの修正方法があれば教えてほしい。 </li></ul><h3 id="説明資料の作成やレビューについて"><a href="#説明資料の作成やレビューについて" class="headerlink" title="説明資料の作成やレビューについて"></a>説明資料の作成やレビューについて</h3><p>説明資料の作成やレビューは、テクニカル サポートでは承っておりません。</p><h3 id="プレビュー機能について"><a href="#プレビュー機能について" class="headerlink" title="プレビュー機能について"></a>プレビュー機能について</h3><p>プレビュー機能は、”現状のまま”、”不具合とともに” 利用可能な機能としてご提供しています。<br>不具合を確認した場合、事象により開発部門にフィードバックを行うことはございますが、修正のお約束はできないことをご了承ください。<br>また、機能強化のご要望がございましたら、Ideas サイトまでご投稿ください。<br><a href="https://ideas.powerapps.com/">Power Apps Ideas</a><br><a href="https://ideas.powerautomate.com/">Power Automate Ideas</a><br><a href="https://ideas.powervirtualagents.com/">Power Virtual Agents Ideas</a>  </p><h3 id="サポート外の機能について"><a href="#サポート外の機能について" class="headerlink" title="サポート外の機能について"></a>サポート外の機能について</h3><p>以下のようなサービス・機能は、テクニカル サポートでのご支援の対象外です。<br>テクニカル サポート以外のお問い合わせ先があるものもございますので、それぞれ適切なお問い合わせ先へのご起票をお願いいたします。  </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/guidance/coe/starter-kit">CoE スターターキット</a> (問合せ先: <a href="https://aka.ms/coe-starter-kit-issues">aka.ms/coe-starter-kit-issues</a>)</li><li><a href="https://learn.microsoft.com/ja-jp/power-automate/guidance/automation-kit/overview/introduction">Automation Kit</a> (問合せ先: <a href="https//aka.ms/automation-kit-issues">aka.ms/automation-kit-issues</a>)</li><li>PowerShell コマンド </li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/teams/use-sample-apps-from-teams-store">Power Apps for Teams のサンプルアプリ</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/open-and-run-a-sample-app">Power Apps のテンプレートアプリ</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-platform/alm/devops-build-tools">Power Apps Build Tool</a> (問合せ先: <a href="https://powerusers.microsoft.com/t5/Power-Apps-Pro-Dev-ISV/bd-p/pa_component_framework">Power Apps component framework, ALM &amp; Pro Dev forum</a>)</li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/developer/data-platform/tools/devtools-install">Power Platform Tools</a> (問合せ先: <a href="https://github.com/microsoft/powerplatform-vscode/issues">https://github.com/microsoft/powerplatform-vscode/issues</a>)</li><li>Microsoft Lobe (問合せ先: <a href="https://www.lobe.ai/docs/welcome/welcome">Lobe Community or Contact Us</a>)</li></ul><h3 id="公開情報の修正依頼・追加依頼について"><a href="#公開情報の修正依頼・追加依頼について" class="headerlink" title="公開情報の修正依頼・追加依頼について"></a>公開情報の修正依頼・追加依頼について</h3><p>我々サポートチームは、責任をもってお客様にご回答を差し上げておりますため、障害発生時や製品に不具合が発生している場合、サポートからの回答をもってマイクロソフトからの正式なご案内とさせていただく場合がございます。<br>公開情報に情報の記載がない場合、サポートチームよりフィードバックすることは可能ですが、情報の記載をお約束することはできかねますので、ご了承ください。  </p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p> 以下の記事も併せてお読みください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-overview">サポートの概要 | Microsoft Learn</a><br><a href="https://www.microsoft.com/ja-jp/services/professional-supportqa.aspx">プロフェッショナル サポートをご利用の皆様へ - Microsoft Services</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームです。&lt;br&gt;今回は、Power Apps/Power Automate/Power Virtual Agents のお問い合わせをいただく際の留意事項、ご協力いただきたい事項についてご紹介します。  &lt;/p&gt;
&lt;p&gt;我々サポートチームといたしましては、できる限りお客様のお役に立てるよう、日々調査に努めておりますが、お客様の協力があって初めてご支援ができることも多くございます。&lt;br&gt;また、クラウドサービスの性質や、成長スピードの速い Power Platform という製品の性質上、また情報保護の観点から、どうしてもお客様への情報のご提供が難しい場合もございます。  &lt;/p&gt;
&lt;p&gt;サポートをご利用いただくうえでは、以下のような点にご留意ください。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="サポート" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88/"/>
    
  </entry>
  
  <entry>
    <title>非アクティブな開発者環境の自動削除について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Developer-environments/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/Automatic-deletion-of-inactive-Developer-environments/</id>
    <published>2023-04-11T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.208Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの山田です。<br><br>今回は、Power Platform の開発者環境の自動削除について、下記項目の順にご説明いたします。  </p><ol><li>開発者環境の自動無効化/削除メカニズムとは  </li><li>自動無効化/削除条件  </li><li>自動無効化/削除メカニズム自体の無効化の可否  </li><li>無効化/削除された環境の復元  </li><li>ご案内メール  </li><li>ご案内メールを受信された際の対応   </li><li>よくあるご質問  </li></ol><p>下記公開情報を基にご説明いたします。<br><a href="https://learn.microsoft.com/en-us/power-platform/admin/automatic-environment-cleanup">Automatic environment cleanup (英語)</a><br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/automatic-environment-cleanup">自動環境クリーンアップ (上記の日本語訳)</a><br>各項目について公開情報内にも詳細を記載しておりますのでご参照ください。<br><br>なお、英語のページが更新されてから、日本語訳のページに同様の内容が反映されるまでに時間がかかる場合がございます。<br><br>そのため、最新情報については英語版も併せてご確認いただけますと幸いでございます。<br><br><br><br></p><span id="more"></span>  <hr><p>本内容については、メッセージセンターにても <strong>MC538688</strong> (※) をご確認いただけますと幸いでございます。<br><br>※日本リージョンのテナントの場合の番号となります。<br><br>下図は 2023 年 4 月 10 時点での本メカニズムの停止に関するメッセージセンターの通知となります。<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Developer-environments/MC538688%20.png"><br><br><br><br></p><h2 id="1-開発者環境の自動無効化-削除メカニズムとは"><a href="#1-開発者環境の自動無効化-削除メカニズムとは" class="headerlink" title="1. 開発者環境の自動無効化/削除メカニズムとは"></a>1. 開発者環境の自動無効化/削除メカニズムとは</h2><p>本メカニズムは 2023 年 4 月中旬より徐々に展開されます。<br>ユーザーによる活動のない期間 (=非アクティブ期間) が 90 日間続いた場合、対象の開発者環境が無効化されます。<br>無効化状態が 30 日継続しますと、対象環境が自動削除されます。<br></p><p>無効化された環境では、アプリやフロー、チャットボット等がご利用いただけません。<br><br><br></p><h2 id="2-開発者環境の自動無効化-削除条件"><a href="#2-開発者環境の自動無効化-削除条件" class="headerlink" title="2. 開発者環境の自動無効化/削除条件"></a>2. 開発者環境の自動無効化/削除条件</h2><p>対象環境におけるユーザーのアプリ起動などの活動が設定期間中に実施されない場合、自動削除の対象となります。<br><br>対象の活動は下記の通りです。</p><ul><li> ユーザーの活動: アプリの起動、フローの実行、Power Virtual Agents ボットとのチャット</li><li>作成者の活動: アプリ、フロー 、Power Virtual Agents ボット、カスタム コネクタの作成、読み取り、更新、削除</li><li>管理者の活動: コピー、削除、バックアップ、復元、リセットなどの環境操作</li></ul><h2 id="3-開発者環境の自動無効化-削除メカニズム自体の無効化の可否"><a href="#3-開発者環境の自動無効化-削除メカニズム自体の無効化の可否" class="headerlink" title="3. 開発者環境の自動無効化/削除メカニズム自体の無効化の可否"></a>3. 開発者環境の自動無効化/削除メカニズム自体の無効化の可否</h2><p>本メカニズムは無効化いただくことが出来ません。<br><br>何卒ご理解いただけますと幸いでございます。<br><br><br></p><h2 id="4-自動無効化-削除された環境の復元"><a href="#4-自動無効化-削除された環境の復元" class="headerlink" title="4. 自動無効化/削除された環境の復元"></a>4. 自動無効化/削除された環境の復元</h2><p>環境無効化後、30 日以内であれば環境の再有効化が可能でございます。<br><br>また、環境削除後も、7 日以内であれば環境の復元が可能でございます。<br><br>どちらもPower Platform 管理センターよりご実施いただけます。<br></p><p><strong>無効となった開発者環境の再有効化</strong><br><br>① Power Platform 管理センター にサインイン<br><br>② 環境 &gt; 無効化された 開発者環境を選択<br><br>③ 環境ページで 「環境を再度有効にする」を選択<br><br><br><br><strong>削除された開発者環境の復元</strong><br>① Power Platform 管理センター にサインイン<br><br>② 環境 &gt; 「削除された環境を復元する」を選択<br><br>③ 復元する対象環境 &gt; 復元 を選択<br><br><br><br>環境の復元の詳細については下記公開情報をご参照ください。<br><br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/recover-environment">環境の回復</a><br><br><br></p><p> 　　  </p><h2 id="5-ご案内メール"><a href="#5-ご案内メール" class="headerlink" title="5. ご案内メール"></a>5. ご案内メール</h2><p>対象環境の無効化が実施される 7 日前より、その旨についてのご案内メールが次のユーザーに通知されます。<br></p><ul><li>環境の管理者</li><li>対象開発者環境の作成者</li></ul><h2 id="6-無効化対象のご案内メールを受信された際の対応"><a href="#6-無効化対象のご案内メールを受信された際の対応" class="headerlink" title="6. 無効化対象のご案内メールを受信された際の対応"></a>6. 無効化対象のご案内メールを受信された際の対応</h2><p>下記 2 通りの方法にて、無効化対象となる非アクティブな期間のカウントを一旦リセットいただけます。<br></p><ul><li>対象環境において、アプリやフローのご実行など上述のユーザー活動を実施</li><li>Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」を実行</li></ul><h2 id="7-よくあるご質問"><a href="#7-よくあるご質問" class="headerlink" title="7. よくあるご質問"></a>7. よくあるご質問</h2><p><strong>Q：開発者環境とは何か。無効化された場合、どのような影響があるか?</strong><br>A：開発者環境は、Power Apps 開発者プランライセンスを持つユーザーが作成できます。<br><br>無効化されると、環境内に作成されていたアプリやフロー、チャットボット等がご利用いただけなくなります。<br><br>開発者環境の詳細については、下記公開情報をご参照ください。<br><br><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan">Power Apps 開発者プランにサインアップ</a><br><br><br></p><p><strong>Q：開発者環境にて無効化される際に配信される通知メールを配信停止することは可能か?</strong><br>A：恐れ入りますが、メール配信を停止することのできる機能はございません。<br><br>製品動作としてご理解賜りますようお願い申し上げます。<br><br><br></p><p><strong>Q：Power Platform 管理センターの対象環境ページにて、「環境活動をトリガーする」の実行は、通常ユーザにて操作可能なものか?</strong><br>A：Power Platform 管理センターにて開発者環境の「環境活動をトリガーする」を実行できるユーザーは以下の通りでございます。<br></p><ul><li>対象開発者環境の作成者</li><li>グローバル管理者</li><li>Power Platform 管理者</li><li>Dynamics 365 管理者</li></ul><p><strong>Q：「環境活動をトリガーする」を実行すると、有効期限は何日まで延びるのか?</strong><br>A：有効期限は90日間延長され、その 90 日の期間中に、対象環境におけるユーザーのアプリ起動などの活動が実施されない場合、<br><br>再び自動削除の対象となり、7 日前 (トリガー実行から 83 日後) にメールにて通知されます。<br><br><br></p><p><strong>Q：無効化される環境内のアプリ等の詳細については、どこから確認できるか?</strong><br>A：下記より対象環境内のアプリ等をご確認いただけます。<br><br>Power Platform 管理センター &gt; 環境 &gt; 対象環境 &gt; リソース<br><br><img src="/blog/powerplatform/Automatic-deletion-of-inactive-Developer-environments/ppac-resource.png"><br><br><br></p><p><strong>Q：再有効化した場合、無効化前の情報が維持されるか?</strong><br>A：再有効化後または復元後は、無効前の情報が維持されます。<br><br>完全に削除されてしまいますと、無効化前の情報は復元できなくなりますのでご注意ください。<br><br><br></p><p>免責事項<br><br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの山田です。&lt;br&gt;&lt;br&gt;今回は、Power Platform の開発者環境の自動削除について、下記項目の順にご説明いたします。  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;開発者環境の自動無効化/削除メカニズムとは  &lt;/li&gt;
&lt;li&gt;自動無効化/削除条件  &lt;/li&gt;
&lt;li&gt;自動無効化/削除メカニズム自体の無効化の可否  &lt;/li&gt;
&lt;li&gt;無効化/削除された環境の復元  &lt;/li&gt;
&lt;li&gt;ご案内メール  &lt;/li&gt;
&lt;li&gt;ご案内メールを受信された際の対応   &lt;/li&gt;
&lt;li&gt;よくあるご質問  &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下記公開情報を基にご説明いたします。&lt;br&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/power-platform/admin/automatic-environment-cleanup&quot;&gt;Automatic environment cleanup (英語)&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-platform/admin/automatic-environment-cleanup&quot;&gt;自動環境クリーンアップ (上記の日本語訳)&lt;/a&gt;&lt;br&gt;各項目について公開情報内にも詳細を記載しておりますのでご参照ください。&lt;br&gt;&lt;br&gt;なお、英語のページが更新されてから、日本語訳のページに同様の内容が反映されるまでに時間がかかる場合がございます。&lt;br&gt;&lt;br&gt;そのため、最新情報については英語版も併せてご確認いただけますと幸いでございます。&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="Environment" scheme="https://jpdynamicscrm.github.io/blog/tags/Environment/"/>
    
    <category term="Developer Environment" scheme="https://jpdynamicscrm.github.io/blog/tags/Developer-Environment/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse の監査ログをエクスポートする方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/export-audit-log/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/export-audit-log/</id>
    <published>2023-04-01T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.288Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチーム鈴木です。  </p><p>Dataverse の監査ログは、レコードに対する変更履歴を監査概要ビューで表示することができます。<br>Dataverse の監査ログの取得や、確認方法については下記公開情報をご参照ください。<br>(ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/manage-dataverse-auditing">Dataverse 監査を管理する</a>)  </p><p>サポートチームでは、監査概要ビューの内容をエクスポートしたい、というお問合せをいただくことがありますが、2023年4月現在では、Dataverse 監査ログのエクスポート機能を提供していません。<br>そこで、今回は XRMToolBox というサードパーティ製のツールを使用したエクスポート方法をご紹介します。<br>XRMToolBox 自体は、当社提供のツールではないため、詳細な使用方法やエラーに対する対処は製品提供元へご確認いただく必要があることをご了承いただいた上で、ご利用いただけますと幸いです。  </p><span id="more"></span><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><hr><p>XRMToolBox とは、Dataverse に接続し、操作できる Windows アプリケーションとなります。<br>事前にインストールし、接続設定を行うことで、Web API でしか実行できないような Dataverse 環境に対する様々なアクションを GUI 操作によって可能にします。  </p><ol><li><p>XRMToolBox を以下のサイトよりダウンロードします。<br> URL: <a href="https://www.xrmtoolbox.com/">https://www.xrmtoolbox.com/</a></p></li><li><p>XRMToolBox アプリケーションを開きます。  </p></li><li><p>Configuration タブより Manage connections を選択します。<br> <img src="/blog/powerplatform/export-audit-log/image01.png"></p></li><li><p>New Connection &gt; Connection Wizard をクリックします。  </p></li><li><p>Organization url に対象の Dataverse 環境の URL を入力し、Next をクリックします。<br> <img src="/blog/powerplatform/export-audit-log/image02.png"></p></li><li><p>環境にサインイン可能な Username と Password を入力し、Next を選択します。<br> <img src="/blog/powerplatform/export-audit-log/image03.png"></p></li><li><p>Connection に任意の名前を入力し、Finish を選択します。  </p></li><li><p>Connection が作成されたことを確認し、Connections Manager ウィンドウを閉じます。  </p></li></ol><p>これで、XRM ToolBox のインストールと Dataverse 環境への接続が完了です。  </p><h2 id="ツールのインストール"><a href="#ツールのインストール" class="headerlink" title="ツールのインストール"></a>ツールのインストール</h2><hr><p>XRM ToolBox には、様々なツールが存在しますが、今回は監査ログをエクスポートするための、Attribute Audit Explorer というツールを使用します。<br>Attribute Audit Explorer の詳細については、下記をご参照ください。<br>(ご参考 : <a href="hhttps://www.xrmtoolbox.com/plugins/MESquare.XrmToolBox.AuditExplorer/">Audit Explorer Plugin</a>)  </p><ol><li><p>Configuration &gt; Tool Libraryを開き、Audit Explorer Plugin にチェックし Install をクリックします。<br> <img src="/blog/powerplatform/export-audit-log/image04.png"></p></li><li><p>Tool Library ウィンドウを閉じます。  </p></li></ol><h2 id="Audit-Explorer-Plugin-を使用して、Dataverse-の監査ログをエクスポートする。"><a href="#Audit-Explorer-Plugin-を使用して、Dataverse-の監査ログをエクスポートする。" class="headerlink" title="Audit Explorer Plugin を使用して、Dataverse の監査ログをエクスポートする。"></a>Audit Explorer Plugin を使用して、Dataverse の監査ログをエクスポートする。</h2><hr><ol><li><p>Tools ウィンドウ で Attribute Audit Explorer をダブルクリックで開きます。<br> <img src="/blog/powerplatform/export-audit-log/image05.png"></p></li><li><p>「Do you want to connect to an organization first?」というダイアログが表示された場合は「はい」を選択し、作成した Connection 先を選び Connect をクリックしてください。  </p></li><li><p>Load Entities をクリックします。<br><img src="/blog/powerplatform/export-audit-log/image06.png"></p></li><li><p>監査が有効化されているテーブルが表示されますので、ログを取得したいテーブルと取得する監査ログの日時を選択します。<br> *Before が取得終了日、After が取得開始日になりますので、ご注意ください。<br><img src="/blog/powerplatform/export-audit-log/image07.png"></p></li><li><p>Export to Excel をクリックすると、監査ログが csvファイル形式で出力されます。<br><img src="/blog/powerplatform/export-audit-log/image08.png"></p></li></ol><p>なお出力する列は、オプションで選択可能です。<br>   <img src="/blog/powerplatform/export-audit-log/image09.png"></p><h2 id="エクスポートした監査ログの確認"><a href="#エクスポートした監査ログの確認" class="headerlink" title="エクスポートした監査ログの確認"></a>エクスポートした監査ログの確認</h2><hr><p>エクスポートした csv ファイルでは、各フィールドの値を一覧で確認できます。<br>   <img src="/blog/powerplatform/export-audit-log/image10.png"></p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><hr><p>Microsoft 365 のコンプライアンスセンターから Dataverse に関する監査ログを確認し、エクスポートする方法もあります。<br>しかし現時点では、Dataverse 環境に関しては監査概要ビューから確認することで、レコードに対する変更履歴が分かりやすく表示されるため、ご利用いただいているユーザー様も多数いらっしゃるかと思います。<br>監査概要ビューでは提供していないエクスポート機能が、XRMToolBox を利用することで可能となりますので、ぜひご活用いただけますと幸いです。  </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチーム鈴木です。  &lt;/p&gt;
&lt;p&gt;Dataverse の監査ログは、レコードに対する変更履歴を監査概要ビューで表示することができます。&lt;br&gt;Dataverse の監査ログの取得や、確認方法については下記公開情報をご参照ください。&lt;br&gt;(ご参考 : &lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-platform/admin/manage-dataverse-auditing&quot;&gt;Dataverse 監査を管理する&lt;/a&gt;)  &lt;/p&gt;
&lt;p&gt;サポートチームでは、監査概要ビューの内容をエクスポートしたい、というお問合せをいただくことがありますが、2023年4月現在では、Dataverse 監査ログのエクスポート機能を提供していません。&lt;br&gt;そこで、今回は XRMToolBox というサードパーティ製のツールを使用したエクスポート方法をご紹介します。&lt;br&gt;XRMToolBox 自体は、当社提供のツールではないため、詳細な使用方法やエラーに対する対処は製品提供元へご確認いただく必要があることをご了承いただいた上で、ご利用いただけますと幸いです。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="Model-driven app" scheme="https://jpdynamicscrm.github.io/blog/tags/Model-driven-app/"/>
    
    <category term="Dynamics" scheme="https://jpdynamicscrm.github.io/blog/tags/Dynamics/"/>
    
  </entry>
  
  <entry>
    <title>Power Apps キャンバス アプリ お問い合わせの際の情報取得手順</title>
    <link href="https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/"/>
    <id>https://jpdynamicscrm.github.io/blog/canvasapp/troubleshooting-general-canvasapp/</id>
    <published>2023-03-30T15:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.076Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの谷です。<br/><br>弊社サポートでは、キャンバス アプリが動作しない、エラーが発生する、等のトラブルシューティングにおいて、お問い合わせの内容をもとに調査方針を立てておりますが、発生している事象を明確に把握するため、ご利用者様の環境で発生している事象の切り分けや情報提供をお願いすることがあります。<br/><br>この記事では、キャンバス アプリのトラブルシューティングを行うにあたって、必要となる情報の取得手順をご説明します。</p><span id="more"></span><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>キャンバス アプリ編集時、また実行時に発生する問題解決におけるお問い合わせの際の情報取得手順についてご説明します。</p><hr><ol><li><a href="#anchor-about-situation">事象の発生状況</a></li><li><a href="#anchor-about-screencapture">事象発生時のエラーメッセージや画面キャプチャ・動画</a></li><li><a href="#anchor-about-appchecker">アプリ チェッカーのエラーメッセージ　※編集中のみ</a></li><li><a href="#anchor-about-versions">Power Apps バージョン</a><ul><li><a href="#anchor-about-versions-edit">キャンバス アプリ 編集時</a></li><li><a href="#anchor-about-versions-play">キャンバス アプリ 実行時</a></li></ul></li><li><a href="#anchor-about-monitorlog">Power Apps モニターログ</a><ul><li><a href="#anchor-about-monitorlog-edit">キャンバス アプリ 編集時</a></li><li><a href="#anchor-about-monitorlog-web-play">キャンバス アプリ 実行時 (Webブラウザ) </a></li><li><a href="#anchor-about-monitorlog-mobile-play">キャンバス アプリ 実行時 (モバイル アプリ) </a></li></ul></li><li><a href="#anchor-about-networkhar">Webブラウザのネットワーク トレース・コンソール ログ</a></li><li><a href="#anchor-about-sessionid">セッションID</a><ul><li><a href="#anchor-about-sessionid-web-edit">編集セッション</a></li><li><a href="#anchor-about-sessionid-web-play">実行セッション (Webブラウザ) </a></li><li><a href="#anchor-about-sessionid-mobile-play">実行セッション (モバイル アプリ) </a></li><li><a href="#anchor-about-sessionid-web-sharepointcustomform">実行セッション (SharePoint カスタムフォーム ) </a></li></ul></li><li><a href="#anchor-about-app-tenant-ids">アプリURL (アプリID、テナントID) </a></li><li><a href="#anchor-about-enviromentid">環境ID</a></li><li><a href="#anchor-about-canvasapp">アプリ</a><ul><li><a href="#anchor-about-canvasapp-published">公開済みアプリ</a></li><li><a href="#anchor-about-canvasapp-edit">編集中アプリ</a></li><li><a href="#anchor-about-canvasapp-solutionapp">ソリューション アプリ</a></li><li><a href="#anchor-about-canvasapp-spocustomform">SharePoint カスタムフォーム</a></li><li><a href="#anchor-about-canvasapp-componentlibrary">コンポーネント単体</a></li></ul></li></ol><h2 id="情報取得手順"><a href="#情報取得手順" class="headerlink" title="情報取得手順"></a>情報取得手順</h2><p><a id='anchor-about-situation'></a></p><h3 id="1-事象の発生状況"><a href="#1-事象の発生状況" class="headerlink" title="1. 事象の発生状況"></a>1. 事象の発生状況</h3><p>エラーや意図しない状況がどのような状況下で発生するかお知らせください。<br/><br>事象の発生条件を見極めることで、問題の箇所を特定するだけではなく、弊社環境で動作検証を行い再現するかどうか確認することができます。<br/><br>例えば、以下の情報をお知らせいただくことでより明確に事象を把握することができます。</p><ul><li>事象が発生するタイミング<ul><li>いつから発生しているか・現在も継続して発生しているか</li><li>どれぐらいの頻度で発生しているか</li><li>発生前後で何らかの変更を行ったか</li></ul></li><li>事象が発生する端末の差異</li><li>事象が発生しているユーザーと事象が発生していないユーザーの差異<ul><li>事象の内容によりユーザーのメールアドレス情報やユーザープリンシパル名をご提供いただく場合があります</li></ul></li><li>キャンバス アプリをご利用いただいている端末のネットワーク環境の差異 (プロキシ経由で利用など)</li><li>事象が発生している Web ブラウザの差異 (Microsoft Edge、Google Chrome、Firefoxなど)<ul><li>Web ブラウザのプラグインや拡張機能の有無</li></ul></li><li>事象の発生環境 (Power Apps モバイルアプリ/Web ブラウザ)</li></ul><p><a id='anchor-about-screencapture'></a></p><h3 id="2-事象発生時のエラーメッセージや画面キャプチャ・動画"><a href="#2-事象発生時のエラーメッセージや画面キャプチャ・動画" class="headerlink" title="2. 事象発生時のエラーメッセージや画面キャプチャ・動画"></a>2. 事象発生時のエラーメッセージや画面キャプチャ・動画</h3><p>エラーの内容を具体的に表すメッセージや画面キャプチャなどの情報をお寄せください。<br/><br>事象再現時の動画がありますと事象の発生状況をより正確に把握することができます。</p><h4 id="エラーメッセージや画面キャプチャ"><a href="#エラーメッセージや画面キャプチャ" class="headerlink" title="エラーメッセージや画面キャプチャ"></a>エラーメッセージや画面キャプチャ</h4><p>エラーの内容が分かるよう画面キャプチャをご取得ください。<br/><br>エラーメッセージ内にタイムスタンプや何らかのエラーコードが記載されている場合はそれらの情報を <strong>テキスト形式</strong> でご取得ください。</p><h4 id="動画"><a href="#動画" class="headerlink" title="動画"></a>動画</h4><p>以下の2つの方法で事象発生時の動画をご取得ください。</p><ul><li><p><code>Windows + G</code> での画面収録</p><ol><li>Web ブラウザを起動します</li><li>Web ブラウザの画面を一度クリックしたのち、<code>Windows キー + G</code> を押下します</li><li>「●」から画面キャプチャを開始します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image01.png"></li><li>事象を発生させます</li><li>画面キャプチャを停止します</li><li>録画ファイルが保存されます</li></ol></li><li><p>Teams 会議の録画機能</p><ol><li>Teams 会議を開始します</li><li>「Start Recording」を選択し、録画を開始します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image02.png"></li><li>画面共有し、事象を発生させます</li><li>Teams 会議を終了します (録画も停止します)</li><li>録画ファイルを保存します</li></ol></li></ul><p><a id='anchor-about-appchecker'></a></p><h3 id="3-アプリ-チェッカーのエラーメッセージ-※編集中のみ"><a href="#3-アプリ-チェッカーのエラーメッセージ-※編集中のみ" class="headerlink" title="3. アプリ チェッカーのエラーメッセージ ※編集中のみ"></a>3. アプリ チェッカーのエラーメッセージ ※編集中のみ</h3><p>キャンバス アプリ編集中の場合、Power Apps Studio のアプリ チェッカーにエラーメッセージが記録されます。<br/><br>エラーが発生している処理 (関数やコントロール等) と併せてアプリ チェッカーに記録されているエラーメッセージをご提供ください。</p><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>対象のアプリの編集画面を表示します</li><li>事象を発生させます</li><li>アプリ チェッカーに記録されるエラーメッセージを <strong>画面キャプチャ</strong> などで取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image03.png"></li></ol><p><a id='anchor-about-versions'></a></p><h3 id="4-Power-Apps-バージョン"><a href="#4-Power-Apps-バージョン" class="headerlink" title="4. Power Apps バージョン"></a>4. Power Apps バージョン</h3><p>バージョン差異による問題かどうかお調べする際に使用します。</p><p><a id='anchor-about-versions-edit'></a></p><h4 id="キャンバス-アプリ-編集時"><a href="#キャンバス-アプリ-編集時" class="headerlink" title="キャンバス アプリ 編集時"></a>キャンバス アプリ 編集時</h4><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>対象のアプリ編集画面を表示します</li><li>メニュー「設定」&gt;「サポート」を選択します</li><li>作成バージョンを <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image04.png"></li></ol><p><a id='anchor-about-versions-play'></a></p><h4 id="キャンバス-アプリ-実行時"><a href="#キャンバス-アプリ-実行時" class="headerlink" title="キャンバス アプリ 実行時"></a>キャンバス アプリ 実行時</h4><p>本手順にてキャンバス アプリのリリース バージョンをご取得いただき、さらに、事象が発生している端末においてライブ バージョンをご取得ください。<br/><br>ライブ バージョンはセッション情報から取得します。<br/><br>Web ブラウザで事象が発生している場合、<a href="#anchor-about-sessionid-web-play">セッションID (Webブラウザ)</a> をご参照ください。<br/><br>モバイル アプリで事象が発生している場合、<a href="#anchor-about-sessionid-mobile-play">セッションID (モバイルアプリ)</a> をご参照ください。</p><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>対象のアプリの「…」メニュー&gt;「詳細」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image05.png"></li><li>「バージョン」タブを押下し、Power Apps リリース バージョンを <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image06.png"></li></ol><p><a id='anchor-about-monitorlog'></a></p><h3 id="5-Power-Apps-モニターログ"><a href="#5-Power-Apps-モニターログ" class="headerlink" title="5. Power Apps モニターログ"></a>5. Power Apps モニターログ</h3><p>キャンバス アプリ編集中、あるいは実行中に発生するイベントの記録をご提供ください。<br/><br>アプリ実行中のイベントを確認することで発生している事象を正確に把握することができます。</p><p>以下ブログ記事でもモニターログの取得方法をご説明しています。<br/><br><a href="https://jpdynamicscrm.github.io/blog/canvasapp/Canvas-app-monitor/">キャンバス アプリのモニターログ取得手順</a></p><p><a id='anchor-about-monitorlog-edit'></a></p><h4 id="キャンバス-アプリ-編集時-1"><a href="#キャンバス-アプリ-編集時-1" class="headerlink" title="キャンバス アプリ 編集時"></a>キャンバス アプリ 編集時</h4><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にアクセスします</li><li>アプリ一覧画面から対象のアプリの編集画面を表示します  </li><li>画面左方にある　高度なツール &gt; 監視 &gt; モニターを開く を選択します<ul><li>別タブで監視ウィンドウが表示されます<br/><br><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage04.png"></li></ul></li><li>アプリ編集画面に戻り、事象を発生させます</li><li>監視ウィンドウに移動し、記録されたモニター結果を「ダウンロード」します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage03.png"></li><li>ダウンロードしたファイル (PowerAppsTraceEvents.json) をご提供ください</li></ol><p><a id='anchor-about-monitorlog-web-play'></a></p><h4 id="キャンバス-アプリ-実行時-Web-ブラウザ"><a href="#キャンバス-アプリ-実行時-Web-ブラウザ" class="headerlink" title="キャンバス アプリ 実行時 (Web ブラウザ)"></a>キャンバス アプリ 実行時 (Web ブラウザ)</h4><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にアクセスします</li><li>アプリ一覧画面から対象のアプリの「…」メニューを表示し、「監視」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage01.png"></li><li>別タブで監視ウィンドウが表示されるので「公開したアプリの再生」を行います<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage02.png"></li><li>別タブでアプリが再生されるので事象を発生させます<br/></li><li>手順3で表示した監視ウィンドウに移動し、記録されたモニター結果を「ダウンロード」します <br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage03.png"></li><li>ダウンロードしたファイル (PowerAppsTraceEvents.json) をご提供ください</li></ol><p><a id='anchor-about-monitorlog-mobile-play'></a></p><h4 id="キャンバス-アプリ-実行時-モバイル-アプリ"><a href="#キャンバス-アプリ-実行時-モバイル-アプリ" class="headerlink" title="キャンバス アプリ 実行時 (モバイル アプリ)"></a>キャンバス アプリ 実行時 (モバイル アプリ)</h4><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にアクセスします</li><li>アプリ一覧画面から対象のアプリの「…」メニューを表示し、「監視」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage05.png"></li><li>ユーザー接続からセッションへのユーザー接続メニューを開きます<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage06.png"></li><li>Power Apps モバイルで使用するユーザーを追加しリンクを入手します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage07.png"></li><li>得られたリンクをメールやチャットなどでモバイル端末に送ります</li><li>モバイル端末で URL へアクセスすると、 Power Apps モバイルが起動されますので事象を発生させます<ul><li>下図のとおり、デバックセッションに接続する旨メッセージが表示されます<br/><br><img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage08.png"></li></ul></li><li>モニターログに Power Apps モバイルの操作が記録されます<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/uImage09.png"></li><li>記録されたモニター結果を「ダウンロード」します </li><li>ダウンロードしたファイル (PowerAppsTraceEvents.json) をご提供ください</li></ol><p><a id='anchor-about-networkhar'></a></p><h3 id="6-Web-ブラウザのネットワーク-トレース・コンソール-ログ"><a href="#6-Web-ブラウザのネットワーク-トレース・コンソール-ログ" class="headerlink" title="6. Web ブラウザのネットワーク トレース・コンソール ログ"></a>6. Web ブラウザのネットワーク トレース・コンソール ログ</h3><p>キャンバス アプリ編集中、あるいは実行中に発生する HTTP リクエストの記録をご提供ください。<br/><br>Power Apps サービスへ送信する HTTP リクエストや Power Apps サービスから受信する HTTP レスポンスの内容を確認することで通信上の問題を特定します。<br/><br>※事象の内容により、netsh trace コマンドやサードパーティ製のツール「Fiddler」によるネットワーク キャプチャの取得をお願いする場合があります。</p><ol><li>Web ブラウザを起動します</li><li>事象が発生する画面を表示します</li><li>手順 2 で表示している画面 (タブ) 上で <code>F12</code> を押下してブラウザの開発者ツールを開始します<ul><li>「ログの保持」・「キャッシュを無効にする」にチェックを入れます (❶・❷)</li></ul></li><li><code>F5</code> を押下して画面を再読み込み後、事象が発生する操作を行います</li><li>ブラウザ開発者ツールに戻り、Networkタブの赤色の [Stop recording network log] アイコンをクリックします(❸)</li><li>[Export HAR] のアイコンをクリックし、任意のファイル名で保存します(❹)</li><li>Console タブをクリックし、表示されるすべての情報をコピーして <strong>テキスト形式</strong> で保存します(❺)</li></ol><p><img src="/blog/canvasapp/troubleshooting-general-canvasapp/image07.png"></p><p><a id='anchor-about-sessionid'></a></p><h3 id="7-セッション-ID"><a href="#7-セッション-ID" class="headerlink" title="7. セッション ID"></a>7. セッション ID</h3><p>セッション情報から Power Apps サービス側の記録を確認し、発生している事象を調査します。</p><h4 id="Web-ブラウザ"><a href="#Web-ブラウザ" class="headerlink" title="Web ブラウザ"></a>Web ブラウザ</h4><p><a id='anchor-about-sessionid-web-edit'></a></p><ul><li>キャンバス アプリ編集時<ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>アプリ一覧画面から対象のアプリのアプリ編集画面を表示します</li><li>メニュー「設定」を選択します</li><li>ポップアップの左メニューから「サポート」を選択します</li><li>「セッション詳細」を押下し、セッション ID を <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image08.png"></li></ol></li></ul><p><a id='anchor-about-sessionid-web-play'></a></p><ul><li>キャンバス アプリ実行時<ol><li>対象のアプリを実行します</li><li>画面右上部の歯車アイコンを押下します</li><li>「セッション詳細」を選択し、Power Apps ライブ バージョンを含む、表示されている情報をすべてを <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image09.png"></li></ol></li></ul><p><a id='anchor-about-sessionid-mobile-play'></a></p><h4 id="モバイル-アプリ"><a href="#モバイル-アプリ" class="headerlink" title="モバイル アプリ"></a>モバイル アプリ</h4><ol><li>Power Apps モバイル アプリを起動します</li><li>画面左上部のユーザーアイコンを押下します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image10.png"></li><li>「バージョン情報」を <strong>テキスト形式</strong> でお手元に控えます<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image11.png"></li><li>「セッション詳細」を押下します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image12.png"></li><li>クリップボードにコピーされた セッション ID を <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image13.png"></li></ol><p><a id='anchor-about-sessionid-web-sharepointcustomform'></a></p><h4 id="SharePoint-カスタム-フォーム等、埋め込みのキャンバス-アプリ"><a href="#SharePoint-カスタム-フォーム等、埋め込みのキャンバス-アプリ" class="headerlink" title="SharePoint カスタム フォーム等、埋め込みのキャンバス アプリ"></a>SharePoint カスタム フォーム等、埋め込みのキャンバス アプリ</h4><ol><li><code>Alt</code> キーを押下しながらフォームを右クリックします</li><li>「セッション詳細」を押下し、セッション ID を <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image14.png"></li></ol><p><a id='anchor-about-app-tenant-ids'></a></p><h3 id="8-アプリ-URL-アプリ-ID、テナント-ID"><a href="#8-アプリ-URL-アプリ-ID、テナント-ID" class="headerlink" title="8. アプリ URL (アプリ ID、テナント ID)"></a>8. アプリ URL (アプリ ID、テナント ID)</h3><p>アプリ ID、テナント ID の情報から Power Apps サービス側の記録を確認し、発生している事象を調査します。</p><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にアクセスします</li><li>アプリ一覧画面から対象のアプリの「…」メニューを押下し、「詳細」を選択します</li><li>Web リンク、アプリ ID を <strong>テキスト形式</strong> で取得します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image15.png"></li></ol><p><a id='anchor-about-enviromentid'></a></p><h3 id="9-環境-ID"><a href="#9-環境-ID" class="headerlink" title="9. 環境 ID"></a>9. 環境 ID</h3><p>環境 ID の情報から Power Apps サービス側の記録を確認し、発生している事象を調査します。</p><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にアクセスします</li><li>事象が発生している環境に切り替えます (❶)</li><li>画面右上部の歯車アイコンを押下します (❷)</li><li>「セッション詳細」を選択します (❸)</li><li>ポップアップで表示された、環境 ID を含むセッションの詳細情報すべてを <strong>テキスト形式</strong> で取得します (❹)<br/><br> ※環境 ID は赤枠で囲った部分です。本セッション情報を用いて事象が発生している環境の情報を確認します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image16.png"></li></ol><p><a id='anchor-about-canvasapp'></a></p><h3 id="10-アプリ"><a href="#10-アプリ" class="headerlink" title="10. アプリ"></a>10. アプリ</h3><p>事象が発生しているアプリを調査し、問題の箇所を特定します。<br/><br>アプリが接続するデータソースにより SharePoint リストのテンプレートや Dataverse テーブルのメタ情報をご提供いただく場合があります。</p><h4 id="アプリのエクスポートファイル"><a href="#アプリのエクスポートファイル" class="headerlink" title="アプリのエクスポートファイル"></a>アプリのエクスポートファイル</h4><p>「エクスポート」機能によりエクスポートされるアプリのファイルは公開済みのバージョンです。<br/><br>アプリを編集中の場合は msapp ファイルとしてローカルに保存したアプリのファイルをご取得ください。</p><p><a id='anchor-about-canvasapp-published'></a></p><ul><li>公開済みのアプリ<ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>アプリ一覧画面から対象のアプリの「…」メニューを押下し、「エクスポート パッケージ」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image17.png"></li><li>任意の名前を付けてエクスポートします</li><li>ローカルに zip ファイルがダウンロードされます</li></ol></li></ul><p><a id='anchor-about-canvasapp-edit'></a></p><ul><li>編集中の最新のアプリ<ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>アプリ一覧画面から対象のアプリを編集します</li><li>メニュー「∨」アイコン &gt; 「コピーのダウンロード」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image18.png"></li><li>ローカルに msapp ファイルをダウンロードします<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image19.png"></li></ol></li></ul><p><a id='anchor-about-canvasapp-solutionapp'></a></p><h4 id="アプリを含むソリューションファイル"><a href="#アプリを含むソリューションファイル" class="headerlink" title="アプリを含むソリューションファイル"></a>アプリを含むソリューションファイル</h4><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>ソリューション一覧画面を表示します</li><li>「新しいソリューション」を押下します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image20.png"></li><li>手順 3 で作成したソリューションに対象のアプリを追加します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image21.png"></li><li>必須オブジェクトを追加し、アプリが使用するテーブルなどをソリューションに自動追加します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image30.png"></li><li>カスタマイズを公開します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image22.png"></li><li>ソリューションをエクスポートします<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image23.png"></li><li>ローカルに zip ファイルがダウンロードされます</li></ol><p><a id='anchor-about-canvasapp-spocustomform'></a></p><h4 id="SharePoint-カスタム-フォーム"><a href="#SharePoint-カスタム-フォーム" class="headerlink" title="SharePoint カスタム フォーム"></a>SharePoint カスタム フォーム</h4><ol><li>カスタム フォームを設定している SharePoint リストを表示します</li><li>画面右上部の歯車アイコンを選択し、「リストの設定」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image24.png"></li><li>「フォームの設定」リンクを選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image25.png"></li><li>「バージョンと使用方法を参照」リンクを選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image26.png"></li><li>Power Apps のアプリ詳細画面に遷移しますので「エクスポート パッケージ」を選択します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image27.png"></li><li>任意の名前を付けてエクスポートします</li><li>ローカルに zip ファイルがダウンロードされます</li></ol><p><a id='anchor-about-canvasapp-componentlibrary'></a></p><h4 id="コンポーネント単体"><a href="#コンポーネント単体" class="headerlink" title="コンポーネント単体"></a>コンポーネント単体</h4><p>※キャンバス アプリ内でコンポーネントを使用している場合、<a href="#anchor-about-canvasapp-published">公開済みアプリのエクスポート ファイル</a> (あるいは、<a href="#anchor-about-canvasapp-edit">編集中アプリのエクスポート ファイル</a>) でご紹介している方法でエクスポートすると、コンポーネントが含まれた状態でエクスポートできます。</p><ol><li><a href="http://make.powerapps.com/">Power Apps 作成者ポータル</a> にサインインします</li><li>ソリューション一覧画面を表示します</li><li>「新しいソリューション」を押下します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image20.png"></li><li>手順 3 で作成したソリューションに対象のコンポーネントを追加します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image28.png"></li><li>カスタマイズを公開します<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image29.png"></li><li>ソリューションをエクスポートします<br/><br> <img src="/blog/canvasapp/troubleshooting-general-canvasapp/image23.png"></li><li>ローカルに zip ファイルがダウンロードされます</li></ol><h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>本手順は執筆時点でのユーザー インターフェイスを基に紹介しています。バージョンアップによって若干の UI の遷移など異なる場合があります。その場合は画面の指示に従って進めてください。<br/><br>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><ul><li><a href="https://support.microsoft.com/ja-jp/office/teams-%E3%81%A7%E4%BC%9A%E8%AD%B0%E3%82%92%E8%A8%98%E9%8C%B2%E3%81%99%E3%82%8B-34dfbe7f-b07d-4a27-b4c6-de62f1348c24">Teams で会議を記録する</a></li><li><a href="https://social.technet.microsoft.com/Forums/ja-JP/7c2e860a-c756-42d7-8fde-6afe043ab57f/12502125211245412470125401248812524125401247312398124611251512?forum=DCRMSupport">ブラウザートレースのキャプチャ手順</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/canvas-apps/get-sessionid">セッションおよびアプリ ID の詳細を取得する</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/monitor-canvasapps">モニターでキャンバス アプリをデバッグする</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/monitor-advanced">高度なモニタリングの概要</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの谷です。&lt;br/&gt;&lt;br&gt;弊社サポートでは、キャンバス アプリが動作しない、エラーが発生する、等のトラブルシューティングにおいて、お問い合わせの内容をもとに調査方針を立てておりますが、発生している事象を明確に把握するため、ご利用者様の環境で発生している事象の切り分けや情報提供をお願いすることがあります。&lt;br/&gt;&lt;br&gt;この記事では、キャンバス アプリのトラブルシューティングを行うにあたって、必要となる情報の取得手順をご説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Canvas app" scheme="https://jpdynamicscrm.github.io/blog/tags/Canvas-app/"/>
    
    <category term="Power Apps" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Apps/"/>
    
    <category term="情報採取" scheme="https://jpdynamicscrm.github.io/blog/tags/%E6%83%85%E5%A0%B1%E6%8E%A1%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>Dataverse のストレージ容量について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/About-Dataverse-Storage/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/About-Dataverse-Storage/</id>
    <published>2023-03-13T03:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.200Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの原です。</p><p>今回は、Dataverse のストレージ容量についてご説明いたします。</p><span id="more"></span><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ol><li><a href="#anchor-about-strage">Dataverse ストレージの概要</a></li><li><a href="#anchor-QA">よくあるご質問</a></li><li><a href="#anchor-finish">おわりに</a></li></ol><p><a id='anchor-about-strage'></a></p><h2 id="1-Dataverse-ストレージの概要"><a href="#1-Dataverse-ストレージの概要" class="headerlink" title="1. Dataverse ストレージの概要"></a>1. Dataverse ストレージの概要</h2><h3 id="保存されるデータと容量の種類について"><a href="#保存されるデータと容量の種類について" class="headerlink" title="保存されるデータと容量の種類について"></a>保存されるデータと容量の種類について</h3><p>Power Platform では、各 Dataverse 環境に格納された Dataverse のデータを「Dataverse ストレージ容量」としてテナントごとに計上します。<br>Dataverse のデータはその特性に応じて以下の 3 種類の領域に格納されます。</p><ul><li>データベース容量 : 通常の業務データなど、リレーショナル データベースでの保存に適したデータが格納されます。</li><li>ファイル容量 : BLOB 形式での保存に適したデータが格納されます。</li><li>ログ容量 : 監査ログなど、長期保存される履歴データが格納されます。</li></ul><h3 id="テナントごとの容量割り当てについて"><a href="#テナントごとの容量割り当てについて" class="headerlink" title="テナントごとの容量割り当てについて"></a>テナントごとの容量割り当てについて</h3><p>弊社では Power Platform のクラウド リソースを各お客様に適切に利用いただくため、ご購入いただいたライセンスに応じてテナントごとに容量上限を割り当てております。<br>容量上限を超過した場合にも、Dataverse へのデータ登録を含めて通常の製品機能を引き続きご利用いただけますが、一部の環境管理操作の実行が制限されます。<br>容量上限を超過した場合の具体的な挙動や、容量削減の方法につきましては、後述の<a href="#anchor-QA">よくあるご質問</a>セクションをご参照ください。</p><p>ストレージの詳細につきましては、以下の公開情報もぜひご参照ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#example-storage-capacity-scenarios-overage-enforcement">新しい Microsoft Dataverse ストレージ容量</a></p><hr><p><a id='anchor-QA'></a></p><h2 id="2-よくあるご質問"><a href="#2-よくあるご質問" class="headerlink" title="2. よくあるご質問"></a>2. よくあるご質問</h2><h3 id="容量が不足した場合の対処法はありますか？"><a href="#容量が不足した場合の対処法はありますか？" class="headerlink" title="容量が不足した場合の対処法はありますか？"></a>容量が不足した場合の対処法はありますか？</h3><p><a id='anchor-reduce-strage'></a></p><ol><li><p>不要なデータや、システムにより蓄積された内部的な履歴データなどを削除することで、運用に影響を及ぼさない形で容量を確保いただけます。<br>手順の詳細につきましては、下記の公開情報をご参照ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/free-storage-space">ストレージの空きを増やす</a><br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/cleanup-asyncoperationbase-table">AsyncOperationBase テーブルと WorkflowLogBase テーブルからレコードをクリーンアップする</a></p></li><li><p>使用していない環境を削除することで容量を確保いただけます。<br>検証などにより一時的に使用していたものの、現在では使用していない環境などがございましたら、ぜひ削除をご検討ください。<br>手順の詳細につきましては、下記の公開情報をご参照ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/delete-environment">環境を削除する</a></p></li><li><p>ライセンス購入により、容量を追加いただけます。<br>1,2 をお試しいただいた上でも容量が不足する場合に備え、容量割り当て用のアドオン ライセンスをご利用いただけます。<br>ライセンスの詳細につきましては、下記のライセンス ガイドをご参照ください。<br>・<a href="https://go.microsoft.com/fwlink/?LinkId=866544&clcid=0x411">Dynamics 365 ライセンス ガイド</a> &gt; キャパシティ ライセンス<br>・<a href="https://go.microsoft.com/fwlink/?LinkId=2085130&clcid=0x411">Power Apps および Power Automate ライセンス ガイド</a> &gt; キャパシティ アドオン</p></li></ol><h3 id="容量を超過するとどうなりますか？"><a href="#容量を超過するとどうなりますか？" class="headerlink" title="容量を超過するとどうなりますか？"></a>容量を超過するとどうなりますか？</h3><p>テナントの容量上限を超過した場合にも、Dataverse へのデータ登録を含む通常の製品機能を引き続きご利用いただけます。<br>ただし、以下の環境管理操作については実施いただけなくなります。</p><ul><li>新しい環境の作成 (1 GB 以上の容量が必要です)</li><li>環境のコピー</li><li>環境の復元</li><li>試用環境を有料環境に変換 (1GB 以上の容量が必要です)</li><li>環境の回復 (少なくとも 1GB の空き容量が必要)</li><li>Dataverse データベースを環境に追加<br>※ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#changes-for-exceeding-storage-capacity-entitlements">記憶域容量の権利を超えるための変更</a></li></ul><p>上記の機能は、一般ユーザーではなく管理者様や開発者様にて、開発作業や障害発生時・メンテナンス時などにご利用いただくことを想定したものでございます。<br>スムーズに管理作業を行い、安全に Power Platform を運用いただくためにも、Dataverse 容量の上限を遵守いただきますようお願い申し上げます。</p><h3 id="特定のストレージ領域のみ容量が超過した場合も、テナント全体の容量上限を超過しますか？"><a href="#特定のストレージ領域のみ容量が超過した場合も、テナント全体の容量上限を超過しますか？" class="headerlink" title="特定のストレージ領域のみ容量が超過した場合も、テナント全体の容量上限を超過しますか？"></a>特定のストレージ領域のみ容量が超過した場合も、テナント全体の容量上限を超過しますか？</h3><p>Dataverse では、各データの特性にあわせて保存コストの異なる領域にデータを格納しております。<br>そのため、より上位のストレージ領域に十分な空き容量が存在する場合には、上位ストレージの空き容量で下位ストレージの不足分を補完いただけます。<br>具体的には、各領域に以下の補完関係がございます。</p><ol><li>データベース容量：補完いただけません。</li><li>ログ容量：データベース領域で補完いただけます。</li><li>ファイル容量：データベースおよびログ領域で補完いただけます。</li></ol><p>以下の公開情報でも、補完関係のパターン例をご紹介しておりますので、ご参考になりましたら幸いです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#example-storage-capacity-scenarios-overage-enforcement">ストレージ容量シナリオの例、超過分の強制 / 超過分なし</a></li></ul><h3 id="環境作成時には、どのようにストレージが消費されますか？"><a href="#環境作成時には、どのようにストレージが消費されますか？" class="headerlink" title="環境作成時には、どのようにストレージが消費されますか？"></a>環境<strong>作成時</strong>には、どのようにストレージが消費されますか？</h3><p>環境を作成いただくにあたっては、環境の種類や構成に関わらず、テナントにて 1 GB の空き容量が必要でございます。<br>空き容量が 1 GB 未満の場合には、環境を作成いただくことができません。</p><p>なお、環境作成時の実際の消費容量は、環境の構成によって異なります。<br>Dataverse なしの環境では、環境作成時の内部処理にて、データベース容量が必ず 1 GB 消費されます。<br>Dataverse ありの環境では、環境作成時に選択いただいた言語やアプリなどの構成要素によって消費容量が変化いたします。<br>そのため Dataverse ありの環境では、実際の容量が 1 GB 未満となることや 1 GB を超えることがございますが、目安として 1 GB の空き容量制限を設けております。</p><h3 id="環境作成後には、どのようにストレージが消費されますか？"><a href="#環境作成後には、どのようにストレージが消費されますか？" class="headerlink" title="環境作成後には、どのようにストレージが消費されますか？"></a>環境<strong>作成後</strong>には、どのようにストレージが消費されますか？</h3><ul><li><p>Dataverse なしの場合<br>環境作成時に消費されたデータベース容量 1 GB 以外は消費されることは記事執筆時点ではありません。</p></li><li><p>Dataverse ありの場合<br>ご自身の環境に追加いただいた業務データ等が容量として消費されます。<br>また、以下の例のように、業務データ以外の要因でも容量が増加する場合がございます。</p></li></ul><ol><li>Dataverse では、お客様により快適にサービスをご利用いただくため、週次アップデートなどの製品改善を行っております。このアップデートに伴い、データ構造や製品内部のプログラム ファイルに変更が発生し、消費容量が増加する場合がございます。</li><li>Dataverse のデータベース領域では、検索性能向上のために随時インデックスの最適化を行っております。この過程で消費容量が増える場合がございます。<br>ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#do-indexes-affect-database-storage-usage">インデックスはデータベース ストレージの使用に影響しますか。</a></li><li>Excel インポートなどの非同期処理を実行いただいた場合には、Dataverse にジョブの実行履歴データが保管されます。長期間環境を運用いただくと、この履歴データが容量を圧迫する場合がございます。<br>ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/cleanup-asyncoperationbase-table">AsyncOperationBase テーブルと WorkflowLogBase テーブルからレコードをクリーンアップする</a></li></ol><p>Dataverse では、上記のように業務と直接関連のないデータが容量を消費する場合もございます。<br>これらの容量には、上記 1 や 2 のように削除いただけないものもございますが、一方で 3 などのデータは削除いただけます。<br>ご不要なデータを削減いただくことで、容量消費状況が大きく改善することもございますので、もし容量がひっ迫した場合にはぜひ<a href="#anchor-reduce-strage">「容量が不足した場合の対処法はありますか？」</a>のセクションをご参照ください。</p><h3 id="既定環境や-Teams-環境など、実稼働・サンドボックス以外の環境を利用しています。テナントの容量について考慮すべき点はありますか？"><a href="#既定環境や-Teams-環境など、実稼働・サンドボックス以外の環境を利用しています。テナントの容量について考慮すべき点はありますか？" class="headerlink" title="既定環境や Teams 環境など、実稼働・サンドボックス以外の環境を利用しています。テナントの容量について考慮すべき点はありますか？"></a>既定環境や Teams 環境など、実稼働・サンドボックス以外の環境を利用しています。テナントの容量について考慮すべき点はありますか？</h3><p>以下の環境は、製品をお試しいただく目的などでの小規模利用を想定していることから、テナントの割り当て容量を消費しません。</p><ul><li>Dataverse for Teams</li><li>試用版</li><li>プレビュー</li><li>サポート</li><li>開発者<br>※ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#dataverse-tab">Dataverse タブ</a> &gt; 注意 セクション</li></ul><p>また、既定環境には公開情報に定められた所定の容量が個別に割り当てられ、割り当て分を超過した容量のみがテナント側の容量を消費いたします。</p><p>上記の種別の環境につきましては、個別に容量の制約が存在するものもございます。<br>ご利用にあたってはぜひ以下の公開情報もご参照ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#dataverse-tab">既定環境</a><br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/about-teams-environment#capacity-limits">Dataverse for Teams 環境</a><br>・<a href="https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan#%E9%96%8B%E7%99%BA%E8%80%85%E7%92%B0%E5%A2%83%E3%81%AE%E5%AE%B9%E9%87%8F%E5%88%B6%E9%99%90%E3%81%AF%E3%81%A9%E3%82%8C%E3%81%8F%E3%82%89%E3%81%84%E3%81%A7%E3%81%99%E3%81%8B">開発者環境</a></p><h3 id="テナントの-Dataverse-容量について通知する機能はありますか？"><a href="#テナントの-Dataverse-容量について通知する機能はありますか？" class="headerlink" title="テナントの Dataverse 容量について通知する機能はありますか？"></a>テナントの Dataverse 容量について通知する機能はありますか？</h3><p>テナント Dataverse 容量がひっ迫した際には、以下のタイミングで通知メールが送信されます。</p><ul><li>Dataverse 空き容量が全体の 15 % 未満となった場合</li><li>Dataverse 空き容量が全体の 5 % 未満となった場合</li><li>Dataverse 容量が上限を超過した場合<br>通知の詳細や送信対象者などにつきましては、以下の公開情報をご参照ください。<br>・ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/capacity-storage#changes-for-exceeding-storage-capacity-entitlements">記憶域容量の権利を超えるための変更</a></li></ul><p>なお記事執筆時点では、通知の送信対象や容量の閾値を変更する機能のご用意がございません。<br>管理者役割ではないユーザーに通知を送信されたい場合には、通知メールを適宜転送いただく運用をご検討いただけますと幸いです。</p><h2 id="3-おわりに"><a href="#3-おわりに" class="headerlink" title="3.おわりに"></a>3.おわりに</h2><p><a id='anchor-finish'></a></p><p>本記事が、Power Platform の Dataverse ストレージ領域を管理いただく上でのお役に立てましたら幸いです。<br>ご不明な点や、もし具体的に容量削減についてお困りのことなどがございましたら、弊社サポート一同にてお待ち申し上げておりますので、ぜひお気軽にお問合せください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの原です。&lt;/p&gt;
&lt;p&gt;今回は、Dataverse のストレージ容量についてご説明いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Dataverse" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse/"/>
    
    <category term="Dataverse ストレージ" scheme="https://jpdynamicscrm.github.io/blog/tags/Dataverse-%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate におけるフローの有効期限切れを防ぐ</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/how-to-avoid-flow-expiration/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/how-to-avoid-flow-expiration/</id>
    <published>2023-03-03T06:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.148Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、 Power Platform サポートの竹内です。<br>今回は、 Power Automate で一定期間フローを実行していない場合に有効期限が切れてしまい自動的に無効化される事象を防ぐために、どのように対応すればよいのかをご紹介します。</p><h2 id="前提"><a href="#前提" class="headerlink" title="[前提]"></a>[前提]</h2><p>現在、以下のプランで Power Automate をご利用されている方々に対し、 90 日間フローを実行していない場合にはフローの作成者 (所有者) と共同作成者 (共同所有者) へ 30 日後にフローを自動的に無効化する旨のメールが届きます。<br>その後、30 日以内に適切な対応がされない場合には、フローはシステム上無効化され、フローの作成者 (所有者) と共同作成者 (共同所有者) へメールで通知されます。<br>[対象のプラン]<br>無料版と試用版、Power Apps 開発者プラン* 、 Microsoft 365 プラン  </p><p>詳細については以下の公開文書を併せてご確認ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits">制限と構成 - Power Automate | Microsoft Learn</a></p><p>*Power Apps コミュニティプランは 2021 年 5 月に Power Apps 開発者プランに名称を変更しました。<br>Power Apps 開発者プランの詳細につきましては以下の公開情報をご参照ください。  </p><p><a href="https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan#improvements-from-the-previous-power-apps-community-plan">Power Apps 開発者プランにサインアップ - Power Apps | Microsoft Learn</a></p><h2 id="フローの無効化を回避する方法"><a href="#フローの無効化を回避する方法" class="headerlink" title="[フローの無効化を回避する方法]"></a>[フローの無効化を回避する方法]</h2><p>以降では、フローが自動的に無効化される事象を回避する方法についてご案内いたします。その方法は大きく分けて、以下の 3 つがございます。<br>① スタンドアロンの Power Automate ライセンスを購入する。<br>② フロー作成、あるいは最終実行日から 120 日以内に 1 度以上実行する。<br>③ フローの最終更新日から 30 日以内に 1 度以上更新する。</p><p>以降ではそれらについて詳細にご紹介いたします。</p><span id="more"></span><h2 id="①-スタンドアロンの-Power-Automate-ライセンスを購入する。"><a href="#①-スタンドアロンの-Power-Automate-ライセンスを購入する。" class="headerlink" title="① スタンドアロンの Power Automate ライセンスを購入する。"></a>① スタンドアロンの Power Automate ライセンスを購入する。</h2><p>スタンドアロンの Power Automate ライセンスを購入することにより、自動で無効化される事象を回避できます。以下のいずれかの方法をご検討ください。</p><ul><li>ユーザーごとの Power Automate ライセンスを購入し、対象のフローの作成者に割り当てる  </li><li>フローごとの Power Automate ライセンスを購入し、対象のフローに割り当てる  </li></ul><p>詳細につきましては以下の公開情報も併せてご確認ください。  </p><p><a href="https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits">制限と構成 - Power Automate | Microsoft Learn</a></p><p>また、スタンドアロンの Power Automate ライセンスの詳細につきましては以下の公開情報をご参照ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/power-automate-licensing/types">Power Automate ライセンスの種類 - Power Platform | Microsoft Learn</a><br><a href="https://powerautomate.microsoft.com/ja-jp/pricing/">価格 | Microsoft Power Automate</a>  </p><h2 id="②-フロー作成日、あるいは最終実行日から-120-日以内に-1-度以上実行する。"><a href="#②-フロー作成日、あるいは最終実行日から-120-日以内に-1-度以上実行する。" class="headerlink" title="② フロー作成日、あるいは最終実行日から 120 日以内に 1 度以上実行する。"></a>② フロー作成日、あるいは最終実行日から 120 日以内に 1 度以上実行する。</h2><p>フローを実行することにより、フローを実行していない 90 日の期間と自動的に無効化されるまでの 30 日の期間をリセットすることができます。<br>手動で実行する方法についてご紹介致します</p><p>フローの一覧画面から対象のフローを選択し、下図の赤枠のいずれかを押すことにより実行します。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image006.png">  </p><p>あるいは下図のフローの詳細画面から実行することもできます。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image007.png">  </p><br>参考情報としまして、下図のように「スケジュール済みクラウド フロー」を作成する場合、90 日に一度は実行されるように設定していただくことで、フローの有効期限切れを防ぐことができます。<p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image005.png">  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image008.png">  </p><h2 id="③-フローの最終更新日から-30-日以内に-1-度以上更新する。"><a href="#③-フローの最終更新日から-30-日以内に-1-度以上更新する。" class="headerlink" title="③ フローの最終更新日から 30 日以内に 1 度以上更新する。"></a>③ フローの最終更新日から 30 日以内に 1 度以上更新する。</h2><p>フローの更新をしていただくことにより、フローが自動的に無効化されるまでの 30 日の期間をリセットすることができます。  </p><p>以下では、手動でフローを更新する方法についてご紹介致します。<br>例として、下図のフローの更新を行います。最終変更日時が 9 月 14 日 12:14 であることが確認できます。  </p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image009.png">  </p><p>では、更新を行います。このフローの編集画面へ遷移すると以下のような画面になります。<br>ここで保存ボタンを押してください。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image011.png">  </p><p>すると、変更日時が更新されていることが確認できます。</p><p><img src="/blog/powerautomate/how-to-avoid-flow-expiration/image012.png">  </p><p>この操作を定期的に行っていただくことにより、自動的にフローがオフになる事象を回避することができます。</p><br><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>以上、Power Automate で一定期間フローを実行していない場合の有効期限切れを防ぐ方法を大きく 3 つご紹介いたしました。<br>なお、Power Automate はグローバルでご利用いただいているクラウド製品となりますので、30 日や 90 日などの実行間隔は余裕をもってご設定ください。<br>参考になりましたら幸いです。  </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、 Power Platform サポートの竹内です。&lt;br&gt;今回は、 Power Automate で一定期間フローを実行していない場合に有効期限が切れてしまい自動的に無効化される事象を防ぐために、どのように対応すればよいのかをご紹介します。&lt;/p&gt;
&lt;h2 id=&quot;前提&quot;&gt;&lt;a href=&quot;#前提&quot; class=&quot;headerlink&quot; title=&quot;[前提]&quot;&gt;&lt;/a&gt;[前提]&lt;/h2&gt;&lt;p&gt;現在、以下のプランで Power Automate をご利用されている方々に対し、 90 日間フローを実行していない場合にはフローの作成者 (所有者) と共同作成者 (共同所有者) へ 30 日後にフローを自動的に無効化する旨のメールが届きます。&lt;br&gt;その後、30 日以内に適切な対応がされない場合には、フローはシステム上無効化され、フローの作成者 (所有者) と共同作成者 (共同所有者) へメールで通知されます。&lt;br&gt;[対象のプラン]&lt;br&gt;無料版と試用版、Power Apps 開発者プラン* 、 Microsoft 365 プラン  &lt;/p&gt;
&lt;p&gt;詳細については以下の公開文書を併せてご確認ください。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-automate/limits-and-config?WT.mc_id=BA-MVP-5003233#expiration-limits&quot;&gt;制限と構成 - Power Automate | Microsoft Learn&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;*Power Apps コミュニティプランは 2021 年 5 月に Power Apps 開発者プランに名称を変更しました。&lt;br&gt;Power Apps 開発者プランの詳細につきましては以下の公開情報をご参照ください。  &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-apps/maker/developer-plan#improvements-from-the-previous-power-apps-community-plan&quot;&gt;Power Apps 開発者プランにサインアップ - Power Apps | Microsoft Learn&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;フローの無効化を回避する方法&quot;&gt;&lt;a href=&quot;#フローの無効化を回避する方法&quot; class=&quot;headerlink&quot; title=&quot;[フローの無効化を回避する方法]&quot;&gt;&lt;/a&gt;[フローの無効化を回避する方法]&lt;/h2&gt;&lt;p&gt;以降では、フローが自動的に無効化される事象を回避する方法についてご案内いたします。その方法は大きく分けて、以下の 3 つがございます。&lt;br&gt;① スタンドアロンの Power Automate ライセンスを購入する。&lt;br&gt;② フロー作成、あるいは最終実行日から 120 日以内に 1 度以上実行する。&lt;br&gt;③ フローの最終更新日から 30 日以内に 1 度以上更新する。&lt;/p&gt;
&lt;p&gt;以降ではそれらについて詳細にご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
  </entry>
  
  <entry>
    <title>Do Until で再試行を繰り返す (リトライループ)</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/retry-loop/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/retry-loop/</id>
    <published>2023-02-02T15:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.184Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートの瀬戸です。<br>今回は、Power Automate で出来る再試行のやり方の 1 つをご紹介します。</p><span id="more"></span><p>Power Automate のアクションには、再試行ポリシーという仕組みがあります。<br>再試行ポリシーとは、そのアクションが一時的な不具合等でエラーになったときに、アクションをもう一度実行してくれるものです。対象のレスポンス コードは、408 (Request Timeout)、429 (Too Many Requests)、5xx (サーバー エラー) です。</p><p><img src="/blog/powerautomate/retry-loop/image07.png"></p><p>再試行ポリシーは便利な機能ですが、実行する API によっては、上記以外のレスポンス コードを返す「ことがある」ものがあります。<br>例えば Microsoft Teams コネクタの「チームの作成」アクションは、API の処理が完了しても実際にチームを使うための準備が整っていないことがあります。そのため、「チームの作成」アクション直後に関連する処理を実行すると、レスポンス コード 404 (Not Found) のエラーになることがあります。</p><p>チーム作成の後すぐにサイト URL を取得しようとしてエラーになる例：<br><img src="/blog/powerautomate/retry-loop/image01.png"></p><p>404 は再試行ポリシーの対象外です。<br>こういう時は何秒か待機した後に次の処理をすればよいのですが、どれくらい待てばよいのかはその都度異なるため、「5 秒待って 1 回やってみる、だめだったらまた 5 秒待ってもう 1 回…」といった再試行と待機を繰り返したくなります。<br>Power Automate でこうした再試行と待機を繰り返すときは、Do Until アクションをご活用いただけます。</p><p>参考：<a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-control-flow-loops#until-loop">アクションを繰り返すループを追加する - Azure Logic Apps | Microsoft Learn</a></p><p>Do Until アクションは、アクションの内側のアクションが失敗しても、繰り返しを中断しません。この特徴が、再試行に有用に働きます。</p><p>エラーになる処理の繰り返し：<br><img src="/blog/powerautomate/retry-loop/image02.png"></p><p>上記の実行結果：<br><img src="/blog/powerautomate/retry-loop/image03.png"></p><h2 id="再試行の例"><a href="#再試行の例" class="headerlink" title="再試行の例"></a>再試行の例</h2><p>以下に、Do Until を使った再試行の例を記載します。各アクションの詳しい説明は後述します。</p><p><img src="/blog/powerautomate/retry-loop/image04.png"></p><h3 id="1-Do-Until"><a href="#1-Do-Until" class="headerlink" title="(1) Do Until"></a>(1) Do Until</h3><p><img src="/blog/powerautomate/retry-loop/image05.png"></p><p>再試行したいアクション「HTTP 要求 V2 を送信する」のステータスが「成功」になるまで、を繰り返しの終了条件にします。</p><table><thead><tr><th>パラメータ</th><th>値</th></tr></thead><tbody><tr><td>条件式 - 左辺</td><td>以下を式として入力：<br><code>actions(&#39;HTTP_要求_V2_を送信する&#39;)?[&#39;Status&#39;]</code>　※1</td></tr><tr><td>条件式 - 比較演算子</td><td><code>次の値に等しい</code></td></tr><tr><td>条件式 - 右辺</td><td><code>Succeeded</code></td></tr><tr><td>詳細モード - 回数</td><td>再試行したい最大回数を指定します。</td></tr><tr><td>詳細モード - タイムアウト</td><td>以下を考慮した時間を設定します。<br>再試行したい最大回数 × (再試行 1 回ごとに待機する時間 ＋ 再試行したい処理にかかる時間)</td></tr></tbody></table><p>※1 <code>HTTP_要求_V2_を送信する</code> は、再試行したいアクションのアクション名です。半角スペースは半角アンダーバーへ置き換えます。</p><h3 id="2-待ち時間"><a href="#2-待ち時間" class="headerlink" title="(2) 待ち時間"></a>(2) 待ち時間</h3><p>「スケジュール」コネクタの「待機」アクションを使い、再試行1回ごとの待機を行います。</p><p><img src="/blog/powerautomate/retry-loop/image06.png"></p><h3 id="Do-Until-の後"><a href="#Do-Until-の後" class="headerlink" title="Do Until の後"></a>Do Until の後</h3><p>Do Until が終わった後は、再試行したアクションの後の処理を続けます。</p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>上記の例を実行した結果が、下図の通りです。</p><p><img src="/blog/powerautomate/retry-loop/image08.png"></p><p>Do Until の繰り返し 1 ～ 7 回目の時点ではまだサイトの準備が終わっておらず、エラーになりました。<br>しかし、8 回目の時点で準備が整ったようで、サイト URL を取得できました。</p><p>同じフローをもう 1 度実行したところ、次は 3 回目で成功しました。</p><p><img src="/blog/powerautomate/retry-loop/image09.png"></p><p>このように、待機時間の見積もりが難しい処理を行うときに、「待ち時間が足りない」事態や「余裕をもって待ちすぎた」ことが防げます。</p><h2 id="終わりに"><a href="#終わりに" class="headerlink" title="終わりに"></a>終わりに</h2><p>以上、Do Until を使った再試行の例をご案内いたしました。Power Automate で出来ることの幅が少しでも広がりましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートの瀬戸です。&lt;br&gt;今回は、Power Automate で出来る再試行のやり方の 1 つをご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
  </entry>
  
  <entry>
    <title>クラウド フローのトリガー条件を設定してトリガーの実行を制御する方法</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/cloudflow-trigger-condition/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/cloudflow-trigger-condition/</id>
    <published>2023-01-18T00:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.132Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポート 谷です。<br/><br>Power Automate では、例えば、SharePoint リストのアイテムの作成や変更などのイベント発生後にタスクを実行したい場合、自動フローを使用することができます。<br/><br>自動フローでは、全ての値が入力されている場合のみ、また、特定の値の場合のみ、など、タスクを実行する際の条件を設定することができます。</p><p>本記事では、トリガー条件を設定して条件を満たす場合のみフローが実行されるようにする方法をご紹介します。</p><span id="more"></span><h2 id="トリガー条件の設定方法"><a href="#トリガー条件の設定方法" class="headerlink" title="トリガー条件の設定方法"></a>トリガー条件の設定方法</h2><p>例として、SharePoint ドキュメント ライブラリにファイルが作成され、指定したカスタム列に値が登録されている場合にのみフローが実行されるよう設定してみます。</p><p>前提条件として、SharePoint ドキュメント ライブラリにカスタム列「カスタム1」、「MyColumn01」を追加しています。<br><img src="/blog/powerautomate/cloudflow-trigger-condition/image01.png"></p><ol><li><p>「ファイルが作成または変更されたとき (プロパティのみ)」トリガーを使用してフローを作成します</p><ul><li><img src="/blog/powerautomate/cloudflow-trigger-condition/image02.png"></li></ul></li><li><p>トリガー右上部の 3 点メニューを押下し、「設定」を選択します</p><ul><li><img src="/blog/powerautomate/cloudflow-trigger-condition/image03.png"></li></ul></li><li><p>トリガーの条件を設定します</p><ul><li><p>triggerBody 関数を使用してトリガー実行時の情報 (ドキュメントライブラリにアップロードされたファイルやカスタム列の値) を取得します。</p></li><li><p>カスタム1 列の値が入力されている場合のみトリガーが実行されるように設定するためには、以下の式を設定します。</p><p>empty 関数は引数の値が空かどうか評価し、空の場合 true を返却します。また、not 関数は引数が false かどうか評価し、false の場合 true を返却します。</p><p><code>@not(empty(triggerBody()[&#39;OData__x30ab__x30b9__x30bf__x30e0__xff11_&#39;]))</code></p><p>※<code>OData__x30ab__x30b9__x30bf__x30e0__xff11_</code> はカスタム1 列の内部列名です。</p><p>　内部列名の確認方法については弊社ブログ記事「<a href="https://jpdynamicscrm.github.io/blog/powerautomate/Look-up-internal-column-names-in-SPO/">SharePoint リストの内部列名の確認方法</a>」でご紹介しています。</p><p><img src="/blog/powerautomate/cloudflow-trigger-condition/image04.png"></p></li><li><p>MyColumn01 列の値が「12345」の場合のみトリガーが実行されるように設定するには、以下の式を設定します。</p><p>equeals 関数は第一引数と第二引数の値が等しいかどうか評価し、等しい場合 true を返却します。</p><p><code>@equals(triggerBody()[&#39;MyColumn1&#39;], &#39;12345&#39;)</code></p><p><img src="/blog/powerautomate/cloudflow-trigger-condition/image05.png"></p></li></ul></li></ol><h2 id="FAQ-amp-Tips"><a href="#FAQ-amp-Tips" class="headerlink" title="FAQ &amp; Tips"></a>FAQ &amp; Tips</h2><h3 id="トリガー条件を複数設定できますか？"><a href="#トリガー条件を複数設定できますか？" class="headerlink" title="トリガー条件を複数設定できますか？"></a>トリガー条件を複数設定できますか？</h3><p>トリガー条件は複数設定することができます。条件を全て満たす場合にフローが実行されます。<br/><br><img src="/blog/powerautomate/cloudflow-trigger-condition/image06.png"></p><h3 id="トリガー条件の式設定を簡単にする方法はありますか？"><a href="#トリガー条件の式設定を簡単にする方法はありますか？" class="headerlink" title="トリガー条件の式設定を簡単にする方法はありますか？"></a>トリガー条件の式設定を簡単にする方法はありますか？</h3><p>以下の方法で条件式を取得することができます。</p><ol><li><p>「データ操作 &gt; アレイのフィルタ処理」 アクションをトリガーの下に追加します</p></li><li><p>トリガーしたい条件をトリガーの動的コンテンツを用いて設定後、”詳細設定モードで編集” リンクを押下し、表示された式をコピーします</p><ul><li><p>“選択肢” という列の値が “選択肢A” の場合の条件式<br><img src="/blog/powerautomate/cloudflow-trigger-condition/image07.png"></p><p>↓</p><p><img src="/blog/powerautomate/cloudflow-trigger-condition/image08.png"></p></li></ul></li><li><p>手順 2 でコピーした式をトリガー [… &gt; 設定] より、トリガー条件に設定します</p><ul><li><img src="/blog/powerautomate/cloudflow-trigger-condition/image09.png"></li></ul></li><li><p>追加した「データ操作 &gt; アレイのフィルタ処理」アクションを削除します</p></li></ol><p>この記事が皆さまの自動化の一助になりましたら幸いです。</p><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference">not、empty、triggerBodyなど式関数のリファレンス</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポート 谷です。&lt;br/&gt;&lt;br&gt;Power Automate では、例えば、SharePoint リストのアイテムの作成や変更などのイベント発生後にタスクを実行したい場合、自動フローを使用することができます。&lt;br/&gt;&lt;br&gt;自動フローでは、全ての値が入力されている場合のみ、また、特定の値の場合のみ、など、タスクを実行する際の条件を設定することができます。&lt;/p&gt;
&lt;p&gt;本記事では、トリガー条件を設定して条件を満たす場合のみフローが実行されるようにする方法をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
    <category term="自動フロー" scheme="https://jpdynamicscrm.github.io/blog/tags/%E8%87%AA%E5%8B%95%E3%83%95%E3%83%AD%E3%83%BC/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で Teams のチーム作成とメンバー追加を自動化</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerautomate/create-team-and-add-members/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerautomate/create-team-and-add-members/</id>
    <published>2023-01-11T15:00:00.000Z</published>
    <updated>2023-06-06T03:44:31.132Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Power Platform サポートの瀬戸です。</p><p>今回は、Teams の新しいチームの作成と、そのチームへのメンバー追加を、Power Automate で自動化する例をご紹介いたします。組織の方針でチーム作成を申請制にしている場合や、たくさんのチームを一度に作成しなければいけないときにご活用いただけます。</p><span id="more"></span><h2 id="メンバー表の例"><a href="#メンバー表の例" class="headerlink" title="メンバー表の例"></a>メンバー表の例</h2><p><img src="/blog/powerautomate/create-team-and-add-members/image01.png"></p><p>今回は、上図のような Excel ファイルのメンバー表を元に、チームのメンバーを追加すると想定しています。表はテーブル形式で、メンバーのメールアドレスと、チームに対する権限の列があります。このファイルを、既存の SharePoint サイトのドキュメント ライブラリへ保存しておきます。</p><h2 id="フローの例"><a href="#フローの例" class="headerlink" title="フローの例"></a>フローの例</h2><p>ここから、フローのサンプルをご案内します。フローの大まかな流れは下記の通りです。</p><ol><li>新しいチームを作成します。</li><li>Excel ファイルのメンバー表を読み込みます。</li><li>メンバー表のメールアドレスを元に、メンバーを追加します。</li></ol><h3 id="全体図"><a href="#全体図" class="headerlink" title="全体図"></a>全体図</h3><p>下図がフローの全体図です。それぞれのアクションの設定方法は後述します。</p><p><img src="/blog/powerautomate/create-team-and-add-members/image02.png"></p><h3 id="1-チームの作成"><a href="#1-チームの作成" class="headerlink" title="(1) チームの作成"></a>(1) チームの作成</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image03.png"></p><p>Microsoft Teams コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/teams/#%E3%83%81%E3%83%BC%E3%83%A0%E3%81%AE%E4%BD%9C%E6%88%90">チームの作成</a>」アクションを使用し、新しいチームを作成します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>チーム名</td><td>任意のチーム名を指定します。</td></tr><tr><td>説明</td><td>任意の説明文を指定します。</td></tr><tr><td>可視性</td><td>任意の値 (Private または Public) を選択します。</td></tr></tbody></table><p>「チームの作成」アクションでチームを作成すると、フロー作成者 (≒このアクションの接続のアカウント) がチームの所有者となります。</p><p>接続のアカウント：<br><img src="/blog/powerautomate/create-team-and-add-members/image18.png"></p><p>作成されたチームのメンバー：<br><img src="/blog/powerautomate/create-team-and-add-members/image19.png"></p><p>これは Teams で手作業でチームを作成した場合と同じ動作です。しかし、このままではメンバー表にいない人がチームに参加していることになってしまうため、後でチームを脱退する必要があります。このフローのサンプルでは、その脱退についても実施しています。</p><h3 id="2-表内に存在する行を一覧表示"><a href="#2-表内に存在する行を一覧表示" class="headerlink" title="(2) 表内に存在する行を一覧表示"></a>(2) 表内に存在する行を一覧表示</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image04.png"></p><p>Excel Online (Business) コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/excelonlinebusiness/#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%86%85%E3%81%AB%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8B%E8%A1%8C%E3%82%92%E4%B8%80%E8%A6%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B">表内に存在する行を一覧表示</a>」アクションを使用し、メンバー表の値を取得します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>場所</td><td>Excel ファイルがある場所を指定します。</td></tr><tr><td>ドキュメント ライブラリ</td><td>Excel ファイルがあるライブラリを指定します。</td></tr><tr><td>ファイル</td><td>Excel ファイルのパスを指定します。</td></tr><tr><td>テーブル</td><td>メンバー表のテーブル名を指定します。</td></tr></tbody></table><h3 id="3-マイ-プロフィールの取得-V2"><a href="#3-マイ-プロフィールの取得-V2" class="headerlink" title="(3) マイ プロフィールの取得 (V2)"></a>(3) マイ プロフィールの取得 (V2)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image05.png"></p><p>※ 設定が必要なパラメータはありません。</p><p>Office 365 Users コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365users/#%E8%87%AA%E5%88%86%E3%81%AE%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-(v2)">マイ プロフィールの取得 (V2)</a>」アクションを使用し、自分 (フロー作成者) の情報を取得します。<br>このアクションは、「(1) チームの作成」のアクションと接続のアカウントが同じである必要があります。</p><p>前述したように、「(1) チームの作成」で作成したチームは、自分が所有者として追加されています。しかし、メンバー表に自分がいない場合はチームから脱退しておきたいので、それに必要な情報を取得しています。</p><h3 id="4-アレイのフィルター処理-自分以外を抽出"><a href="#4-アレイのフィルター処理-自分以外を抽出" class="headerlink" title="(4) アレイのフィルター処理-自分以外を抽出"></a>(4) アレイのフィルター処理-自分以外を抽出</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image06.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-filter-array-action">アレイのフィルター処理</a>」アクションを使用し、Excel ファイルから取得したメンバー表から、自分 (フロー作成者) を削除した一覧を作成します。<br>この後メンバーをチームに追加しますが、前述したように自分はすでにメンバーとしてチームに参加しているため、追加の必要がないためです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>差出人</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「value」</td></tr><tr><td>条件式-左辺</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「メールアドレス」 ※<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しくない」</td></tr><tr><td>条件式-右辺</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「メール」</td></tr></tbody></table><p>※ 「メールアドレス」は メンバー表の列の名前です。</p><h3 id="5-Apply-to-each"><a href="#5-Apply-to-each" class="headerlink" title="(5) Apply to each"></a>(5) Apply to each</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image07.png"></p><p>コントロール コネクタの「Apply to each」アクションを使用し、自分 (フロー作成者) 以外のメンバーをチームに追加する繰り返し処理を行います。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>以前の手順から出力を選択</td><td>「(4) アレイのフィルター処理-自分以外を抽出」アクションの出力「本文」</td></tr></tbody></table><h3 id="6-ユーザーの検索-V2"><a href="#6-ユーザーの検索-V2" class="headerlink" title="(6) ユーザーの検索 (V2)"></a>(6) ユーザーの検索 (V2)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image08.png"></p><p>Office 365 Users コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365users/#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%92%E6%A4%9C%E7%B4%A2%E3%81%99%E3%82%8B-(v2)">ユーザーの検索 (V2)</a>」アクションを使用し、メンバー表のメールアドレスから、ユーザー情報を取得します。この後の処理に UPN (ユーザー プリンシパル名) が必要なのでこのアクションを使用していますが、メールアドレスと UPN が必ず一致する環境であれば、このアクションは必要ありません。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>検索語句</td><td>「(4) アレイのフィルター処理-自分以外を抽出」アクションの出力「メールアドレス」 ※<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr></tbody></table><p>※ 「メールアドレス」は メンバー表の列の名前です。</p><h3 id="7-作成-検索結果の1行目"><a href="#7-作成-検索結果の1行目" class="headerlink" title="(7) 作成-検索結果の1行目"></a>(7) 作成-検索結果の1行目</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image09.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-compose-action">作成</a>」アクションを使用し、前のアクションのリスト形式の出力から、1行目を取り出します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>入力</td><td>以下を式として入力：<br><code>outputs(&#39;ユーザーの検索_(V2)&#39;)?[&#39;body/value&#39;]?[0]</code> ※</td></tr></tbody></table><p>※ <code>ユーザーの検索_(V2)</code> は、「(6) ユーザーの検索 (V2)」のアクション名です。</p><h3 id="8-チームにメンバーを追加する"><a href="#8-チームにメンバーを追加する" class="headerlink" title="(8) チームにメンバーを追加する"></a>(8) チームにメンバーを追加する</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image10.png"></p><p>Microsoft Teams コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/teams/#%E3%83%81%E3%83%BC%E3%83%A0%E3%81%AB%E3%83%A1%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">チームにメンバーを追加する</a>」アクションを使用し、新しく作成したチームにメンバーを追加します。また、メンバー表に「所有者」として記載されたメンバーを所有者として登録するようにします。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>チーム</td><td>「(1) チームの作成」アクションの出力「新しいチームID」</td></tr><tr><td>チームに追加するユーザーの<br>プリンシパル名または AAD ID</td><td>「(7) 作成-検索結果の1行目」アクションの出力「Id」<br>または以下を式として入力：<br><code>outputs(&#39;作成-検索結果の1行目&#39;)?[&#39;Id&#39;]</code> ※1</td></tr><tr><td>新しく追加されたユーザーが<br>チームの所有者である必要があります</td><td>以下を式として入力：<br><code>equals(item()?[&#39;権限&#39;], &#39;所有者&#39;)</code> ※2</td></tr></tbody></table><p>※1 <code>作成-検索結果の1行目</code> は、「(7) 作成-検索結果の1行目」のアクション名です。<br>※2 <code>権限</code> は、メンバー表の列名です。<code>所有者</code> は、メンバー表の権限の列に入力した値です。</p><h3 id="9-待ち時間-遅延"><a href="#9-待ち時間-遅延" class="headerlink" title="(9) 待ち時間 (遅延)"></a>(9) 待ち時間 (遅延)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image11.png"></p><p>スケジュール コネクタの「遅延」アクションを使用し、メンバーの追加後少し待機します。待機無しで次の処理へ移ると、前の処理がまだ処理中で、まれにエラーになることがあるためです。<br>実際に何秒待機するべきかは、サーバーの処理状況によって異なるため、個別に調整が必要です。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>カウント</td><td>5</td></tr><tr><td>単位</td><td>秒</td></tr></tbody></table><h3 id="10-アレイのフィルター処理-自分を抽出"><a href="#10-アレイのフィルター処理-自分を抽出" class="headerlink" title="(10) アレイのフィルター処理-自分を抽出"></a>(10) アレイのフィルター処理-自分を抽出</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image12.png"></p><p>データ操作 コネクタの「<a href="https://learn.microsoft.com/ja-jp/power-automate/data-operations#use-the-filter-array-action">アレイのフィルター処理</a>」アクションを使用し、メンバー表から自分 (フロー作成者) を抽出します。このアクションの出力を使い、既にチーム所有者として登録されている自分を削除するかどうか、権限を変更するかどうかを判定します。設定内容は、(4) のアクションとほぼ同じで、比較演算子が異なるのみです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>差出人</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「value」</td></tr><tr><td>条件式-左辺</td><td>「(2) 表内に存在する行を一覧表示」アクションの出力「メールアドレス」<br>または以下を式として入力：<br><code>item()?[&#39;メールアドレス&#39;]</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式-右辺</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「メール」</td></tr></tbody></table><p>※ <code>メールアドレス</code> は、メンバー表の列名です。</p><h3 id="11-条件-メンバー表に自分がないor所有者ではない"><a href="#11-条件-メンバー表に自分がないor所有者ではない" class="headerlink" title="(11) 条件-メンバー表に自分がないor所有者ではない"></a>(11) 条件-メンバー表に自分がないor所有者ではない</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image13.png"></p><p>コントロール コネクタの「条件」アクションを使用し、メンバー表に自分 (フロー作成者) がいない または メンバー表にはいるけど所有者ではないとき、で処理を分岐します。<br>条件に一致するときのみ、自分から所有者の権限を削除します。<br>メンバー表に自分がいないときはチームから自分を削除すればいいのですが、チームの所有者を削除するには、所有者権限の削除 → メンバーの削除、という 2 つの手順が必要です。</p><p>以下 2 つの条件式を「または」でつなげます：</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式1-左辺</td><td>以下を式として入力：<br><code>length(body(&#39;アレイのフィルター処理-自分を抽出&#39;))</code> ※1</td></tr><tr><td>条件式1-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式1-右辺</td><td><code>0</code></td></tr></tbody></table><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式2-左辺</td><td>以下を式として入力：<br><code>body(&#39;アレイのフィルター処理-自分を抽出&#39;)?[0]?[&#39;権限&#39;]</code> ※1</td></tr><tr><td>条件式2-比較演算子</td><td>「次の値に等しくない」</td></tr><tr><td>条件式2-右辺</td><td><code>所有者</code> ※2</td></tr></tbody></table><p>※1 <code>アレイのフィルター処理-自分を抽出</code> は、「(10) アレイのフィルター処理-自分を抽出」のアクション名です。<code>権限</code> は、メンバー表の列名です。<br>※2 <code>所有者</code> は、メンバー表の権限の列に入力した値です。</p><h3 id="12-HTTP-要求-V2-を送信する"><a href="#12-HTTP-要求-V2-を送信する" class="headerlink" title="(12) HTTP 要求 V2 を送信する"></a>(12) HTTP 要求 V2 を送信する</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image14.png"></p><p>Office 365 Groups コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365groups/#http-%E8%A6%81%E6%B1%82%E3%82%92%E9%80%81%E4%BF%A1%E3%81%99%E3%82%8B-v2-(%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC)">HTTP 要求 V2 を送信する</a>」アクションを使用し、自分 (フロー作成者) から所有者権限を削除します。<br>Teams のチームも Microsoft 365 グループの 1 つなので、メンバーの操作は Office 365 Groups コネクタのアクションからも行えます。しかし所有者権限を削除できるアクションは現時点では提供されていないため、「HTTP 要求 V2 を送信する」アクションを使用し Graph API を実行します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>URI</td><td><code>https://graph.microsoft.com/v1.0/groups/※1/owners/※2/$ref</code></td></tr><tr><td>メソッド</td><td>「DELETE」</td></tr><tr><td>本文</td><td>(空白)</td></tr><tr><td>Content-Type</td><td><code>application/json</code></td></tr></tbody></table><p>※1「(1) チームの作成」アクションの出力「新しいチームID」<br><br>※2「(3) マイ プロフィールの取得 (V2)」アクションの出力「ID」</p><p>参考：<a href="https://learn.microsoft.com/ja-jp/graph/api/group-delete-owners?view=graph-rest-1.0&tabs=http">グループ所有者を削除する - Microsoft Graph v1.0 | Microsoft Learn</a></p><h3 id="13-待ち時間-2-遅延"><a href="#13-待ち時間-2-遅延" class="headerlink" title="(13) 待ち時間 2 (遅延)"></a>(13) 待ち時間 2 (遅延)</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image15.png"></p><p>スケジュール コネクタの「遅延」アクションを使用し、少し処理を待機します。<br>実際に何秒待機するべきかは、サーバーの処理状況によって異なるため、個別に調整が必要です。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>カウント</td><td>5</td></tr><tr><td>単位</td><td>秒</td></tr></tbody></table><h3 id="14-条件-メンバー表に自分がいない"><a href="#14-条件-メンバー表に自分がいない" class="headerlink" title="(14) 条件-メンバー表に自分がいない"></a>(14) 条件-メンバー表に自分がいない</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image16.png"></p><p>コントロール コネクタの「条件」アクションを使用し、メンバー表に自分 (フロー作成者) がいないとき、で条件分岐します。条件に一致するときのみ、チームから自分を削除します。<br>指定する条件は、(11) の条件式1と同じです。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>条件式-左辺</td><td>以下を式として入力：<br><code>length(body(&#39;アレイのフィルター処理-自分を抽出&#39;))</code> ※</td></tr><tr><td>条件式-比較演算子</td><td>「次の値に等しい」</td></tr><tr><td>条件式-右辺</td><td><code>0</code></td></tr></tbody></table><p>※ <code>アレイのフィルター処理-自分を抽出</code> は、「(10) アレイのフィルター処理-自分を抽出」のアクション名です。</p><h3 id="15-グループからメンバーを削除"><a href="#15-グループからメンバーを削除" class="headerlink" title="(15) グループからメンバーを削除"></a>(15) グループからメンバーを削除</h3><p><img src="/blog/powerautomate/create-team-and-add-members/image17.png"></p><p>Office 365 Groups コネクタの「<a href="https://learn.microsoft.com/ja-jp/connectors/office365groups/#%E3%83%A1%E3%83%B3%E3%83%90%E3%83%BC%E3%82%92%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E3%81%8B%E3%82%89%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B">グループからメンバーを削除</a>」アクションを使用し、自分 (フロー作成者) をチームから削除します。</p><table><thead><tr><th>パラメータ名</th><th>値</th></tr></thead><tbody><tr><td>グループ ID</td><td>「(1) チームの作成」アクションの出力「新しいチーム ID」</td></tr><tr><td>ユーザー プリンシパル名</td><td>「(3) マイ プロフィールの取得 (V2)」アクションの出力「ユーザー プリンシパル名」</td></tr></tbody></table><p>フローの各アクションの設定は以上です。</p><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>今回の例では手動トリガーを使用しましたが、例えば手動トリガーの入力に「チーム名」などを追加すれば、実行の度に任意のチーム名を指定できるようになります。<br>そのほか、承認アクションや Microsoft Forms コネクタと組み合わせれば、申請からチーム作成の流れを自動化することも可能です。</p><p>この記事が皆さまの自動化の一助になりましたら幸いです。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは。Power Platform サポートの瀬戸です。&lt;/p&gt;
&lt;p&gt;今回は、Teams の新しいチームの作成と、そのチームへのメンバー追加を、Power Automate で自動化する例をご紹介いたします。組織の方針でチーム作成を申請制にしている場合や、たくさんのチームを一度に作成しなければいけないときにご活用いただけます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Automate" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Automate/"/>
    
    <category term="Cloud flow" scheme="https://jpdynamicscrm.github.io/blog/tags/Cloud-flow/"/>
    
    <category term="How to" scheme="https://jpdynamicscrm.github.io/blog/tags/How-to/"/>
    
  </entry>
  
  <entry>
    <title>環境のテナント移行について</title>
    <link href="https://jpdynamicscrm.github.io/blog/powerplatform/T2T-Introduction/"/>
    <id>https://jpdynamicscrm.github.io/blog/powerplatform/T2T-Introduction/</id>
    <published>2022-12-28T08:30:00.000Z</published>
    <updated>2023-06-06T03:44:31.288Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power Platform サポートチームの島です。<br>本記事では、Power Platform の Dataverse あり環境を他のテナントに移行するプロセスについてご案内します。</p><span id="more"></span><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>Power Platform では、複数テナントの統合や企業組織の変更などに対応するため、環境のテナント移行をサポートしています。<br>テナント移行は運用影響の大きい処理であり、また <strong>リハーサル日程も含めた形で事前に移行スケジュールを計画いただく</strong> ことを弊社として強く推奨しております。<br>そのため計画段階でのお役に立てるよう、移行全体の流れやよくいただくご質問についてご案内いたします。</p><p>なお記事の前提として、以下の点についてご留意ください。</p><ul><li>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。<br>特にテナント移行は環境のダウンタイムを伴う運用影響の大きい処理ですので、確実に移行を完遂するため、記載内容についてはお手元でのご検証や弊社への問合せなどでもご確認ください。</li><li>最新情報につきましては、以下の公開情報もご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant">テナントからテナントへの移行</a></li><li>テナント移行は Dataverse あり環境が対象です。Dataverse なしの環境についてはテナント移行の実施が叶いませんので、Dataverse なしの環境に含まれるキャンバス アプリや Power Automate などの移行方法につきましては、各製品の公開情報をご参照ください。</li></ul><hr><ol><li><a href="#anchor-whole-process">移行の流れ</a></li><li><a href="#anchor-QA">よくいただくご質問</a></li></ol><p><a id='anchor-whole-process'></a></p><h2 id="1-移行の流れ"><a href="#1-移行の流れ" class="headerlink" title="1. 移行の流れ"></a>1. 移行の流れ</h2><p>テナント移行は以下の流れで実施いたします。</p><ol><li>(お客様) 移行対象の本番環境を直近でコピーしている環境について、リハーサル移行用のお問合せを起票いただく。</li><li>(お客様) テナント移行の事前準備を進めていただく。</li><li>(お客様) ユーザー マッピングファイルをご提供いただく。</li><li>(弊社) ユーザー マッピングファイルの検証を実施。</li><li>(弊社) 日程調整の上、テナント移行を実施。</li><li>(お客様・弊社) 1 ～ 5 のプロセスにて、リハーサル後の移行環境の動作に問題がなかった場合には、本番環境に対して 1 ～ 5 のプロセスを実施。</li></ol><h3 id="1-1-お問合せの起票について"><a href="#1-1-お問合せの起票について" class="headerlink" title="1-1. お問合せの起票について"></a>1-1. お問合せの起票について</h3><p>本番環境をコピーしたリハーサル環境をご用意いただいた上で、移行対象の環境ごとに、テナント移行を希望いただいている旨をご連絡ください。<br>お問合せ起票時に、以下の情報をお寄せください。</p><ul><li>移行対象環境の環境 URL</li><li>移行先のテナント ID ※<a href="https://learn.microsoft.com/ja-jp/sharepoint/find-your-office-365-tenant-id">ご確認方法</a></li><li>移行先テナントで環境にセキュリティ グループを割り当てる場合、セキュリティ グループの Azure Active Directory Object ID</li><li>移行実施をご希望の日時</li></ul><p>なお、移行日時をご指定いただく場合には、実施の 1 週間前までにお問合せにて日時をお知らせください。</p><h3 id="1-2-テナント移行の事前準備について"><a href="#1-2-テナント移行の事前準備について" class="headerlink" title="1-2. テナント移行の事前準備について"></a>1-2. テナント移行の事前準備について</h3><p>以下の項目について対応を実施ください。</p><h5 id="1-2-1-移行先テナントのライセンスについて"><a href="#1-2-1-移行先テナントのライセンスについて" class="headerlink" title="1-2-1. 移行先テナントのライセンスについて"></a>1-2-1. 移行先テナントのライセンスについて</h5><p>移行先テナントで、事前にユーザーに環境の利用権を有する Power Platform ライセンスを割り当てください。<br>またテナント単位のライセンスや Power Apps per app ライセンスをお使いの場合など、ユーザーに割り当てるライセンスがない場合にはお問合せにて個別にご相談ください。</p><h5 id="1-2-2-移行先テナントの容量について"><a href="#1-2-2-移行先テナントの容量について" class="headerlink" title="1-2-2. 移行先テナントの容量について"></a>1-2-2. 移行先テナントの容量について</h5><p>移行先テナントにて、移行対象の環境と同等以上の Power Platform テナントの空き容量を確保ください。<br>もしやむを得ず空き容量の確保が難しい場合には、お問合せにて個別にご相談ください。</p><p><a id='anchor-unsupported-components'></a></p><h5 id="1-2-3-事前準備が必要なコンポーネントについて"><a href="#1-2-3-事前準備が必要なコンポーネントについて" class="headerlink" title="1-2-3. 事前準備が必要なコンポーネントについて"></a>1-2-3. 事前準備が必要なコンポーネントについて</h5><p>テナント移行にあたって事前準備を実施いただく必要のあるコンポーネントがございます。<br>各コンポーネントについて、環境上での利用有無をご確認いただき、利用いただいている場合には事前準備を実施ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant?tabs=image#confirm-if-any-of-the-solutions-below-are-installed-in-the-environments-to-be-migrated-as-these-may-require-additional-steps-either-from-you-or-support">ご参考 : 対象コンポーネントについて</a></p><p>なお上記のコンポーネントの中には、キャンバス アプリや Power Automate など、<strong>事前対応いただかなかった場合移行できず消滅する機能</strong> が複数存在いたします。<br>そのため対象機能については、移行後に正しく動作するかをリハーサルにて必ずご確認いただきますようお願い申し上げます。</p><h5 id="1-2-4-ユーザー-SystemUser-テーブルのプラグインについて"><a href="#1-2-4-ユーザー-SystemUser-テーブルのプラグインについて" class="headerlink" title="1-2-4. ユーザー (SystemUser) テーブルのプラグインについて"></a>1-2-4. ユーザー (SystemUser) テーブルのプラグインについて</h5><p>ユーザー (SystemUser) テーブルに対してプラグインを実装いただいている場合、当該プラグインが動作することでユーザー マッピング時に想定しない処理が発生する可能性がございます。<br>そのため、移行前にユーザーテーブルのプラグインを無効化いただきますようお願い申し上げます。</p><h3 id="1-3-ユーザー-マッピングファイルのご提供について"><a href="#1-3-ユーザー-マッピングファイルのご提供について" class="headerlink" title="1-3. ユーザー マッピングファイルのご提供について"></a>1-3. ユーザー マッピングファイルのご提供について</h3><p>ユーザー マッピングファイルは、テナント移行において移行元テナントのユーザーと移行後テナントのユーザーを紐づける定義であり、以下のフォーマットで記述された CSV ファイルです。<br>「_移行元テナントのユーザーの UPN, 移行先テナントのユーザーの UPN_」</p><p>例えば AAA.com テナントから BBB.com テナントへ移行を行い、ユーザー XXX および YYY の 2 名のマッピングを行う場合、ユーザー マッピングファイルは以下のように記述されます。<br><em><code>XXX@AAA.com,XXX@BBB.com</code></em><br><em><code>YYY@AAA.com,YYY@BBB.com</code></em></p><p>そのため、以下の手順に従ってユーザー マッピングファイルを作成し、お問合せ内でご提供ください。<br>・<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/move-environment-tenant?tabs=image#steps-to-create-the-mapping-file">ご参考 : マッピング ファイルを作成するステップ</a></p><p>なお、ユーザー マッピングファイルの内容に起因してテナント移行が失敗する事例が多くございます。<br>そのため、<strong>リハーサル移行であっても極力本番移行と同一のユーザー マッピングファイル</strong> をご提供いただきますようお願い申し上げます。<br>本番移行まで期間が空くなどにより同一ファイルのご提供が難しい場合には、観点を分けての複数回のリハーサル実施も承っております。</p><h3 id="1-4-ユーザー-マッピングファイルの検証について"><a href="#1-4-ユーザー-マッピングファイルの検証について" class="headerlink" title="1-4. ユーザー マッピングファイルの検証について"></a>1-4. ユーザー マッピングファイルの検証について</h3><p>ユーザー マッピングファイルをご提供いただいた後、弊社にてファイルの内容をもとに、ユーザーの存在有無やライセンス状況の確認を行います。<br>問題があった場合にはお問合せ内でその旨をご連絡いたします。<br>問題がない場合には、調整させていただいた日時をもとに、テナント移行の実施を手配いたします。</p><h3 id="1-5-テナント移行の実施について"><a href="#1-5-テナント移行の実施について" class="headerlink" title="1-5. テナント移行の実施について"></a>1-5. テナント移行の実施について</h3><p>いただいた情報をもとに、弊社データセンター部門にてテナント移行を実施いたします。<br>テナント移行の実施中は環境にアクセスいただけなくなりますのでご注意ください。<br>移行完了後、技術サポートから窓口営業時間内に移行結果をご連絡いたします。</p><h3 id="1-6-本番移行の実施について"><a href="#1-6-本番移行の実施について" class="headerlink" title="1-6. 本番移行の実施について"></a>1-6. 本番移行の実施について</h3><p>弊社では、本番環境をテナント移行する場合、移行が適切に行えることを確認するために必ずテスト環境での事前リハーサルをお願いしております。<br>必ず 1 から 5 までの手順にてリハーサル結果が問題ないことを確認の上で、本番環境の移行をご依頼ください。<br>特に <a href="#anchor-unsupported-components">1-2-3</a> の通り、移行にあたって追加対応が必要なコンポーネントにつきましては、必ずリハーサル後に動作をご確認ください。</p><p>本番移行にあたっては、リハーサルを実施した際のお問合せ番号を併記の上、改めてお問合せを起票いただけますと幸いです。</p><hr><p><a id='anchor-QA'></a></p><h2 id="2-よくいただくご質問"><a href="#2-よくいただくご質問" class="headerlink" title="2. よくいただくご質問"></a>2. よくいただくご質問</h2><h3 id="2-1-テナント移行前後で変更される環境情報はあるか"><a href="#2-1-テナント移行前後で変更される環境情報はあるか" class="headerlink" title="2-1. テナント移行前後で変更される環境情報はあるか"></a>2-1. テナント移行前後で変更される環境情報はあるか</h3><p>以下の項目については変更や影響がございますので、ご留意ください。</p><ul><li><a href="#anchor-unsupported-components">事前準備が必要なコンポーネント</a>には移行されないものがございます。</li><li>ユーザー マッピングに伴い、UPN や氏名などのユーザー情報が新テナントの Azure Active Directory の内容に置き換わります。</li></ul><p>以下の項目は変化いたしません。</p><ul><li>環境の URL ※環境を別リージョンに移行する場合を除く</li><li>環境の組織 ID</li><li>モデル駆動型アプリの内容や構成</li><li>関連付けやレコードの所有権情報、セキュリティ ロール情報などを含む Dataverse のすべてのデータ</li></ul><h3 id="2-2-移行の所要時間はどの程度か"><a href="#2-2-移行の所要時間はどの程度か" class="headerlink" title="2.-2. 移行の所要時間はどの程度か"></a>2.-2. 移行の所要時間はどの程度か</h3><p>移行の所要時間は、クラウド リソースの利用状況やネットワーク状況に依存いたします。<br>そのため移行時間を事前にお見積りすることは叶いませんが、通常では数時間程度の所要時間をいただいております。<br>詳細な移行時間につきましては、リハーサル移行の実績を目安としていただけますと幸いです。</p><h3 id="2-3-夜間や休日の移行を希望するが、Microsoft-側でどのような支援体制が可能か"><a href="#2-3-夜間や休日の移行を希望するが、Microsoft-側でどのような支援体制が可能か" class="headerlink" title="2-3 夜間や休日の移行を希望するが、Microsoft 側でどのような支援体制が可能か"></a>2-3 夜間や休日の移行を希望するが、Microsoft 側でどのような支援体制が可能か</h3><p>弊社技術サポートでは、<a href="https://learn.microsoft.com/ja-jp/power-platform/admin/support-overview#what-hours-are-considered-local-business-hours-for-support">弊社技術サポート営業時間</a>内でのご支援を承っております。<br>そのため夜間や休日に移行を実施する場合には、営業時間内での技術サポートからの完了報告が叶いませんので、技術サポートからは翌営業日の営業時間に実施結果をご報告いたします。<br>誠に恐れ入りますが、サポート契約上の制限事項として何卒ご理解を賜りますようお願い申し上げます。</p><p>夜間や休日帯の移行に際し、弊社からのご連絡前に結果を確認されたい場合には、移行が完了したと考えられる時間帯以降に、環境がアクセス可能であることや環境の管理モードが無効となっていることをご確認ください。</p><h3 id="2-4-移行が失敗した場合の対応について"><a href="#2-4-移行が失敗した場合の対応について" class="headerlink" title="2-4 移行が失敗した場合の対応について"></a>2-4 移行が失敗した場合の対応について</h3><p>移行が万が一失敗した場合には、以下の対応を行います。</p><ul><li><p>テナントの移行処理自体が失敗した場合<br>弊社側で、自動で処理のロールバックを行います。</p></li><li><p>ユーザー マッピングが一部ユーザーのライセンス不足などにより失敗した場合<br>テナント移行の自動ロールバックは行いません。そのため環境の移行自体は完了し、ユーザー マッピングのみが完了していない状態となります。<br>この場合には、失敗した原因ごとに、ライセンス付与やユーザー マッピングファイルの修正など、発生事象に応じたご対応をお願い申し上げます。</p></li></ul><p>また、特に本番環境の移行が万が一失敗し、これにより広範な業務停止などの重大な影響が発生した場合には、緊急度重大のお問合せを起票いただくことで、事象回避を目的とした 24 時間体制でご支援できる場合がございます。</p><h3 id="2-5-ユーザー-マッピング後のユーザー情報はどのように更新されるか"><a href="#2-5-ユーザー-マッピング後のユーザー情報はどのように更新されるか" class="headerlink" title="2-5 ユーザー マッピング後のユーザー情報はどのように更新されるか"></a>2-5 ユーザー マッピング後のユーザー情報はどのように更新されるか</h3><p>ユーザー マッピング処理では、環境のユーザー情報のうち、UPN など Azure AD との連携に直接関わる部分の書き換えを行います。<br>これにより、移行完了後のユーザーは新テナントの Azure AD と同期されるようになります。<br>従って、その後は通常のユーザー同期機構により、ユーザー情報 (氏名や状態など) の書き換えが追加で行われます。</p><p>そのため移行後のユーザー状況が意図したものとなっていない場合、ユーザー同期機構の正常な動きに事象が起因する可能性がございますので、一度 Power Platform 管理センターからユーザーを再度追加するなどし、同期内容をご検証いただけますと幸いです。<br>よくいただくご質問として、Office 365 ライセンスのみをお持ちのユーザー様について、ユーザー マッピング後に一時的に状態が無効となるケースがございます。<br>これは当該ユーザーがライセンス要件上、環境に自動で追加されないためでございます。<br>本挙動は通常環境にユーザーを追加いただく際にも発生する正常なものであり、ユーザーの環境利用には影響いたしません。<br>・ご参考 : <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/create-users#categories-of-users-not-added-automatically-in-dataverse">Dataverse に自動的に追加されないユーザーのカテゴリ</a></p><hr><h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h2><p>本記事がテナント移行をご検討いただいている皆様のお役に立てましたら幸いです。<br>ご不明な点などがございましたら、弊社サポート一同にてお待ち申し上げておりますので、ぜひお気軽にお問合せください。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power Platform サポートチームの島です。&lt;br&gt;本記事では、Power Platform の Dataverse あり環境を他のテナントに移行するプロセスについてご案内します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power Platform" scheme="https://jpdynamicscrm.github.io/blog/tags/Power-Platform/"/>
    
    <category term="Environment" scheme="https://jpdynamicscrm.github.io/blog/tags/Environment/"/>
    
    <category term="テナント移行" scheme="https://jpdynamicscrm.github.io/blog/tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E7%A7%BB%E8%A1%8C/"/>
    
  </entry>
  
</feed>
